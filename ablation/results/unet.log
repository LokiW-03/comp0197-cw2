Trial 0:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
/usr/local/lib/python3.11/dist-packages/torch/autograd/graph.py:823: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:180.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.1837727967811666, 'accuracy': 0.7291074606387512, 'precision': 0.8623021260551784, 'recall': 0.3653861083414244, 'iou': 0.2695784308988115, 'dice': 0.3183064425121183}
Test   -> {'loss': 9.21354866027832, 'accuracy': 0.5663613677024841, 'precision': 0.6995325088500977, 'recall': 0.34062445163726807, 'iou': 0.19900226593017578, 'dice': 0.2621656656265259}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5022503591102102, 'accuracy': 0.8178348222504491, 'precision': 0.8481317727462105, 'recall': 0.5227744673905166, 'iou': 0.430860352386599, 'dice': 0.5153410715901333}
Test   -> {'loss': 10.478824615478516, 'accuracy': 0.56390380859375, 'precision': 0.6064627170562744, 'recall': 0.3330773115158081, 'iou': 0.18835791945457458, 'dice': 0.2412167489528656}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4918529523455578, 'accuracy': 0.81994222143422, 'precision': 0.8498956944631494, 'recall': 0.5234189525894497, 'iou': 0.43297879112803417, 'dice': 0.5171125296665274}
Test   -> {'loss': 22.618793487548828, 'accuracy': 0.5416072607040405, 'precision': 0.5279394388198853, 'recall': 0.3284938931465149, 'iou': 0.18094277381896973, 'dice': 0.23495762050151825}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4904650806084923, 'accuracy': 0.8201724200145059, 'precision': 0.8498370033243429, 'recall': 0.5243056065362433, 'iou': 0.4336477480504824, 'dice': 0.5177032230988793}
Test   -> {'loss': 18.629745483398438, 'accuracy': 0.6514917612075806, 'precision': 0.5511078834533691, 'recall': 0.3319624066352844, 'iou': 0.2171885371208191, 'dice': 0.26300927996635437}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.48803776800632476, 'accuracy': 0.821063940162244, 'precision': 0.8504639770673669, 'recall': 0.5246465914923212, 'iou': 0.43459843228692596, 'dice': 0.5184577756601831}
Test   -> {'loss': 16.709976196289062, 'accuracy': 0.5931521058082581, 'precision': 0.7580846548080444, 'recall': 0.33402785658836365, 'iou': 0.19840644299983978, 'dice': 0.24962961673736572}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.4858833994554437, 'accuracy': 0.8215715514576953, 'precision': 0.8508989437766697, 'recall': 0.5250308213026628, 'iou': 0.4352374786915986, 'dice': 0.5189457222171452}
Test   -> {'loss': 17.27189064025879, 'accuracy': 0.5664485692977905, 'precision': 0.5398455858230591, 'recall': 0.3325149118900299, 'iou': 0.18898533284664154, 'dice': 0.24135230481624603}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.48580568264360013, 'accuracy': 0.8215343226557192, 'precision': 0.8508675919926685, 'recall': 0.5252351062453311, 'iou': 0.4350613897261412, 'dice': 0.518819636495217}
Test   -> {'loss': 15.326242446899414, 'accuracy': 0.5684154033660889, 'precision': 0.5233789682388306, 'recall': 0.3326233923435211, 'iou': 0.18981465697288513, 'dice': 0.24188777804374695}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.48472136479357014, 'accuracy': 0.8219087556652401, 'precision': 0.8510605501091999, 'recall': 0.5262392881123916, 'iou': 0.43588452870431155, 'dice': 0.5195348698159923}
Test   -> {'loss': 8.923819541931152, 'accuracy': 0.6249638795852661, 'precision': 0.8749879598617554, 'recall': 0.3333333432674408, 'iou': 0.20832130312919617, 'dice': 0.2564011514186859}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4829367004010988, 'accuracy': 0.8228349908538487, 'precision': 0.8511673535989679, 'recall': 0.5274807082570118, 'iou': 0.4372837902411171, 'dice': 0.5206718214180158}
Test   -> {'loss': 9.114774703979492, 'accuracy': 0.5702439546585083, 'precision': 0.7884528040885925, 'recall': 0.33692091703414917, 'iou': 0.1934472620487213, 'dice': 0.24922099709510803}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.4846353591784187, 'accuracy': 0.8226609774257826, 'precision': 0.8514943446802057, 'recall': 0.5275096003128135, 'iou': 0.43710362833479177, 'dice': 0.5204398384560709}
Test   -> {'loss': 8.003846168518066, 'accuracy': 0.6221450567245483, 'precision': 0.8625451922416687, 'recall': 0.33604705333709717, 'iou': 0.20984452962875366, 'dice': 0.2608890235424042}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 4 with IoU 0.2171885371208191
Test -> {'loss': 18.629745483398438, 'accuracy': 0.6514917612075806, 'precision': 0.5511078834533691, 'recall': 0.3319624066352844, 'iou': 0.2171885371208191, 'dice': 0.26300927996635437} 
Train -> {'loss': 0.4904650806084923, 'accuracy': 0.8201724200145059, 'precision': 0.8498370033243429, 'recall': 0.5243056065362433, 'iou': 0.4336477480504824, 'dice': 0.5177032230988793} 

Best model saved for model unet at epoch 10

Trial 1:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.8094314305678658, 'accuracy': 0.7136201267657073, 'precision': 0.8987429784691852, 'recall': 0.3333333240902942, 'iou': 0.23787338374101596, 'dice': 0.27594497527765194}
Test   -> {'loss': 3.260688066482544, 'accuracy': 0.5785970687866211, 'precision': 0.8439518809318542, 'recall': 0.3333670496940613, 'iou': 0.1928958296775818, 'dice': 0.24441635608673096}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7268430932708408, 'accuracy': 0.7257430216540461, 'precision': 0.9057968150014463, 'recall': 0.3341785039590753, 'iou': 0.24282697594684102, 'dice': 0.2819534586823505}
Test   -> {'loss': 4.149308681488037, 'accuracy': 0.5777332186698914, 'precision': 0.8592444658279419, 'recall': 0.3333333432674408, 'iou': 0.1925777643918991, 'dice': 0.2441195249557495}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6843216020128001, 'accuracy': 0.725606091644453, 'precision': 0.908535387205041, 'recall': 0.3333333432674408, 'iou': 0.2418687053348707, 'dice': 0.280311700053837}
Test   -> {'loss': 4.150728702545166, 'accuracy': 0.5704283118247986, 'precision': 0.8568094968795776, 'recall': 0.3333333432674408, 'iou': 0.19014279544353485, 'dice': 0.2421540468931198}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6130581954251165, 'accuracy': 0.7268115940301315, 'precision': 0.8058651530224344, 'recall': 0.3636767161929089, 'iou': 0.2685243342233741, 'dice': 0.3223776931348054}
Test   -> {'loss': 4.6667046546936035, 'accuracy': 0.6155373454093933, 'precision': 0.6833982467651367, 'recall': 0.3559667766094208, 'iou': 0.2383054792881012, 'dice': 0.31584805250167847}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5394430575163468, 'accuracy': 0.7954473713169927, 'precision': 0.821702810474064, 'recall': 0.5139903944471608, 'iou': 0.41095831316450365, 'dice': 0.4962230189986851}
Test   -> {'loss': 3.3420143127441406, 'accuracy': 0.5856456756591797, 'precision': 0.687133252620697, 'recall': 0.3801797032356262, 'iou': 0.2554800808429718, 'dice': 0.3521944284439087}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5063206263210462, 'accuracy': 0.8162341615428095, 'precision': 0.84135386062705, 'recall': 0.5296773065691409, 'iou': 0.43266069267107093, 'dice': 0.5175340766492097}
Test   -> {'loss': 3.387794017791748, 'accuracy': 0.6137090921401978, 'precision': 0.6917581558227539, 'recall': 0.397352933883667, 'iou': 0.27674996852874756, 'dice': 0.3748134970664978}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.500449522163557, 'accuracy': 0.8175124510474827, 'precision': 0.8442632980968641, 'recall': 0.5265241286028987, 'iou': 0.4325301971124566, 'dice': 0.5172977250555287}
Test   -> {'loss': 5.044373512268066, 'accuracy': 0.6075894236564636, 'precision': 0.7001623511314392, 'recall': 0.37948620319366455, 'iou': 0.2579462230205536, 'dice': 0.35014018416404724}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5027844496395277, 'accuracy': 0.8185481232145558, 'precision': 0.8455784668093143, 'recall': 0.5257361536440642, 'iou': 0.43298535528390303, 'dice': 0.5175964998162311}
Test   -> {'loss': 3.826218843460083, 'accuracy': 0.5994866490364075, 'precision': 0.7113308310508728, 'recall': 0.3789212107658386, 'iou': 0.25114816427230835, 'dice': 0.3419800400733948}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.49415020191151166, 'accuracy': 0.8199582613032798, 'precision': 0.8487691889638486, 'recall': 0.523838452152584, 'iou': 0.4332404737887175, 'dice': 0.5176968305007271}
Test   -> {'loss': 4.777534008026123, 'accuracy': 0.5726701021194458, 'precision': 0.7025368213653564, 'recall': 0.37796542048454285, 'iou': 0.24316346645355225, 'dice': 0.33729082345962524}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.490801532631335, 'accuracy': 0.8207251455472864, 'precision': 0.8492672272350477, 'recall': 0.5242379592812579, 'iou': 0.43400973573974944, 'dice': 0.5182635799698208}
Test   -> {'loss': 3.3071556091308594, 'accuracy': 0.623504638671875, 'precision': 0.701941728591919, 'recall': 0.3787841498851776, 'iou': 0.2618657052516937, 'dice': 0.3513256311416626}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 6 with IoU 0.27674996852874756
Test -> {'loss': 3.387794017791748, 'accuracy': 0.6137090921401978, 'precision': 0.6917581558227539, 'recall': 0.397352933883667, 'iou': 0.27674996852874756, 'dice': 0.3748134970664978} 
Train -> {'loss': 0.5063206263210462, 'accuracy': 0.8162341615428095, 'precision': 0.84135386062705, 'recall': 0.5296773065691409, 'iou': 0.43266069267107093, 'dice': 0.5175340766492097} 

Best model saved for model unet at epoch 10

Trial 2:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 308550.0332640345, 'accuracy': 0.6506535063295261, 'precision': 0.8291808809923089, 'recall': 0.33294874844343764, 'iou': 0.21762824283669824, 'dice': 0.25628163850987734}
Test   -> {'loss': 0.8804177045822144, 'accuracy': 0.6113206148147583, 'precision': 0.8704402446746826, 'recall': 0.3333333432674408, 'iou': 0.20377355813980103, 'dice': 0.25292739272117615}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7250279317731443, 'accuracy': 0.7256061222242273, 'precision': 0.908535401199175, 'recall': 0.3333333432674408, 'iou': 0.2418687182924022, 'dice': 0.28027006452498227}
Test   -> {'loss': 0.9563578367233276, 'accuracy': 0.5858590006828308, 'precision': 0.8619530200958252, 'recall': 0.3333333432674408, 'iou': 0.1952863335609436, 'dice': 0.2462846338748932}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.724060992313468, 'accuracy': 0.7256061232608297, 'precision': 0.9085354019766269, 'recall': 0.3333333432674408, 'iou': 0.2418687185515528, 'dice': 0.2802737692128057}
Test   -> {'loss': 0.9384465217590332, 'accuracy': 0.5984920263290405, 'precision': 0.8661640882492065, 'recall': 0.3333333432674408, 'iou': 0.19949737191200256, 'dice': 0.2496069371700287}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7238064120645108, 'accuracy': 0.7256061219650766, 'precision': 0.908535401199175, 'recall': 0.3333333432674408, 'iou': 0.24186871835718984, 'dice': 0.28027343970278035}
Test   -> {'loss': 0.9242599010467529, 'accuracy': 0.6341714262962341, 'precision': 0.8780571818351746, 'recall': 0.3333333432674408, 'iou': 0.21139049530029297, 'dice': 0.2587127685546875}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7235875233359959, 'accuracy': 0.725606123779131, 'precision': 0.9085353978302168, 'recall': 0.3333333432674408, 'iou': 0.241868717385375, 'dice': 0.2802690078382907}
Test   -> {'loss': 1.0026758909225464, 'accuracy': 0.5480919480323792, 'precision': 0.8493639826774597, 'recall': 0.3333333432674408, 'iou': 0.1826973259449005, 'dice': 0.2360290288925171}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7233683246633281, 'accuracy': 0.7256061235199804, 'precision': 0.9085354009400244, 'recall': 0.3333333432674408, 'iou': 0.2418687182924022, 'dice': 0.2802709387696308}
Test   -> {'loss': 1.0485402345657349, 'accuracy': 0.49834954738616943, 'precision': 0.8327832221984863, 'recall': 0.3333333432674408, 'iou': 0.16611652076244354, 'dice': 0.22173266112804413}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.723095715045929, 'accuracy': 0.7256061222242273, 'precision': 0.9085354009400244, 'recall': 0.3333333432674408, 'iou': 0.24186871868112814, 'dice': 0.2802751846935438}
Test   -> {'loss': 0.9118120670318604, 'accuracy': 0.6080833077430725, 'precision': 0.8693611025810242, 'recall': 0.3333333432674408, 'iou': 0.20269444584846497, 'dice': 0.25209444761276245}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7230356314907903, 'accuracy': 0.7256061248157335, 'precision': 0.9085353988668193, 'recall': 0.3333333432674408, 'iou': 0.2418687179684639, 'dice': 0.2802766387877257}
Test   -> {'loss': 0.959290623664856, 'accuracy': 0.5776528716087341, 'precision': 0.859217643737793, 'recall': 0.3333333432674408, 'iou': 0.19255098700523376, 'dice': 0.2440980076789856}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7227223033490389, 'accuracy': 0.7256061230016791, 'precision': 0.9085353980893675, 'recall': 0.3333333432674408, 'iou': 0.24186871822761452, 'dice': 0.28026592161344444}
Test   -> {'loss': 0.9244598150253296, 'accuracy': 0.5909261703491211, 'precision': 0.8636420965194702, 'recall': 0.3333333432674408, 'iou': 0.19697539508342743, 'dice': 0.24762354791164398}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.722061770895253, 'accuracy': 0.7256061240382816, 'precision': 0.9085353993851205, 'recall': 0.3333333432674408, 'iou': 0.24186871745016264, 'dice': 0.2802755138148432}
Test   -> {'loss': 0.8845271468162537, 'accuracy': 0.6341228485107422, 'precision': 0.8780409693717957, 'recall': 0.3333333432674408, 'iou': 0.21137431263923645, 'dice': 0.2587006092071533}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 4 with IoU 0.21139049530029297
Test -> {'loss': 0.9242599010467529, 'accuracy': 0.6341714262962341, 'precision': 0.8780571818351746, 'recall': 0.3333333432674408, 'iou': 0.21139049530029297, 'dice': 0.2587127685546875} 
Train -> {'loss': 0.7238064120645108, 'accuracy': 0.7256061219650766, 'precision': 0.908535401199175, 'recall': 0.3333333432674408, 'iou': 0.24186871835718984, 'dice': 0.28027343970278035} 

Best model saved for model unet at epoch 10

Trial 3:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 227641806.99400124, 'accuracy': 0.582073849050895, 'precision': 0.8036246634047964, 'recall': 0.33269056263177293, 'iou': 0.19415059433035228, 'dice': 0.2347564050036928}
Test   -> {'loss': 0.9446830153465271, 'accuracy': 0.5999117493629456, 'precision': 0.8666372299194336, 'recall': 0.3333333432674408, 'iou': 0.19997058808803558, 'dice': 0.2499770224094391}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7705539076224618, 'accuracy': 0.7256057267603667, 'precision': 0.9085352674774502, 'recall': 0.3333333432674408, 'iou': 0.24186858664388242, 'dice': 0.2803134589091591}
Test   -> {'loss': 0.9808993339538574, 'accuracy': 0.5674684643745422, 'precision': 0.8558228015899658, 'recall': 0.3333333432674408, 'iou': 0.1891561597585678, 'dice': 0.24135242402553558}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7361651373946149, 'accuracy': 0.7256057267603667, 'precision': 0.9085352690323539, 'recall': 0.3333333432674408, 'iou': 0.2418685863847318, 'dice': 0.2803107383458511}
Test   -> {'loss': 0.9704251885414124, 'accuracy': 0.5739067196846008, 'precision': 0.8579689264297485, 'recall': 0.3333333432674408, 'iou': 0.19130223989486694, 'dice': 0.24309222400188446}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7265821285869765, 'accuracy': 0.7256057257237641, 'precision': 0.9085352690323539, 'recall': 0.3333333432674408, 'iou': 0.24186858508897865, 'dice': 0.28031741717587344}
Test   -> {'loss': 1.00095534324646, 'accuracy': 0.5617255568504333, 'precision': 0.8539085388183594, 'recall': 0.3333333432674408, 'iou': 0.18724185228347778, 'dice': 0.23978841304779053}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.72354089539984, 'accuracy': 0.7256057272786679, 'precision': 0.9085352695506552, 'recall': 0.3333333432674408, 'iou': 0.2418685856072799, 'dice': 0.2803139474080957}
Test   -> {'loss': 0.9786412119865417, 'accuracy': 0.5857549905776978, 'precision': 0.8619183301925659, 'recall': 0.3333333432674408, 'iou': 0.1952516734600067, 'dice': 0.24625705182552338}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7225691017897232, 'accuracy': 0.7256057262420654, 'precision': 0.9085352638493414, 'recall': 0.3333333432674408, 'iou': 0.24186858806921088, 'dice': 0.28031215304913726}
Test   -> {'loss': 0.930952250957489, 'accuracy': 0.6171180605888367, 'precision': 0.8723727464675903, 'recall': 0.3333333432674408, 'iou': 0.20570603013038635, 'dice': 0.25441065430641174}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7222735005876292, 'accuracy': 0.7256057334982831, 'precision': 0.9085352679957515, 'recall': 0.3333333432674408, 'iou': 0.24186858508897865, 'dice': 0.28031272032986515}
Test   -> {'loss': 0.984163761138916, 'accuracy': 0.5760394930839539, 'precision': 0.8586798906326294, 'recall': 0.3333333432674408, 'iou': 0.1920131891965866, 'dice': 0.2436654418706894}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7222035630889561, 'accuracy': 0.7256057226139566, 'precision': 0.9085352654042451, 'recall': 0.3333333432674408, 'iou': 0.24186858521855395, 'dice': 0.28031634377396625}
Test   -> {'loss': 0.9708627462387085, 'accuracy': 0.5969200730323792, 'precision': 0.8656400442123413, 'recall': 0.3333333432674408, 'iou': 0.19897335767745972, 'dice': 0.249196395277977}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7221812170484792, 'accuracy': 0.7256057272786679, 'precision': 0.9085352638493414, 'recall': 0.3333333432674408, 'iou': 0.24186858716218368, 'dice': 0.2803122815878495}
Test   -> {'loss': 0.9607527852058411, 'accuracy': 0.6074697971343994, 'precision': 0.8691565990447998, 'recall': 0.3333333432674408, 'iou': 0.2024899572134018, 'dice': 0.25193625688552856}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7221816477568254, 'accuracy': 0.7256057277969692, 'precision': 0.9085352659225464, 'recall': 0.3333333432674408, 'iou': 0.24186858521855395, 'dice': 0.28030955739643265}
Test   -> {'loss': 0.9707248210906982, 'accuracy': 0.5995302796363831, 'precision': 0.8665100932121277, 'recall': 0.3333333432674408, 'iou': 0.19984343647956848, 'dice': 0.24987763166427612}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 6 with IoU 0.20570603013038635
Test -> {'loss': 0.930952250957489, 'accuracy': 0.6171180605888367, 'precision': 0.8723727464675903, 'recall': 0.3333333432674408, 'iou': 0.20570603013038635, 'dice': 0.25441065430641174} 
Train -> {'loss': 0.7225691017897232, 'accuracy': 0.7256057262420654, 'precision': 0.9085352638493414, 'recall': 0.3333333432674408, 'iou': 0.24186858806921088, 'dice': 0.28031215304913726} 

Best model saved for model unet at epoch 10

Trial 4:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7996318467285322, 'accuracy': 0.7565264715124731, 'precision': 0.9117878867232281, 'recall': 0.33473870844944664, 'iou': 0.25327257177104123, 'dice': 0.2881092236417791}
Test   -> {'loss': 4.882120132446289, 'accuracy': 0.45314866304397583, 'precision': 0.5998565554618835, 'recall': 0.38740843534469604, 'iou': 0.21966050565242767, 'dice': 0.3016147017478943}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4911830214054688, 'accuracy': 0.7896993344244749, 'precision': 0.7856187201064566, 'recall': 0.45960812711197396, 'iou': 0.3608865621297256, 'dice': 0.43605416041353473}
Test   -> {'loss': 14.277595520019531, 'accuracy': 0.5280238389968872, 'precision': 0.5230168104171753, 'recall': 0.35358166694641113, 'iou': 0.2107451856136322, 'dice': 0.2819311022758484}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4657011734402698, 'accuracy': 0.8008979761082193, 'precision': 0.7241714246895002, 'recall': 0.4765890659197517, 'iou': 0.3834847189809965, 'dice': 0.4685272946305897}
Test   -> {'loss': 18.626384735107422, 'accuracy': 0.5602454543113708, 'precision': 0.5420438647270203, 'recall': 0.3545829951763153, 'iou': 0.21602335572242737, 'dice': 0.2865845859050751}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4575344067552815, 'accuracy': 0.8033833998700847, 'precision': 0.6581113694802575, 'recall': 0.4951988856429639, 'iou': 0.4014542578355126, 'dice': 0.49923440399377245}
Test   -> {'loss': 18.315202713012695, 'accuracy': 0.5355212092399597, 'precision': 0.45564568042755127, 'recall': 0.3823988139629364, 'iou': 0.24189506471157074, 'dice': 0.34667086601257324}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.46939205721668575, 'accuracy': 0.798637838208157, 'precision': 0.6888766943112664, 'recall': 0.4843566867320434, 'iou': 0.38969923989928285, 'dice': 0.4821680767380673}
Test   -> {'loss': 15.616568565368652, 'accuracy': 0.5946742296218872, 'precision': 0.43528836965560913, 'recall': 0.3434452414512634, 'iou': 0.22445301711559296, 'dice': 0.2955438494682312}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.459972571030907, 'accuracy': 0.802108652436215, 'precision': 0.6698390029046847, 'recall': 0.49589186660621476, 'iou': 0.3990536900966064, 'dice': 0.4942450923764187}
Test   -> {'loss': 16.136734008789062, 'accuracy': 0.5751379728317261, 'precision': 0.5048806667327881, 'recall': 0.3979807496070862, 'iou': 0.2679174542427063, 'dice': 0.3746647238731384}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.43247210940589076, 'accuracy': 0.8141811365666597, 'precision': 0.6591916287722794, 'recall': 0.5532619544993276, 'iou': 0.450392691337544, 'dice': 0.5679911380228789}
Test   -> {'loss': 16.598539352416992, 'accuracy': 0.5851975679397583, 'precision': 0.5070945620536804, 'recall': 0.4413893222808838, 'iou': 0.31121110916137695, 'dice': 0.43821829557418823}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.409942787108214, 'accuracy': 0.8235688745975495, 'precision': 0.6775670144868934, 'recall': 0.5940419721862544, 'iou': 0.48381770991760753, 'dice': 0.6104145419338475}
Test   -> {'loss': 21.147117614746094, 'accuracy': 0.5113425850868225, 'precision': 0.4243003726005554, 'recall': 0.3721844553947449, 'iou': 0.23779544234275818, 'dice': 0.3462175726890564}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.38996623339860337, 'accuracy': 0.8334611991177434, 'precision': 0.6976817602696626, 'recall': 0.6182015821985577, 'iou': 0.5080951134795728, 'dice': 0.637472300944121}
Test   -> {'loss': 12.772059440612793, 'accuracy': 0.6002658009529114, 'precision': 0.5143658518791199, 'recall': 0.42173612117767334, 'iou': 0.29618436098098755, 'dice': 0.413618803024292}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.38090596808039623, 'accuracy': 0.8385061865267547, 'precision': 0.7093018749485845, 'recall': 0.630976423750753, 'iou': 0.5202228276625923, 'dice': 0.6505399472039679}
Test   -> {'loss': 16.744789123535156, 'accuracy': 0.6070282459259033, 'precision': 0.4697563648223877, 'recall': 0.4116952121257782, 'iou': 0.29387766122817993, 'dice': 0.4111824035644531}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 7 with IoU 0.31121110916137695
Test -> {'loss': 16.598539352416992, 'accuracy': 0.5851975679397583, 'precision': 0.5070945620536804, 'recall': 0.4413893222808838, 'iou': 0.31121110916137695, 'dice': 0.43821829557418823} 
Train -> {'loss': 0.43247210940589076, 'accuracy': 0.8141811365666597, 'precision': 0.6591916287722794, 'recall': 0.5532619544993276, 'iou': 0.450392691337544, 'dice': 0.5679911380228789} 

Best model saved for model unet at epoch 10

Trial 5:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7958401747371839, 'accuracy': 0.7351869298064191, 'precision': 0.829660557663959, 'recall': 0.334671987398811, 'iou': 0.24569491925446885, 'dice': 0.2813572822705559}
Test   -> {'loss': 3.5220320224761963, 'accuracy': 0.5986816883087158, 'precision': 0.8662272691726685, 'recall': 0.3333333432674408, 'iou': 0.19956056773662567, 'dice': 0.24965642392635345}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.677884286382924, 'accuracy': 0.762199676555136, 'precision': 0.9207332517789758, 'recall': 0.3333333432674408, 'iou': 0.2540665735369143, 'dice': 0.2883367279301519}
Test   -> {'loss': 7.227869033813477, 'accuracy': 0.6152082085609436, 'precision': 0.8717360496520996, 'recall': 0.3333333432674408, 'iou': 0.2050694078207016, 'dice': 0.2539231777191162}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6371231794357299, 'accuracy': 0.7620095719461856, 'precision': 0.893508596005647, 'recall': 0.3487294850142106, 'iou': 0.2653521693271139, 'dice': 0.3055012215738711}
Test   -> {'loss': 22.461639404296875, 'accuracy': 0.5849170088768005, 'precision': 0.8616390228271484, 'recall': 0.3333333432674408, 'iou': 0.19497233629226685, 'dice': 0.24603477120399475}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5000073782775714, 'accuracy': 0.7863049838853919, 'precision': 0.7340215662251348, 'recall': 0.46476389273353247, 'iou': 0.36292134264241094, 'dice': 0.4420689178549725}
Test   -> {'loss': 17.297630310058594, 'accuracy': 0.6123301982879639, 'precision': 0.4635930061340332, 'recall': 0.349394291639328, 'iou': 0.22705772519111633, 'dice': 0.29581326246261597}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.46007909230563954, 'accuracy': 0.8020754280297653, 'precision': 0.6660369007483773, 'recall': 0.48855487989342733, 'iou': 0.3952460035033848, 'dice': 0.48968335752901826}
Test   -> {'loss': 23.506975173950195, 'accuracy': 0.5873082876205444, 'precision': 0.4807496964931488, 'recall': 0.35942456126213074, 'iou': 0.22714295983314514, 'dice': 0.30476123094558716}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.4565468754457391, 'accuracy': 0.8033600895301155, 'precision': 0.6410757510558419, 'recall': 0.5000435899133268, 'iou': 0.4050911395446114, 'dice': 0.5057598025902458}
Test   -> {'loss': 26.13532829284668, 'accuracy': 0.6072141528129578, 'precision': 0.48818439245224, 'recall': 0.33492547273635864, 'iou': 0.20493416488170624, 'dice': 0.2564848065376282}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4574150406795999, 'accuracy': 0.8031941937363666, 'precision': 0.6675416049749955, 'recall': 0.5001661634963491, 'iou': 0.40377388881600423, 'dice': 0.5023804213689721}
Test   -> {'loss': 12.872447967529297, 'accuracy': 0.5479838848114014, 'precision': 0.5857822895050049, 'recall': 0.36352431774139404, 'iou': 0.22636571526527405, 'dice': 0.29788070917129517}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.457744878789653, 'accuracy': 0.8029671777849612, 'precision': 0.6654264672942783, 'recall': 0.4919383474018263, 'iou': 0.3988929878110471, 'dice': 0.4949902031732642}
Test   -> {'loss': 14.57341194152832, 'accuracy': 0.6107809543609619, 'precision': 0.45400357246398926, 'recall': 0.39557886123657227, 'iou': 0.2805250585079193, 'dice': 0.38701921701431274}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4539724642815797, 'accuracy': 0.8047050424244093, 'precision': 0.6309622660927151, 'recall': 0.5092552083989849, 'iou': 0.41358258827872896, 'dice': 0.5188007160373356}
Test   -> {'loss': 16.828527450561523, 'accuracy': 0.6213210821151733, 'precision': 0.43547123670578003, 'recall': 0.4064878821372986, 'iou': 0.29609525203704834, 'dice': 0.40812593698501587}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.4453702615654987, 'accuracy': 0.808678792870563, 'precision': 0.6466544959856116, 'recall': 0.5270141964373382, 'iou': 0.4301782750565073, 'dice': 0.5437919181326162}
Test   -> {'loss': 27.648632049560547, 'accuracy': 0.5671947002410889, 'precision': 0.43260741233825684, 'recall': 0.39784061908721924, 'iou': 0.272569477558136, 'dice': 0.38782498240470886}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 9 with IoU 0.29609525203704834
Test -> {'loss': 16.828527450561523, 'accuracy': 0.6213210821151733, 'precision': 0.43547123670578003, 'recall': 0.4064878821372986, 'iou': 0.29609525203704834, 'dice': 0.40812593698501587} 
Train -> {'loss': 0.4539724642815797, 'accuracy': 0.8047050424244093, 'precision': 0.6309622660927151, 'recall': 0.5092552083989849, 'iou': 0.41358258827872896, 'dice': 0.5188007160373356} 

Best model saved for model unet at epoch 10

Trial 6:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 90307.16026321675, 'accuracy': 0.6912972167296254, 'precision': 0.875034545685934, 'recall': 0.3335537078587905, 'iou': 0.23076055816820135, 'dice': 0.2653921541960343}
Test   -> {'loss': 2.9528439044952393, 'accuracy': 0.626375138759613, 'precision': 0.8754584193229675, 'recall': 0.3333333432674408, 'iou': 0.20879171788692474, 'dice': 0.25675714015960693}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6742801803609599, 'accuracy': 0.7621860576712567, 'precision': 0.9207287106824957, 'recall': 0.3333333432674408, 'iou': 0.25406203321788623, 'dice': 0.2883094371660896}
Test   -> {'loss': 63.959877014160156, 'accuracy': 0.5950142741203308, 'precision': 0.8650047779083252, 'recall': 0.3333333432674408, 'iou': 0.1983380913734436, 'dice': 0.24869757890701294}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6712320973043856, 'accuracy': 0.7621860561163529, 'precision': 0.9207287106824957, 'recall': 0.3333333432674408, 'iou': 0.2540620320517084, 'dice': 0.28830142435820205}
Test   -> {'loss': 11.947797775268555, 'accuracy': 0.639668345451355, 'precision': 0.8798894882202148, 'recall': 0.3333333432674408, 'iou': 0.21322278678417206, 'dice': 0.26008039712905884}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6700763466565506, 'accuracy': 0.7621860558572022, 'precision': 0.9207287109416464, 'recall': 0.3333333432674408, 'iou': 0.2540620335418245, 'dice': 0.288305933320004}
Test   -> {'loss': 79.5053482055664, 'accuracy': 0.6104462146759033, 'precision': 0.870148777961731, 'recall': 0.3333333432674408, 'iou': 0.20348207652568817, 'dice': 0.2527027428150177}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6675158140452012, 'accuracy': 0.762186058189558, 'precision': 0.9207287099050439, 'recall': 0.3333333432674408, 'iou': 0.2540620330883109, 'dice': 0.28830495191657024}
Test   -> {'loss': 45.20954132080078, 'accuracy': 0.5852947235107422, 'precision': 0.8617649078369141, 'recall': 0.3333333432674408, 'iou': 0.19509826600551605, 'dice': 0.24613499641418457}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6659974300343058, 'accuracy': 0.7621860566346542, 'precision': 0.9207287150880564, 'recall': 0.3333333432674408, 'iou': 0.2540620328291603, 'dice': 0.28830456306105073}
Test   -> {'loss': 26.8613224029541, 'accuracy': 0.6353386044502258, 'precision': 0.8784462213516235, 'recall': 0.3333333432674408, 'iou': 0.21177953481674194, 'dice': 0.2590039074420929}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6661343911419744, 'accuracy': 0.7621860576712567, 'precision': 0.9207287101641946, 'recall': 0.3333333432674408, 'iou': 0.25406203269958494, 'dice': 0.2883040955533152}
Test   -> {'loss': 50.02579879760742, 'accuracy': 0.6539978981018066, 'precision': 0.8846659660339355, 'recall': 0.3333333432674408, 'iou': 0.21799930930137634, 'dice': 0.2636028826236725}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6644333419592484, 'accuracy': 0.7621860545614492, 'precision': 0.9207287130148515, 'recall': 0.3333333432674408, 'iou': 0.2540620330883109, 'dice': 0.2883063009251719}
Test   -> {'loss': 34.35055923461914, 'accuracy': 0.6274189949035645, 'precision': 0.8758063316345215, 'recall': 0.3333333432674408, 'iou': 0.20913967490196228, 'dice': 0.2570200562477112}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6643498135649639, 'accuracy': 0.7621860563755035, 'precision': 0.9207287135331527, 'recall': 0.3333333432674408, 'iou': 0.2540620328939479, 'dice': 0.28830693467803625}
Test   -> {'loss': 104.77457427978516, 'accuracy': 0.5103772282600403, 'precision': 0.6230587959289551, 'recall': 0.3337518572807312, 'iou': 0.17063650488853455, 'dice': 0.2262938916683197}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6616680663564931, 'accuracy': 0.7621860571529554, 'precision': 0.920728709127592, 'recall': 0.3333333432674408, 'iou': 0.25406203373618746, 'dice': 0.2883024446342302}
Test   -> {'loss': 41.050174713134766, 'accuracy': 0.6441824436187744, 'precision': 0.8813941478729248, 'recall': 0.3333333432674408, 'iou': 0.2147275060415268, 'dice': 0.26119667291641235}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 7 with IoU 0.21799930930137634
Test -> {'loss': 50.02579879760742, 'accuracy': 0.6539978981018066, 'precision': 0.8846659660339355, 'recall': 0.3333333432674408, 'iou': 0.21799930930137634, 'dice': 0.2636028826236725} 
Train -> {'loss': 0.6661343911419744, 'accuracy': 0.7621860576712567, 'precision': 0.9207287101641946, 'recall': 0.3333333432674408, 'iou': 0.25406203269958494, 'dice': 0.2883040955533152} 

Best model saved for model unet at epoch 10

Trial 7:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 15537663.04380541, 'accuracy': 0.5900814618105473, 'precision': 0.7044061349785846, 'recall': 0.333631190787191, 'iou': 0.1996377969889537, 'dice': 0.23779172722412192}
Test   -> {'loss': 1.0138342380523682, 'accuracy': 0.5511431097984314, 'precision': 0.850381076335907, 'recall': 0.3333333432674408, 'iou': 0.1837143748998642, 'dice': 0.23687611520290375}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7972968878953354, 'accuracy': 0.7622039649797523, 'precision': 0.9207346729610277, 'recall': 0.3333333432674408, 'iou': 0.2540680004202801, 'dice': 0.28834509694057964}
Test   -> {'loss': 0.9963080883026123, 'accuracy': 0.598451554775238, 'precision': 0.8661505579948425, 'recall': 0.3333333432674408, 'iou': 0.19948385655879974, 'dice': 0.24959638714790344}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7121066824249599, 'accuracy': 0.7622039603150409, 'precision': 0.920734675552534, 'recall': 0.3333333432674408, 'iou': 0.2540680017160333, 'dice': 0.288343963674877}
Test   -> {'loss': 1.07439124584198, 'accuracy': 0.5829452276229858, 'precision': 0.860981822013855, 'recall': 0.3333333432674408, 'iou': 0.1943150758743286, 'dice': 0.24551080167293549}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6924988865852356, 'accuracy': 0.7622039603150409, 'precision': 0.9207346760708353, 'recall': 0.3333333432674408, 'iou': 0.2540680019751839, 'dice': 0.28834075772244}
Test   -> {'loss': 1.1207927465438843, 'accuracy': 0.5838707089424133, 'precision': 0.8612902164459229, 'recall': 0.3333333432674408, 'iou': 0.19462357461452484, 'dice': 0.24575689435005188}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6873725362445997, 'accuracy': 0.7622039618699447, 'precision': 0.9207346854002579, 'recall': 0.3333333432674408, 'iou': 0.2540680019751839, 'dice': 0.2883405607679616}
Test   -> {'loss': 1.151362419128418, 'accuracy': 0.5824581980705261, 'precision': 0.8608194589614868, 'recall': 0.3333333432674408, 'iou': 0.19415274262428284, 'dice': 0.2453811764717102}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6859064418336619, 'accuracy': 0.7622039572052334, 'precision': 0.9207346822904504, 'recall': 0.3333333432674408, 'iou': 0.254068001586458, 'dice': 0.288343840578328}
Test   -> {'loss': 1.2238988876342773, 'accuracy': 0.5593168139457703, 'precision': 0.8531056642532349, 'recall': 0.3333333432674408, 'iou': 0.18643894791603088, 'dice': 0.23912900686264038}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6855045505191969, 'accuracy': 0.7622039634248484, 'precision': 0.9207346719244253, 'recall': 0.3333333432674408, 'iou': 0.2540680030117864, 'dice': 0.28833998234375663}
Test   -> {'loss': 1.274195671081543, 'accuracy': 0.5446251034736633, 'precision': 0.8482083678245544, 'recall': 0.3333333432674408, 'iou': 0.18154171109199524, 'dice': 0.23506247997283936}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6853888003722481, 'accuracy': 0.7622039561686309, 'precision': 0.920734677625739, 'recall': 0.3333333432674408, 'iou': 0.25406800560329273, 'dice': 0.2883421848649564}
Test   -> {'loss': 1.2646337747573853, 'accuracy': 0.5462802052497864, 'precision': 0.8487600684165955, 'recall': 0.3333333432674408, 'iou': 0.18209341168403625, 'dice': 0.23552446067333221}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6853652762330097, 'accuracy': 0.7622039582418358, 'precision': 0.9207346719244253, 'recall': 0.3333333432674408, 'iou': 0.2540680019751839, 'dice': 0.28834333316139554}
Test   -> {'loss': 1.2135756015777588, 'accuracy': 0.5766791105270386, 'precision': 0.858893096446991, 'recall': 0.3333333432674408, 'iou': 0.19222639501094818, 'dice': 0.24383704364299774}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6853601434956427, 'accuracy': 0.7622039654980535, 'precision': 0.9207346739976302, 'recall': 0.3333333432674408, 'iou': 0.25406799886537634, 'dice': 0.2883436374042345}
Test   -> {'loss': 1.1487493515014648, 'accuracy': 0.59699946641922, 'precision': 0.8656665682792664, 'recall': 0.3333333432674408, 'iou': 0.19899985194206238, 'dice': 0.24921715259552002}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 2 with IoU 0.19948385655879974
Test -> {'loss': 0.9963080883026123, 'accuracy': 0.598451554775238, 'precision': 0.8661505579948425, 'recall': 0.3333333432674408, 'iou': 0.19948385655879974, 'dice': 0.24959638714790344} 
Train -> {'loss': 0.7972968878953354, 'accuracy': 0.7622039649797523, 'precision': 0.9207346729610277, 'recall': 0.3333333432674408, 'iou': 0.2540680004202801, 'dice': 0.28834509694057964} 

Best model saved for model unet at epoch 10

Trial 8:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.069125945671745, 'accuracy': 0.698622969052066, 'precision': 0.858601480981578, 'recall': 0.38407626294571423, 'iou': 0.26991747938420463, 'dice': 0.3267718823707622}
Test   -> {'loss': 2.1461703777313232, 'accuracy': 0.708304226398468, 'precision': 0.7534540891647339, 'recall': 0.35407349467277527, 'iou': 0.25839531421661377, 'dice': 0.3184319734573364}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5667612362167109, 'accuracy': 0.7923753398915996, 'precision': 0.8317368820957516, 'recall': 0.5345435794280923, 'iou': 0.4272823603256889, 'dice': 0.5140867326570594}
Test   -> {'loss': 2.309263229370117, 'accuracy': 0.6780071258544922, 'precision': 0.8303819894790649, 'recall': 0.4027789235115051, 'iou': 0.29043036699295044, 'dice': 0.3806813657283783}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5514764332253, 'accuracy': 0.7959320809530175, 'precision': 0.8355149660421455, 'recall': 0.5360571221165035, 'iou': 0.43096179703007576, 'dice': 0.5169889733843182}
Test   -> {'loss': 3.837510347366333, 'accuracy': 0.6584023833274841, 'precision': 0.7803627848625183, 'recall': 0.3718737065792084, 'iou': 0.25830721855163574, 'dice': 0.3368545472621918}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5345882673626361, 'accuracy': 0.8015451695608056, 'precision': 0.8413706341515417, 'recall': 0.5440622237713441, 'iou': 0.43841199952623117, 'dice': 0.5229231843481893}
Test   -> {'loss': 2.600612163543701, 'accuracy': 0.6143150925636292, 'precision': 0.7584347128868103, 'recall': 0.3919437527656555, 'iou': 0.26252758502960205, 'dice': 0.35654014348983765}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5167991399765015, 'accuracy': 0.8074706554412842, 'precision': 0.8460725043130958, 'recall': 0.5518842255291732, 'iou': 0.4467058707838473, 'dice': 0.529652188912682}
Test   -> {'loss': 3.1865038871765137, 'accuracy': 0.6695718169212341, 'precision': 0.7193642854690552, 'recall': 0.3654581904411316, 'iou': 0.2608877420425415, 'dice': 0.33671507239341736}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.49057751012885054, 'accuracy': 0.8167952503847039, 'precision': 0.8539021331331004, 'recall': 0.563736527380736, 'iou': 0.45945229284141376, 'dice': 0.5394394805897837}
Test   -> {'loss': 5.208897590637207, 'accuracy': 0.5933974981307983, 'precision': 0.7195910215377808, 'recall': 0.3458150625228882, 'iou': 0.21386054158210754, 'dice': 0.28089994192123413}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4723273440547611, 'accuracy': 0.8231333639310754, 'precision': 0.859436724756075, 'recall': 0.5713302884412849, 'iou': 0.46804838815461036, 'dice': 0.5458839704161105}
Test   -> {'loss': 6.849422931671143, 'accuracy': 0.5990725159645081, 'precision': 0.7658678889274597, 'recall': 0.3793279528617859, 'iou': 0.24479322135448456, 'dice': 0.3334041237831116}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.45839738055415774, 'accuracy': 0.8277650335560675, 'precision': 0.8069197094958761, 'recall': 0.5766752561797266, 'iou': 0.47420484060826507, 'dice': 0.5504411860652592}
Test   -> {'loss': 4.930847644805908, 'accuracy': 0.6504740715026855, 'precision': 0.8276416659355164, 'recall': 0.39298105239868164, 'iou': 0.27187269926071167, 'dice': 0.36107930541038513}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.44842824119588603, 'accuracy': 0.8309491649917934, 'precision': 0.7411405873039495, 'recall': 0.580315869398739, 'iou': 0.47869383031907287, 'dice': 0.5537931767494783}
Test   -> {'loss': 4.603142738342285, 'accuracy': 0.577473521232605, 'precision': 0.7644988894462585, 'recall': 0.3596981167793274, 'iou': 0.2188882678747177, 'dice': 0.29625824093818665}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.4390846126753351, 'accuracy': 0.833852990295576, 'precision': 0.6940175243045973, 'recall': 0.5830089781595313, 'iou': 0.4826132762691249, 'dice': 0.556886023801306}
Test   -> {'loss': 5.631560802459717, 'accuracy': 0.5903021097183228, 'precision': 0.4179031252861023, 'recall': 0.34129059314727783, 'iou': 0.20554104447364807, 'dice': 0.26566147804260254}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 2 with IoU 0.29043036699295044
Test -> {'loss': 2.309263229370117, 'accuracy': 0.6780071258544922, 'precision': 0.8303819894790649, 'recall': 0.4027789235115051, 'iou': 0.29043036699295044, 'dice': 0.3806813657283783} 
Train -> {'loss': 0.5667612362167109, 'accuracy': 0.7923753398915996, 'precision': 0.8317368820957516, 'recall': 0.5345435794280923, 'iou': 0.4272823603256889, 'dice': 0.5140867326570594} 

Best model saved for model unet at epoch 10

Trial 9:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.6150244567705236, 'accuracy': 0.6757114517947902, 'precision': 0.8742242797561314, 'recall': 0.3337051103944364, 'iou': 0.22726608832245287, 'dice': 0.271018439013025}
Test   -> {'loss': 1.874530553817749, 'accuracy': 0.5901243090629578, 'precision': 0.8633748292922974, 'recall': 0.3333333432674408, 'iou': 0.19670811295509338, 'dice': 0.24741224944591522}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7726825340934421, 'accuracy': 0.6876892307530279, 'precision': 0.8539635326551355, 'recall': 0.35577157036117885, 'iou': 0.245697116592656, 'dice': 0.2966357728709345}
Test   -> {'loss': 2.6012022495269775, 'accuracy': 0.6526576280593872, 'precision': 0.7431166172027588, 'recall': 0.45725592970848083, 'iou': 0.3268499970436096, 'dice': 0.4320177435874939}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5789023238679637, 'accuracy': 0.7867274196251579, 'precision': 0.8226700451063074, 'recall': 0.5437793534734975, 'iou': 0.42592275039009425, 'dice': 0.5135124501974686}
Test   -> {'loss': 2.232736110687256, 'accuracy': 0.6740607023239136, 'precision': 0.7715997695922852, 'recall': 0.45710277557373047, 'iou': 0.33443766832351685, 'dice': 0.43697938323020935}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5634997373041899, 'accuracy': 0.7927824626798216, 'precision': 0.8299557732499164, 'recall': 0.5373140583867612, 'iou': 0.42859117051829465, 'dice': 0.5154657773349596}
Test   -> {'loss': 2.0456833839416504, 'accuracy': 0.695797324180603, 'precision': 0.7772256135940552, 'recall': 0.48702192306518555, 'iou': 0.36140650510787964, 'dice': 0.4628285765647888}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5523990931718246, 'accuracy': 0.7953659270120703, 'precision': 0.8339034401852151, 'recall': 0.5370790351992069, 'iou': 0.4306895577389261, 'dice': 0.5170982205349466}
Test   -> {'loss': 2.036170721054077, 'accuracy': 0.67018061876297, 'precision': 0.7796359062194824, 'recall': 0.4725501537322998, 'iou': 0.34477218985557556, 'dice': 0.4496312737464905}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.543069731152576, 'accuracy': 0.7980835987173993, 'precision': 0.8367360462313113, 'recall': 0.5412143297817396, 'iou': 0.4344776081002277, 'dice': 0.5201138682987378}
Test   -> {'loss': 2.615464210510254, 'accuracy': 0.6789799928665161, 'precision': 0.7771685123443604, 'recall': 0.4831686019897461, 'iou': 0.3542192876338959, 'dice': 0.4578534960746765}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5336468717326288, 'accuracy': 0.8015151733937471, 'precision': 0.8414038855096568, 'recall': 0.5450369181840317, 'iou': 0.43866744844809824, 'dice': 0.5234127972436988}
Test   -> {'loss': 2.115598201751709, 'accuracy': 0.6887063384056091, 'precision': 0.77657151222229, 'recall': 0.48368656635284424, 'iou': 0.3577365279197693, 'dice': 0.4603630304336548}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5275233926980392, 'accuracy': 0.8035619036011074, 'precision': 0.8436472234518632, 'recall': 0.5483784359434377, 'iou': 0.44177071167075116, 'dice': 0.5259219765663147}
Test   -> {'loss': 2.332343101501465, 'accuracy': 0.6896785497665405, 'precision': 0.7833776473999023, 'recall': 0.4350421130657196, 'iou': 0.3230544328689575, 'dice': 0.42050454020500183}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5096143955769746, 'accuracy': 0.8091956724291263, 'precision': 0.8473828481591266, 'recall': 0.5541914551154427, 'iou': 0.44905657638674196, 'dice': 0.5316782567812048}
Test   -> {'loss': 3.1393511295318604, 'accuracy': 0.6471853256225586, 'precision': 0.7850430011749268, 'recall': 0.44807034730911255, 'iou': 0.31728023290634155, 'dice': 0.422145813703537}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5081807945085608, 'accuracy': 0.8099050055379453, 'precision': 0.8479657167973725, 'recall': 0.5558678860249726, 'iou': 0.45017825235491216, 'dice': 0.5325188636779785}
Test   -> {'loss': 3.2127981185913086, 'accuracy': 0.6225872039794922, 'precision': 0.784308910369873, 'recall': 0.44197171926498413, 'iou': 0.302185982465744, 'dice': 0.40861690044403076}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 4 with IoU 0.36140650510787964
Test -> {'loss': 2.0456833839416504, 'accuracy': 0.695797324180603, 'precision': 0.7772256135940552, 'recall': 0.48702192306518555, 'iou': 0.36140650510787964, 'dice': 0.4628285765647888} 
Train -> {'loss': 0.5634997373041899, 'accuracy': 0.7927824626798216, 'precision': 0.8299557732499164, 'recall': 0.5373140583867612, 'iou': 0.42859117051829465, 'dice': 0.5154657773349596} 

Best model saved for model unet at epoch 10

Trial 10:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 83281375.5922552, 'accuracy': 0.6618761447784693, 'precision': 0.8518844835784124, 'recall': 0.3338142839462861, 'iou': 0.2220844325730982, 'dice': 0.265086515215428}
Test   -> {'loss': 1.0270631313323975, 'accuracy': 0.5276501774787903, 'precision': 0.8425500392913818, 'recall': 0.3333333432674408, 'iou': 0.17588339745998383, 'dice': 0.23026657104492188}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.8048821516658948, 'accuracy': 0.6912362832090129, 'precision': 0.8970787851706795, 'recall': 0.3333333432674408, 'iou': 0.2304121044018994, 'dice': 0.27240115430044093}
Test   -> {'loss': 0.9968861937522888, 'accuracy': 0.5458884835243225, 'precision': 0.8486294746398926, 'recall': 0.3333333432674408, 'iou': 0.18196283280849457, 'dice': 0.23541520535945892}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.804874252754709, 'accuracy': 0.6912362858005192, 'precision': 0.8970787872438846, 'recall': 0.3333333432674408, 'iou': 0.23041210524413896, 'dice': 0.2724094208167947}
Test   -> {'loss': 1.0842058658599854, 'accuracy': 0.4619302451610565, 'precision': 0.820643424987793, 'recall': 0.3333333432674408, 'iou': 0.15397675335407257, 'dice': 0.2106485664844513}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.8048753502576248, 'accuracy': 0.6912362842456155, 'precision': 0.8970787851706795, 'recall': 0.3333333432674408, 'iou': 0.23041210427232411, 'dice': 0.2723927175221236}
Test   -> {'loss': 1.1058706045150757, 'accuracy': 0.45159661769866943, 'precision': 0.8171989321708679, 'recall': 0.3333333432674408, 'iou': 0.15053221583366394, 'dice': 0.20740225911140442}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.8048556053120157, 'accuracy': 0.6912362850230673, 'precision': 0.8970787913902946, 'recall': 0.3333333432674408, 'iou': 0.2304121056328649, 'dice': 0.272411972284317}
Test   -> {'loss': 0.8986124992370605, 'accuracy': 0.6362640857696533, 'precision': 0.878754734992981, 'recall': 0.3333333432674408, 'iou': 0.21208803355693817, 'dice': 0.2592344880104065}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.8049097786778989, 'accuracy': 0.691236284504766, 'precision': 0.8970787802468175, 'recall': 0.3333333432674408, 'iou': 0.23041210466105005, 'dice': 0.2723964536319608}
Test   -> {'loss': 1.0044078826904297, 'accuracy': 0.5395058989524841, 'precision': 0.8465020060539246, 'recall': 0.3333333432674408, 'iou': 0.17983531951904297, 'dice': 0.2336273044347763}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.8049140471479167, 'accuracy': 0.6912362863188205, 'precision': 0.8970787900945415, 'recall': 0.3333333432674408, 'iou': 0.2304121053089266, 'dice': 0.2724013433508251}
Test   -> {'loss': 0.9434722065925598, 'accuracy': 0.5877311825752258, 'precision': 0.8625770807266235, 'recall': 0.3333333432674408, 'iou': 0.19591039419174194, 'dice': 0.24678032100200653}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.8049636921157007, 'accuracy': 0.691236284504766, 'precision': 0.8970787869847339, 'recall': 0.3333333432674408, 'iou': 0.23041210517935132, 'dice': 0.2724064070245494}
Test   -> {'loss': 0.9105554819107056, 'accuracy': 0.6190110445022583, 'precision': 0.8730037212371826, 'recall': 0.3333333432674408, 'iou': 0.20633703470230103, 'dice': 0.2548926770687103}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.8049026592918064, 'accuracy': 0.6912362865779711, 'precision': 0.8970787851706795, 'recall': 0.3333333432674408, 'iou': 0.23041210492020067, 'dice': 0.27240484071814497}
Test   -> {'loss': 0.871126651763916, 'accuracy': 0.6558240056037903, 'precision': 0.8852746486663818, 'recall': 0.3333333432674408, 'iou': 0.21860800683498383, 'dice': 0.26404738426208496}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.8049214277578437, 'accuracy': 0.6912362839864648, 'precision': 0.897078786207282, 'recall': 0.3333333432674408, 'iou': 0.23041210543850194, 'dice': 0.2724005592905957}
Test   -> {'loss': 0.965477466583252, 'accuracy': 0.5793431997299194, 'precision': 0.8597811460494995, 'recall': 0.3333333432674408, 'iou': 0.19311439990997314, 'dice': 0.24455027282238007}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 9 with IoU 0.21860800683498383
Test -> {'loss': 0.871126651763916, 'accuracy': 0.6558240056037903, 'precision': 0.8852746486663818, 'recall': 0.3333333432674408, 'iou': 0.21860800683498383, 'dice': 0.26404738426208496} 
Train -> {'loss': 0.8049026592918064, 'accuracy': 0.6912362865779711, 'precision': 0.8970787851706795, 'recall': 0.3333333432674408, 'iou': 0.23041210492020067, 'dice': 0.27240484071814497} 

Best model saved for model unet at epoch 10

Trial 11:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 52641964.995898075, 'accuracy': 0.5981874459463618, 'precision': 0.672780273012493, 'recall': 0.3340582119381946, 'iou': 0.20663527933799702, 'dice': 0.2569109934827556}
Test   -> {'loss': 0.8996943235397339, 'accuracy': 0.6338189244270325, 'precision': 0.8779397010803223, 'recall': 0.3333333432674408, 'iou': 0.21127299964427948, 'dice': 0.25862473249435425}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.8164324858914251, 'accuracy': 0.6912312823793162, 'precision': 0.8970771105393119, 'recall': 0.3333333432674408, 'iou': 0.23041043696196184, 'dice': 0.272457689565161}
Test   -> {'loss': 0.9245530962944031, 'accuracy': 0.6078410148620605, 'precision': 0.8692803382873535, 'recall': 0.3333333432674408, 'iou': 0.2026136815547943, 'dice': 0.25203198194503784}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.8059998336045638, 'accuracy': 0.691231286007425, 'precision': 0.8970771172772283, 'recall': 0.3333333432674408, 'iou': 0.2304104367028112, 'dice': 0.2724592815274778}
Test   -> {'loss': 0.946622371673584, 'accuracy': 0.5910055637359619, 'precision': 0.8636685609817505, 'recall': 0.3333333432674408, 'iou': 0.1970018744468689, 'dice': 0.24764446914196014}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.8049761067266049, 'accuracy': 0.691231281861015, 'precision': 0.8970771177955296, 'recall': 0.3333333432674408, 'iou': 0.23041043475918146, 'dice': 0.27245420606239984}
Test   -> {'loss': 0.9300835132598877, 'accuracy': 0.5986602306365967, 'precision': 0.8662201166152954, 'recall': 0.3333333432674408, 'iou': 0.19955341517925262, 'dice': 0.24965080618858337}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.8048774625944055, 'accuracy': 0.6912312839342201, 'precision': 0.8970771162406258, 'recall': 0.3333333432674408, 'iou': 0.2304104367028112, 'dice': 0.27245798732923426}
Test   -> {'loss': 0.9884159564971924, 'accuracy': 0.5539647340774536, 'precision': 0.8513215780258179, 'recall': 0.3333333432674408, 'iou': 0.18465492129325867, 'dice': 0.23765650391578674}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.8048568974370541, 'accuracy': 0.6912312828976175, 'precision': 0.8970771152040232, 'recall': 0.3333333432674408, 'iou': 0.23041043540705805, 'dice': 0.2724592618320299}
Test   -> {'loss': 0.9450576305389404, 'accuracy': 0.5939218997955322, 'precision': 0.8646406531333923, 'recall': 0.3333333432674408, 'iou': 0.19797396659851074, 'dice': 0.2484111189842224}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.8048578391904416, 'accuracy': 0.6912312761597011, 'precision': 0.8970771177955296, 'recall': 0.3333333432674408, 'iou': 0.2304104367028112, 'dice': 0.2724594686342322}
Test   -> {'loss': 0.9545648694038391, 'accuracy': 0.5878828167915344, 'precision': 0.8626276254653931, 'recall': 0.3333333432674408, 'iou': 0.19596093893051147, 'dice': 0.24682042002677917}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.8048492348712424, 'accuracy': 0.6912312782329062, 'precision': 0.8970771141674208, 'recall': 0.3333333432674408, 'iou': 0.23041043631408525, 'dice': 0.2724637923033341}
Test   -> {'loss': 1.0036817789077759, 'accuracy': 0.5453366637229919, 'precision': 0.8484455943107605, 'recall': 0.3333333432674408, 'iou': 0.1817788928747177, 'dice': 0.2352612316608429}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.8048788132874862, 'accuracy': 0.6912312839342201, 'precision': 0.8970771115759145, 'recall': 0.3333333432674408, 'iou': 0.23041043748026308, 'dice': 0.2724617247996123}
Test   -> {'loss': 0.9554908275604248, 'accuracy': 0.5836016535758972, 'precision': 0.8612005710601807, 'recall': 0.3333333432674408, 'iou': 0.19453388452529907, 'dice': 0.2456853836774826}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.804865420901257, 'accuracy': 0.6912312771963036, 'precision': 0.8970771110576132, 'recall': 0.3333333432674408, 'iou': 0.23041043709153713, 'dice': 0.27245773750802743}
Test   -> {'loss': 0.9690289497375488, 'accuracy': 0.5738590955734253, 'precision': 0.8579530715942383, 'recall': 0.3333333432674408, 'iou': 0.1912863701581955, 'dice': 0.24307940900325775}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model unet at epoch 10
Best model found at epoch 1 with IoU 0.21127299964427948
Test -> {'loss': 0.8996943235397339, 'accuracy': 0.6338189244270325, 'precision': 0.8779397010803223, 'recall': 0.3333333432674408, 'iou': 0.21127299964427948, 'dice': 0.25862473249435425} 
Train -> {'loss': 52641964.995898075, 'accuracy': 0.5981874459463618, 'precision': 0.672780273012493, 'recall': 0.3340582119381946, 'iou': 0.20663527933799702, 'dice': 0.2569109934827556} 

Best model saved for model unet at epoch 10

Best parameters:
Best parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Max IoU: 0.3306
Best metrics: {'loss': 2.571415146744261, 'accuracy': 0.674321193498823, 'precision': 0.7840349439640206, 'recall': 0.45342094343765843, 'iou': 0.33062065406338204, 'dice': 0.4319327228333782}
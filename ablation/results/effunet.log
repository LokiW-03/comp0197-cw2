[6]
18m
1
!python -m ablation.grid_search --result_path=efficientunet_result1.csv
100% 792M/792M [00:31<00:00, 25.5MB/s]
100% 19.2M/19.2M [00:01<00:00, 13.8MB/s]

Trial 0:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
100% 97.8M/97.8M [00:00<00:00, 199MB/s]
/usr/local/lib/python3.11/dist-packages/torch/autograd/graph.py:823: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:180.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Downloading: "https://download.pytorch.org/models/efficientnet_b0_rwightman-7f5810bc.pth" to /root/.cache/torch/hub/checkpoints/efficientnet_b0_rwightman-7f5810bc.pth
100% 20.5M/20.5M [00:00<00:00, 135MB/s] 
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4272787502278452, 'accuracy': 0.8442237768484199, 'precision': 0.6681531341179557, 'recall': 0.5972237982179808, 'iou': 0.5116440539126811, 'dice': 0.5774686608625494}
Test   -> {'loss': 9.011999130249023, 'accuracy': 0.6280579566955566, 'precision': 0.41686147451400757, 'recall': 0.3617594242095947, 'iou': 0.24335941672325134, 'dice': 0.32223403453826904}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.34279819675113843, 'accuracy': 0.8735265358634617, 'precision': 0.7505405889905017, 'recall': 0.6186867151571357, 'iou': 0.5419510246618934, 'dice': 0.5973838417426399}
Test   -> {'loss': 47.378875732421875, 'accuracy': 0.5516942739486694, 'precision': 0.3511754870414734, 'recall': 0.33217960596084595, 'iou': 0.20005449652671814, 'dice': 0.2690426707267761}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.305388946701651, 'accuracy': 0.8849833244862764, 'precision': 0.7391343912352686, 'recall': 0.6283454286015552, 'iou': 0.5559561400309853, 'dice': 0.605906654699989}
Test   -> {'loss': 5.5471906661987305, 'accuracy': 0.5263796448707581, 'precision': 0.28026503324508667, 'recall': 0.3255874812602997, 'iou': 0.18368898332118988, 'dice': 0.24638646841049194}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.27993750986845595, 'accuracy': 0.8925269704797993, 'precision': 0.7274016012316165, 'recall': 0.634554912732995, 'iou': 0.5655586102734441, 'dice': 0.6119035477223603}
Test   -> {'loss': 7.904478549957275, 'accuracy': 0.4393061399459839, 'precision': 0.40093547105789185, 'recall': 0.34368932247161865, 'iou': 0.16002216935157776, 'dice': 0.23317019641399384}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.26031280581070027, 'accuracy': 0.8979411441346873, 'precision': 0.7385394189668738, 'recall': 0.6393933073334072, 'iou': 0.5732601738494375, 'dice': 0.617645837172218}
Test   -> {'loss': 8.655247688293457, 'accuracy': 0.6214537024497986, 'precision': 0.4101228713989258, 'recall': 0.3594962954521179, 'iou': 0.2428312748670578, 'dice': 0.322409987449646}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.24062430003414984, 'accuracy': 0.9034847096256587, 'precision': 0.7406761353430541, 'recall': 0.6449180380157803, 'iou': 0.5814890452053236, 'dice': 0.6240615914697233}
Test   -> {'loss': 8.67598819732666, 'accuracy': 0.5547709465026855, 'precision': 0.37735384702682495, 'recall': 0.3379473388195038, 'iou': 0.19616685807704926, 'dice': 0.2609347999095917}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.22497131688439329, 'accuracy': 0.9079608388569044, 'precision': 0.7377303947573123, 'recall': 0.6582410452158555, 'iou': 0.598462116199991, 'dice': 0.6478460664334504}
Test   -> {'loss': 7.7212910652160645, 'accuracy': 0.513916015625, 'precision': 0.2762514650821686, 'recall': 0.32863110303878784, 'iou': 0.17542880773544312, 'dice': 0.23465624451637268}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.21346531154020973, 'accuracy': 0.9116497190102287, 'precision': 0.7472553766292075, 'recall': 0.6747102320194245, 'iou': 0.6171204541040504, 'dice': 0.6747969961684683}
Test   -> {'loss': 10.250073432922363, 'accuracy': 0.5476771593093872, 'precision': 0.4130142629146576, 'recall': 0.4038066864013672, 'iou': 0.27546370029449463, 'dice': 0.3969688415527344}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.19792933697285858, 'accuracy': 0.9172158801037332, 'precision': 0.7653368040271428, 'recall': 0.7023562633472941, 'iou': 0.6452237683793772, 'dice': 0.7126181672448697}
Test   -> {'loss': 19.400054931640625, 'accuracy': 0.5031987428665161, 'precision': 0.3513549268245697, 'recall': 0.3580930233001709, 'iou': 0.2340458333492279, 'dice': 0.3442581593990326}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.19340725638296294, 'accuracy': 0.9188982846944228, 'precision': 0.7702137511709463, 'recall': 0.7123780439729276, 'iou': 0.6543427086394766, 'dice': 0.7243457563545392}
Test   -> {'loss': 25.72736930847168, 'accuracy': 0.4235316514968872, 'precision': 0.3361504077911377, 'recall': 0.34240707755088806, 'iou': 0.20323801040649414, 'dice': 0.31677961349487305}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 8 with IoU 0.27546370029449463
Test -> {'loss': 10.250073432922363, 'accuracy': 0.5476771593093872, 'precision': 0.4130142629146576, 'recall': 0.4038066864013672, 'iou': 0.27546370029449463, 'dice': 0.3969688415527344} 
Train -> {'loss': 0.21346531154020973, 'accuracy': 0.9116497190102287, 'precision': 0.7472553766292075, 'recall': 0.6747102320194245, 'iou': 0.6171204541040504, 'dice': 0.6747969961684683} 

Best model saved for model efficientunet at epoch 10

Trial 1:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.46297449314075967, 'accuracy': 0.8255009941432787, 'precision': 0.6103546894114951, 'recall': 0.5823939328608305, 'iou': 0.49649822686029516, 'dice': 0.5648520682169044}
Test   -> {'loss': 35.4586181640625, 'accuracy': 0.5241310000419617, 'precision': 0.3027300536632538, 'recall': 0.325769305229187, 'iou': 0.19343791902065277, 'dice': 0.26660865545272827}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3076026439666748, 'accuracy': 0.8847329626912656, 'precision': 0.6831547509069028, 'recall': 0.6276025191597316, 'iou': 0.555789654151253, 'dice': 0.6061704257260199}
Test   -> {'loss': 22.24500846862793, 'accuracy': 0.6204005479812622, 'precision': 0.38533079624176025, 'recall': 0.3475765585899353, 'iou': 0.23271775245666504, 'dice': 0.30522701144218445}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.2615740708682848, 'accuracy': 0.897723472636679, 'precision': 0.7139718770980835, 'recall': 0.6387905115666597, 'iou': 0.5725737602814384, 'dice': 0.6167537072430487}
Test   -> {'loss': 16.291353225708008, 'accuracy': 0.5277871489524841, 'precision': 0.3175291419029236, 'recall': 0.322706401348114, 'iou': 0.19893985986709595, 'dice': 0.2756027579307556}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.22870252689589624, 'accuracy': 0.9068273585775625, 'precision': 0.7364186701567277, 'recall': 0.6569221600242283, 'iou': 0.5965924853863923, 'dice': 0.6462027694868004}
Test   -> {'loss': 6.8961181640625, 'accuracy': 0.6144284605979919, 'precision': 0.42380291223526, 'recall': 0.3440416753292084, 'iou': 0.22942900657653809, 'dice': 0.301036536693573}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.21142104851162952, 'accuracy': 0.9126855725827424, 'precision': 0.752780676924664, 'recall': 0.6831791914027671, 'iou': 0.6258482793103094, 'dice': 0.6877351309942162}
Test   -> {'loss': 4.681403160095215, 'accuracy': 0.565487265586853, 'precision': 0.5020968914031982, 'recall': 0.351892352104187, 'iou': 0.21579289436340332, 'dice': 0.290480375289917}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.1986574595389159, 'accuracy': 0.9173159853271816, 'precision': 0.7658262631167536, 'recall': 0.6941656651704208, 'iou': 0.6382233733716218, 'dice': 0.7020521620045538}
Test   -> {'loss': 9.248022079467773, 'accuracy': 0.6166260242462158, 'precision': 0.4787103533744812, 'recall': 0.33471810817718506, 'iou': 0.2084003984928131, 'dice': 0.25966572761535645}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.18093999676082445, 'accuracy': 0.9232758014098458, 'precision': 0.7833083754000456, 'recall': 0.7345155000686645, 'iou': 0.6742868267971537, 'dice': 0.7487541965816332}
Test   -> {'loss': 25.6015682220459, 'accuracy': 0.5805302858352661, 'precision': 0.26240605115890503, 'recall': 0.32957518100738525, 'iou': 0.19573229551315308, 'dice': 0.2492126226425171}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.17687632933906886, 'accuracy': 0.9254246825757234, 'precision': 0.7908196786175603, 'recall': 0.7415096168932708, 'iou': 0.6810623039369997, 'dice': 0.756102979183197}
Test   -> {'loss': 15.010872840881348, 'accuracy': 0.5451230406761169, 'precision': 0.36913126707077026, 'recall': 0.3336469531059265, 'iou': 0.18393179774284363, 'dice': 0.23974435031414032}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.16526750196581302, 'accuracy': 0.9298457814299542, 'precision': 0.8042955870213716, 'recall': 0.754915686275648, 'iou': 0.6942642429600592, 'dice': 0.7699717594229657}
Test   -> {'loss': 16.28629493713379, 'accuracy': 0.6032801866531372, 'precision': 0.4532000422477722, 'recall': 0.3364493250846863, 'iou': 0.20629648864269257, 'dice': 0.26128506660461426}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.15479923577412316, 'accuracy': 0.9338353872299194, 'precision': 0.8143257068551105, 'recall': 0.7799230979836506, 'iou': 0.715045570290607, 'dice': 0.7931849738825922}
Test   -> {'loss': 10.90079402923584, 'accuracy': 0.5668783187866211, 'precision': 0.40168771147727966, 'recall': 0.3359104096889496, 'iou': 0.20566624402999878, 'dice': 0.272000789642334}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.23271775245666504
Test -> {'loss': 22.24500846862793, 'accuracy': 0.6204005479812622, 'precision': 0.38533079624176025, 'recall': 0.3475765585899353, 'iou': 0.23271775245666504, 'dice': 0.30522701144218445} 
Train -> {'loss': 0.3076026439666748, 'accuracy': 0.8847329626912656, 'precision': 0.6831547509069028, 'recall': 0.6276025191597316, 'iou': 0.555789654151253, 'dice': 0.6061704257260199} 

Best model saved for model efficientunet at epoch 10

Trial 2:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4199087101480235, 'accuracy': 0.8466904689436373, 'precision': 0.6691388561673787, 'recall': 0.5985604948323706, 'iou': 0.5140932701204134, 'dice': 0.578981387226478}
Test   -> {'loss': 14.593086242675781, 'accuracy': 0.5159787535667419, 'precision': 0.33819836378097534, 'recall': 0.3339841067790985, 'iou': 0.17664013803005219, 'dice': 0.23640817403793335}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3415692217971968, 'accuracy': 0.874271578633267, 'precision': 0.7205534751000612, 'recall': 0.6194740596024887, 'iou': 0.5428923779207727, 'dice': 0.5979610632295194}
Test   -> {'loss': 13.224244117736816, 'accuracy': 0.5612369179725647, 'precision': 0.36962518095970154, 'recall': 0.3489697575569153, 'iou': 0.2315659373998642, 'dice': 0.32323887944221497}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.30906727495400804, 'accuracy': 0.8844246382298677, 'precision': 0.7553006211052771, 'recall': 0.6276407552802045, 'iou': 0.5553057046040245, 'dice': 0.605492367433465}
Test   -> {'loss': 15.633724212646484, 'accuracy': 0.6202990412712097, 'precision': 0.3733469843864441, 'recall': 0.33548682928085327, 'iou': 0.21065300703048706, 'dice': 0.2634374499320984}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.27574074877345045, 'accuracy': 0.8936205153879913, 'precision': 0.7319407867348713, 'recall': 0.6351451788259589, 'iou': 0.5667793382769045, 'dice': 0.6124445692352627}
Test   -> {'loss': 6.589667320251465, 'accuracy': 0.6002732515335083, 'precision': 0.3141198754310608, 'recall': 0.32352715730667114, 'iou': 0.2122851312160492, 'dice': 0.27441465854644775}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.25560214532458264, 'accuracy': 0.8993617078532343, 'precision': 0.7365017046099124, 'recall': 0.639896870955177, 'iou': 0.5742393234501715, 'dice': 0.6172015301559283}
Test   -> {'loss': 173.32411193847656, 'accuracy': 0.45002466440200806, 'precision': 0.3416820168495178, 'recall': 0.35200509428977966, 'iou': 0.20761483907699585, 'dice': 0.3157775104045868}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.24301579892635344, 'accuracy': 0.9032575957153155, 'precision': 0.7379239836464757, 'recall': 0.6452294813550037, 'iou': 0.5816676637400752, 'dice': 0.6248061625853829}
Test   -> {'loss': 111.6290054321289, 'accuracy': 0.4549386203289032, 'precision': 0.3651909828186035, 'recall': 0.37668928503990173, 'iou': 0.21670269966125488, 'dice': 0.32751935720443726}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.22203317226275154, 'accuracy': 0.9088769150816876, 'precision': 0.7409551397613857, 'recall': 0.6583473379197328, 'iou': 0.5990334228329036, 'dice': 0.6474916147149128}
Test   -> {'loss': 69.72748565673828, 'accuracy': 0.4575282335281372, 'precision': 0.38607534766197205, 'recall': 0.3861027657985687, 'iou': 0.2180640548467636, 'dice': 0.3314589858055115}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.20658224931229716, 'accuracy': 0.9140555482843647, 'precision': 0.7552100075327832, 'recall': 0.684050470849742, 'iou': 0.62676311938659, 'dice': 0.6871576500975567}
Test   -> {'loss': 67.38066864013672, 'accuracy': 0.4805820882320404, 'precision': 0.36760085821151733, 'recall': 0.3812592923641205, 'iou': 0.23128172755241394, 'dice': 0.3458770513534546}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.19734128337839377, 'accuracy': 0.9176401340443155, 'precision': 0.7659991681575775, 'recall': 0.7068453457044519, 'iou': 0.6491426159506258, 'dice': 0.7179876107236614}
Test   -> {'loss': 64.2630615234375, 'accuracy': 0.5208030343055725, 'precision': 0.3989722728729248, 'recall': 0.3711051940917969, 'iou': 0.23289017379283905, 'dice': 0.33826014399528503}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.18867123126983643, 'accuracy': 0.9206173922704614, 'precision': 0.7755762527818265, 'recall': 0.7208790693594062, 'iou': 0.6621566173822984, 'dice': 0.7339496635872385}
Test   -> {'loss': 109.29659271240234, 'accuracy': 0.5079731941223145, 'precision': 0.3619248867034912, 'recall': 0.3770012855529785, 'iou': 0.24406719207763672, 'dice': 0.3572293221950531}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.24406719207763672
Test -> {'loss': 109.29659271240234, 'accuracy': 0.5079731941223145, 'precision': 0.3619248867034912, 'recall': 0.3770012855529785, 'iou': 0.24406719207763672, 'dice': 0.3572293221950531} 
Train -> {'loss': 0.18867123126983643, 'accuracy': 0.9206173922704614, 'precision': 0.7755762527818265, 'recall': 0.7208790693594062, 'iou': 0.6621566173822984, 'dice': 0.7339496635872385} 

Best model saved for model efficientunet at epoch 10

Trial 3:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4572410329528477, 'accuracy': 0.8272968727609386, 'precision': 0.6150404458460601, 'recall': 0.5879934010298355, 'iou': 0.5010818230069202, 'dice': 0.5687617130901502}
Test   -> {'loss': 48.420814514160156, 'accuracy': 0.6061684489250183, 'precision': 0.30753540992736816, 'recall': 0.327886700630188, 'iou': 0.20566090941429138, 'dice': 0.258774995803833}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.31616442099861475, 'accuracy': 0.8829363403112992, 'precision': 0.6934376975764399, 'recall': 0.6261067359343819, 'iou': 0.5538512095161107, 'dice': 0.6053431459095167}
Test   -> {'loss': 10.819243431091309, 'accuracy': 0.5735607147216797, 'precision': 0.36929088830947876, 'recall': 0.33693093061447144, 'iou': 0.2004828155040741, 'dice': 0.2617390751838684}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.261228523047074, 'accuracy': 0.8980750089106353, 'precision': 0.7248414138089055, 'recall': 0.6396761749101721, 'iou': 0.5739818832148676, 'dice': 0.6188699048498403}
Test   -> {'loss': 9.663820266723633, 'accuracy': 0.5809450745582581, 'precision': 0.44276928901672363, 'recall': 0.33989769220352173, 'iou': 0.2016039788722992, 'dice': 0.2602651119232178}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.23259153871432595, 'accuracy': 0.9058357948842256, 'precision': 0.7396421613900558, 'recall': 0.6495381122050078, 'iou': 0.5880157190820445, 'dice': 0.6326449171356533}
Test   -> {'loss': 18.225194931030273, 'accuracy': 0.5858680605888367, 'precision': 0.39036473631858826, 'recall': 0.3480289876461029, 'iou': 0.2199266254901886, 'dice': 0.29439419507980347}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.21008893691975136, 'accuracy': 0.9123890394749848, 'precision': 0.7536335266154746, 'recall': 0.6677730679512024, 'iou': 0.6104088254596876, 'dice': 0.6626239284225132}
Test   -> {'loss': 34.238040924072266, 'accuracy': 0.5411781668663025, 'precision': 0.3541611135005951, 'recall': 0.34424179792404175, 'iou': 0.21548227965831757, 'dice': 0.3019125461578369}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.1987132445625637, 'accuracy': 0.9170625251272451, 'precision': 0.7657632045123888, 'recall': 0.6947935726331628, 'iou': 0.6382361422414365, 'dice': 0.7019204502520354}
Test   -> {'loss': 61.60475540161133, 'accuracy': 0.592951238155365, 'precision': 0.36855348944664, 'recall': 0.34633558988571167, 'iou': 0.22246800363063812, 'dice': 0.2963179349899292}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.18453135075776472, 'accuracy': 0.9214777158654255, 'precision': 0.7799264814542688, 'recall': 0.7081280117449553, 'iou': 0.6517874375633571, 'dice': 0.717612910270691}
Test   -> {'loss': 78.36917877197266, 'accuracy': 0.5677888989448547, 'precision': 0.3234456479549408, 'recall': 0.33266305923461914, 'iou': 0.2067451924085617, 'dice': 0.2759900391101837}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.17271514949591263, 'accuracy': 0.9260482570399409, 'precision': 0.7925762829573259, 'recall': 0.7341477974601414, 'iou': 0.6766724602035854, 'dice': 0.7497639319171077}
Test   -> {'loss': 25.839820861816406, 'accuracy': 0.6073006987571716, 'precision': 0.3855140209197998, 'recall': 0.3372369706630707, 'iou': 0.21263357996940613, 'dice': 0.2719705104827881}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.16454488660978234, 'accuracy': 0.9299472456393034, 'precision': 0.803541954703953, 'recall': 0.7635893391526264, 'iou': 0.7002453270165817, 'dice': 0.7776124902393506}
Test   -> {'loss': 23.989038467407227, 'accuracy': 0.6033583283424377, 'precision': 0.33205607533454895, 'recall': 0.3338029384613037, 'iou': 0.20971930027008057, 'dice': 0.2669448256492615}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.15752710959185726, 'accuracy': 0.9326691223227459, 'precision': 0.8122758777245231, 'recall': 0.7678901408029639, 'iou': 0.7059413028799969, 'dice': 0.7828064172164254}
Test   -> {'loss': 18.499357223510742, 'accuracy': 0.5596014261245728, 'precision': 0.44524240493774414, 'recall': 0.3367617726325989, 'iou': 0.1933380663394928, 'dice': 0.2523598074913025}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.22246800363063812
Test -> {'loss': 61.60475540161133, 'accuracy': 0.592951238155365, 'precision': 0.36855348944664, 'recall': 0.34633558988571167, 'iou': 0.22246800363063812, 'dice': 0.2963179349899292} 
Train -> {'loss': 0.1987132445625637, 'accuracy': 0.9170625251272451, 'precision': 0.7657632045123888, 'recall': 0.6947935726331628, 'iou': 0.6382361422414365, 'dice': 0.7019204502520354} 

Best model saved for model efficientunet at epoch 10

Trial 4:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 1213.7915857605312, 'accuracy': 0.5418855037378228, 'precision': 0.416376259210317, 'recall': 0.4122546859409498, 'iou': 0.279115369008935, 'dice': 0.3912808727958928}
Test   -> {'loss': 142.68650817871094, 'accuracy': 0.370686411857605, 'precision': 0.28267526626586914, 'recall': 0.2983773350715637, 'iou': 0.1695573329925537, 'dice': 0.26981621980667114}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.9973035431426505, 'accuracy': 0.7005521390749061, 'precision': 0.49089920805848164, 'recall': 0.494475413016651, 'iou': 0.3789032767648282, 'dice': 0.4883335609798846}
Test   -> {'loss': 70.83160400390625, 'accuracy': 0.37070509791374207, 'precision': 0.30070608854293823, 'recall': 0.3107638657093048, 'iou': 0.1797189712524414, 'dice': 0.28554221987724304}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7680657021377397, 'accuracy': 0.7343959715055383, 'precision': 0.5110927027204762, 'recall': 0.5156123253314392, 'iou': 0.4029122509386229, 'dice': 0.5050396029068076}
Test   -> {'loss': 39.82283020019531, 'accuracy': 0.41049256920814514, 'precision': 0.2868426442146301, 'recall': 0.3112300634384155, 'iou': 0.1785835325717926, 'dice': 0.270496666431427}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6942234959291376, 'accuracy': 0.7537718451541403, 'precision': 0.5223003552011821, 'recall': 0.5277010373447253, 'iou': 0.41714669012505073, 'dice': 0.5139394684978154}
Test   -> {'loss': 33.387672424316406, 'accuracy': 0.5043023228645325, 'precision': 0.35408443212509155, 'recall': 0.342987060546875, 'iou': 0.218264639377594, 'dice': 0.3145401179790497}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6655315197032431, 'accuracy': 0.7623541274796362, 'precision': 0.5275597253571386, 'recall': 0.532799870553224, 'iou': 0.42336067350014395, 'dice': 0.5173723570678546}
Test   -> {'loss': 31.749177932739258, 'accuracy': 0.48441237211227417, 'precision': 0.3158908486366272, 'recall': 0.319497287273407, 'iou': 0.1995558738708496, 'dice': 0.28550443053245544}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6446442062440125, 'accuracy': 0.7671671955481819, 'precision': 0.5298593557399253, 'recall': 0.535999846458435, 'iou': 0.4271757413511691, 'dice': 0.5196605533361435}
Test   -> {'loss': 26.656402587890625, 'accuracy': 0.4733375906944275, 'precision': 0.3208101987838745, 'recall': 0.3255135416984558, 'iou': 0.19793526828289032, 'dice': 0.28769776225090027}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6260668614636297, 'accuracy': 0.7726352429908255, 'precision': 0.5337822958179143, 'recall': 0.5392467760521432, 'iou': 0.4317037185896998, 'dice': 0.5227424536062324}
Test   -> {'loss': 25.06294059753418, 'accuracy': 0.4463226795196533, 'precision': 0.33490440249443054, 'recall': 0.3215751349925995, 'iou': 0.20133940875530243, 'dice': 0.304937481880188}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6157122832277547, 'accuracy': 0.7761121516642363, 'precision': 0.535092414850774, 'recall': 0.5413101632957873, 'iou': 0.4346818554660548, 'dice': 0.5247121568607247}
Test   -> {'loss': 26.218027114868164, 'accuracy': 0.48939481377601624, 'precision': 0.3064765930175781, 'recall': 0.3246675133705139, 'iou': 0.2006787657737732, 'dice': 0.2862704396247864}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6117648956568345, 'accuracy': 0.7772787796414417, 'precision': 0.5364553430806036, 'recall': 0.5417211364144864, 'iou': 0.43551245681617573, 'dice': 0.5252602137949156}
Test   -> {'loss': 21.188987731933594, 'accuracy': 0.5224160552024841, 'precision': 0.2990042567253113, 'recall': 0.3133922815322876, 'iou': 0.2073252648115158, 'dice': 0.29013097286224365}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6055710109679595, 'accuracy': 0.7787779727707739, 'precision': 0.536001801620359, 'recall': 0.5426472288110982, 'iou': 0.43680070625699086, 'dice': 0.5260916107374689}
Test   -> {'loss': 19.535463333129883, 'accuracy': 0.49705037474632263, 'precision': 0.3562977910041809, 'recall': 0.35174474120140076, 'iou': 0.23737733066082, 'dice': 0.3522273004055023}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.23737733066082
Test -> {'loss': 19.535463333129883, 'accuracy': 0.49705037474632263, 'precision': 0.3562977910041809, 'recall': 0.35174474120140076, 'iou': 0.23737733066082, 'dice': 0.3522273004055023} 
Train -> {'loss': 0.6055710109679595, 'accuracy': 0.7787779727707739, 'precision': 0.536001801620359, 'recall': 0.5426472288110982, 'iou': 0.43680070625699086, 'dice': 0.5260916107374689} 

Best model saved for model efficientunet at epoch 10

Trial 5:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 427.3824089444202, 'accuracy': 0.4453507897646531, 'precision': 0.3793616515138875, 'recall': 0.376771377739699, 'iou': 0.22775721213091973, 'dice': 0.3368916346974995}
Test   -> {'loss': 538.3776245117188, 'accuracy': 0.37165674567222595, 'precision': 0.34001803398132324, 'recall': 0.33920806646347046, 'iou': 0.20214520394802094, 'dice': 0.3269057273864746}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 1.9161726070486982, 'accuracy': 0.6286041378974915, 'precision': 0.44514939810918724, 'recall': 0.4447630351004393, 'iou': 0.325905966758728, 'dice': 0.4417580881844396}
Test   -> {'loss': 127.56829071044922, 'accuracy': 0.5100337266921997, 'precision': 0.2821205258369446, 'recall': 0.31678450107574463, 'iou': 0.19621452689170837, 'dice': 0.2740320563316345}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7996820537940316, 'accuracy': 0.7230139540589374, 'precision': 0.5011846469796222, 'recall': 0.5035330554713373, 'iou': 0.3899602895197661, 'dice': 0.4936429749364438}
Test   -> {'loss': 66.08833312988281, 'accuracy': 0.5070806741714478, 'precision': 0.2634970545768738, 'recall': 0.306769460439682, 'iou': 0.19014553725719452, 'dice': 0.2642028331756592}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7105170794155287, 'accuracy': 0.7499060874399932, 'precision': 0.5185702764469644, 'recall': 0.5223659489465796, 'iou': 0.4114155808220739, 'dice': 0.5087137217107026}
Test   -> {'loss': 77.04810333251953, 'accuracy': 0.4959576427936554, 'precision': 0.27476030588150024, 'recall': 0.3033898174762726, 'iou': 0.19018368422985077, 'dice': 0.26916271448135376}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.668290036139281, 'accuracy': 0.7627967694531317, 'precision': 0.5266814786454905, 'recall': 0.5316354751586914, 'iou': 0.42275819622952004, 'dice': 0.5167938053607941}
Test   -> {'loss': 59.064388275146484, 'accuracy': 0.45488566160202026, 'precision': 0.2682209014892578, 'recall': 0.29648491740226746, 'iou': 0.1837945282459259, 'dice': 0.269696444272995}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6380324249682219, 'accuracy': 0.7704677208610203, 'precision': 0.5320268884949062, 'recall': 0.5369020814480989, 'iou': 0.4294374989426654, 'dice': 0.5213588263677514}
Test   -> {'loss': 42.37263488769531, 'accuracy': 0.44757360219955444, 'precision': 0.2933956980705261, 'recall': 0.30249595642089844, 'iou': 0.19542405009269714, 'dice': 0.2934216856956482}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6266192887140357, 'accuracy': 0.7739359897115956, 'precision': 0.5350128375965616, 'recall': 0.538956155984298, 'iou': 0.4323650826578555, 'dice': 0.5233862721401712}
Test   -> {'loss': 37.25655746459961, 'accuracy': 0.37449488043785095, 'precision': 0.3035013973712921, 'recall': 0.31276020407676697, 'iou': 0.18733662366867065, 'dice': 0.29830044507980347}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6141087355821029, 'accuracy': 0.7774168097454569, 'precision': 0.5369987736577573, 'recall': 0.5405218393906303, 'iou': 0.43533636409303417, 'dice': 0.5254709119382112}
Test   -> {'loss': 29.531299591064453, 'accuracy': 0.43211737275123596, 'precision': 0.3131449520587921, 'recall': 0.31934183835983276, 'iou': 0.20349335670471191, 'dice': 0.3115471601486206}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6016447336777396, 'accuracy': 0.7806500626646954, 'precision': 0.5399373541707578, 'recall': 0.54277329341225, 'iou': 0.43830531006274015, 'dice': 0.5275218160256095}
Test   -> {'loss': 27.743074417114258, 'accuracy': 0.4498465359210968, 'precision': 0.31818801164627075, 'recall': 0.31838104128837585, 'iou': 0.2078312337398529, 'dice': 0.31693124771118164}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.595821389944657, 'accuracy': 0.7829664007477138, 'precision': 0.5414073234019072, 'recall': 0.5441471027291339, 'iou': 0.440538081397181, 'dice': 0.5292303904243137}
Test   -> {'loss': 36.25933837890625, 'accuracy': 0.35094279050827026, 'precision': 0.3128681778907776, 'recall': 0.31364208459854126, 'iou': 0.18599502742290497, 'dice': 0.30451783537864685}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 9 with IoU 0.2078312337398529
Test -> {'loss': 27.743074417114258, 'accuracy': 0.4498465359210968, 'precision': 0.31818801164627075, 'recall': 0.31838104128837585, 'iou': 0.2078312337398529, 'dice': 0.31693124771118164} 
Train -> {'loss': 0.6016447336777396, 'accuracy': 0.7806500626646954, 'precision': 0.5399373541707578, 'recall': 0.54277329341225, 'iou': 0.43830531006274015, 'dice': 0.5275218160256095} 

Best model saved for model efficientunet at epoch 10

Trial 6:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 829.9107842637145, 'accuracy': 0.5049410418971725, 'precision': 0.3857897073030472, 'recall': 0.3864315963957621, 'iou': 0.25340521850663683, 'dice': 0.3647503644875858}
Test   -> {'loss': 99.88549041748047, 'accuracy': 0.3989444673061371, 'precision': 0.3801909387111664, 'recall': 0.3695116937160492, 'iou': 0.21822266280651093, 'dice': 0.34688299894332886}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 1.23230855750001, 'accuracy': 0.6805515810199406, 'precision': 0.47783796877964685, 'recall': 0.4781001536742501, 'iou': 0.36066849257635036, 'dice': 0.4719412396783414}
Test   -> {'loss': 101.23545837402344, 'accuracy': 0.4973480701446533, 'precision': 0.28812846541404724, 'recall': 0.31432273983955383, 'iou': 0.19071730971336365, 'dice': 0.27136802673339844}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.8922761116338813, 'accuracy': 0.7252885769242826, 'precision': 0.5054354960503785, 'recall': 0.5087524613608485, 'iou': 0.3944920090229615, 'dice': 0.4980667169975198}
Test   -> {'loss': 20.97551918029785, 'accuracy': 0.44019922614097595, 'precision': 0.3678145408630371, 'recall': 0.3679213523864746, 'iou': 0.23433133959770203, 'dice': 0.3614933490753174}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7618502984876218, 'accuracy': 0.7476666157660277, 'precision': 0.5182593540005062, 'recall': 0.5248033476912457, 'iou': 0.41274302899837495, 'dice': 0.5110107504803202}
Test   -> {'loss': 11.966633796691895, 'accuracy': 0.4147189259529114, 'precision': 0.3868176341056824, 'recall': 0.38540491461753845, 'iou': 0.22802893817424774, 'dice': 0.3585997223854065}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7048857999884564, 'accuracy': 0.7582435913707899, 'precision': 0.5244217056295146, 'recall': 0.5318355644526689, 'iou': 0.4212924844544867, 'dice': 0.5168091846548992}
Test   -> {'loss': 18.67448616027832, 'accuracy': 0.47489461302757263, 'precision': 0.40037262439727783, 'recall': 0.40342625975608826, 'iou': 0.24216103553771973, 'dice': 0.3647215962409973}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6806719256483991, 'accuracy': 0.7615232812321704, 'precision': 0.5281798432702604, 'recall': 0.5331309151390324, 'iou': 0.4232394697873489, 'dice': 0.5177436279213947}
Test   -> {'loss': 7.35963773727417, 'accuracy': 0.5219876170158386, 'precision': 0.4063574969768524, 'recall': 0.42177408933639526, 'iou': 0.26993468403816223, 'dice': 0.39254069328308105}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6562796540882276, 'accuracy': 0.7669898808002472, 'precision': 0.5288782996975857, 'recall': 0.5365782828434654, 'iou': 0.42749677883542103, 'dice': 0.520157232751017}
Test   -> {'loss': 14.566658973693848, 'accuracy': 0.4632381498813629, 'precision': 0.38503867387771606, 'recall': 0.39337414503097534, 'iou': 0.2332945317029953, 'dice': 0.35306546092033386}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6413822479870008, 'accuracy': 0.7695892481700234, 'precision': 0.531079684133115, 'recall': 0.5382296584222628, 'iou': 0.42965873363225354, 'dice': 0.5216801248166872}
Test   -> {'loss': 8.712198257446289, 'accuracy': 0.4477015733718872, 'precision': 0.34942030906677246, 'recall': 0.3538728356361389, 'iou': 0.2213279902935028, 'dice': 0.3402988612651825}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6339766002219657, 'accuracy': 0.7706726507000301, 'precision': 0.5333092795765918, 'recall': 0.5386456624321315, 'iou': 0.4302952034317929, 'dice': 0.5219000544237054}
Test   -> {'loss': 5.975656509399414, 'accuracy': 0.42964887619018555, 'precision': 0.36879023909568787, 'recall': 0.36811405420303345, 'iou': 0.23356088995933533, 'dice': 0.3637183904647827}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6267409612303195, 'accuracy': 0.7718123949092367, 'precision': 0.5335003545750743, 'recall': 0.5393829604853755, 'iou': 0.43108134191969166, 'dice': 0.5222992841316306}
Test   -> {'loss': 7.531948089599609, 'accuracy': 0.47195371985435486, 'precision': 0.3895537853240967, 'recall': 0.3975536823272705, 'iou': 0.24832896888256073, 'dice': 0.3760036826133728}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.26993468403816223
Test -> {'loss': 7.35963773727417, 'accuracy': 0.5219876170158386, 'precision': 0.4063574969768524, 'recall': 0.42177408933639526, 'iou': 0.26993468403816223, 'dice': 0.39254069328308105} 
Train -> {'loss': 0.6806719256483991, 'accuracy': 0.7615232812321704, 'precision': 0.5281798432702604, 'recall': 0.5331309151390324, 'iou': 0.4232394697873489, 'dice': 0.5177436279213947} 

Best model saved for model efficientunet at epoch 10

Trial 7:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1894.5999518912772, 'accuracy': 0.35476127564907073, 'precision': 0.35382761722025663, 'recall': 0.35397300797960035, 'iou': 0.17844347843657368, 'dice': 0.2708577856421471}
Test   -> {'loss': 28078.923828125, 'accuracy': 0.3019813895225525, 'precision': 0.38973021507263184, 'recall': 0.35456180572509766, 'iou': 0.1552192121744156, 'dice': 0.2551348805427551}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 40.978936133177385, 'accuracy': 0.5828724293605141, 'precision': 0.4356009804684183, 'recall': 0.4295578946237979, 'iou': 0.3009971119787382, 'dice': 0.41649164868437727}
Test   -> {'loss': 157.81016540527344, 'accuracy': 0.25171831250190735, 'precision': 0.34348416328430176, 'recall': 0.34581267833709717, 'iou': 0.1301412284374237, 'dice': 0.2238917052745819}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 1.9494430894437043, 'accuracy': 0.6472056575443433, 'precision': 0.463427746295929, 'recall': 0.46142744318298673, 'iou': 0.34244014983591825, 'dice': 0.45917443244353584}
Test   -> {'loss': 54.440093994140625, 'accuracy': 0.3393414616584778, 'precision': 0.29843443632125854, 'recall': 0.3471642732620239, 'iou': 0.1657973825931549, 'dice': 0.26192373037338257}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 1.2028795791708904, 'accuracy': 0.6812786319981451, 'precision': 0.47911198709322056, 'recall': 0.4805102073627969, 'iou': 0.36453903680262356, 'dice': 0.47707601733829663}
Test   -> {'loss': 36.643516540527344, 'accuracy': 0.376252144575119, 'precision': 0.3055225610733032, 'recall': 0.3439633548259735, 'iou': 0.1790284812450409, 'dice': 0.27755817770957947}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.9679339439972587, 'accuracy': 0.7076290514158166, 'precision': 0.49337895227515177, 'recall': 0.4971871417501698, 'iou': 0.38276316549467004, 'dice': 0.4907113106354423}
Test   -> {'loss': 26.820220947265625, 'accuracy': 0.4202008843421936, 'precision': 0.3213878273963928, 'recall': 0.345097154378891, 'iou': 0.19741909205913544, 'dice': 0.2974551320075989}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.887665695729463, 'accuracy': 0.7205488324165344, 'precision': 0.5006442707517873, 'recall': 0.5046203255653381, 'iou': 0.3908863627392313, 'dice': 0.49590739866961603}
Test   -> {'loss': 24.414934158325195, 'accuracy': 0.41802728176116943, 'precision': 0.29583919048309326, 'recall': 0.32995516061782837, 'iou': 0.18874689936637878, 'dice': 0.28386354446411133}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.8716622492541437, 'accuracy': 0.7219118107920107, 'precision': 0.5007824747458748, 'recall': 0.5037344061810037, 'iou': 0.3894201698510543, 'dice': 0.49267200179722}
Test   -> {'loss': 19.85984992980957, 'accuracy': 0.4415423274040222, 'precision': 0.30654460191726685, 'recall': 0.3259778916835785, 'iou': 0.19322220981121063, 'dice': 0.28661859035491943}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.8034650325775147, 'accuracy': 0.7379205517146898, 'precision': 0.5110828016115272, 'recall': 0.516276102480681, 'iou': 0.40278105683948684, 'dice': 0.503125076190285}
Test   -> {'loss': 14.7170991897583, 'accuracy': 0.4268842339515686, 'precision': 0.3108236491680145, 'recall': 0.3283034563064575, 'iou': 0.19732892513275146, 'dice': 0.2980833947658539}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7902937655863554, 'accuracy': 0.7383498824161032, 'precision': 0.5104812886403954, 'recall': 0.5147947980009991, 'iou': 0.40179636841234956, 'dice': 0.5016266688056614}
Test   -> {'loss': 20.543861389160156, 'accuracy': 0.4968532621860504, 'precision': 0.28985396027565, 'recall': 0.32171303033828735, 'iou': 0.1949382722377777, 'dice': 0.27481815218925476}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.746373524873153, 'accuracy': 0.7493494199669879, 'precision': 0.5166764661021854, 'recall': 0.5240265815154366, 'iou': 0.4117353636285533, 'dice': 0.508968780870023}
Test   -> {'loss': 16.457908630371094, 'accuracy': 0.4788011610507965, 'precision': 0.3022311329841614, 'recall': 0.326627254486084, 'iou': 0.1972232311964035, 'dice': 0.2844061255455017}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 5 with IoU 0.19741909205913544
Test -> {'loss': 26.820220947265625, 'accuracy': 0.4202008843421936, 'precision': 0.3213878273963928, 'recall': 0.345097154378891, 'iou': 0.19741909205913544, 'dice': 0.2974551320075989} 
Train -> {'loss': 0.9679339439972587, 'accuracy': 0.7076290514158166, 'precision': 0.49337895227515177, 'recall': 0.4971871417501698, 'iou': 0.38276316549467004, 'dice': 0.4907113106354423} 

Best model saved for model efficientunet at epoch 10

Trial 8:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4088517953520236, 'accuracy': 0.7911317028429197, 'precision': 0.5999607331078985, 'recall': 0.5959465142177499, 'iou': 0.4943120697270269, 'dice': 0.5929426821677581}
Test   -> {'loss': 0.7470680475234985, 'accuracy': 0.5667699575424194, 'precision': 0.42078453302383423, 'recall': 0.3872743248939514, 'iou': 0.24417638778686523, 'dice': 0.341153085231781}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5392173380955406, 'accuracy': 0.6722315560216489, 'precision': 0.4809201261271601, 'recall': 0.4916472656571347, 'iou': 0.3595735934765443, 'dice': 0.46834960929725483}
Test   -> {'loss': 0.7381606101989746, 'accuracy': 0.3879033327102661, 'precision': 0.423425555229187, 'recall': 0.39248907566070557, 'iou': 0.17432300746440887, 'dice': 0.279202938079834}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6945442806119504, 'accuracy': 0.4182979185944018, 'precision': 0.32565368349137513, 'recall': 0.3260404538849126, 'iou': 0.2000026934172796, 'dice': 0.31391544160635576}
Test   -> {'loss': 0.6980203986167908, 'accuracy': 0.4529431164264679, 'precision': 0.34547123312950134, 'recall': 0.34640738368034363, 'iou': 0.2203914225101471, 'dice': 0.3382236659526825}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6993003643077352, 'accuracy': 0.4311636427174444, 'precision': 0.31674775701502095, 'recall': 0.3153161453164142, 'iou': 0.19750747071660082, 'dice': 0.3076912267052609}
Test   -> {'loss': 0.6993597745895386, 'accuracy': 0.42678770422935486, 'precision': 0.3278125524520874, 'recall': 0.3297516107559204, 'iou': 0.20147216320037842, 'dice': 0.3127535283565521}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6801028438236403, 'accuracy': 0.4727342377538266, 'precision': 0.3366758149603139, 'recall': 0.338104847073555, 'iou': 0.2140957781802053, 'dice': 0.3232412616843763}
Test   -> {'loss': 0.7114900350570679, 'accuracy': 0.42629319429397583, 'precision': 0.29864010214805603, 'recall': 0.32595333456993103, 'iou': 0.19323799014091492, 'dice': 0.29763656854629517}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6856106962846673, 'accuracy': 0.44621147850285403, 'precision': 0.3300786193298257, 'recall': 0.330020967255468, 'iou': 0.20614084828159082, 'dice': 0.3181472291117129}
Test   -> {'loss': 0.6797571182250977, 'accuracy': 0.44200414419174194, 'precision': 0.3381999135017395, 'recall': 0.3409537971019745, 'iou': 0.21429555118083954, 'dice': 0.32930105924606323}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.687148642539978, 'accuracy': 0.4395783649838489, 'precision': 0.32822965305784474, 'recall': 0.32780080152594526, 'iou': 0.20404010855633278, 'dice': 0.3166487469621327}
Test   -> {'loss': 0.682948112487793, 'accuracy': 0.45791810750961304, 'precision': 0.3403241038322449, 'recall': 0.3419630527496338, 'iou': 0.2159191071987152, 'dice': 0.32842016220092773}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6823862500812696, 'accuracy': 0.4449483381665271, 'precision': 0.3315442463626032, 'recall': 0.3313881811888322, 'iou': 0.20787368202986925, 'dice': 0.3213960480430852}
Test   -> {'loss': 0.6803241968154907, 'accuracy': 0.43473348021507263, 'precision': 0.33946412801742554, 'recall': 0.3416402339935303, 'iou': 0.21081283688545227, 'dice': 0.32655006647109985}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6678630950658218, 'accuracy': 0.45563261470069055, 'precision': 0.341026750466098, 'recall': 0.34151855085207067, 'iou': 0.2185805369330489, 'dice': 0.3356274664402008}
Test   -> {'loss': 0.6846909523010254, 'accuracy': 0.42158475518226624, 'precision': 0.33536064624786377, 'recall': 0.3355400562286377, 'iou': 0.21056482195854187, 'dice': 0.3301406800746918}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.66855403288551, 'accuracy': 0.4550079661866893, 'precision': 0.34007071425085483, 'recall': 0.34049434234266696, 'iou': 0.21805252257896507, 'dice': 0.33491639689258906}
Test   -> {'loss': 0.706109881401062, 'accuracy': 0.42507123947143555, 'precision': 0.3298771381378174, 'recall': 0.32815706729888916, 'iou': 0.20048174262046814, 'dice': 0.3116350769996643}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 1 with IoU 0.24417638778686523
Test -> {'loss': 0.7470680475234985, 'accuracy': 0.5667699575424194, 'precision': 0.42078453302383423, 'recall': 0.3872743248939514, 'iou': 0.24417638778686523, 'dice': 0.341153085231781} 
Train -> {'loss': 0.4088517953520236, 'accuracy': 0.7911317028429197, 'precision': 0.5999607331078985, 'recall': 0.5959465142177499, 'iou': 0.4943120697270269, 'dice': 0.5929426821677581} 

Best model saved for model efficientunet at epoch 10

Trial 9:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.40556528153626814, 'accuracy': 0.8095614972321884, 'precision': 0.6145353820012963, 'recall': 0.6010001514268958, 'iou': 0.5085228676381318, 'dice': 0.5984418304070183}
Test   -> {'loss': 0.7730209827423096, 'accuracy': 0.4028148949146271, 'precision': 0.29849299788475037, 'recall': 0.29975229501724243, 'iou': 0.18586251139640808, 'dice': 0.2922000288963318}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3483904677888621, 'accuracy': 0.8390657305717468, 'precision': 0.6536569802657418, 'recall': 0.6515520417171976, 'iou': 0.5573409007943195, 'dice': 0.652150099173836}
Test   -> {'loss': 0.7545061111450195, 'accuracy': 0.45228731632232666, 'precision': 0.33720383048057556, 'recall': 0.33878272771835327, 'iou': 0.21587225794792175, 'dice': 0.3297032117843628}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3448006360427193, 'accuracy': 0.8417470496633779, 'precision': 0.6584064571753793, 'recall': 0.6539208381072334, 'iou': 0.5608275118081466, 'dice': 0.6553946474324102}
Test   -> {'loss': 0.7489213347434998, 'accuracy': 0.41742223501205444, 'precision': 0.2937062382698059, 'recall': 0.2950979173183441, 'iou': 0.1879274547100067, 'dice': 0.29200440645217896}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.34750682167384933, 'accuracy': 0.8378166297207708, 'precision': 0.6549156313357146, 'recall': 0.6526119605354641, 'iou': 0.5572375323461449, 'dice': 0.6530566334724426}
Test   -> {'loss': 0.7484499216079712, 'accuracy': 0.3946302831172943, 'precision': 0.3017062544822693, 'recall': 0.3009331226348877, 'iou': 0.1899539679288864, 'dice': 0.30074065923690796}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3580070568167645, 'accuracy': 0.8268711250761281, 'precision': 0.6445332869239475, 'recall': 0.6436397179313328, 'iou': 0.5453250607718592, 'dice': 0.6427491478298022}
Test   -> {'loss': 0.7896119356155396, 'accuracy': 0.3544660210609436, 'precision': 0.36727914214134216, 'recall': 0.34525224566459656, 'iou': 0.14533251523971558, 'dice': 0.23014894127845764}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.40098850312440293, 'accuracy': 0.800426136929056, 'precision': 0.6045165523238804, 'recall': 0.6025901799616606, 'iou': 0.5020962028399758, 'dice': 0.6008445739746093}
Test   -> {'loss': 0.6460030674934387, 'accuracy': 0.5382366180419922, 'precision': 0.40401405096054077, 'recall': 0.40915411710739136, 'iou': 0.26591214537620544, 'dice': 0.3813828229904175}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4745556338973667, 'accuracy': 0.7492200524910636, 'precision': 0.546336855577386, 'recall': 0.5319721931996553, 'iou': 0.42739920097848644, 'dice': 0.5316584229469299}
Test   -> {'loss': 0.8162674903869629, 'accuracy': 0.33538320660591125, 'precision': 0.3996436595916748, 'recall': 0.35531753301620483, 'iou': 0.13039378821849823, 'dice': 0.209248349070549}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5402496918388034, 'accuracy': 0.6563740808030833, 'precision': 0.47614991302075593, 'recall': 0.4887085445549177, 'iou': 0.3584913656763408, 'dice': 0.4662422882473987}
Test   -> {'loss': 0.9248433113098145, 'accuracy': 0.12059051543474197, 'precision': 0.3234131932258606, 'recall': 0.3314233422279358, 'iou': 0.04358071833848953, 'dice': 0.07840511947870255}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.8014269497083581, 'accuracy': 0.3155628963657047, 'precision': 0.2817027027192323, 'recall': 0.2703417648439822, 'iou': 0.13682877201101054, 'dice': 0.22507930397987366}
Test   -> {'loss': 0.7668513059616089, 'accuracy': 0.5147455930709839, 'precision': 0.311804860830307, 'recall': 0.31906574964523315, 'iou': 0.20103369653224945, 'dice': 0.28417739272117615}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7542610816333605, 'accuracy': 0.40324366636898207, 'precision': 0.3018049849116284, 'recall': 0.2930214443932409, 'iou': 0.17403230187685592, 'dice': 0.27458937194036404}
Test   -> {'loss': 0.7701666355133057, 'accuracy': 0.5183924436569214, 'precision': 0.2449958771467209, 'recall': 0.29376736283302307, 'iou': 0.18494389951229095, 'dice': 0.2520930767059326}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.26591214537620544
Test -> {'loss': 0.6460030674934387, 'accuracy': 0.5382366180419922, 'precision': 0.40401405096054077, 'recall': 0.40915411710739136, 'iou': 0.26591214537620544, 'dice': 0.3813828229904175} 
Train -> {'loss': 0.40098850312440293, 'accuracy': 0.800426136929056, 'precision': 0.6045165523238804, 'recall': 0.6025901799616606, 'iou': 0.5020962028399758, 'dice': 0.6008445739746093} 

Best model saved for model efficientunet at epoch 10

Trial 10:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.42538942020872367, 'accuracy': 0.7886266792597978, 'precision': 0.5821282073207523, 'recall': 0.5809964212386505, 'iou': 0.4808869821869809, 'dice': 0.577005064357882}
Test   -> {'loss': 0.672545850276947, 'accuracy': 0.5023180842399597, 'precision': 0.3951598107814789, 'recall': 0.3957969546318054, 'iou': 0.26607996225357056, 'dice': 0.39506834745407104}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5323199396548064, 'accuracy': 0.6706112545469533, 'precision': 0.4838115251582602, 'recall': 0.4822992225056109, 'iou': 0.36475869605074757, 'dice': 0.47637241417947024}
Test   -> {'loss': 0.725500226020813, 'accuracy': 0.41831377148628235, 'precision': 0.31580454111099243, 'recall': 0.32108074426651, 'iou': 0.1986909806728363, 'dice': 0.3087438642978668}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6065394834331844, 'accuracy': 0.5984639642031296, 'precision': 0.422297881219698, 'recall': 0.42798126249209695, 'iou': 0.29999095285716265, 'dice': 0.413686851574027}
Test   -> {'loss': 0.7155017852783203, 'accuracy': 0.5447350144386292, 'precision': 0.36949798464775085, 'recall': 0.364716500043869, 'iou': 0.24128252267837524, 'dice': 0.3424243628978729}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6121704184490702, 'accuracy': 0.6097274422645569, 'precision': 0.4231582017048546, 'recall': 0.42929989384568257, 'iou': 0.3025617790610894, 'dice': 0.4152553943188294}
Test   -> {'loss': 0.782455325126648, 'accuracy': 0.3651222586631775, 'precision': 0.41698455810546875, 'recall': 0.35497915744781494, 'iou': 0.14487875998020172, 'dice': 0.228643000125885}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6813689042692599, 'accuracy': 0.5709793259268222, 'precision': 0.37655579525491467, 'recall': 0.3786075383424759, 'iou': 0.2617449172165083, 'dice': 0.3684070013139559}
Test   -> {'loss': 0.7634652853012085, 'accuracy': 0.37467238306999207, 'precision': 0.3744215965270996, 'recall': 0.38662001490592957, 'iou': 0.16761378943920135, 'dice': 0.2685844898223877}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6688035161598869, 'accuracy': 0.5822926008183024, 'precision': 0.38357057066067407, 'recall': 0.38284019763055055, 'iou': 0.2660379477817079, 'dice': 0.3714751248774321}
Test   -> {'loss': 0.679703950881958, 'accuracy': 0.5050310492515564, 'precision': 0.3968832492828369, 'recall': 0.4104143977165222, 'iou': 0.24726137518882751, 'dice': 0.3617972731590271}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6119810161383256, 'accuracy': 0.6321955102941265, 'precision': 0.4272503521131433, 'recall': 0.4289596878963968, 'iou': 0.3092930012423059, 'dice': 0.41845236835272415}
Test   -> {'loss': 0.8327848315238953, 'accuracy': 0.31445685029029846, 'precision': 0.4388204514980316, 'recall': 0.34930965304374695, 'iou': 0.11493026465177536, 'dice': 0.18346303701400757}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6210049051305522, 'accuracy': 0.6363151889780293, 'precision': 0.4304847705623378, 'recall': 0.4155793574841126, 'iou': 0.299987804500953, 'dice': 0.4050633803657863}
Test   -> {'loss': 0.7932813763618469, 'accuracy': 0.34678930044174194, 'precision': 0.37797197699546814, 'recall': 0.3631029725074768, 'iou': 0.14685681462287903, 'dice': 0.23914125561714172}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6445969807065052, 'accuracy': 0.6323436856269836, 'precision': 0.42769002318382265, 'recall': 0.401749939892603, 'iou': 0.2869584660815156, 'dice': 0.38820528556471284}
Test   -> {'loss': 0.7825480103492737, 'accuracy': 0.3440651297569275, 'precision': 0.4140573740005493, 'recall': 0.3874623775482178, 'iou': 0.14423957467079163, 'dice': 0.23529237508773804}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6669426127620365, 'accuracy': 0.6174085950073989, 'precision': 0.40701257754927095, 'recall': 0.3864952473536782, 'iou': 0.2714521810412407, 'dice': 0.36902873801148456}
Test   -> {'loss': 0.7242612838745117, 'accuracy': 0.4986920952796936, 'precision': 0.3514827489852905, 'recall': 0.3660176694393158, 'iou': 0.2300141304731369, 'dice': 0.33772730827331543}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 1 with IoU 0.26607996225357056
Test -> {'loss': 0.672545850276947, 'accuracy': 0.5023180842399597, 'precision': 0.3951598107814789, 'recall': 0.3957969546318054, 'iou': 0.26607996225357056, 'dice': 0.39506834745407104} 
Train -> {'loss': 0.42538942020872367, 'accuracy': 0.7886266792597978, 'precision': 0.5821282073207523, 'recall': 0.5809964212386505, 'iou': 0.4808869821869809, 'dice': 0.577005064357882} 

Best model saved for model efficientunet at epoch 10

Trial 11:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4096144629561383, 'accuracy': 0.8038106140883072, 'precision': 0.6085373494936073, 'recall': 0.5978695231935253, 'iou': 0.5029036112453626, 'dice': 0.5933687842410543}
Test   -> {'loss': 0.7554558515548706, 'accuracy': 0.5384508967399597, 'precision': 0.287880003452301, 'recall': 0.3186061978340149, 'iou': 0.19823859632015228, 'dice': 0.2704032063484192}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3517209514327671, 'accuracy': 0.8395156523455745, 'precision': 0.6517642015996187, 'recall': 0.6471287400826163, 'iou': 0.5545192677041758, 'dice': 0.6487220567205678}
Test   -> {'loss': 0.7343547344207764, 'accuracy': 0.492305189371109, 'precision': 0.32608652114868164, 'recall': 0.3301776945590973, 'iou': 0.21569684147834778, 'dice': 0.31700965762138367}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.35223403236140377, 'accuracy': 0.8403142244919487, 'precision': 0.6531815622163856, 'recall': 0.6472462462342303, 'iou': 0.5549051212227862, 'dice': 0.6482058431791222}
Test   -> {'loss': 0.7532405257225037, 'accuracy': 0.49470269680023193, 'precision': 0.3427444398403168, 'recall': 0.3498687148094177, 'iou': 0.2303219884634018, 'dice': 0.3407360911369324}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3551981309185857, 'accuracy': 0.8307119524997214, 'precision': 0.6480018346206001, 'recall': 0.6441305160522461, 'iou': 0.5480010006738746, 'dice': 0.6451395687849625}
Test   -> {'loss': 0.7655492424964905, 'accuracy': 0.4956042170524597, 'precision': 0.2959707975387573, 'recall': 0.32063525915145874, 'iou': 0.18573802709579468, 'dice': 0.2616702616214752}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.37513426697772484, 'accuracy': 0.8212708468022554, 'precision': 0.6273773618366407, 'recall': 0.6278857687245245, 'iou': 0.5309523302575816, 'dice': 0.6263106418692548}
Test   -> {'loss': 0.7212820053100586, 'accuracy': 0.4429660737514496, 'precision': 0.37801849842071533, 'recall': 0.3788956105709076, 'iou': 0.21680638194084167, 'dice': 0.3345430791378021}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.4210493626801864, 'accuracy': 0.7896751279416292, 'precision': 0.5875970954480378, 'recall': 0.5831826873447584, 'iou': 0.48057174838107564, 'dice': 0.5810499326042508}
Test   -> {'loss': 0.698605477809906, 'accuracy': 0.53177410364151, 'precision': 0.3638073801994324, 'recall': 0.3532112240791321, 'iou': 0.23415502905845642, 'dice': 0.33725282549858093}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4702027942823327, 'accuracy': 0.735064827359241, 'precision': 0.5358218664708345, 'recall': 0.5421455243359441, 'iou': 0.42483736432116964, 'dice': 0.5333382394002831}
Test   -> {'loss': 0.5502041578292847, 'accuracy': 0.6303271651268005, 'precision': 0.4811263978481293, 'recall': 0.49763330817222595, 'iou': 0.3448588252067566, 'dice': 0.4628165662288666}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5208492455275162, 'accuracy': 0.701158444777779, 'precision': 0.5022695961205855, 'recall': 0.4919774071029995, 'iou': 0.37773038770841516, 'dice': 0.4890401016110959}
Test   -> {'loss': 0.6718825101852417, 'accuracy': 0.4782640039920807, 'precision': 0.42619627714157104, 'recall': 0.42214784026145935, 'iou': 0.2391010969877243, 'dice': 0.36000823974609375}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5526506563891536, 'accuracy': 0.609915846845378, 'precision': 0.46403850887132725, 'recall': 0.4712738177050715, 'iou': 0.331665459404821, 'dice': 0.4517903250196706}
Test   -> {'loss': 0.857468843460083, 'accuracy': 0.27971041202545166, 'precision': 0.41369128227233887, 'recall': 0.3349127769470215, 'iou': 0.09739911556243896, 'dice': 0.15294426679611206}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5339414492897365, 'accuracy': 0.6602539560069208, 'precision': 0.4840373228425565, 'recall': 0.495909541586171, 'iou': 0.35400845771250516, 'dice': 0.46917608509893005}
Test   -> {'loss': 0.8266959190368652, 'accuracy': 0.34042078256607056, 'precision': 0.41834235191345215, 'recall': 0.34430593252182007, 'iou': 0.12358814477920532, 'dice': 0.1914403885602951}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 7 with IoU 0.3448588252067566
Test -> {'loss': 0.5502041578292847, 'accuracy': 0.6303271651268005, 'precision': 0.4811263978481293, 'recall': 0.49763330817222595, 'iou': 0.3448588252067566, 'dice': 0.4628165662288666} 
Train -> {'loss': 0.4702027942823327, 'accuracy': 0.735064827359241, 'precision': 0.5358218664708345, 'recall': 0.5421455243359441, 'iou': 0.42483736432116964, 'dice': 0.5333382394002831} 

Best model saved for model efficientunet at epoch 10

Trial 12:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6196304650410361, 'accuracy': 0.5565534421931142, 'precision': 0.39851585730262423, 'recall': 0.39812129554541215, 'iou': 0.2772883020665335, 'dice': 0.39134132589982906}
Test   -> {'loss': 0.7296853065490723, 'accuracy': 0.6208234429359436, 'precision': 0.24740728735923767, 'recall': 0.3225460946559906, 'iou': 0.2186543047428131, 'dice': 0.27617722749710083}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.631335962596147, 'accuracy': 0.5305540863586509, 'precision': 0.3870143917591675, 'recall': 0.382077422219774, 'iou': 0.2628557593278263, 'dice': 0.3813758861759435}
Test   -> {'loss': 0.7440913915634155, 'accuracy': 0.5497536063194275, 'precision': 0.24093231558799744, 'recall': 0.3240705132484436, 'iou': 0.19741907715797424, 'dice': 0.26231783628463745}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6313807479713274, 'accuracy': 0.5307928034792776, 'precision': 0.38719329833984373, 'recall': 0.38206287648366843, 'iou': 0.26298330808463305, 'dice': 0.3815009973619295}
Test   -> {'loss': 0.7714459300041199, 'accuracy': 0.4734596610069275, 'precision': 0.21564438939094543, 'recall': 0.32161572575569153, 'iou': 0.1717757284641266, 'dice': 0.2397371232509613}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.694063939737237, 'accuracy': 0.38732840522475864, 'precision': 0.36989880800247193, 'recall': 0.35929771869078925, 'iou': 0.20084054528371148, 'dice': 0.3128117891757385}
Test   -> {'loss': 0.6974884867668152, 'accuracy': 0.35794752836227417, 'precision': 0.3331350088119507, 'recall': 0.3331443667411804, 'iou': 0.19483765959739685, 'dice': 0.31840425729751587}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7253890516965286, 'accuracy': 0.31019645035266874, 'precision': 0.3536985835303431, 'recall': 0.34492719315964243, 'iou': 0.16670036212257716, 'dice': 0.2772520796112392}
Test   -> {'loss': 0.693612813949585, 'accuracy': 0.36398252844810486, 'precision': 0.33941611647605896, 'recall': 0.3397175073623657, 'iou': 0.200270414352417, 'dice': 0.3259419798851013}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6913145961968795, 'accuracy': 0.3761358802733214, 'precision': 0.3381315762582033, 'recall': 0.33827077033727065, 'iou': 0.1941791668534279, 'dice': 0.31194964673208153}
Test   -> {'loss': 0.6877667903900146, 'accuracy': 0.36622586846351624, 'precision': 0.33815181255340576, 'recall': 0.3382989168167114, 'iou': 0.19897735118865967, 'dice': 0.323106050491333}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7016534310320149, 'accuracy': 0.3531745524510093, 'precision': 0.337391643550085, 'recall': 0.33664593929829806, 'iou': 0.18576981114304583, 'dice': 0.3014438394619071}
Test   -> {'loss': 0.7040902972221375, 'accuracy': 0.3258392810821533, 'precision': 0.33438095450401306, 'recall': 0.3337867259979248, 'iou': 0.18367747962474823, 'dice': 0.305489182472229}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7092122230840766, 'accuracy': 0.3546851421179979, 'precision': 0.3348690912775371, 'recall': 0.33468513475812, 'iou': 0.1826246536296347, 'dice': 0.29365131595860355}
Test   -> {'loss': 0.6983016729354858, 'accuracy': 0.3503928482532501, 'precision': 0.3331204652786255, 'recall': 0.33355581760406494, 'iou': 0.1921844184398651, 'dice': 0.3144451677799225}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7015523120113041, 'accuracy': 0.366869557681291, 'precision': 0.33605389037857886, 'recall': 0.3352938644264055, 'iou': 0.18840166906947675, 'dice': 0.3014151146878367}
Test   -> {'loss': 0.695268988609314, 'accuracy': 0.38228434324264526, 'precision': 0.33375367522239685, 'recall': 0.3349575698375702, 'iou': 0.19781368970870972, 'dice': 0.31517672538757324}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7082819539567698, 'accuracy': 0.3665071534073871, 'precision': 0.3344142365714778, 'recall': 0.3343533246413521, 'iou': 0.1851159611473913, 'dice': 0.2945548203976258}
Test   -> {'loss': 0.7091518640518188, 'accuracy': 0.3569585084915161, 'precision': 0.33304399251937866, 'recall': 0.33260348439216614, 'iou': 0.18466369807720184, 'dice': 0.29760468006134033}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 1 with IoU 0.2186543047428131
Test -> {'loss': 0.7296853065490723, 'accuracy': 0.6208234429359436, 'precision': 0.24740728735923767, 'recall': 0.3225460946559906, 'iou': 0.2186543047428131, 'dice': 0.27617722749710083} 
Train -> {'loss': 0.6196304650410361, 'accuracy': 0.5565534421931142, 'precision': 0.39851585730262423, 'recall': 0.39812129554541215, 'iou': 0.2772883020665335, 'dice': 0.39134132589982906} 

Best model saved for model efficientunet at epoch 10

Trial 13:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6386660866115405, 'accuracy': 0.5837215905604155, 'precision': 0.4086811848308729, 'recall': 0.40963611628698265, 'iou': 0.2815762514653413, 'dice': 0.3893345366353574}
Test   -> {'loss': 0.7514453530311584, 'accuracy': 0.5424380898475647, 'precision': 0.306514710187912, 'recall': 0.32060903310775757, 'iou': 0.19644688069820404, 'dice': 0.2654624581336975}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6088533992352693, 'accuracy': 0.6033440610636835, 'precision': 0.418675121276275, 'recall': 0.43096589497897936, 'iou': 0.2969830111317013, 'dice': 0.409151180671609}
Test   -> {'loss': 0.7573239803314209, 'accuracy': 0.50433349609375, 'precision': 0.31892985105514526, 'recall': 0.32387927174568176, 'iou': 0.18712729215621948, 'dice': 0.26151353120803833}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6068715924802034, 'accuracy': 0.6088470510814501, 'precision': 0.4204887848833333, 'recall': 0.4312080435130907, 'iou': 0.2995571012082307, 'dice': 0.41116401034852734}
Test   -> {'loss': 0.7562442421913147, 'accuracy': 0.6000033020973206, 'precision': 0.2740016579627991, 'recall': 0.3318330645561218, 'iou': 0.20089605450630188, 'dice': 0.2518123984336853}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6046232446380283, 'accuracy': 0.6116662611132083, 'precision': 0.41977835582650225, 'recall': 0.4276436867921249, 'iou': 0.2994925255360811, 'dice': 0.41041117025458296}
Test   -> {'loss': 0.7647539973258972, 'accuracy': 0.5571008920669556, 'precision': 0.3404596745967865, 'recall': 0.3351133465766907, 'iou': 0.19020384550094604, 'dice': 0.24801312386989594}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6042259812355042, 'accuracy': 0.6114639422167902, 'precision': 0.41964105471320773, 'recall': 0.42786217020905537, 'iou': 0.2995233193687771, 'dice': 0.41045788733855537}
Test   -> {'loss': 0.7526359558105469, 'accuracy': 0.5972137451171875, 'precision': 0.3702547550201416, 'recall': 0.3357560634613037, 'iou': 0.2038784623146057, 'dice': 0.2591332197189331}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6036652165910472, 'accuracy': 0.611986013599064, 'precision': 0.4201351549314416, 'recall': 0.42801809621893844, 'iou': 0.2998473416204038, 'dice': 0.4107446139273436}
Test   -> {'loss': 0.7612553834915161, 'accuracy': 0.5727442502975464, 'precision': 0.24035237729549408, 'recall': 0.328377366065979, 'iou': 0.19198709726333618, 'dice': 0.24486318230628967}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6640854545261549, 'accuracy': 0.47554566782453783, 'precision': 0.3739045542219411, 'recall': 0.37832735776901244, 'iou': 0.23128471270851467, 'dice': 0.3435704863589743}
Test   -> {'loss': 0.7163626551628113, 'accuracy': 0.3094065189361572, 'precision': 0.34171146154403687, 'recall': 0.3397936522960663, 'iou': 0.1741175353527069, 'dice': 0.29255491495132446}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7462964596955672, 'accuracy': 0.32259096166361934, 'precision': 0.3273710758789726, 'recall': 0.33290262274120164, 'iou': 0.159374934953192, 'dice': 0.2560233603353086}
Test   -> {'loss': 0.7210490703582764, 'accuracy': 0.35267141461372375, 'precision': 0.32999855279922485, 'recall': 0.3336857259273529, 'iou': 0.18099284172058105, 'dice': 0.2909175753593445}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7009570919949075, 'accuracy': 0.36871771112732266, 'precision': 0.3341879932776741, 'recall': 0.33501472784125286, 'iou': 0.18898257950077887, 'dice': 0.30214991595434104}
Test   -> {'loss': 0.695539116859436, 'accuracy': 0.37439149618148804, 'precision': 0.33754128217697144, 'recall': 0.3371163606643677, 'iou': 0.19838950037956238, 'dice': 0.3181867301464081}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7029908636341924, 'accuracy': 0.36532758837160856, 'precision': 0.3344972781513048, 'recall': 0.33484365266302357, 'iou': 0.18748098845067232, 'dice': 0.3001168308050736}
Test   -> {'loss': 0.7053832411766052, 'accuracy': 0.35687628388404846, 'precision': 0.33989644050598145, 'recall': 0.33806318044662476, 'iou': 0.18985705077648163, 'dice': 0.3075694739818573}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 5 with IoU 0.2038784623146057
Test -> {'loss': 0.7526359558105469, 'accuracy': 0.5972137451171875, 'precision': 0.3702547550201416, 'recall': 0.3357560634613037, 'iou': 0.2038784623146057, 'dice': 0.2591332197189331} 
Train -> {'loss': 0.6042259812355042, 'accuracy': 0.6114639422167902, 'precision': 0.41964105471320773, 'recall': 0.42786217020905537, 'iou': 0.2995233193687771, 'dice': 0.41045788733855537} 

Best model saved for model efficientunet at epoch 10

Trial 14:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.749369860732037, 'accuracy': 0.4166185207988905, 'precision': 0.2740818058019099, 'recall': 0.28061040801846465, 'iou': 0.17129725243734276, 'dice': 0.25721670907476674}
Test   -> {'loss': 0.8346357345581055, 'accuracy': 0.3448909819126129, 'precision': 0.47095274925231934, 'recall': 0.3334776759147644, 'iou': 0.11554288864135742, 'dice': 0.17194801568984985}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7920662843662759, 'accuracy': 0.388862760041071, 'precision': 0.21915904983230258, 'recall': 0.2296200692653656, 'iou': 0.14267149036345275, 'dice': 0.21507467174011727}
Test   -> {'loss': 0.8573508262634277, 'accuracy': 0.2931443750858307, 'precision': 0.44170066714286804, 'recall': 0.33361029624938965, 'iou': 0.09858167171478271, 'dice': 0.15276479721069336}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.792010276991388, 'accuracy': 0.3893021697583406, 'precision': 0.21958449333906174, 'recall': 0.22983434744503187, 'iou': 0.14280778513006542, 'dice': 0.2152149762796319}
Test   -> {'loss': 0.8500409126281738, 'accuracy': 0.30940961837768555, 'precision': 0.4472125768661499, 'recall': 0.3332664370536804, 'iou': 0.10356461256742477, 'dice': 0.15822701156139374}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.792204001934632, 'accuracy': 0.38840449879998745, 'precision': 0.21961794061505277, 'recall': 0.22940607168104338, 'iou': 0.14254665841226993, 'dice': 0.2149449702838193}
Test   -> {'loss': 0.8386123180389404, 'accuracy': 0.33775609731674194, 'precision': 0.4657313823699951, 'recall': 0.33328360319137573, 'iou': 0.11318361014127731, 'dice': 0.1693665087223053}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.783655256551245, 'accuracy': 0.3767649418633917, 'precision': 0.24495864633632744, 'recall': 0.25678183306818425, 'iou': 0.1470007139703502, 'dice': 0.2229660338681677}
Test   -> {'loss': 0.8839592933654785, 'accuracy': 0.15351587533950806, 'precision': 0.328182578086853, 'recall': 0.3220336437225342, 'iou': 0.06854762136936188, 'dice': 0.12416118383407593}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7417200961838598, 'accuracy': 0.3023524191716443, 'precision': 0.3432935082394144, 'recall': 0.34283177904460743, 'iou': 0.15972727245610693, 'dice': 0.26153261506039166}
Test   -> {'loss': 0.7023229598999023, 'accuracy': 0.3567517399787903, 'precision': 0.33234578371047974, 'recall': 0.3331759572029114, 'iou': 0.1926671713590622, 'dice': 0.3150715231895447}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.711604886210483, 'accuracy': 0.34420596438905465, 'precision': 0.32976846837479135, 'recall': 0.3303034817395003, 'iou': 0.1789069013103195, 'dice': 0.2914680022260417}
Test   -> {'loss': 0.7249724864959717, 'accuracy': 0.32181718945503235, 'precision': 0.3332180976867676, 'recall': 0.33349093794822693, 'iou': 0.1696978658437729, 'dice': 0.2830658555030823}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7177388118660968, 'accuracy': 0.3262469681708709, 'precision': 0.33085660338401796, 'recall': 0.33176481633082683, 'iou': 0.17324536410362823, 'dice': 0.2852918071591336}
Test   -> {'loss': 0.7132152915000916, 'accuracy': 0.32083067297935486, 'precision': 0.3334527015686035, 'recall': 0.33433616161346436, 'iou': 0.18181638419628143, 'dice': 0.3035134971141815}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7300004710321841, 'accuracy': 0.29869973504025005, 'precision': 0.33515519370203434, 'recall': 0.33453931691853894, 'iou': 0.16283183246850969, 'dice': 0.27280324840027353}
Test   -> {'loss': 0.7250813841819763, 'accuracy': 0.3024391531944275, 'precision': 0.3342992663383484, 'recall': 0.33411985635757446, 'iou': 0.17276597023010254, 'dice': 0.29196009039878845}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7307558401771214, 'accuracy': 0.296921162760776, 'precision': 0.3356834914373315, 'recall': 0.33492622816044354, 'iou': 0.16217984634896984, 'dice': 0.27200581716454547}
Test   -> {'loss': 0.7349783778190613, 'accuracy': 0.2966221272945404, 'precision': 0.3334742486476898, 'recall': 0.3337244987487793, 'iou': 0.16630882024765015, 'dice': 0.28181391954421997}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.1926671713590622
Test -> {'loss': 0.7023229598999023, 'accuracy': 0.3567517399787903, 'precision': 0.33234578371047974, 'recall': 0.3331759572029114, 'iou': 0.1926671713590622, 'dice': 0.3150715231895447} 
Train -> {'loss': 0.7417200961838598, 'accuracy': 0.3023524191716443, 'precision': 0.3432935082394144, 'recall': 0.34283177904460743, 'iou': 0.15972727245610693, 'dice': 0.26153261506039166} 

Best model saved for model efficientunet at epoch 10

Trial 15:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7048245865365733, 'accuracy': 0.5366634633230126, 'precision': 0.36910623519316965, 'recall': 0.3592151082080344, 'iou': 0.23320422975913338, 'dice': 0.3262527242950771}
Test   -> {'loss': 0.8221301436424255, 'accuracy': 0.20127588510513306, 'precision': 0.34335678815841675, 'recall': 0.33450421690940857, 'iou': 0.11198454350233078, 'dice': 0.1936691254377365}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7305773024973662, 'accuracy': 0.5526310889617256, 'precision': 0.35341767901959625, 'recall': 0.34217243142749953, 'iou': 0.2223871939856073, 'dice': 0.30783304960831354}
Test   -> {'loss': 0.8110227584838867, 'accuracy': 0.22264036536216736, 'precision': 0.37146973609924316, 'recall': 0.3360236883163452, 'iou': 0.12113086879253387, 'dice': 0.20563994348049164}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7310413236203401, 'accuracy': 0.5523393262987552, 'precision': 0.3527446049710979, 'recall': 0.3417873408483422, 'iou': 0.22200214344522226, 'dice': 0.30723236280938854}
Test   -> {'loss': 0.8224453330039978, 'accuracy': 0.21038475632667542, 'precision': 0.30901390314102173, 'recall': 0.33312034606933594, 'iou': 0.11323686689138412, 'dice': 0.191168874502182}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.731244242709616, 'accuracy': 0.5529280843942062, 'precision': 0.3528122736060101, 'recall': 0.34148020796153855, 'iou': 0.22182032025378684, 'dice': 0.3067158927088198}
Test   -> {'loss': 0.7971557378768921, 'accuracy': 0.24166589975357056, 'precision': 0.34782636165618896, 'recall': 0.33651837706565857, 'iou': 0.1330527365207672, 'dice': 0.22677385807037354}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.730014573491138, 'accuracy': 0.5528256027594857, 'precision': 0.3541242760160695, 'recall': 0.3424081820508708, 'iou': 0.2225795100564542, 'dice': 0.3080907826838286}
Test   -> {'loss': 0.8061715364456177, 'accuracy': 0.2327597439289093, 'precision': 0.4078409671783447, 'recall': 0.33760881423950195, 'iou': 0.12497705221176147, 'dice': 0.21029874682426453}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7316819351652394, 'accuracy': 0.5533106321873872, 'precision': 0.3524826410024062, 'recall': 0.34137784657271014, 'iou': 0.22154724325822747, 'dice': 0.30618544454159946}
Test   -> {'loss': 0.8238539695739746, 'accuracy': 0.20311440527439117, 'precision': 0.33415114879608154, 'recall': 0.333994597196579, 'iou': 0.11128844320774078, 'dice': 0.19026248157024384}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7304509836694468, 'accuracy': 0.5530291951220968, 'precision': 0.35360105815141096, 'recall': 0.34199467741924783, 'iou': 0.2223411148009093, 'dice': 0.30757742550062095}
Test   -> {'loss': 0.810753345489502, 'accuracy': 0.2199261635541916, 'precision': 0.342618465423584, 'recall': 0.3364863395690918, 'iou': 0.12068625539541245, 'dice': 0.2065204232931137}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7310433325560196, 'accuracy': 0.5529350187467492, 'precision': 0.3525346118470897, 'recall': 0.3415335344231647, 'iou': 0.22177518191544907, 'dice': 0.3066833983296933}
Test   -> {'loss': 0.8146049380302429, 'accuracy': 0.21466687321662903, 'precision': 0.29321902990341187, 'recall': 0.3317374885082245, 'iou': 0.11627741158008575, 'dice': 0.19731757044792175}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7310490919196088, 'accuracy': 0.5540383981621784, 'precision': 0.3539351634357287, 'recall': 0.3421645128208658, 'iou': 0.2222350115361421, 'dice': 0.3071194887161255}
Test   -> {'loss': 0.814768373966217, 'accuracy': 0.223951056599617, 'precision': 0.38291072845458984, 'recall': 0.337080717086792, 'iou': 0.121575728058815, 'dice': 0.20622721314430237}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7308001906975455, 'accuracy': 0.5530772395755934, 'precision': 0.35307162792786306, 'recall': 0.34176446147586986, 'iou': 0.22201090714205865, 'dice': 0.3070258679597274}
Test   -> {'loss': 0.8106260895729065, 'accuracy': 0.2175881415605545, 'precision': 0.36468908190727234, 'recall': 0.336056649684906, 'iou': 0.11938174068927765, 'dice': 0.2038673758506775}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 4 with IoU 0.1330527365207672
Test -> {'loss': 0.7971557378768921, 'accuracy': 0.24166589975357056, 'precision': 0.34782636165618896, 'recall': 0.33651837706565857, 'iou': 0.1330527365207672, 'dice': 0.22677385807037354} 
Train -> {'loss': 0.731244242709616, 'accuracy': 0.5529280843942062, 'precision': 0.3528122736060101, 'recall': 0.34148020796153855, 'iou': 0.22182032025378684, 'dice': 0.3067158927088198} 

Best model saved for model efficientunet at epoch 10

Trial 16:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.42535652285036835, 'accuracy': 0.8164000591506129, 'precision': 0.7570627853922222, 'recall': 0.7206112046604571, 'iou': 0.5948703824178032, 'dice': 0.7265657965255821}
Test   -> {'loss': 93.19290161132812, 'accuracy': 0.5488032102584839, 'precision': 0.22906631231307983, 'recall': 0.33331865072250366, 'iou': 0.18302004039287567, 'dice': 0.23639462888240814}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3288604520585226, 'accuracy': 0.8602047684399978, 'precision': 0.8161221465338832, 'recall': 0.7892570184624713, 'iou': 0.6760002537913944, 'dice': 0.7978122420932936}
Test   -> {'loss': 23.748607635498047, 'accuracy': 0.6396347284317017, 'precision': 0.495531290769577, 'recall': 0.36496293544769287, 'iou': 0.25354528427124023, 'dice': 0.33712610602378845}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.288301148297994, 'accuracy': 0.8777040997277136, 'precision': 0.8395824867746104, 'recall': 0.8179520314154418, 'iou': 0.7114351788292761, 'dice': 0.8246500074863434}
Test   -> {'loss': 56.63811492919922, 'accuracy': 0.5596014261245728, 'precision': 0.32904812693595886, 'recall': 0.35849910974502563, 'iou': 0.23542778193950653, 'dice': 0.32863304018974304}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.25817369611366936, 'accuracy': 0.8906179731306823, 'precision': 0.8561915493529776, 'recall': 0.8384004033130148, 'iou': 0.7382198538469231, 'dice': 0.843998046024986}
Test   -> {'loss': 47.70547103881836, 'accuracy': 0.5198837518692017, 'precision': 0.3687213063240051, 'recall': 0.34922468662261963, 'iou': 0.2093912810087204, 'dice': 0.2982484996318817}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.23160173659739286, 'accuracy': 0.9015053414780161, 'precision': 0.8699173046194989, 'recall': 0.8547403353711833, 'iou': 0.7610458184843478, 'dice': 0.8600172281265259}
Test   -> {'loss': 31.536602020263672, 'accuracy': 0.5739384889602661, 'precision': 0.4973393380641937, 'recall': 0.3482015132904053, 'iou': 0.20871159434318542, 'dice': 0.2782844603061676}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2096648067883823, 'accuracy': 0.9103980160277823, 'precision': 0.8809818783532019, 'recall': 0.8681673449018728, 'iou': 0.7793623084607332, 'dice': 0.8723539093266363}
Test   -> {'loss': 37.424739837646484, 'accuracy': 0.5581042170524597, 'precision': 0.4496448040008545, 'recall': 0.36404380202293396, 'iou': 0.22393617033958435, 'dice': 0.3114871382713318}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.19669649095638939, 'accuracy': 0.91604701332424, 'precision': 0.8884935832541921, 'recall': 0.8767666783021844, 'iou': 0.7919463585252348, 'dice': 0.8806712495244068}
Test   -> {'loss': 39.36598587036133, 'accuracy': 0.5617501139640808, 'precision': 0.5535413026809692, 'recall': 0.3401915729045868, 'iou': 0.2105272263288498, 'dice': 0.280079185962677}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.18097920346519222, 'accuracy': 0.9227046274620554, 'precision': 0.8968348129935887, 'recall': 0.886827613218971, 'iou': 0.8065247411313264, 'dice': 0.8901503938695658}
Test   -> {'loss': 34.11860656738281, 'accuracy': 0.5951799750328064, 'precision': 0.3058775067329407, 'recall': 0.3269254267215729, 'iou': 0.22132238745689392, 'dice': 0.290785014629364}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1713127116146295, 'accuracy': 0.9268177996511044, 'precision': 0.9023226966028628, 'recall': 0.8931808453539144, 'iou': 0.8158904930819636, 'dice': 0.8961730428363965}
Test   -> {'loss': 58.94319152832031, 'accuracy': 0.5093271732330322, 'precision': 0.34805452823638916, 'recall': 0.3276700973510742, 'iou': 0.2104947417974472, 'dice': 0.29708290100097656}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.16230785461223643, 'accuracy': 0.9310843662075374, 'precision': 0.9076943957287332, 'recall': 0.8989184369211611, 'iou': 0.825034666320552, 'dice': 0.9019329262816388}
Test   -> {'loss': 26.832225799560547, 'accuracy': 0.6088381409645081, 'precision': 0.20388291776180267, 'recall': 0.3308364152908325, 'iou': 0.20294605195522308, 'dice': 0.25228896737098694}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.25354528427124023
Test -> {'loss': 23.748607635498047, 'accuracy': 0.6396347284317017, 'precision': 0.495531290769577, 'recall': 0.36496293544769287, 'iou': 0.25354528427124023, 'dice': 0.33712610602378845} 
Train -> {'loss': 0.3288604520585226, 'accuracy': 0.8602047684399978, 'precision': 0.8161221465338832, 'recall': 0.7892570184624713, 'iou': 0.6760002537913944, 'dice': 0.7978122420932936} 

Best model saved for model efficientunet at epoch 10

Trial 17:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4628340949182925, 'accuracy': 0.798122022981229, 'precision': 0.7262315294016962, 'recall': 0.6969971351001574, 'iou': 0.5676627565985141, 'dice': 0.6977713533069776}
Test   -> {'loss': 41.42572021484375, 'accuracy': 0.5006225109100342, 'precision': 0.2958882749080658, 'recall': 0.3231208622455597, 'iou': 0.19197021424770355, 'dice': 0.2689982056617737}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3062059392099795, 'accuracy': 0.8697667386220849, 'precision': 0.8274976253509522, 'recall': 0.7984461364538773, 'iou': 0.6882939131363578, 'dice': 0.806947214188783}
Test   -> {'loss': 55.10081100463867, 'accuracy': 0.5554224252700806, 'precision': 0.19592136144638062, 'recall': 0.3302572965621948, 'iou': 0.18534491956233978, 'dice': 0.23827773332595825}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.2547426694113275, 'accuracy': 0.8915708801020746, 'precision': 0.8555189257082731, 'recall': 0.8343383975650953, 'iou': 0.733858981858129, 'dice': 0.8405327263085739}
Test   -> {'loss': 36.386104583740234, 'accuracy': 0.5952634215354919, 'precision': 0.3579519987106323, 'recall': 0.3310507535934448, 'iou': 0.20964625477790833, 'dice': 0.26998376846313477}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.22416440922281017, 'accuracy': 0.9037548521290655, 'precision': 0.8723311559013699, 'recall': 0.8530851996463278, 'iou': 0.7586737435796986, 'dice': 0.8580391904582148}
Test   -> {'loss': 38.75688552856445, 'accuracy': 0.541218638420105, 'precision': 0.31535112857818604, 'recall': 0.33722150325775146, 'iou': 0.20686325430870056, 'dice': 0.2799663841724396}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.19855655846388442, 'accuracy': 0.9151203855224278, 'precision': 0.8860341859900434, 'recall': 0.8714844931726871, 'iou': 0.7845241702121237, 'dice': 0.8755658792412799}
Test   -> {'loss': 35.23676300048828, 'accuracy': 0.5616224408149719, 'precision': 0.22537468373775482, 'recall': 0.33422017097473145, 'iou': 0.19266293942928314, 'dice': 0.2491377592086792}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.17659160080163375, 'accuracy': 0.9242153219554735, 'precision': 0.8975953475288723, 'recall': 0.8868088779242143, 'iou': 0.8071246473685555, 'dice': 0.8905359320018602}
Test   -> {'loss': 38.48733139038086, 'accuracy': 0.55948406457901, 'precision': 0.23863336443901062, 'recall': 0.34038445353507996, 'iou': 0.20947198569774628, 'dice': 0.2758156955242157}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.17121562439462412, 'accuracy': 0.9268616868102032, 'precision': 0.9019901607347571, 'recall': 0.8908994436264038, 'iou': 0.8123996382174284, 'dice': 0.8937796530516251}
Test   -> {'loss': 72.44979858398438, 'accuracy': 0.5374011397361755, 'precision': 0.2428971230983734, 'recall': 0.33309686183929443, 'iou': 0.1891571581363678, 'dice': 0.2507125735282898}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.1535653637803119, 'accuracy': 0.9341858651327051, 'precision': 0.9112757579140042, 'recall': 0.9027996799220209, 'iou': 0.8312437855679056, 'dice': 0.9058984875679016}
Test   -> {'loss': 47.25224685668945, 'accuracy': 0.6090990900993347, 'precision': 0.2032354325056076, 'recall': 0.33285415172576904, 'iou': 0.203057199716568, 'dice': 0.2523748278617859}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1426502042490503, 'accuracy': 0.9388994755952255, 'precision': 0.9173549398131993, 'recall': 0.9083438044009001, 'iou': 0.8406404826952063, 'dice': 0.9116185172744419}
Test   -> {'loss': 44.58876419067383, 'accuracy': 0.5948585867881775, 'precision': 0.5193420648574829, 'recall': 0.3346412181854248, 'iou': 0.20874057710170746, 'dice': 0.2664305567741394}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.13831627485544784, 'accuracy': 0.9409336395885634, 'precision': 0.9197584276613981, 'recall': 0.912289956341619, 'iou': 0.8455619635789291, 'dice': 0.914585048219432}
Test   -> {'loss': 41.847412109375, 'accuracy': 0.5610743761062622, 'precision': 0.3713306784629822, 'recall': 0.3438470959663391, 'iou': 0.21089331805706024, 'dice': 0.2817698121070862}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.21089331805706024
Test -> {'loss': 41.847412109375, 'accuracy': 0.5610743761062622, 'precision': 0.3713306784629822, 'recall': 0.3438470959663391, 'iou': 0.21089331805706024, 'dice': 0.2817698121070862} 
Train -> {'loss': 0.13831627485544784, 'accuracy': 0.9409336395885634, 'precision': 0.9197584276613981, 'recall': 0.912289956341619, 'iou': 0.8455619635789291, 'dice': 0.914585048219432} 

Best model saved for model efficientunet at epoch 10

Trial 18:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4243138521909714, 'accuracy': 0.8160639367673708, 'precision': 0.7590747425089712, 'recall': 0.7201908102501994, 'iou': 0.5946649688741436, 'dice': 0.7265182839787525}
Test   -> {'loss': 56.59689712524414, 'accuracy': 0.5255948901176453, 'precision': 0.21623103320598602, 'recall': 0.329287052154541, 'iou': 0.17535552382469177, 'dice': 0.23000507056713104}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3286952316761017, 'accuracy': 0.8605067224606223, 'precision': 0.8181003754553587, 'recall': 0.7900116824585458, 'iou': 0.6767215054968129, 'dice': 0.798351698336394}
Test   -> {'loss': 55.83219528198242, 'accuracy': 0.5854890942573547, 'precision': 0.2156619131565094, 'recall': 0.32317501306533813, 'iou': 0.19804945588111877, 'dice': 0.2519911527633667}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.28545801639556884, 'accuracy': 0.8786092729672141, 'precision': 0.8408875983694325, 'recall': 0.8188131363495537, 'iou': 0.7127360597900723, 'dice': 0.8256000153396441}
Test   -> {'loss': 34.202945709228516, 'accuracy': 0.6423414349555969, 'precision': 0.4514724016189575, 'recall': 0.3501521050930023, 'iou': 0.24531525373458862, 'dice': 0.31836366653442383}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.25909622894681017, 'accuracy': 0.8903242787589197, 'precision': 0.8564625338367794, 'recall': 0.8386055244051892, 'iou': 0.7385683852693309, 'dice': 0.844278855945753}
Test   -> {'loss': 60.90797424316406, 'accuracy': 0.5978991389274597, 'precision': 0.19976285099983215, 'recall': 0.3320459723472595, 'iou': 0.19929972290992737, 'dice': 0.24945217370986938}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2280750231898349, 'accuracy': 0.9033674074255902, 'precision': 0.8722629884014959, 'recall': 0.8572465432726819, 'iou': 0.7645858090856801, 'dice': 0.8622992134612539}
Test   -> {'loss': 31.945892333984375, 'accuracy': 0.44521284103393555, 'precision': 0.4618150591850281, 'recall': 0.3569974899291992, 'iou': 0.2100054919719696, 'dice': 0.31369516253471375}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2100868579486142, 'accuracy': 0.9104084512461786, 'precision': 0.8810991168022155, 'recall': 0.8678927416386811, 'iou': 0.77922159485195, 'dice': 0.872250240004581}
Test   -> {'loss': 20.57300567626953, 'accuracy': 0.5393664240837097, 'precision': 0.32995742559432983, 'recall': 0.3372611403465271, 'iou': 0.19553939998149872, 'dice': 0.2615034580230713}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.18941319332174633, 'accuracy': 0.919339795993722, 'precision': 0.8925059621748717, 'recall': 0.8817575014155844, 'iou': 0.7991867334946342, 'dice': 0.8854063075521718}
Test   -> {'loss': 8.221405982971191, 'accuracy': 0.6387814879417419, 'precision': 0.24549417197704315, 'recall': 0.33328163623809814, 'iou': 0.21298900246620178, 'dice': 0.2599840760231018}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.17711249181757802, 'accuracy': 0.924500419523405, 'precision': 0.8992779355982076, 'recall': 0.8897060977376026, 'iou': 0.810981903128002, 'dice': 0.8930777339831643}
Test   -> {'loss': 14.072920799255371, 'accuracy': 0.6133958101272583, 'precision': 0.5816011428833008, 'recall': 0.3368474841117859, 'iou': 0.21667584776878357, 'dice': 0.2730039954185486}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.17073367808176124, 'accuracy': 0.9274551228336666, 'precision': 0.9034315093703892, 'recall': 0.8940144461134206, 'iou': 0.8175396188445713, 'dice': 0.8972221628479335}
Test   -> {'loss': 20.608400344848633, 'accuracy': 0.6422916054725647, 'precision': 0.2142285704612732, 'recall': 0.3330162465572357, 'iou': 0.21409720182418823, 'dice': 0.2607298493385315}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.15610433684095093, 'accuracy': 0.933546282156654, 'precision': 0.910762397620989, 'recall': 0.9027785091296486, 'iou': 0.8308957820353301, 'dice': 0.9056153297424316}
Test   -> {'loss': 12.994877815246582, 'accuracy': 0.5685710906982422, 'precision': 0.23853717744350433, 'recall': 0.32947877049446106, 'iou': 0.19293591380119324, 'dice': 0.2483445256948471}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 3 with IoU 0.24531525373458862
Test -> {'loss': 34.202945709228516, 'accuracy': 0.6423414349555969, 'precision': 0.4514724016189575, 'recall': 0.3501521050930023, 'iou': 0.24531525373458862, 'dice': 0.31836366653442383} 
Train -> {'loss': 0.28545801639556884, 'accuracy': 0.8786092729672141, 'precision': 0.8408875983694325, 'recall': 0.8188131363495537, 'iou': 0.7127360597900723, 'dice': 0.8256000153396441} 

Best model saved for model efficientunet at epoch 10

Trial 19:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4758458417394887, 'accuracy': 0.7926918745040894, 'precision': 0.7200417948805767, 'recall': 0.6897938427717789, 'iou': 0.5599391776582469, 'dice': 0.6904948835787565}
Test   -> {'loss': 70.53911590576172, 'accuracy': 0.5831155180931091, 'precision': 0.2652958333492279, 'recall': 0.332110732793808, 'iou': 0.1964828372001648, 'dice': 0.2497325986623764}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3034512141476507, 'accuracy': 0.8703647209250409, 'precision': 0.828125044055607, 'recall': 0.8013650609099346, 'iou': 0.6922407456066297, 'dice': 0.8103717498157336}
Test   -> {'loss': 64.44207000732422, 'accuracy': 0.5754328966140747, 'precision': 0.21057234704494476, 'recall': 0.32804328203201294, 'iou': 0.1938706338405609, 'dice': 0.24684534966945648}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.25052396033121194, 'accuracy': 0.8930089033168295, 'precision': 0.8572787233020949, 'recall': 0.8372058728466863, 'iou': 0.7369904922402424, 'dice': 0.8430379758710447}
Test   -> {'loss': 72.9086685180664, 'accuracy': 0.5600703954696655, 'precision': 0.3117734491825104, 'recall': 0.3269733786582947, 'iou': 0.21004393696784973, 'dice': 0.28363263607025146}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2172513133805731, 'accuracy': 0.9066967228184576, 'precision': 0.8744440140931503, 'recall': 0.8590544187504312, 'iou': 0.767251894266709, 'dice': 0.8641851699870565}
Test   -> {'loss': 91.87325286865234, 'accuracy': 0.526677668094635, 'precision': 0.22074976563453674, 'recall': 0.3208758234977722, 'iou': 0.1841510385274887, 'dice': 0.24690847098827362}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.19199873260829758, 'accuracy': 0.9177697046943333, 'precision': 0.8897930062335471, 'recall': 0.8771775681039561, 'iou': 0.7931877405747123, 'dice': 0.8815778711567754}
Test   -> {'loss': 65.23883819580078, 'accuracy': 0.5817802548408508, 'precision': 0.30603280663490295, 'recall': 0.3283213675022125, 'iou': 0.19712591171264648, 'dice': 0.2514626681804657}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.1745773009631945, 'accuracy': 0.9253012543139251, 'precision': 0.8981572602106177, 'recall': 0.8883577051370041, 'iou': 0.8084451965663744, 'dice': 0.8913606721421946}
Test   -> {'loss': 149.6668243408203, 'accuracy': 0.5773455500602722, 'precision': 0.26317155361175537, 'recall': 0.33293938636779785, 'iou': 0.19625791907310486, 'dice': 0.2516133785247803}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.16107254689154418, 'accuracy': 0.9311398252196934, 'precision': 0.907609510421753, 'recall': 0.8962062840876373, 'iou': 0.822217857837677, 'dice': 0.9001549202462901}
Test   -> {'loss': 34.173316955566406, 'accuracy': 0.5909601449966431, 'precision': 0.22233614325523376, 'recall': 0.3318595290184021, 'iou': 0.19806256890296936, 'dice': 0.2497101128101349}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.15003588614256486, 'accuracy': 0.9358893555143605, 'precision': 0.9137799511785093, 'recall': 0.9061700287072555, 'iou': 0.8361616020617277, 'dice': 0.9089404090591099}
Test   -> {'loss': 33.49819564819336, 'accuracy': 0.6013036966323853, 'precision': 0.28872162103652954, 'recall': 0.32954517006874084, 'iou': 0.2048090398311615, 'dice': 0.2589266300201416}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.14759621620178223, 'accuracy': 0.9371604966080707, 'precision': 0.9159407470537269, 'recall': 0.9063704646151999, 'iou': 0.8366723143536111, 'dice': 0.9090646598650062}
Test   -> {'loss': 22.173477172851562, 'accuracy': 0.5775339603424072, 'precision': 0.5817059874534607, 'recall': 0.3342425525188446, 'iou': 0.19431857764720917, 'dice': 0.2473612278699875}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.13457053925680076, 'accuracy': 0.9425662294678067, 'precision': 0.9232257324716319, 'recall': 0.9150520770446114, 'iou': 0.8506723787473596, 'dice': 0.9177545334981836}
Test   -> {'loss': 29.46042251586914, 'accuracy': 0.6215963363647461, 'precision': 0.5849236845970154, 'recall': 0.33366215229034424, 'iou': 0.2110101580619812, 'dice': 0.26269885897636414}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.2110101580619812
Test -> {'loss': 29.46042251586914, 'accuracy': 0.6215963363647461, 'precision': 0.5849236845970154, 'recall': 0.33366215229034424, 'iou': 0.2110101580619812, 'dice': 0.26269885897636414} 
Train -> {'loss': 0.13457053925680076, 'accuracy': 0.9425662294678067, 'precision': 0.9232257324716319, 'recall': 0.9150520770446114, 'iou': 0.8506723787473596, 'dice': 0.9177545334981836} 

Best model saved for model efficientunet at epoch 10

Trial 20:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 68.8483102614465, 'accuracy': 0.6114226698227551, 'precision': 0.4852966504900352, 'recall': 0.4730163094142209, 'iou': 0.334894424514926, 'dice': 0.46131018743566843}
Test   -> {'loss': 11.333409309387207, 'accuracy': 0.5285295844078064, 'precision': 0.386568158864975, 'recall': 0.3718419671058655, 'iou': 0.2264919877052307, 'dice': 0.3137097954750061}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6560543842937635, 'accuracy': 0.712035793584326, 'precision': 0.5804086755151334, 'recall': 0.5434454062710637, 'iou': 0.41723857781161433, 'dice': 0.5524683437917544}
Test   -> {'loss': 8.927647590637207, 'accuracy': 0.5402993559837341, 'precision': 0.4073213040828705, 'recall': 0.3454984426498413, 'iou': 0.20921695232391357, 'dice': 0.28594738245010376}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6212661305199498, 'accuracy': 0.723481900277345, 'precision': 0.6067691976609437, 'recall': 0.5667156727417656, 'iou': 0.43856884876023167, 'dice': 0.5774959740431412}
Test   -> {'loss': 6.733697891235352, 'accuracy': 0.6125849485397339, 'precision': 0.40306371450424194, 'recall': 0.35564881563186646, 'iou': 0.24561695754528046, 'dice': 0.32689592242240906}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6010573766801668, 'accuracy': 0.7341756110605986, 'precision': 0.6293576950612275, 'recall': 0.5848551650410113, 'iou': 0.4563997111890627, 'dice': 0.5972951559916787}
Test   -> {'loss': 4.5763139724731445, 'accuracy': 0.5691030025482178, 'precision': 0.4424615502357483, 'recall': 0.355726957321167, 'iou': 0.22653478384017944, 'dice': 0.30755382776260376}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5891247885382693, 'accuracy': 0.7388472813626994, 'precision': 0.6389138278753861, 'recall': 0.5939642242763353, 'iou': 0.46525428502456, 'dice': 0.6072314692580182}
Test   -> {'loss': 4.4588117599487305, 'accuracy': 0.5722606182098389, 'precision': 0.4175839424133301, 'recall': 0.3419650197029114, 'iou': 0.21216461062431335, 'dice': 0.28256845474243164}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5810704578524051, 'accuracy': 0.7428946619448454, 'precision': 0.6472904477430427, 'recall': 0.6000238097232321, 'iou': 0.47240648321483447, 'dice': 0.6153056883293649}
Test   -> {'loss': 6.9063544273376465, 'accuracy': 0.5835172533988953, 'precision': 0.4120211601257324, 'recall': 0.34560173749923706, 'iou': 0.21973422169685364, 'dice': 0.2923128008842468}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5700531379036281, 'accuracy': 0.7480644775473553, 'precision': 0.6560505454954894, 'recall': 0.6080999309601991, 'iou': 0.48072558822839156, 'dice': 0.6237775336141171}
Test   -> {'loss': 7.817543029785156, 'accuracy': 0.5249072909355164, 'precision': 0.3771449327468872, 'recall': 0.3341732621192932, 'iou': 0.18205219507217407, 'dice': 0.24258801341056824}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5625395715236664, 'accuracy': 0.7524067521095276, 'precision': 0.6635418267353721, 'recall': 0.614375620821248, 'iou': 0.4871746153935142, 'dice': 0.6303743056629015}
Test   -> {'loss': 7.657797813415527, 'accuracy': 0.5802574753761292, 'precision': 0.24384479224681854, 'recall': 0.3187623620033264, 'iou': 0.19945940375328064, 'dice': 0.255061537027359}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5481886249521505, 'accuracy': 0.7583318331967229, 'precision': 0.67367811643559, 'recall': 0.6213449198266734, 'iou': 0.4951125923706138, 'dice': 0.6377905596857486}
Test   -> {'loss': 8.066213607788086, 'accuracy': 0.5188474059104919, 'precision': 0.3195379674434662, 'recall': 0.32911860942840576, 'iou': 0.1959291398525238, 'dice': 0.2709587812423706}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5402219561131104, 'accuracy': 0.7629134364750074, 'precision': 0.6795219333275505, 'recall': 0.6305061980434086, 'iou': 0.5035571177368579, 'dice': 0.6467574801134026}
Test   -> {'loss': 8.65366268157959, 'accuracy': 0.5354190468788147, 'precision': 0.24897238612174988, 'recall': 0.3208853304386139, 'iou': 0.18948346376419067, 'dice': 0.2537643313407898}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 3 with IoU 0.24561695754528046
Test -> {'loss': 6.733697891235352, 'accuracy': 0.6125849485397339, 'precision': 0.40306371450424194, 'recall': 0.35564881563186646, 'iou': 0.24561695754528046, 'dice': 0.32689592242240906} 
Train -> {'loss': 0.6212661305199498, 'accuracy': 0.723481900277345, 'precision': 0.6067691976609437, 'recall': 0.5667156727417656, 'iou': 0.43856884876023167, 'dice': 0.5774959740431412} 

Best model saved for model efficientunet at epoch 10

Trial 21:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1793.493100885723, 'accuracy': 0.4064427443172621, 'precision': 0.35778312579445215, 'recall': 0.3588831963746444, 'iou': 0.20424487033615943, 'dice': 0.3109832069148188}
Test   -> {'loss': 8922.607421875, 'accuracy': 0.3115682601928711, 'precision': 0.37581342458724976, 'recall': 0.3621334433555603, 'iou': 0.17893490195274353, 'dice': 0.2986561954021454}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 6.307910892237787, 'accuracy': 0.5774231853692428, 'precision': 0.4305233297140702, 'recall': 0.4281029786752618, 'iou': 0.2953485457793526, 'dice': 0.41782928886620896}
Test   -> {'loss': 2464.421142578125, 'accuracy': 0.3727909028530121, 'precision': 0.3364487290382385, 'recall': 0.3350710868835449, 'iou': 0.19883662462234497, 'dice': 0.32057222723960876}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 1.4309883781101393, 'accuracy': 0.6255305259124092, 'precision': 0.46864978800649226, 'recall': 0.453480325056159, 'iou': 0.3287117317966793, 'dice': 0.4564137790514075}
Test   -> {'loss': 870.8873291015625, 'accuracy': 0.3955722749233246, 'precision': 0.34908244013786316, 'recall': 0.3502357006072998, 'iou': 0.2131977081298828, 'dice': 0.33970826864242554}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 1.1046608629434005, 'accuracy': 0.653092506657476, 'precision': 0.4962803410447162, 'recall': 0.47667188851729686, 'iou': 0.3510775680127351, 'dice': 0.4801028635190881}
Test   -> {'loss': 979.332763671875, 'accuracy': 0.4423557221889496, 'precision': 0.3525530993938446, 'recall': 0.35629773139953613, 'iou': 0.22684749960899353, 'dice': 0.349665105342865}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.9735985569331957, 'accuracy': 0.6701685164285742, 'precision': 0.5162179931350376, 'recall': 0.49195541817208993, 'iou': 0.3671823423841725, 'dice': 0.4976041151129681}
Test   -> {'loss': 511.29779052734375, 'accuracy': 0.3609659671783447, 'precision': 0.3213333785533905, 'recall': 0.32441088557243347, 'iou': 0.19087430834770203, 'dice': 0.31052452325820923}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.8513401845227118, 'accuracy': 0.6814169256583504, 'precision': 0.5288239805594734, 'recall': 0.49859079329863837, 'iou': 0.37423266820285633, 'dice': 0.5034892984058545}
Test   -> {'loss': 561.2369384765625, 'accuracy': 0.33107057213783264, 'precision': 0.33703383803367615, 'recall': 0.34284862875938416, 'iou': 0.18025076389312744, 'dice': 0.299547016620636}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.8009046829265097, 'accuracy': 0.6907930565916973, 'precision': 0.5415504538494608, 'recall': 0.5069659419681715, 'iou': 0.3840522050857544, 'dice': 0.5141341618869616}
Test   -> {'loss': 724.0286865234375, 'accuracy': 0.47489428520202637, 'precision': 0.3511143922805786, 'recall': 0.3489576578140259, 'iou': 0.231620192527771, 'dice': 0.34811660647392273}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7548578625139983, 'accuracy': 0.6978413441906804, 'precision': 0.5525134428687718, 'recall': 0.5153761982917786, 'iou': 0.3929886447346729, 'dice': 0.5242909877196602}
Test   -> {'loss': 669.7401123046875, 'accuracy': 0.3951534330844879, 'precision': 0.36758506298065186, 'recall': 0.3700917363166809, 'iou': 0.21790765225887299, 'dice': 0.34771299362182617}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7278312211451323, 'accuracy': 0.7024712977202042, 'precision': 0.5605426503264386, 'recall': 0.5247600881949716, 'iou': 0.40063981621161754, 'dice': 0.53317289352417}
Test   -> {'loss': 1139.5750732421875, 'accuracy': 0.38064324855804443, 'precision': 0.3433140218257904, 'recall': 0.34189194440841675, 'iou': 0.20686249434947968, 'dice': 0.33238309621810913}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7061137614042863, 'accuracy': 0.706161660215129, 'precision': 0.5668253359587296, 'recall': 0.5265905976295471, 'iou': 0.40323334725006765, 'dice': 0.5353195185246675}
Test   -> {'loss': 476.84320068359375, 'accuracy': 0.38484033942222595, 'precision': 0.3945874571800232, 'recall': 0.3834790885448456, 'iou': 0.2208147495985031, 'dice': 0.35267600417137146}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 7 with IoU 0.231620192527771
Test -> {'loss': 724.0286865234375, 'accuracy': 0.47489428520202637, 'precision': 0.3511143922805786, 'recall': 0.3489576578140259, 'iou': 0.231620192527771, 'dice': 0.34811660647392273} 
Train -> {'loss': 0.8009046829265097, 'accuracy': 0.6907930565916973, 'precision': 0.5415504538494608, 'recall': 0.5069659419681715, 'iou': 0.3840522050857544, 'dice': 0.5141341618869616} 

Best model saved for model efficientunet at epoch 10

Trial 22:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 41.041866639904356, 'accuracy': 0.6211303699923598, 'precision': 0.4969179779291153, 'recall': 0.47872920314902845, 'iou': 0.3456414880959884, 'dice': 0.4745706589973491}
Test   -> {'loss': 26.973657608032227, 'accuracy': 0.5311030149459839, 'precision': 0.2993127107620239, 'recall': 0.3232550323009491, 'iou': 0.21425923705101013, 'dice': 0.298965185880661}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6254823220812756, 'accuracy': 0.7207694851833841, 'precision': 0.603206272488055, 'recall': 0.564364599533703, 'iou': 0.4358263673989669, 'dice': 0.5748372076646141}
Test   -> {'loss': 108.64613342285156, 'accuracy': 0.5202848315238953, 'precision': 0.3577001988887787, 'recall': 0.34846633672714233, 'iou': 0.22329136729240417, 'dice': 0.3201596736907959}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5965499874042428, 'accuracy': 0.7344829209472822, 'precision': 0.629641385441241, 'recall': 0.5857950364765914, 'iou': 0.4567427048216695, 'dice': 0.5977375202852747}
Test   -> {'loss': 48.083770751953125, 'accuracy': 0.5140455365180969, 'precision': 0.3764406144618988, 'recall': 0.3469417095184326, 'iou': 0.20865027606487274, 'dice': 0.29541778564453125}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5837473273277283, 'accuracy': 0.7412711451882902, 'precision': 0.6418950884238533, 'recall': 0.5961617303931195, 'iou': 0.4682187967974207, 'dice': 0.6104584691317185}
Test   -> {'loss': 17.251195907592773, 'accuracy': 0.5746123790740967, 'precision': 0.31723612546920776, 'recall': 0.32921892404556274, 'iou': 0.21316298842430115, 'dice': 0.28451573848724365}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5705772129089935, 'accuracy': 0.7472017912761025, 'precision': 0.6535153565199479, 'recall': 0.607055304620577, 'iou': 0.47882614381935285, 'dice': 0.6218128950699516}
Test   -> {'loss': 16.111955642700195, 'accuracy': 0.5169403553009033, 'precision': 0.3455476760864258, 'recall': 0.3653872609138489, 'iou': 0.23718371987342834, 'dice': 0.3433200716972351}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5614107151394305, 'accuracy': 0.751470866151478, 'precision': 0.6616019451099894, 'recall': 0.6147102793921595, 'iou': 0.486558800417444, 'dice': 0.6299171248207922}
Test   -> {'loss': 26.857927322387695, 'accuracy': 0.5369474291801453, 'precision': 0.3369182050228119, 'recall': 0.3332069516181946, 'iou': 0.21142888069152832, 'dice': 0.29582011699676514}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5504825584266497, 'accuracy': 0.7562075412791708, 'precision': 0.6689532878606216, 'recall': 0.6200950210509093, 'iou': 0.49245796333188596, 'dice': 0.6354896649070408}
Test   -> {'loss': 15.3108549118042, 'accuracy': 0.560884416103363, 'precision': 0.35024553537368774, 'recall': 0.34449857473373413, 'iou': 0.2207576483488083, 'dice': 0.3041687607765198}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5405514590118242, 'accuracy': 0.7609769919644231, 'precision': 0.6763767690762229, 'recall': 0.6287539666113646, 'iou': 0.5015065180218738, 'dice': 0.6449810538602911}
Test   -> {'loss': 19.226425170898438, 'accuracy': 0.5989940166473389, 'precision': 0.31188952922821045, 'recall': 0.3289826512336731, 'iou': 0.2120746225118637, 'dice': 0.2738097608089447}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5278251305870388, 'accuracy': 0.7662938799547112, 'precision': 0.6854099061178125, 'recall': 0.6375915706157684, 'iou': 0.510494548211927, 'dice': 0.654009589423304}
Test   -> {'loss': 14.905472755432129, 'accuracy': 0.5305586457252502, 'precision': 0.3191567063331604, 'recall': 0.3407456576824188, 'iou': 0.20187515020370483, 'dice': 0.2729702889919281}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.518993915811829, 'accuracy': 0.7707771754783133, 'precision': 0.6913509247095688, 'recall': 0.6458698803963868, 'iou': 0.5181213754674663, 'dice': 0.661267646499302}
Test   -> {'loss': 8.55428409576416, 'accuracy': 0.5535552501678467, 'precision': 0.40964579582214355, 'recall': 0.35518282651901245, 'iou': 0.22498127818107605, 'dice': 0.3116581439971924}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 5 with IoU 0.23718371987342834
Test -> {'loss': 16.111955642700195, 'accuracy': 0.5169403553009033, 'precision': 0.3455476760864258, 'recall': 0.3653872609138489, 'iou': 0.23718371987342834, 'dice': 0.3433200716972351} 
Train -> {'loss': 0.5705772129089935, 'accuracy': 0.7472017912761025, 'precision': 0.6535153565199479, 'recall': 0.607055304620577, 'iou': 0.47882614381935285, 'dice': 0.6218128950699516} 

Best model saved for model efficientunet at epoch 10

Trial 23:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 426.6636020183563, 'accuracy': 0.44910597360652427, 'precision': 0.3800002362417138, 'recall': 0.37624465589937955, 'iou': 0.22762682684089827, 'dice': 0.3391718734865603}
Test   -> {'loss': 811.520751953125, 'accuracy': 0.3306784927845001, 'precision': 0.30994004011154175, 'recall': 0.3095388412475586, 'iou': 0.15799877047538757, 'dice': 0.26309043169021606}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 2.7009830194970834, 'accuracy': 0.5999855399131775, 'precision': 0.4442487099896307, 'recall': 0.4329946771911953, 'iou': 0.3081875759622325, 'dice': 0.43187868517378103}
Test   -> {'loss': 45.88115310668945, 'accuracy': 0.38755518198013306, 'precision': 0.33803224563598633, 'recall': 0.3348855674266815, 'iou': 0.1887601613998413, 'dice': 0.2929694652557373}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.8626399599987528, 'accuracy': 0.6642999172210693, 'precision': 0.49547803764757903, 'recall': 0.464917275439138, 'iou': 0.34853393876034283, 'dice': 0.47228791506394097}
Test   -> {'loss': 24.645732879638672, 'accuracy': 0.4310738742351532, 'precision': 0.370003879070282, 'recall': 0.3630167245864868, 'iou': 0.21760892868041992, 'dice': 0.3304782509803772}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7612858098486196, 'accuracy': 0.6803084793298141, 'precision': 0.5181441182675569, 'recall': 0.4832210027653238, 'iou': 0.36612832468488943, 'dice': 0.4923791691013005}
Test   -> {'loss': 24.179580688476562, 'accuracy': 0.35337579250335693, 'precision': 0.4025747776031494, 'recall': 0.38202351331710815, 'iou': 0.1983737200498581, 'dice': 0.3203357756137848}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7228204576865487, 'accuracy': 0.6885411392087522, 'precision': 0.5301339958025062, 'recall': 0.4928377161855283, 'iou': 0.37566278991491897, 'dice': 0.5027195588402126}
Test   -> {'loss': 18.34554100036621, 'accuracy': 0.3870890140533447, 'precision': 0.4287395179271698, 'recall': 0.40813466906547546, 'iou': 0.2253783941268921, 'dice': 0.3572659492492676}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6956692389819933, 'accuracy': 0.6947313614513563, 'precision': 0.5405109338138414, 'recall': 0.5007596368375031, 'iou': 0.38318032648252404, 'dice': 0.5110738733540411}
Test   -> {'loss': 15.829554557800293, 'accuracy': 0.5327671766281128, 'precision': 0.3842611014842987, 'recall': 0.3793874979019165, 'iou': 0.262224406003952, 'dice': 0.38066214323043823}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6754314894261567, 'accuracy': 0.7000229908072431, 'precision': 0.5500628829002381, 'recall': 0.5083814227062723, 'iou': 0.3904989885247272, 'dice': 0.5195186169251151}
Test   -> {'loss': 14.643131256103516, 'accuracy': 0.5283025503158569, 'precision': 0.42123040556907654, 'recall': 0.41664761304855347, 'iou': 0.2862352132797241, 'dice': 0.4169943332672119}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6626098964525305, 'accuracy': 0.7054479801136514, 'precision': 0.5604740313861681, 'recall': 0.5161924051201862, 'iou': 0.39798991861550703, 'dice': 0.5281333498332812}
Test   -> {'loss': 15.486579895019531, 'accuracy': 0.39465487003326416, 'precision': 0.42073091864585876, 'recall': 0.4121214747428894, 'iou': 0.22865623235702515, 'dice': 0.36231204867362976}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6549354589503744, 'accuracy': 0.7072725710661515, 'precision': 0.5638182360193004, 'recall': 0.5218469935914745, 'iou': 0.40242321258005886, 'dice': 0.5335932332536448}
Test   -> {'loss': 17.12175941467285, 'accuracy': 0.4215153157711029, 'precision': 0.41242820024490356, 'recall': 0.40823179483413696, 'iou': 0.2393845021724701, 'dice': 0.3731709122657776}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6429572649624037, 'accuracy': 0.7116222034329953, 'precision': 0.5723068092180335, 'recall': 0.5292063479838164, 'iou': 0.40893815004307293, 'dice': 0.5410589394362076}
Test   -> {'loss': 14.176082611083984, 'accuracy': 0.45836156606674194, 'precision': 0.41865643858909607, 'recall': 0.41862231492996216, 'iou': 0.26065850257873535, 'dice': 0.3977714478969574}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 7 with IoU 0.2862352132797241
Test -> {'loss': 14.643131256103516, 'accuracy': 0.5283025503158569, 'precision': 0.42123040556907654, 'recall': 0.41664761304855347, 'iou': 0.2862352132797241, 'dice': 0.4169943332672119} 
Train -> {'loss': 0.6754314894261567, 'accuracy': 0.7000229908072431, 'precision': 0.5500628829002381, 'recall': 0.5083814227062723, 'iou': 0.3904989885247272, 'dice': 0.5195186169251151} 

Best model saved for model efficientunet at epoch 10

Trial 24:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.435283211780631, 'accuracy': 0.7478668308776358, 'precision': 0.5743550272091575, 'recall': 0.5682028004656667, 'iou': 0.4483293705660364, 'dice': 0.5673591421998065}
Test   -> {'loss': 0.7508333325386047, 'accuracy': 0.3450329899787903, 'precision': 0.3713735044002533, 'recall': 0.3811809718608856, 'iou': 0.19081518054008484, 'dice': 0.31014883518218994}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4562013680520265, 'accuracy': 0.7376190823057424, 'precision': 0.5595981908881146, 'recall': 0.5508059949978538, 'iou': 0.42985963056916776, 'dice': 0.5459729920262876}
Test   -> {'loss': 0.7416927218437195, 'accuracy': 0.5471228957176208, 'precision': 0.4278561472892761, 'recall': 0.3417244851589203, 'iou': 0.19987422227859497, 'dice': 0.26585498452186584}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5983925194843955, 'accuracy': 0.6278937903435334, 'precision': 0.43345717243526294, 'recall': 0.43195243516693943, 'iou': 0.309076749889747, 'dice': 0.4135289742894795}
Test   -> {'loss': 0.7434724569320679, 'accuracy': 0.3267647922039032, 'precision': 0.3519577980041504, 'recall': 0.3997456729412079, 'iou': 0.1666048765182495, 'dice': 0.26087287068367004}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7179277093514153, 'accuracy': 0.5368814498186112, 'precision': 0.302676508737647, 'recall': 0.3200901395600775, 'iou': 0.21613755537116008, 'dice': 0.3022285997867584}
Test   -> {'loss': 0.9077593088150024, 'accuracy': 0.13447290658950806, 'precision': 0.40015333890914917, 'recall': 0.34493693709373474, 'iou': 0.05236879736185074, 'dice': 0.09588643908500671}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7086829527564671, 'accuracy': 0.5818901362626449, 'precision': 0.3271857927674833, 'recall': 0.3394560655821925, 'iou': 0.2335303883837617, 'dice': 0.3175356442513673}
Test   -> {'loss': 0.9106658697128296, 'accuracy': 0.13498236238956451, 'precision': 0.3965145945549011, 'recall': 0.3400968909263611, 'iou': 0.04933171719312668, 'dice': 0.08932310342788696}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6925703502219657, 'accuracy': 0.6091942667961121, 'precision': 0.3541274307862572, 'recall': 0.3598398279884587, 'iou': 0.25124763535416644, 'dice': 0.33707917099413665}
Test   -> {'loss': 0.9215748310089111, 'accuracy': 0.1233171746134758, 'precision': 0.36110538244247437, 'recall': 0.3339824080467224, 'iou': 0.04213681444525719, 'dice': 0.07562953233718872}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7015607128972593, 'accuracy': 0.5593303033839101, 'precision': 0.32602544737898786, 'recall': 0.33853939603204314, 'iou': 0.2311813817076061, 'dice': 0.32018170408580615}
Test   -> {'loss': 0.8183045387268066, 'accuracy': 0.23416323959827423, 'precision': 0.3743250370025635, 'recall': 0.37344086170196533, 'iou': 0.10739637911319733, 'dice': 0.18452924489974976}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6821701832439588, 'accuracy': 0.49659464540688886, 'precision': 0.33569559338300126, 'recall': 0.340717200740524, 'iou': 0.22486332480026328, 'dice': 0.33052134293576946}
Test   -> {'loss': 0.7354120016098022, 'accuracy': 0.3132747709751129, 'precision': 0.33666205406188965, 'recall': 0.3353906571865082, 'iou': 0.16693302989006042, 'dice': 0.27807506918907166}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6927561718484629, 'accuracy': 0.37997930205386615, 'precision': 0.3361968438262525, 'recall': 0.3361098656187887, 'iou': 0.1936495937730955, 'dice': 0.3108178920072058}
Test   -> {'loss': 0.7155299186706543, 'accuracy': 0.36692342162132263, 'precision': 0.336861252784729, 'recall': 0.3374919295310974, 'iou': 0.18376928567886353, 'dice': 0.2931751310825348}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6956211792386097, 'accuracy': 0.36671231712984004, 'precision': 0.3340855350960856, 'recall': 0.33376005589962005, 'iou': 0.19056138895128083, 'dice': 0.3076744796141334}
Test   -> {'loss': 0.691158652305603, 'accuracy': 0.37228456139564514, 'precision': 0.330478310585022, 'recall': 0.32985609769821167, 'iou': 0.20188722014427185, 'dice': 0.3270277678966522}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.20188722014427185
Test -> {'loss': 0.691158652305603, 'accuracy': 0.37228456139564514, 'precision': 0.330478310585022, 'recall': 0.32985609769821167, 'iou': 0.20188722014427185, 'dice': 0.3270277678966522} 
Train -> {'loss': 0.6956211792386097, 'accuracy': 0.36671231712984004, 'precision': 0.3340855350960856, 'recall': 0.33376005589962005, 'iou': 0.19056138895128083, 'dice': 0.3076744796141334} 

Best model saved for model efficientunet at epoch 10

Trial 25:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.43386934425519863, 'accuracy': 0.7455157352530438, 'precision': 0.5765644944232443, 'recall': 0.575086061850838, 'iou': 0.4529526529104813, 'dice': 0.5713978679283805}
Test   -> {'loss': 0.7486217021942139, 'accuracy': 0.4045475423336029, 'precision': 0.3248945474624634, 'recall': 0.33172231912612915, 'iou': 0.193654865026474, 'dice': 0.3002933859825134}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4080969178158304, 'accuracy': 0.793357983879421, 'precision': 0.6055902781693832, 'recall': 0.6010136386622553, 'iou': 0.48784394938012826, 'dice': 0.5937554794809092}
Test   -> {'loss': 0.8262379765510559, 'accuracy': 0.26906538009643555, 'precision': 0.368694543838501, 'recall': 0.35523244738578796, 'iou': 0.14371183514595032, 'dice': 0.2460925430059433}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4088370406109354, 'accuracy': 0.8038471698760986, 'precision': 0.6111423658288043, 'recall': 0.6054265224415323, 'iou': 0.49342164889625884, 'dice': 0.5930963448856188}
Test   -> {'loss': 0.7952927350997925, 'accuracy': 0.3353053331375122, 'precision': 0.37738460302352905, 'recall': 0.35890644788742065, 'iou': 0.17664310336112976, 'dice': 0.28459131717681885}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.40502752480299575, 'accuracy': 0.8089294407678687, 'precision': 0.6172355361606764, 'recall': 0.6097699859867926, 'iou': 0.4985210340955983, 'dice': 0.5969592954801477}
Test   -> {'loss': 0.8043924570083618, 'accuracy': 0.31289735436439514, 'precision': 0.3693884611129761, 'recall': 0.3493683338165283, 'iou': 0.1613313853740692, 'dice': 0.2640504539012909}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.40325304995412414, 'accuracy': 0.8109297462131666, 'precision': 0.6163505782251772, 'recall': 0.6116797353910364, 'iou': 0.5012782786203467, 'dice': 0.5987890969152035}
Test   -> {'loss': 0.7817384004592896, 'accuracy': 0.3946969211101532, 'precision': 0.34487709403038025, 'recall': 0.33228588104248047, 'iou': 0.1863400936126709, 'dice': 0.2857522666454315}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.40192394256591796, 'accuracy': 0.8124724149703979, 'precision': 0.6180052487746529, 'recall': 0.6128631757653278, 'iou': 0.5029081925101903, 'dice': 0.6001345323479694}
Test   -> {'loss': 0.7230931520462036, 'accuracy': 0.5211608409881592, 'precision': 0.3807830810546875, 'recall': 0.3493310809135437, 'iou': 0.2189193218946457, 'dice': 0.3043912351131439}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4019123378007308, 'accuracy': 0.812663501760234, 'precision': 0.6183739206065302, 'recall': 0.6128910992456519, 'iou': 0.5029682988705843, 'dice': 0.6001893955728282}
Test   -> {'loss': 0.7343853712081909, 'accuracy': 0.35589879751205444, 'precision': 0.37988078594207764, 'recall': 0.37562525272369385, 'iou': 0.18586747348308563, 'dice': 0.2950422167778015}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.4011894034302753, 'accuracy': 0.81329389344091, 'precision': 0.6191469876662544, 'recall': 0.6138758089231409, 'iou': 0.5039038051729617, 'dice': 0.6009411112121914}
Test   -> {'loss': 0.796053946018219, 'accuracy': 0.2786145806312561, 'precision': 0.31013545393943787, 'recall': 0.3125539720058441, 'iou': 0.14147338271141052, 'dice': 0.23869812488555908}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4013131701427957, 'accuracy': 0.8129937094190847, 'precision': 0.6213377149208732, 'recall': 0.6139283423838409, 'iou': 0.5033809744793436, 'dice': 0.6008335040963214}
Test   -> {'loss': 0.7799532413482666, 'accuracy': 0.26977819204330444, 'precision': 0.3844738006591797, 'recall': 0.36580801010131836, 'iou': 0.14767292141914368, 'dice': 0.25188180804252625}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.4032293889833533, 'accuracy': 0.8107021124466606, 'precision': 0.618309409722038, 'recall': 0.6114504886710126, 'iou': 0.5007691551809725, 'dice': 0.5987855921620908}
Test   -> {'loss': 0.7798640727996826, 'accuracy': 0.2668329179286957, 'precision': 0.38357171416282654, 'recall': 0.3595317304134369, 'iou': 0.14576449990272522, 'dice': 0.24932754039764404}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.2189193218946457
Test -> {'loss': 0.7230931520462036, 'accuracy': 0.5211608409881592, 'precision': 0.3807830810546875, 'recall': 0.3493310809135437, 'iou': 0.2189193218946457, 'dice': 0.3043912351131439} 
Train -> {'loss': 0.40192394256591796, 'accuracy': 0.8124724149703979, 'precision': 0.6180052487746529, 'recall': 0.6128631757653278, 'iou': 0.5029081925101903, 'dice': 0.6001345323479694} 

Best model saved for model efficientunet at epoch 10

Trial 26:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4431239905564681, 'accuracy': 0.7377402445544368, 'precision': 0.5604820843624032, 'recall': 0.5636766819850259, 'iou': 0.43915713740431744, 'dice': 0.5591720774121907}
Test   -> {'loss': 0.8172746300697327, 'accuracy': 0.35169827938079834, 'precision': 0.35837578773498535, 'recall': 0.3321370780467987, 'iou': 0.1575303077697754, 'dice': 0.24406056106090546}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5555687608926193, 'accuracy': 0.6785556972026825, 'precision': 0.45219154694805974, 'recall': 0.4899056561615156, 'iou': 0.3507021963596344, 'dice': 0.4483619950387789}
Test   -> {'loss': 0.7926080822944641, 'accuracy': 0.4745657742023468, 'precision': 0.28323811292648315, 'recall': 0.3455447554588318, 'iou': 0.19116996228694916, 'dice': 0.2705394923686981}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6189086261002914, 'accuracy': 0.6154845727526623, 'precision': 0.40843126022297405, 'recall': 0.42311558075573136, 'iou': 0.293596646124902, 'dice': 0.3955638833667921}
Test   -> {'loss': 0.9353912472724915, 'accuracy': 0.10634441673755646, 'precision': 0.35056495666503906, 'recall': 0.33449968695640564, 'iou': 0.036041658371686935, 'dice': 0.06548009812831879}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6703360858170883, 'accuracy': 0.47295532965141796, 'precision': 0.35531442657760953, 'recall': 0.3540199866761332, 'iou': 0.22575335541497107, 'dice': 0.33500792500765425}
Test   -> {'loss': 0.7296300530433655, 'accuracy': 0.35300368070602417, 'precision': 0.33301958441734314, 'recall': 0.3328646421432495, 'iou': 0.17402392625808716, 'dice': 0.2777523994445801}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6858645890070044, 'accuracy': 0.4312239030133123, 'precision': 0.3333869755268097, 'recall': 0.3332028443398683, 'iou': 0.2046157231149466, 'dice': 0.3173043646242308}
Test   -> {'loss': 0.7171767950057983, 'accuracy': 0.3574754297733307, 'precision': 0.33154746890068054, 'recall': 0.3323281705379486, 'iou': 0.18105630576610565, 'dice': 0.29070043563842773}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6939593654611836, 'accuracy': 0.37238559230514195, 'precision': 0.333372365521348, 'recall': 0.3333452095156131, 'iou': 0.19123415635979693, 'dice': 0.3094318599804588}
Test   -> {'loss': 0.7182409167289734, 'accuracy': 0.32633379101753235, 'precision': 0.3329218626022339, 'recall': 0.3333969712257385, 'iou': 0.1783810555934906, 'dice': 0.2956485152244568}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6908751176751178, 'accuracy': 0.417509017560793, 'precision': 0.3313195175450781, 'recall': 0.33327025615650674, 'iou': 0.19986351132392882, 'dice': 0.31232412574083906}
Test   -> {'loss': 0.7413435578346252, 'accuracy': 0.3539328873157501, 'precision': 0.31692010164260864, 'recall': 0.3290249705314636, 'iou': 0.1693912148475647, 'dice': 0.26742175221443176}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6983567069406095, 'accuracy': 0.4438078095083651, 'precision': 0.3173898431270019, 'recall': 0.33309313032938087, 'iou': 0.19989752257647722, 'dice': 0.30454167412674943}
Test   -> {'loss': 0.768499493598938, 'accuracy': 0.3414580523967743, 'precision': 0.5614926218986511, 'recall': 0.3331858515739441, 'iou': 0.15424586832523346, 'dice': 0.23774731159210205}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7033053413681362, 'accuracy': 0.44751266383606453, 'precision': 0.3071442584628644, 'recall': 0.3336600277734839, 'iou': 0.19785970870567404, 'dice': 0.29949963338997054}
Test   -> {'loss': 0.7653204798698425, 'accuracy': 0.34148794412612915, 'precision': 0.3700895309448242, 'recall': 0.3321571946144104, 'iou': 0.15560312569141388, 'dice': 0.24082764983177185}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7033158849114957, 'accuracy': 0.44749470171721084, 'precision': 0.30708578812039417, 'recall': 0.3336594027021657, 'iou': 0.1978544220328331, 'dice': 0.29949702050374905}
Test   -> {'loss': 0.7743370532989502, 'accuracy': 0.32708117365837097, 'precision': 0.251853883266449, 'recall': 0.3340451717376709, 'iou': 0.1510065495967865, 'dice': 0.23493406176567078}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.19116996228694916
Test -> {'loss': 0.7926080822944641, 'accuracy': 0.4745657742023468, 'precision': 0.28323811292648315, 'recall': 0.3455447554588318, 'iou': 0.19116996228694916, 'dice': 0.2705394923686981} 
Train -> {'loss': 0.5555687608926193, 'accuracy': 0.6785556972026825, 'precision': 0.45219154694805974, 'recall': 0.4899056561615156, 'iou': 0.3507021963596344, 'dice': 0.4483619950387789} 

Best model saved for model efficientunet at epoch 10

Trial 27:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4376578854477924, 'accuracy': 0.7459306898324386, 'precision': 0.5745927396027938, 'recall': 0.5743981444317362, 'iou': 0.4516819033933722, 'dice': 0.5680984274200771}
Test   -> {'loss': 0.7379083037376404, 'accuracy': 0.46916663646698, 'precision': 0.32430288195610046, 'recall': 0.3301790952682495, 'iou': 0.20378896594047546, 'dice': 0.2990206480026245}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3967130339663962, 'accuracy': 0.7867757107900537, 'precision': 0.6077718164609827, 'recall': 0.6050789568735205, 'iou': 0.4914804178735484, 'dice': 0.6052791103072789}
Test   -> {'loss': 0.7664124369621277, 'accuracy': 0.5069760680198669, 'precision': 0.29073017835617065, 'recall': 0.3191470503807068, 'iou': 0.19335725903511047, 'dice': 0.26983582973480225}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3884071453757908, 'accuracy': 0.7968933608220972, 'precision': 0.6162277641503707, 'recall': 0.6137858846913213, 'iou': 0.5024632378764774, 'dice': 0.613672227444856}
Test   -> {'loss': 0.7754868268966675, 'accuracy': 0.44048011302948, 'precision': 0.302573561668396, 'recall': 0.30801302194595337, 'iou': 0.18884024024009705, 'dice': 0.2814580202102661}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3860095988149228, 'accuracy': 0.7994746083798616, 'precision': 0.6185784303623697, 'recall': 0.6159846093343652, 'iou': 0.5054207685201064, 'dice': 0.6160956009574559}
Test   -> {'loss': 0.7524709701538086, 'accuracy': 0.5374568700790405, 'precision': 0.3202073276042938, 'recall': 0.3311028480529785, 'iou': 0.20206372439861298, 'dice': 0.27559447288513184}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.38411567107490874, 'accuracy': 0.8014759151831917, 'precision': 0.6204299978587938, 'recall': 0.6182399542435356, 'iou': 0.507942823741747, 'dice': 0.6180774999701458}
Test   -> {'loss': 0.7642961144447327, 'accuracy': 0.5464458465576172, 'precision': 0.2858191430568695, 'recall': 0.3257288336753845, 'iou': 0.19176416099071503, 'dice': 0.2537611424922943}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3819417165673297, 'accuracy': 0.8037094235420227, 'precision': 0.6224702648494554, 'recall': 0.6204655585081681, 'iou': 0.5105787360149882, 'dice': 0.6201983151228532}
Test   -> {'loss': 0.7542321681976318, 'accuracy': 0.5458797216415405, 'precision': 0.30019837617874146, 'recall': 0.3166763484477997, 'iou': 0.2064957618713379, 'dice': 0.28050586581230164}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3803266587464706, 'accuracy': 0.8054999506991842, 'precision': 0.6247430853221727, 'recall': 0.621832333440366, 'iou': 0.512317783417909, 'dice': 0.6218307883843132}
Test   -> {'loss': 0.7575446963310242, 'accuracy': 0.41683024168014526, 'precision': 0.3137268126010895, 'recall': 0.3094695210456848, 'iou': 0.18729686737060547, 'dice': 0.28494784235954285}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.37757361764493197, 'accuracy': 0.8080193224160568, 'precision': 0.6293395711028058, 'recall': 0.6248909297196762, 'iou': 0.5149882632753123, 'dice': 0.6245805844016697}
Test   -> {'loss': 0.7951861619949341, 'accuracy': 0.29077085852622986, 'precision': 0.2976137101650238, 'recall': 0.3038303852081299, 'iou': 0.1499515175819397, 'dice': 0.2534879446029663}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.3921696802844172, 'accuracy': 0.7924028588377912, 'precision': 0.6134237253147623, 'recall': 0.609256881216298, 'iou': 0.4970412720804629, 'dice': 0.6100050060645393}
Test   -> {'loss': 0.762394905090332, 'accuracy': 0.41675490140914917, 'precision': 0.3021429479122162, 'recall': 0.30619126558303833, 'iou': 0.1845889538526535, 'dice': 0.280864953994751}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.40116556157236516, 'accuracy': 0.780685658040254, 'precision': 0.6035844393398451, 'recall': 0.6011409795802573, 'iou': 0.4855517511782439, 'dice': 0.6010220398073611}
Test   -> {'loss': 0.7653408050537109, 'accuracy': 0.37128183245658875, 'precision': 0.31465959548950195, 'recall': 0.3168129026889801, 'iou': 0.17993763089179993, 'dice': 0.28501948714256287}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.2064957618713379
Test -> {'loss': 0.7542321681976318, 'accuracy': 0.5458797216415405, 'precision': 0.30019837617874146, 'recall': 0.3166763484477997, 'iou': 0.2064957618713379, 'dice': 0.28050586581230164} 
Train -> {'loss': 0.3819417165673297, 'accuracy': 0.8037094235420227, 'precision': 0.6224702648494554, 'recall': 0.6204655585081681, 'iou': 0.5105787360149882, 'dice': 0.6201983151228532} 

Best model saved for model efficientunet at epoch 10

Trial 28:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7336565652619238, 'accuracy': 0.39128201143897096, 'precision': 0.3254090817726177, 'recall': 0.325031978086285, 'iou': 0.18112060414708178, 'dice': 0.2796670365592708}
Test   -> {'loss': 0.8918085098266602, 'accuracy': 0.1402587890625, 'precision': 0.3679113984107971, 'recall': 0.3319500684738159, 'iou': 0.059964220970869064, 'dice': 0.10975822061300278}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7690886800703796, 'accuracy': 0.23500549832116002, 'precision': 0.35260194112425264, 'recall': 0.34767736714819203, 'iou': 0.13317283492373383, 'dice': 0.23387674145076587}
Test   -> {'loss': 0.7439821362495422, 'accuracy': 0.27803754806518555, 'precision': 0.35219496488571167, 'recall': 0.3439065217971802, 'iou': 0.15937970578670502, 'dice': 0.2705419957637787}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.770623693258866, 'accuracy': 0.2330874080243318, 'precision': 0.3544834033302639, 'recall': 0.34845297712346784, 'iou': 0.13214783765699553, 'dice': 0.23227493432552918}
Test   -> {'loss': 0.7426790595054626, 'accuracy': 0.27304762601852417, 'precision': 0.35121414065361023, 'recall': 0.3422982394695282, 'iou': 0.1569952666759491, 'dice': 0.26754724979400635}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7704319728457409, 'accuracy': 0.23333379567965218, 'precision': 0.3548880627621775, 'recall': 0.3486216647469479, 'iou': 0.13228127169220344, 'dice': 0.2324926049165104}
Test   -> {'loss': 0.7556047439575195, 'accuracy': 0.25590795278549194, 'precision': 0.3525710105895996, 'recall': 0.3411876857280731, 'iou': 0.14718440175056458, 'dice': 0.25392040610313416}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.770487763311552, 'accuracy': 0.23329403977031293, 'precision': 0.35442863210387854, 'recall': 0.34852026299290034, 'iou': 0.13226403376978377, 'dice': 0.23245045153991037}
Test   -> {'loss': 0.7377179861068726, 'accuracy': 0.27138224244117737, 'precision': 0.3540266454219818, 'recall': 0.34329700469970703, 'iou': 0.15705931186676025, 'dice': 0.268816202878952}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7702396664930427, 'accuracy': 0.2335002974971481, 'precision': 0.35498807274776956, 'recall': 0.34908459186553953, 'iou': 0.1324063433577185, 'dice': 0.23269597777853843}
Test   -> {'loss': 0.7367608547210693, 'accuracy': 0.2690853178501129, 'precision': 0.3536037802696228, 'recall': 0.3433518409729004, 'iou': 0.15650707483291626, 'dice': 0.26885297894477844}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7703750086867291, 'accuracy': 0.23335770679556805, 'precision': 0.3547354208386463, 'recall': 0.3489505412785903, 'iou': 0.13230446466933127, 'dice': 0.23253047025722007}
Test   -> {'loss': 0.7577443718910217, 'accuracy': 0.2584552466869354, 'precision': 0.3494027554988861, 'recall': 0.34187623858451843, 'iou': 0.14895693957805634, 'dice': 0.25704753398895264}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7565084462580474, 'accuracy': 0.29771906662246456, 'precision': 0.34627484666264574, 'recall': 0.3383521695499835, 'iou': 0.15031128441509994, 'dice': 0.24597053281638934}
Test   -> {'loss': 0.7030541896820068, 'accuracy': 0.4403325319290161, 'precision': 0.34048646688461304, 'recall': 0.33306604623794556, 'iou': 0.20166927576065063, 'dice': 0.308689683675766}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7505712827910548, 'accuracy': 0.37350436539753623, 'precision': 0.32745786814585975, 'recall': 0.3334585829921391, 'iou': 0.16457742776559747, 'dice': 0.2512217100547708}
Test   -> {'loss': 0.7117421627044678, 'accuracy': 0.4390433132648468, 'precision': 0.3020327389240265, 'recall': 0.33240994811058044, 'iou': 0.19433510303497314, 'dice': 0.2952260971069336}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7505421985750613, 'accuracy': 0.3734646737575531, 'precision': 0.32773946795774545, 'recall': 0.33340515312941177, 'iou': 0.16457453383051832, 'dice': 0.251223853489627}
Test   -> {'loss': 0.7175219058990479, 'accuracy': 0.44535234570503235, 'precision': 0.3252379894256592, 'recall': 0.33262333273887634, 'iou': 0.19739359617233276, 'dice': 0.2997662425041199}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 8 with IoU 0.20166927576065063
Test -> {'loss': 0.7030541896820068, 'accuracy': 0.4403325319290161, 'precision': 0.34048646688461304, 'recall': 0.33306604623794556, 'iou': 0.20166927576065063, 'dice': 0.308689683675766} 
Train -> {'loss': 0.7565084462580474, 'accuracy': 0.29771906662246456, 'precision': 0.34627484666264574, 'recall': 0.3383521695499835, 'iou': 0.15031128441509994, 'dice': 0.24597053281638934} 

Best model saved for model efficientunet at epoch 10

Trial 29:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6887306550274724, 'accuracy': 0.5717369701551355, 'precision': 0.3640855900619341, 'recall': 0.3605393287928208, 'iou': 0.24590931755045187, 'dice': 0.3389052468797435}
Test   -> {'loss': 0.9283562898635864, 'accuracy': 0.12199743837118149, 'precision': 0.3739970326423645, 'recall': 0.3333377242088318, 'iou': 0.04066794365644455, 'dice': 0.07249341905117035}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.702560890239218, 'accuracy': 0.5934134161990622, 'precision': 0.3628354995147042, 'recall': 0.3516469958035842, 'iou': 0.24324938499409218, 'dice': 0.3297120254972707}
Test   -> {'loss': 0.9171960353851318, 'accuracy': 0.13880982995033264, 'precision': 0.38675522804260254, 'recall': 0.3345935046672821, 'iou': 0.04736722633242607, 'dice': 0.08383379876613617}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.701795942887016, 'accuracy': 0.5940871617068415, 'precision': 0.3628702363242274, 'recall': 0.35217804027640304, 'iou': 0.24373701746049134, 'dice': 0.330241111309632}
Test   -> {'loss': 0.9299510717391968, 'accuracy': 0.11824627220630646, 'precision': 0.3726385235786438, 'recall': 0.33356451988220215, 'iou': 0.03953632339835167, 'dice': 0.0707806795835495}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7015560253806736, 'accuracy': 0.5943446693213089, 'precision': 0.36332210120947467, 'recall': 0.3527257968550143, 'iou': 0.24414331912994386, 'dice': 0.3309294358543728}
Test   -> {'loss': 0.9296836853027344, 'accuracy': 0.11887655407190323, 'precision': 0.3728388547897339, 'recall': 0.33355972170829773, 'iou': 0.039731889963150024, 'dice': 0.07109156996011734}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7037699777147044, 'accuracy': 0.5933449822923411, 'precision': 0.3623431514138761, 'recall': 0.35127244876778646, 'iou': 0.24287476034268088, 'dice': 0.32915988849556965}
Test   -> {'loss': 0.9253403544425964, 'accuracy': 0.1252080202102661, 'precision': 0.37539491057395935, 'recall': 0.3338187634944916, 'iou': 0.042034950107336044, 'dice': 0.07489719986915588}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6986182922902314, 'accuracy': 0.5435871124267578, 'precision': 0.3545948248842488, 'recall': 0.34544083501981654, 'iou': 0.23154347344585088, 'dice': 0.3257163350996764}
Test   -> {'loss': 0.7100455164909363, 'accuracy': 0.36626511812210083, 'precision': 0.333473801612854, 'recall': 0.3367229402065277, 'iou': 0.1882147490978241, 'dice': 0.3015475273132324}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6866978774900022, 'accuracy': 0.39214274105818375, 'precision': 0.33148933960043864, 'recall': 0.3324922131455463, 'iou': 0.19917827611384184, 'dice': 0.31698286896166594}
Test   -> {'loss': 0.6928042769432068, 'accuracy': 0.3854413628578186, 'precision': 0.3316062092781067, 'recall': 0.3311308026313782, 'iou': 0.20312367379665375, 'dice': 0.32537803053855896}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7124304906181668, 'accuracy': 0.3810106715430384, 'precision': 0.3358006855715876, 'recall': 0.33689287745434304, 'iou': 0.18492870460385863, 'dice': 0.2901999229970186}
Test   -> {'loss': 0.6953688859939575, 'accuracy': 0.43785998225212097, 'precision': 0.33644670248031616, 'recall': 0.33556145429611206, 'iou': 0.20641565322875977, 'dice': 0.31783348321914673}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7274842225986978, 'accuracy': 0.34583900337633877, 'precision': 0.33694000399631, 'recall': 0.34205764272938605, 'iou': 0.17129311587499535, 'dice': 0.27490839828615604}
Test   -> {'loss': 0.6942063570022583, 'accuracy': 0.3635244369506836, 'precision': 0.33884215354919434, 'recall': 0.3386077284812927, 'iou': 0.19709347188472748, 'dice': 0.3210080564022064}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7163551734841388, 'accuracy': 0.33942125750624613, 'precision': 0.3348805549352065, 'recall': 0.337234742226808, 'iou': 0.17553989731747172, 'dice': 0.2864479904589446}
Test   -> {'loss': 0.6881532669067383, 'accuracy': 0.42440265417099, 'precision': 0.33152541518211365, 'recall': 0.3310951888561249, 'iou': 0.2074449062347412, 'dice': 0.3232843279838562}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.2074449062347412
Test -> {'loss': 0.6881532669067383, 'accuracy': 0.42440265417099, 'precision': 0.33152541518211365, 'recall': 0.3310951888561249, 'iou': 0.2074449062347412, 'dice': 0.3232843279838562} 
Train -> {'loss': 0.7163551734841388, 'accuracy': 0.33942125750624613, 'precision': 0.3348805549352065, 'recall': 0.337234742226808, 'iou': 0.17553989731747172, 'dice': 0.2864479904589446} 

Best model saved for model efficientunet at epoch 10

Trial 30:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6444930789263352, 'accuracy': 0.5510591618392778, 'precision': 0.3965261599291926, 'recall': 0.39671239062495856, 'iou': 0.25994819655366563, 'dice': 0.3660417928643849}
Test   -> {'loss': 0.9273646473884583, 'accuracy': 0.12244648486375809, 'precision': 0.3614349365234375, 'recall': 0.3340667188167572, 'iou': 0.04131186008453369, 'dice': 0.07392270863056183}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6415605231471684, 'accuracy': 0.551882125761198, 'precision': 0.39841950483944105, 'recall': 0.3993154467447944, 'iou': 0.2614135540050009, 'dice': 0.3682688700116199}
Test   -> {'loss': 0.9236727952957153, 'accuracy': 0.12871068716049194, 'precision': 0.37419018149375916, 'recall': 0.33418697118759155, 'iou': 0.04334651678800583, 'dice': 0.0770878791809082}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6407698263292727, 'accuracy': 0.5520004534203073, 'precision': 0.398794844487439, 'recall': 0.3998886004738186, 'iou': 0.2616824659316436, 'dice': 0.36864000519980555}
Test   -> {'loss': 0.9384253025054932, 'accuracy': 0.10119006037712097, 'precision': 0.35312944650650024, 'recall': 0.33391329646110535, 'iou': 0.034088149666786194, 'dice': 0.062123462557792664}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7002916211667268, 'accuracy': 0.41504402031069215, 'precision': 0.34003329140984495, 'recall': 0.3382461074253787, 'iou': 0.20013580471277237, 'dice': 0.306107429900895}
Test   -> {'loss': 0.7595114707946777, 'accuracy': 0.41771090030670166, 'precision': 0.5386316776275635, 'recall': 0.3326706290245056, 'iou': 0.17371748387813568, 'dice': 0.25359126925468445}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6721850664719291, 'accuracy': 0.38274812594704005, 'precision': 0.3771457092917484, 'recall': 0.3776841751907183, 'iou': 0.2062787831477497, 'dice': 0.3310550075510274}
Test   -> {'loss': 0.7275712490081787, 'accuracy': 0.31901830434799194, 'precision': 0.32696545124053955, 'recall': 0.32502585649490356, 'iou': 0.1715441644191742, 'dice': 0.2847890853881836}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.674745593122814, 'accuracy': 0.400249694093414, 'precision': 0.353903064650038, 'recall': 0.3550712642462357, 'iou': 0.20641642595114915, 'dice': 0.3285469380409821}
Test   -> {'loss': 0.7169475555419922, 'accuracy': 0.34522977471351624, 'precision': 0.3324119746685028, 'recall': 0.3286679983139038, 'iou': 0.17999768257141113, 'dice': 0.29273521900177}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6850194334983826, 'accuracy': 0.4098733675220738, 'precision': 0.37857462258442587, 'recall': 0.3782386048980381, 'iou': 0.202390945929548, 'dice': 0.3179238769023315}
Test   -> {'loss': 0.7352853417396545, 'accuracy': 0.4673561453819275, 'precision': 0.3253136873245239, 'recall': 0.3229578733444214, 'iou': 0.20357052981853485, 'dice': 0.3028219938278198}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.715308629170708, 'accuracy': 0.3933100897332896, 'precision': 0.39292117525701936, 'recall': 0.3867523961740991, 'iou': 0.18178439088489698, 'dice': 0.2879405848357988}
Test   -> {'loss': 0.7194273471832275, 'accuracy': 0.5093557834625244, 'precision': 0.33508992195129395, 'recall': 0.3371120095252991, 'iou': 0.22352489829063416, 'dice': 0.32436561584472656}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7162933663181636, 'accuracy': 0.3890774673741797, 'precision': 0.3943169964396435, 'recall': 0.3853687098492747, 'iou': 0.18076726431431978, 'dice': 0.28690881897573883}
Test   -> {'loss': 0.743543803691864, 'accuracy': 0.35506516695022583, 'precision': 0.33168232440948486, 'recall': 0.33512914180755615, 'iou': 0.1792357861995697, 'dice': 0.2943882346153259}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7237755757311116, 'accuracy': 0.29945079230743904, 'precision': 0.436089293723521, 'recall': 0.3693772943123527, 'iou': 0.1676800486834153, 'dice': 0.27864664987377497}
Test   -> {'loss': 0.7251453399658203, 'accuracy': 0.3774600923061371, 'precision': 0.3502783477306366, 'recall': 0.3352144658565521, 'iou': 0.18346671760082245, 'dice': 0.29598158597946167}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 8 with IoU 0.22352489829063416
Test -> {'loss': 0.7194273471832275, 'accuracy': 0.5093557834625244, 'precision': 0.33508992195129395, 'recall': 0.3371120095252991, 'iou': 0.22352489829063416, 'dice': 0.32436561584472656} 
Train -> {'loss': 0.715308629170708, 'accuracy': 0.3933100897332896, 'precision': 0.39292117525701936, 'recall': 0.3867523961740991, 'iou': 0.18178439088489698, 'dice': 0.2879405848357988} 

Best model saved for model efficientunet at epoch 10

Trial 31:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7391805078672327, 'accuracy': 0.43180261591206426, 'precision': 0.28785896327184596, 'recall': 0.2980766716210739, 'iou': 0.1808236387760743, 'dice': 0.26979624629020693}
Test   -> {'loss': 0.8464285135269165, 'accuracy': 0.18564029037952423, 'precision': 0.38291996717453003, 'recall': 0.3548310399055481, 'iou': 0.0861547440290451, 'dice': 0.15501098334789276}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7700723741365516, 'accuracy': 0.42988288946773695, 'precision': 0.24722701881242834, 'recall': 0.25207128032394077, 'iou': 0.16219777179800945, 'dice': 0.2406462506107662}
Test   -> {'loss': 0.8549808859825134, 'accuracy': 0.1776188462972641, 'precision': 0.37476035952568054, 'recall': 0.3523504436016083, 'iou': 0.08057017624378204, 'dice': 0.14574909210205078}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7707565711892169, 'accuracy': 0.42926670105560966, 'precision': 0.247436581487241, 'recall': 0.25135861583378005, 'iou': 0.1617192154345305, 'dice': 0.23995789444964866}
Test   -> {'loss': 0.851046621799469, 'accuracy': 0.18405680358409882, 'precision': 0.37899529933929443, 'recall': 0.35598230361938477, 'iou': 0.08361026644706726, 'dice': 0.150914266705513}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7577571977739749, 'accuracy': 0.40865731213403783, 'precision': 0.2706558256045632, 'recall': 0.26053628869678663, 'iou': 0.16341657729252526, 'dice': 0.2504416273987812}
Test   -> {'loss': 0.7464701533317566, 'accuracy': 0.3267252445220947, 'precision': 0.3922833800315857, 'recall': 0.3472443222999573, 'iou': 0.1616009771823883, 'dice': 0.25673872232437134}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7595109276149584, 'accuracy': 0.3865010256352632, 'precision': 0.2914501252381698, 'recall': 0.2872911370318869, 'iou': 0.16282789927461874, 'dice': 0.2565872667924218}
Test   -> {'loss': 0.7568840980529785, 'accuracy': 0.5844109654426575, 'precision': 0.23997041583061218, 'recall': 0.3243170380592346, 'iou': 0.1961691826581955, 'dice': 0.24834351241588593}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7963115692138671, 'accuracy': 0.3271356707033904, 'precision': 0.2641910003579181, 'recall': 0.26828825240549836, 'iou': 0.13892944053463313, 'dice': 0.2294295627137889}
Test   -> {'loss': 0.7632699012756348, 'accuracy': 0.5585171580314636, 'precision': 0.25686243176460266, 'recall': 0.3264022171497345, 'iou': 0.18890701234340668, 'dice': 0.24378636479377747}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7450142368026401, 'accuracy': 0.28390830509040665, 'precision': 0.32763815211213154, 'recall': 0.3268277795418449, 'iou': 0.153241844540057, 'dice': 0.2606315016746521}
Test   -> {'loss': 0.7300201654434204, 'accuracy': 0.29211050271987915, 'precision': 0.3358326852321625, 'recall': 0.3356127142906189, 'iou': 0.16551809012889862, 'dice': 0.2805368900299072}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7892222746558811, 'accuracy': 0.21631109157334202, 'precision': 0.29684402890827344, 'recall': 0.2624715968318608, 'iou': 0.12685782067153764, 'dice': 0.21832407065059828}
Test   -> {'loss': 0.8473753929138184, 'accuracy': 0.310975044965744, 'precision': 0.436967670917511, 'recall': 0.33354151248931885, 'iou': 0.10384249687194824, 'dice': 0.1585274636745453}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7188723242801168, 'accuracy': 0.3456539270670518, 'precision': 0.3202924730985061, 'recall': 0.3083194608273713, 'iou': 0.17708209480928339, 'dice': 0.2862472865892493}
Test   -> {'loss': 0.7310925722122192, 'accuracy': 0.3511850833892822, 'precision': 0.33007049560546875, 'recall': 0.33382225036621094, 'iou': 0.17524951696395874, 'dice': 0.2788068652153015}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6896276090456092, 'accuracy': 0.4212025740872259, 'precision': 0.3316946542781332, 'recall': 0.33351406169974285, 'iou': 0.20111317777115365, 'dice': 0.31383159160614016}
Test   -> {'loss': 0.721903383731842, 'accuracy': 0.36388131976127625, 'precision': 0.3317762017250061, 'recall': 0.3326687216758728, 'iou': 0.18371330201625824, 'dice': 0.29243242740631104}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 5 with IoU 0.1961691826581955
Test -> {'loss': 0.7568840980529785, 'accuracy': 0.5844109654426575, 'precision': 0.23997041583061218, 'recall': 0.3243170380592346, 'iou': 0.1961691826581955, 'dice': 0.24834351241588593} 
Train -> {'loss': 0.7595109276149584, 'accuracy': 0.3865010256352632, 'precision': 0.2914501252381698, 'recall': 0.2872911370318869, 'iou': 0.16282789927461874, 'dice': 0.2565872667924218} 

Best model saved for model efficientunet at epoch 10

Trial 32:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4724299569492755, 'accuracy': 0.8167496440203293, 'precision': 0.6639680989410566, 'recall': 0.6101519587247268, 'iou': 0.5065654772131339, 'dice': 0.5782168004823768}
Test   -> {'loss': 17.240089416503906, 'accuracy': 0.6397044658660889, 'precision': 0.39388319849967957, 'recall': 0.35347360372543335, 'iou': 0.24658203125, 'dice': 0.322837233543396}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.38153784132522084, 'accuracy': 0.844073588433473, 'precision': 0.7053635167038959, 'recall': 0.6365924389465996, 'iou': 0.5417575132587682, 'dice': 0.6091145450654237}
Test   -> {'loss': 11.847509384155273, 'accuracy': 0.5896382331848145, 'precision': 0.32844942808151245, 'recall': 0.32899460196495056, 'iou': 0.21762989461421967, 'dice': 0.28860044479370117}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3406603252110274, 'accuracy': 0.8566561939923659, 'precision': 0.7236113431661025, 'recall': 0.6681997439135676, 'iou': 0.5814225373060807, 'dice': 0.6610637872115426}
Test   -> {'loss': 14.718647003173828, 'accuracy': 0.5997326970100403, 'precision': 0.4328584671020508, 'recall': 0.40677976608276367, 'iou': 0.28097113966941833, 'dice': 0.38809680938720703}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.31171821945387385, 'accuracy': 0.8672316947708959, 'precision': 0.7460649586242178, 'recall': 0.6980953716713449, 'iou': 0.6146933179834615, 'dice': 0.7016231806381888}
Test   -> {'loss': 20.954397201538086, 'accuracy': 0.61578369140625, 'precision': 0.3537638783454895, 'recall': 0.3436223268508911, 'iou': 0.23934033513069153, 'dice': 0.3178224563598633}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2869929761990257, 'accuracy': 0.8773218717264093, 'precision': 0.7677525810573412, 'recall': 0.731809870056484, 'iou': 0.6483053860457048, 'dice': 0.7401472135730411}
Test   -> {'loss': 8.722752571105957, 'accuracy': 0.5314019322395325, 'precision': 0.32106417417526245, 'recall': 0.33269578218460083, 'iou': 0.2019379585981369, 'dice': 0.27991926670074463}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2682919953180396, 'accuracy': 0.8851239155168119, 'precision': 0.7838478539301001, 'recall': 0.7521462137284486, 'iou': 0.6686258862847867, 'dice': 0.7610624458478845}
Test   -> {'loss': 7.876192569732666, 'accuracy': 0.6118724346160889, 'precision': 0.4367174804210663, 'recall': 0.3365400433540344, 'iou': 0.20871542394161224, 'dice': 0.2612234950065613}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2486933162678843, 'accuracy': 0.8925762220569279, 'precision': 0.7987194040547246, 'recall': 0.7753137471883194, 'iou': 0.6906008121759996, 'dice': 0.7833991462769716}
Test   -> {'loss': 6.341788291931152, 'accuracy': 0.5376088619232178, 'precision': 0.4855111837387085, 'recall': 0.3619266450405121, 'iou': 0.2138056755065918, 'dice': 0.297760546207428}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.23541261067856914, 'accuracy': 0.8990271889645121, 'precision': 0.8109839729640795, 'recall': 0.7915651601293813, 'iou': 0.7070521067018094, 'dice': 0.7988622393297112}
Test   -> {'loss': 7.800008773803711, 'accuracy': 0.5572484731674194, 'precision': 0.305815726518631, 'recall': 0.33116793632507324, 'iou': 0.2106597125530243, 'dice': 0.2834687829017639}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.22223845875781514, 'accuracy': 0.9038003556106402, 'precision': 0.8195512121138365, 'recall': 0.8017989702846693, 'iou': 0.7179887429527615, 'dice': 0.8087161393269249}
Test   -> {'loss': 11.26267147064209, 'accuracy': 0.5014162659645081, 'precision': 0.3573858141899109, 'recall': 0.3544768691062927, 'iou': 0.23887191712856293, 'dice': 0.35382527112960815}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.21079609212668046, 'accuracy': 0.9091109612713689, 'precision': 0.829851872506349, 'recall': 0.8167843590611997, 'iou': 0.7325584318326868, 'dice': 0.8219572507816812}
Test   -> {'loss': 9.265989303588867, 'accuracy': 0.5221295952796936, 'precision': 0.3861684203147888, 'recall': 0.3868134021759033, 'iou': 0.26224929094314575, 'dice': 0.38446110486984253}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 3 with IoU 0.28097113966941833
Test -> {'loss': 14.718647003173828, 'accuracy': 0.5997326970100403, 'precision': 0.4328584671020508, 'recall': 0.40677976608276367, 'iou': 0.28097113966941833, 'dice': 0.38809680938720703} 
Train -> {'loss': 0.3406603252110274, 'accuracy': 0.8566561939923659, 'precision': 0.7236113431661025, 'recall': 0.6681997439135676, 'iou': 0.5814225373060807, 'dice': 0.6610637872115426} 

Best model saved for model efficientunet at epoch 10

Trial 33:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5070583232071089, 'accuracy': 0.7986190298329229, 'precision': 0.6383884124133898, 'recall': 0.5968595302623251, 'iou': 0.49342604357263314, 'dice': 0.5684485767198646}
Test   -> {'loss': 15.456209182739258, 'accuracy': 0.5268766283988953, 'precision': 0.31246480345726013, 'recall': 0.32698261737823486, 'iou': 0.1926400363445282, 'dice': 0.2639947533607483}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3587279210919919, 'accuracy': 0.851764180349267, 'precision': 0.7237884604412577, 'recall': 0.6545498568078746, 'iou': 0.5640673844710641, 'dice': 0.6379970001137775}
Test   -> {'loss': 28.441078186035156, 'accuracy': 0.5901778936386108, 'precision': 0.3646964728832245, 'recall': 0.3441959321498871, 'iou': 0.22562497854232788, 'dice': 0.3033275306224823}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.30159587367721225, 'accuracy': 0.8696617147196894, 'precision': 0.7568705771280372, 'recall': 0.6947014300719552, 'iou': 0.6109812425530475, 'dice': 0.6926882909691852}
Test   -> {'loss': 26.890066146850586, 'accuracy': 0.5612020492553711, 'precision': 0.30857765674591064, 'recall': 0.32814502716064453, 'iou': 0.20635603368282318, 'dice': 0.27749869227409363}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2606514496647793, 'accuracy': 0.8879532072855079, 'precision': 0.7909980162330296, 'recall': 0.7588276930477308, 'iou': 0.6757189890612727, 'dice': 0.7688226741293203}
Test   -> {'loss': 21.135211944580078, 'accuracy': 0.5001329779624939, 'precision': 0.35086679458618164, 'recall': 0.3406180143356323, 'iou': 0.215066060423851, 'dice': 0.3141736686229706}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.23530837906443555, 'accuracy': 0.8989596983660822, 'precision': 0.8124642880066582, 'recall': 0.7884507303652556, 'iou': 0.7050121825674306, 'dice': 0.7973828517872354}
Test   -> {'loss': 11.830350875854492, 'accuracy': 0.5534197688102722, 'precision': 0.36600261926651, 'recall': 0.3399955928325653, 'iou': 0.20794668793678284, 'dice': 0.2772221565246582}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.22093373446360878, 'accuracy': 0.9046860181767008, 'precision': 0.8230778839277184, 'recall': 0.7996933843778528, 'iou': 0.7174376218215279, 'dice': 0.808069952674534}
Test   -> {'loss': 8.629903793334961, 'accuracy': 0.5348323583602905, 'precision': 0.3938223719596863, 'recall': 0.3433544635772705, 'iou': 0.21507136523723602, 'dice': 0.2969003915786743}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.20297958021578583, 'accuracy': 0.9122445718101834, 'precision': 0.837670209615127, 'recall': 0.8186906016391257, 'iou': 0.7371980117714924, 'dice': 0.8257414812627046}
Test   -> {'loss': 8.440872192382812, 'accuracy': 0.47180548310279846, 'precision': 0.3790134787559509, 'recall': 0.3583797812461853, 'iou': 0.22918806970119476, 'dice': 0.3413275182247162}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.19201814933963443, 'accuracy': 0.9173085155694382, 'precision': 0.8474887257036956, 'recall': 0.8299914836883545, 'iou': 0.7495302941488183, 'dice': 0.8362941130347874}
Test   -> {'loss': 30.407188415527344, 'accuracy': 0.5188215374946594, 'precision': 0.3654012680053711, 'recall': 0.3557121753692627, 'iou': 0.24044370651245117, 'dice': 0.34903186559677124}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.17678398153056268, 'accuracy': 0.9235463816186656, 'precision': 0.8583040351453035, 'recall': 0.8451217651367188, 'iou': 0.7662504082140715, 'dice': 0.8502664690432341}
Test   -> {'loss': 46.167762756347656, 'accuracy': 0.4295750856399536, 'precision': 0.3361981511116028, 'recall': 0.33683115243911743, 'iou': 0.21568040549755096, 'dice': 0.3331707715988159}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.1719986897447835, 'accuracy': 0.9259460760199505, 'precision': 0.8621438710585885, 'recall': 0.8518090735311094, 'iou': 0.7733646947404612, 'dice': 0.8561320449994958}
Test   -> {'loss': 40.95714569091797, 'accuracy': 0.5416676998138428, 'precision': 0.3616839647293091, 'recall': 0.33938801288604736, 'iou': 0.2197631597518921, 'dice': 0.30668964982032776}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 8 with IoU 0.24044370651245117
Test -> {'loss': 30.407188415527344, 'accuracy': 0.5188215374946594, 'precision': 0.3654012680053711, 'recall': 0.3557121753692627, 'iou': 0.24044370651245117, 'dice': 0.34903186559677124} 
Train -> {'loss': 0.19201814933963443, 'accuracy': 0.9173085155694382, 'precision': 0.8474887257036956, 'recall': 0.8299914836883545, 'iou': 0.7495302941488183, 'dice': 0.8362941130347874} 

Best model saved for model efficientunet at epoch 10

Trial 34:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4694481035937434, 'accuracy': 0.8177880595559659, 'precision': 0.6618980613739595, 'recall': 0.6089627418829047, 'iou': 0.5055629892193753, 'dice': 0.575382181354191}
Test   -> {'loss': 25.1364688873291, 'accuracy': 0.6175325512886047, 'precision': 0.371826708316803, 'recall': 0.3344190716743469, 'iou': 0.21061182022094727, 'dice': 0.2640117406845093}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3843036159225132, 'accuracy': 0.8438155946524247, 'precision': 0.7063343708929808, 'recall': 0.6354706168174744, 'iou': 0.5406008234490519, 'dice': 0.607316945169283}
Test   -> {'loss': 19.881576538085938, 'accuracy': 0.6141518950462341, 'precision': 0.4224407374858856, 'recall': 0.3365389108657837, 'iou': 0.20946478843688965, 'dice': 0.26321840286254883}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.33780979488206947, 'accuracy': 0.8570807687614275, 'precision': 0.7244276230749876, 'recall': 0.6679691755253335, 'iou': 0.5812746825425521, 'dice': 0.6602482399214868}
Test   -> {'loss': 28.872493743896484, 'accuracy': 0.5748950839042664, 'precision': 0.33452582359313965, 'recall': 0.3352174162864685, 'iou': 0.21056120097637177, 'dice': 0.2799035310745239}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3089539991772693, 'accuracy': 0.8688482603301173, 'precision': 0.7500000228052554, 'recall': 0.7066711832647739, 'iou': 0.6230808053327643, 'dice': 0.7123181490794472}
Test   -> {'loss': 17.298158645629883, 'accuracy': 0.5781362056732178, 'precision': 0.45722031593322754, 'recall': 0.35631173849105835, 'iou': 0.21920762956142426, 'dice': 0.2965630888938904}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.28636034791884213, 'accuracy': 0.8773026637409045, 'precision': 0.7685168667979863, 'recall': 0.7310786335364632, 'iou': 0.6476452760074449, 'dice': 0.7393927924011064}
Test   -> {'loss': 6.538403511047363, 'accuracy': 0.5760510563850403, 'precision': 0.47095081210136414, 'recall': 0.3536735475063324, 'iou': 0.21514026820659637, 'dice': 0.28834614157676697}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2630532948867134, 'accuracy': 0.886808731244958, 'precision': 0.7874219580836918, 'recall': 0.761006554313328, 'iou': 0.6763706215049909, 'dice': 0.7694475386453712}
Test   -> {'loss': 8.486278533935547, 'accuracy': 0.5809388160705566, 'precision': 0.5011717677116394, 'recall': 0.33771809935569763, 'iou': 0.19984197616577148, 'dice': 0.256338506937027}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.24099327811728352, 'accuracy': 0.8961442172527313, 'precision': 0.805249478765156, 'recall': 0.7842045405636663, 'iou': 0.6996449457562488, 'dice': 0.7919756461744724}
Test   -> {'loss': 10.29858684539795, 'accuracy': 0.5283053517341614, 'precision': 0.28758156299591064, 'recall': 0.32433080673217773, 'iou': 0.1887650489807129, 'dice': 0.25517863035202026}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2319909787696341, 'accuracy': 0.9003508352715036, 'precision': 0.8136013785134191, 'recall': 0.7963389847589576, 'iou': 0.7111291978670203, 'dice': 0.8028148661489072}
Test   -> {'loss': 4.547069549560547, 'accuracy': 0.6128066778182983, 'precision': 0.5624553561210632, 'recall': 0.35619938373565674, 'iou': 0.2323216199874878, 'dice': 0.30480170249938965}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.21599079325147297, 'accuracy': 0.9067671047604602, 'precision': 0.8255830611871636, 'recall': 0.811187774202098, 'iou': 0.7267374157905578, 'dice': 0.8167463079742764}
Test   -> {'loss': 3.5280094146728516, 'accuracy': 0.6136412024497986, 'precision': 0.5592477917671204, 'recall': 0.38231056928634644, 'iou': 0.25614964962005615, 'dice': 0.34424445033073425}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2090292648776718, 'accuracy': 0.9100422903247501, 'precision': 0.8316398436608522, 'recall': 0.8188105020834052, 'iou': 0.7349189032679019, 'dice': 0.8238813636095628}
Test   -> {'loss': 9.194808959960938, 'accuracy': 0.5692288279533386, 'precision': 0.3930245041847229, 'recall': 0.35484132170677185, 'iou': 0.2370598316192627, 'dice': 0.32844552397727966}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 9 with IoU 0.25614964962005615
Test -> {'loss': 3.5280094146728516, 'accuracy': 0.6136412024497986, 'precision': 0.5592477917671204, 'recall': 0.38231056928634644, 'iou': 0.25614964962005615, 'dice': 0.34424445033073425} 
Train -> {'loss': 0.21599079325147297, 'accuracy': 0.9067671047604602, 'precision': 0.8255830611871636, 'recall': 0.811187774202098, 'iou': 0.7267374157905578, 'dice': 0.8167463079742764} 

Best model saved for model efficientunet at epoch 10

Trial 35:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4909234661123027, 'accuracy': 0.8012868290362151, 'precision': 0.6528442704159281, 'recall': 0.6038010084110758, 'iou': 0.500542432328929, 'dice': 0.5752952700075896}
Test   -> {'loss': 65.64947509765625, 'accuracy': 0.5627634525299072, 'precision': 0.33152568340301514, 'recall': 0.3297260105609894, 'iou': 0.20564888417720795, 'dice': 0.27605903148651123}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3415118336677551, 'accuracy': 0.8564148405323858, 'precision': 0.7280501054680866, 'recall': 0.6663244496221128, 'iou': 0.5789485692977905, 'dice': 0.6574828256731448}
Test   -> {'loss': 17.878122329711914, 'accuracy': 0.5393240451812744, 'precision': 0.3280196189880371, 'recall': 0.3332107663154602, 'iou': 0.20281575620174408, 'dice': 0.27776169776916504}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.28679186053898026, 'accuracy': 0.877047410218612, 'precision': 0.7683437217836795, 'recall': 0.7297957544741424, 'iou': 0.6466254851092463, 'dice': 0.73890075372613}
Test   -> {'loss': 25.698429107666016, 'accuracy': 0.5643808841705322, 'precision': 0.30100002884864807, 'recall': 0.32277315855026245, 'iou': 0.19886791706085205, 'dice': 0.2618759572505951}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.25277405536693076, 'accuracy': 0.8908266627270243, 'precision': 0.7954674218011939, 'recall': 0.763998277809309, 'iou': 0.6811997538027557, 'dice': 0.773300810482191}
Test   -> {'loss': 37.98611068725586, 'accuracy': 0.5626105666160583, 'precision': 0.2972792983055115, 'recall': 0.3224964737892151, 'iou': 0.1983686089515686, 'dice': 0.2615421414375305}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.23425837819990905, 'accuracy': 0.8994212295698083, 'precision': 0.8125695311504861, 'recall': 0.7878424836241681, 'iou': 0.7048202302144921, 'dice': 0.796601040466972}
Test   -> {'loss': 12.892448425292969, 'accuracy': 0.48717793822288513, 'precision': 0.24496698379516602, 'recall': 0.33051517605781555, 'iou': 0.1874263733625412, 'dice': 0.2601504623889923}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2107411107291346, 'accuracy': 0.9088459434716598, 'precision': 0.8301786785540374, 'recall': 0.8115374026091202, 'iou': 0.7292090307111325, 'dice': 0.8188472447188004}
Test   -> {'loss': 6.816030025482178, 'accuracy': 0.5402178168296814, 'precision': 0.5240811109542847, 'recall': 0.35899075865745544, 'iou': 0.2135593593120575, 'dice': 0.28910669684410095}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.19985765607460684, 'accuracy': 0.9139910366224206, 'precision': 0.8410548681798189, 'recall': 0.8205854400344517, 'iou': 0.740347058876701, 'dice': 0.8280653259028559}
Test   -> {'loss': 11.18493938446045, 'accuracy': 0.5138471722602844, 'precision': 0.36199697852134705, 'recall': 0.3592090308666229, 'iou': 0.21610796451568604, 'dice': 0.2968492805957794}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.1918028695427853, 'accuracy': 0.9179525054019431, 'precision': 0.8477144738902216, 'recall': 0.8310791492462158, 'iou': 0.7512540843175806, 'dice': 0.837551474571228}
Test   -> {'loss': 7.936918258666992, 'accuracy': 0.4792274832725525, 'precision': 0.2640594244003296, 'recall': 0.38986849784851074, 'iou': 0.21984311938285828, 'dice': 0.30580973625183105}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1842989506928817, 'accuracy': 0.9207572480906611, 'precision': 0.8536843999572422, 'recall': 0.8359632315843002, 'iou': 0.7573991277943487, 'dice': 0.8425718203834865}
Test   -> {'loss': 28.011173248291016, 'accuracy': 0.5128809213638306, 'precision': 0.3251747488975525, 'recall': 0.33528441190719604, 'iou': 0.21814212203025818, 'dice': 0.31042784452438354}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.16755548223205236, 'accuracy': 0.9280816010806872, 'precision': 0.8658659473709438, 'recall': 0.8555824554484823, 'iou': 0.7781595458155093, 'dice': 0.8597489268883415}
Test   -> {'loss': 8.707176208496094, 'accuracy': 0.54609614610672, 'precision': 0.5475728511810303, 'recall': 0.36057090759277344, 'iou': 0.21833394467830658, 'dice': 0.2951941192150116}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 8 with IoU 0.21984311938285828
Test -> {'loss': 7.936918258666992, 'accuracy': 0.4792274832725525, 'precision': 0.2640594244003296, 'recall': 0.38986849784851074, 'iou': 0.21984311938285828, 'dice': 0.30580973625183105} 
Train -> {'loss': 0.1918028695427853, 'accuracy': 0.9179525054019431, 'precision': 0.8477144738902216, 'recall': 0.8310791492462158, 'iou': 0.7512540843175806, 'dice': 0.837551474571228} 

Best model saved for model efficientunet at epoch 10

Trial 36:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 146.78285528343656, 'accuracy': 0.6153875516160675, 'precision': 0.4769925832748413, 'recall': 0.4794115171484325, 'iou': 0.350399478589711, 'dice': 0.46513466297284417}
Test   -> {'loss': 120.12057495117188, 'accuracy': 0.45779356360435486, 'precision': 0.3585161566734314, 'recall': 0.36527055501937866, 'iou': 0.23380327224731445, 'dice': 0.3560580611228943}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7069918534030085, 'accuracy': 0.7403811724289604, 'precision': 0.5438979813586111, 'recall': 0.5489425523125607, 'iou': 0.4258989667115004, 'dice': 0.5232212539600289}
Test   -> {'loss': 77.60053253173828, 'accuracy': 0.470179945230484, 'precision': 0.38554438948631287, 'recall': 0.3886580467224121, 'iou': 0.25428807735443115, 'dice': 0.38518041372299194}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6751197156698807, 'accuracy': 0.7493510147799616, 'precision': 0.5519137872302013, 'recall': 0.5534919002781744, 'iou': 0.43084196551986365, 'dice': 0.5240842833467152}
Test   -> {'loss': 84.24823760986328, 'accuracy': 0.5775333046913147, 'precision': 0.30207300186157227, 'recall': 0.3178154230117798, 'iou': 0.21913282573223114, 'dice': 0.2952882647514343}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6572615734908892, 'accuracy': 0.7544246059396993, 'precision': 0.5578059948008993, 'recall': 0.5564811486264933, 'iou': 0.434792474300965, 'dice': 0.5261128908914069}
Test   -> {'loss': 51.450313568115234, 'accuracy': 0.5106499791145325, 'precision': 0.3562574088573456, 'recall': 0.3773866891860962, 'iou': 0.24191901087760925, 'dice': 0.35266202688217163}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6480746499870135, 'accuracy': 0.7570554520772851, 'precision': 0.5593123426903849, 'recall': 0.5581810961598935, 'iou': 0.4369109348110531, 'dice': 0.527311607417853}
Test   -> {'loss': 86.90869140625, 'accuracy': 0.4672677218914032, 'precision': 0.3686964511871338, 'recall': 0.3829403519630432, 'iou': 0.22457556426525116, 'dice': 0.3395804166793823}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.63884520660276, 'accuracy': 0.759464356691941, 'precision': 0.5626723026451858, 'recall': 0.5593010790970014, 'iou': 0.4388973803623863, 'dice': 0.5285404507232749}
Test   -> {'loss': 49.84912109375, 'accuracy': 0.542805552482605, 'precision': 0.33181512355804443, 'recall': 0.33515140414237976, 'iou': 0.22383253276348114, 'dice': 0.31526821851730347}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6315045551113461, 'accuracy': 0.7615552599015443, 'precision': 0.5694409919821698, 'recall': 0.5608676184778628, 'iou': 0.44103810035664104, 'dice': 0.5301863630180773}
Test   -> {'loss': 35.7877311706543, 'accuracy': 0.4406140148639679, 'precision': 0.34315356612205505, 'recall': 0.3433247208595276, 'iou': 0.22272121906280518, 'dice': 0.3431907594203949}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6232507195161736, 'accuracy': 0.7638250656749891, 'precision': 0.5729626156713652, 'recall': 0.5623894652594691, 'iou': 0.4430428098077359, 'dice': 0.5313976816509081}
Test   -> {'loss': 48.6213493347168, 'accuracy': 0.4690277576446533, 'precision': 0.36263507604599, 'recall': 0.39728689193725586, 'iou': 0.22151288390159607, 'dice': 0.3325115144252777}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6208674588929052, 'accuracy': 0.7647299385589102, 'precision': 0.5774948017752689, 'recall': 0.5632043423859969, 'iou': 0.44407663176889006, 'dice': 0.5322958987692128}
Test   -> {'loss': 60.64056396484375, 'accuracy': 0.4998629689216614, 'precision': 0.3480767607688904, 'recall': 0.3594813346862793, 'iou': 0.2301097810268402, 'dice': 0.33740875124931335}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6173071594341941, 'accuracy': 0.7658556142578954, 'precision': 0.575379358296809, 'recall': 0.5639645483182825, 'iou': 0.4451247970695081, 'dice': 0.5329993040665336}
Test   -> {'loss': 40.483238220214844, 'accuracy': 0.5366235971450806, 'precision': 0.3506925702095032, 'recall': 0.37581586837768555, 'iou': 0.2482582926750183, 'dice': 0.3552708625793457}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.25428807735443115
Test -> {'loss': 77.60053253173828, 'accuracy': 0.470179945230484, 'precision': 0.38554438948631287, 'recall': 0.3886580467224121, 'iou': 0.25428807735443115, 'dice': 0.38518041372299194} 
Train -> {'loss': 0.7069918534030085, 'accuracy': 0.7403811724289604, 'precision': 0.5438979813586111, 'recall': 0.5489425523125607, 'iou': 0.4258989667115004, 'dice': 0.5232212539600289} 

Best model saved for model efficientunet at epoch 10

Trial 37:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 364.293413299063, 'accuracy': 0.37291455009709235, 'precision': 0.3502288854640463, 'recall': 0.3464930192283962, 'iou': 0.19072375284588855, 'dice': 0.2997271346009296}
Test   -> {'loss': 296.0158386230469, 'accuracy': 0.4222511649131775, 'precision': 0.2828049957752228, 'recall': 0.3452664315700531, 'iou': 0.1875627338886261, 'dice': 0.275356650352478}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 2.6040643298107646, 'accuracy': 0.5784940564114115, 'precision': 0.43965174840844196, 'recall': 0.4399269057356793, 'iou': 0.3118719069854073, 'dice': 0.4363277642623238}
Test   -> {'loss': 13.974136352539062, 'accuracy': 0.45240160822868347, 'precision': 0.31168434023857117, 'recall': 0.32571977376937866, 'iou': 0.20502802729606628, 'dice': 0.3069423735141754}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.8594578986582548, 'accuracy': 0.6735935729482899, 'precision': 0.49260583234869915, 'recall': 0.49769138045932937, 'iou': 0.3701971453169118, 'dice': 0.48268823260846344}
Test   -> {'loss': 9.878573417663574, 'accuracy': 0.5102320909500122, 'precision': 0.3057076334953308, 'recall': 0.32075512409210205, 'iou': 0.20091740787029266, 'dice': 0.28432798385620117}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7913570419601772, 'accuracy': 0.6987240812052851, 'precision': 0.5074775146401447, 'recall': 0.5138079731360726, 'iou': 0.38518744188806286, 'dice': 0.4904993192009304}
Test   -> {'loss': 6.4647440910339355, 'accuracy': 0.49141833186149597, 'precision': 0.32850542664527893, 'recall': 0.329948753118515, 'iou': 0.2166687250137329, 'dice': 0.31909483671188354}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7536335867384206, 'accuracy': 0.7148152019666589, 'precision': 0.519567950134692, 'recall': 0.5266359199648318, 'iou': 0.3990253018296283, 'dice': 0.5007426782794621}
Test   -> {'loss': 5.73402738571167, 'accuracy': 0.5250682830810547, 'precision': 0.3491327464580536, 'recall': 0.3454328179359436, 'iou': 0.23249506950378418, 'dice': 0.33566296100616455}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.729762429776399, 'accuracy': 0.7252165493757828, 'precision': 0.5297444338383882, 'recall': 0.5355575571889463, 'iou': 0.40922682181648584, 'dice': 0.5090280403261599}
Test   -> {'loss': 5.81265926361084, 'accuracy': 0.569524347782135, 'precision': 0.35582539439201355, 'recall': 0.35010963678359985, 'iou': 0.2414689064025879, 'dice': 0.3368864953517914}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7334078773208287, 'accuracy': 0.7253094605777575, 'precision': 0.5265013715495234, 'recall': 0.533778032530909, 'iou': 0.4067331936048425, 'dice': 0.5050522337789121}
Test   -> {'loss': 4.759085655212402, 'accuracy': 0.5037405490875244, 'precision': 0.3705592751502991, 'recall': 0.3745458126068115, 'iou': 0.2483557164669037, 'dice': 0.36752885580062866}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7089386100354402, 'accuracy': 0.7352349478265513, 'precision': 0.5339071869850158, 'recall': 0.5421861441239066, 'iou': 0.4162936482740485, 'dice': 0.5124040246009827}
Test   -> {'loss': 5.345067024230957, 'accuracy': 0.5396868586540222, 'precision': 0.36773574352264404, 'recall': 0.3589751422405243, 'iou': 0.24415884912014008, 'dice': 0.3506543040275574}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6938518570817035, 'accuracy': 0.7402672342632128, 'precision': 0.538491982480754, 'recall': 0.5458507942116779, 'iou': 0.4204815950082696, 'dice': 0.5150909646697667}
Test   -> {'loss': 3.808471918106079, 'accuracy': 0.4671823978424072, 'precision': 0.363141268491745, 'recall': 0.36644285917282104, 'iou': 0.23718222975730896, 'dice': 0.3597608208656311}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6889677638592927, 'accuracy': 0.7428357761839162, 'precision': 0.5432170546573142, 'recall': 0.5487175143283346, 'iou': 0.4243013013964114, 'dice': 0.5190589002940966}
Test   -> {'loss': 3.994013547897339, 'accuracy': 0.5575228333473206, 'precision': 0.37884029746055603, 'recall': 0.3747369647026062, 'iou': 0.25956520438194275, 'dice': 0.36877983808517456}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.25956520438194275
Test -> {'loss': 3.994013547897339, 'accuracy': 0.5575228333473206, 'precision': 0.37884029746055603, 'recall': 0.3747369647026062, 'iou': 0.25956520438194275, 'dice': 0.36877983808517456} 
Train -> {'loss': 0.6889677638592927, 'accuracy': 0.7428357761839162, 'precision': 0.5432170546573142, 'recall': 0.5487175143283346, 'iou': 0.4243013013964114, 'dice': 0.5190589002940966} 

Best model saved for model efficientunet at epoch 10

Trial 38:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 601.8911885963834, 'accuracy': 0.5585288385334222, 'precision': 0.4453893140606258, 'recall': 0.4463132428086322, 'iou': 0.31112898510435355, 'dice': 0.43147528249284495}
Test   -> {'loss': 566.4884643554688, 'accuracy': 0.4709983170032501, 'precision': 0.26880383491516113, 'recall': 0.3021509051322937, 'iou': 0.18534140288829803, 'dice': 0.26516586542129517}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.9359990055146424, 'accuracy': 0.6830966643665148, 'precision': 0.5100725291863731, 'recall': 0.5143822238497112, 'iou': 0.3884587339732958, 'dice': 0.5033452604127967}
Test   -> {'loss': 327.0854797363281, 'accuracy': 0.5053523778915405, 'precision': 0.23678335547447205, 'recall': 0.29559794068336487, 'iou': 0.18555031716823578, 'dice': 0.25440821051597595}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7822850844134455, 'accuracy': 0.7161822098752727, 'precision': 0.5288149696329366, 'recall': 0.5325372412152912, 'iou': 0.4072868086721586, 'dice': 0.512081657414851}
Test   -> {'loss': 435.3306884765625, 'accuracy': 0.4413190484046936, 'precision': 0.20326024293899536, 'recall': 0.29057928919792175, 'iou': 0.1652792990207672, 'dice': 0.23679575324058533}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7444343885649806, 'accuracy': 0.72658171420512, 'precision': 0.5359402466079463, 'recall': 0.5379386380962704, 'iou': 0.41247956338136094, 'dice': 0.5129106578619583}
Test   -> {'loss': 219.82130432128906, 'accuracy': 0.534993052482605, 'precision': 0.25728660821914673, 'recall': 0.31303149461746216, 'iou': 0.19824431836605072, 'dice': 0.2675023674964905}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7261282754981, 'accuracy': 0.7316375434398651, 'precision': 0.5404687895723012, 'recall': 0.5408073889172595, 'iou': 0.4156860501869865, 'dice': 0.5141672258791716}
Test   -> {'loss': 307.281494140625, 'accuracy': 0.46513521671295166, 'precision': 0.1966458261013031, 'recall': 0.2889924645423889, 'iou': 0.1658247858285904, 'dice': 0.23231051862239838}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.707439689014269, 'accuracy': 0.7370912225350089, 'precision': 0.5451956031115158, 'recall': 0.5436367205951524, 'iou': 0.41909268926019255, 'dice': 0.5153161451868389}
Test   -> {'loss': 231.9957733154297, 'accuracy': 0.5427021980285645, 'precision': 0.2558773159980774, 'recall': 0.3027706742286682, 'iou': 0.19869989156723022, 'dice': 0.26688119769096375}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7000857747119406, 'accuracy': 0.7396462165791056, 'precision': 0.5491886135028756, 'recall': 0.5456116255210793, 'iou': 0.4216860045557437, 'dice': 0.5176664682834045}
Test   -> {'loss': 190.5017547607422, 'accuracy': 0.3994389772415161, 'precision': 0.24429742991924286, 'recall': 0.2868359684944153, 'iou': 0.15845157206058502, 'dice': 0.2393570840358734}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6831860933614814, 'accuracy': 0.7446046878462252, 'precision': 0.5526193544916485, 'recall': 0.5485092108664306, 'iou': 0.4254020177799722, 'dice': 0.5197182516688886}
Test   -> {'loss': 201.57363891601562, 'accuracy': 0.4755174219608307, 'precision': 0.23454265296459198, 'recall': 0.30476054549217224, 'iou': 0.18359796702861786, 'dice': 0.25966545939445496}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6761942446231842, 'accuracy': 0.7467632995999378, 'precision': 0.5552402904500132, 'recall': 0.5498700903809589, 'iou': 0.4270055247389752, 'dice': 0.5203617403040761}
Test   -> {'loss': 182.9276123046875, 'accuracy': 0.4195581376552582, 'precision': 0.201042041182518, 'recall': 0.30078408122062683, 'iou': 0.15848490595817566, 'dice': 0.2319837063550949}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6739239151063172, 'accuracy': 0.7474925805693088, 'precision': 0.5566157027431157, 'recall': 0.5505737589753192, 'iou': 0.42825053036212923, 'dice': 0.5218828794748887}
Test   -> {'loss': 124.27083587646484, 'accuracy': 0.5241960883140564, 'precision': 0.2893800735473633, 'recall': 0.3145301938056946, 'iou': 0.20611271262168884, 'dice': 0.2872820794582367}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.20611271262168884
Test -> {'loss': 124.27083587646484, 'accuracy': 0.5241960883140564, 'precision': 0.2893800735473633, 'recall': 0.3145301938056946, 'iou': 0.20611271262168884, 'dice': 0.2872820794582367} 
Train -> {'loss': 0.6739239151063172, 'accuracy': 0.7474925805693088, 'precision': 0.5566157027431157, 'recall': 0.5505737589753192, 'iou': 0.42825053036212923, 'dice': 0.5218828794748887} 

Best model saved for model efficientunet at epoch 10

Trial 39:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 164.6348959363025, 'accuracy': 0.4407336914021036, 'precision': 0.38976913250010947, 'recall': 0.37802165850349095, 'iou': 0.23407318423623624, 'dice': 0.35140129198198733}
Test   -> {'loss': 94.9661865234375, 'accuracy': 0.4821070432662964, 'precision': 0.3072252869606018, 'recall': 0.3163701295852661, 'iou': 0.20721828937530518, 'dice': 0.3049333095550537}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 1.1589107928068743, 'accuracy': 0.6747074609217436, 'precision': 0.5045390823613043, 'recall': 0.5098271893418354, 'iou': 0.3836696904638539, 'dice': 0.4990095605020938}
Test   -> {'loss': 12.818441390991211, 'accuracy': 0.5066777467727661, 'precision': 0.3590890169143677, 'recall': 0.3529324531555176, 'iou': 0.23659847676753998, 'dice': 0.3475686013698578}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7377031968987506, 'accuracy': 0.7354115014490874, 'precision': 0.5391693016757135, 'recall': 0.5441558112268863, 'iou': 0.4212755716365317, 'dice': 0.5202552992364634}
Test   -> {'loss': 10.150184631347656, 'accuracy': 0.5400353074073792, 'precision': 0.36935776472091675, 'recall': 0.36062830686569214, 'iou': 0.24800598621368408, 'dice': 0.35646742582321167}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7013797490493111, 'accuracy': 0.7439939239750738, 'precision': 0.5453867248866869, 'recall': 0.5490385978118233, 'iou': 0.42632448336352474, 'dice': 0.5215289390605429}
Test   -> {'loss': 10.28292179107666, 'accuracy': 0.5428606867790222, 'precision': 0.3637882173061371, 'recall': 0.34641164541244507, 'iou': 0.22549788653850555, 'dice': 0.318741112947464}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6840599562810815, 'accuracy': 0.7483798877052639, 'precision': 0.5502883190694062, 'recall': 0.551701838037242, 'iou': 0.4294170027193816, 'dice': 0.5229456818622091}
Test   -> {'loss': 12.263026237487793, 'accuracy': 0.5240662097930908, 'precision': 0.37717223167419434, 'recall': 0.36792874336242676, 'iou': 0.25077587366104126, 'dice': 0.3657064437866211}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6677451237388279, 'accuracy': 0.751765731624935, 'precision': 0.551165010618127, 'recall': 0.5533555212228195, 'iou': 0.4317706268766652, 'dice': 0.5239758185718371}
Test   -> {'loss': 7.014147758483887, 'accuracy': 0.5208288431167603, 'precision': 0.39189717173576355, 'recall': 0.38084539771080017, 'iou': 0.25900405645370483, 'dice': 0.37966808676719666}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6595518485359524, 'accuracy': 0.7547926260077436, 'precision': 0.5521178359570711, 'recall': 0.5550515257793924, 'iou': 0.43417131019675215, 'dice': 0.5253293420957482}
Test   -> {'loss': 14.822896957397461, 'accuracy': 0.5176323056221008, 'precision': 0.337573379278183, 'recall': 0.33715319633483887, 'iou': 0.22075295448303223, 'dice': 0.3177284002304077}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.648873491909193, 'accuracy': 0.7566542837930762, 'precision': 0.5543722774671471, 'recall': 0.5560143564058386, 'iou': 0.4356287474217622, 'dice': 0.526111650466919}
Test   -> {'loss': 8.72348690032959, 'accuracy': 0.48602449893951416, 'precision': 0.3673590421676636, 'recall': 0.36498183012008667, 'iou': 0.241244837641716, 'dice': 0.36136433482170105}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6444256398988807, 'accuracy': 0.7581195204154305, 'precision': 0.5528323246085125, 'recall': 0.5573186366454415, 'iou': 0.4370007934777633, 'dice': 0.5270396901213604}
Test   -> {'loss': 21.685165405273438, 'accuracy': 0.5255201458930969, 'precision': 0.37460821866989136, 'recall': 0.35385775566101074, 'iou': 0.22916220128536224, 'dice': 0.3305516541004181}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6406391973080843, 'accuracy': 0.7594314082809116, 'precision': 0.5531464084334995, 'recall': 0.5581192534902821, 'iou': 0.4382775529571202, 'dice': 0.5279509881268377}
Test   -> {'loss': 11.682429313659668, 'accuracy': 0.5057556629180908, 'precision': 0.36824458837509155, 'recall': 0.35548028349876404, 'iou': 0.23198384046554565, 'dice': 0.3415202796459198}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.25900405645370483
Test -> {'loss': 7.014147758483887, 'accuracy': 0.5208288431167603, 'precision': 0.39189717173576355, 'recall': 0.38084539771080017, 'iou': 0.25900405645370483, 'dice': 0.37966808676719666} 
Train -> {'loss': 0.6677451237388279, 'accuracy': 0.751765731624935, 'precision': 0.551165010618127, 'recall': 0.5533555212228195, 'iou': 0.4317706268766652, 'dice': 0.5239758185718371} 

Best model saved for model efficientunet at epoch 10
Max trials reached.

Best parameters:
Best parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
Max IoU: 0.2629
Best metrics: {'loss': 13.68901045272382, 'accuracy': 0.46344566846387725, 'precision': 0.41942285184445643, 'recall': 0.41985517269130884, 'iou': 0.2628539481704649, 'dice': 0.398410221769427}
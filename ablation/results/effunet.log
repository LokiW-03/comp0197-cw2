100% 792M/792M [00:21<00:00, 36.3MB/s]
100% 19.2M/19.2M [00:01<00:00, 15.9MB/s]

Trial 0:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to /root/.cache/torch/hub/checkpoints/resnet50-0676ba61.pth
100% 97.8M/97.8M [00:00<00:00, 204MB/s]
/usr/local/lib/python3.11/dist-packages/torch/autograd/graph.py:823: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:180.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Downloading: "https://download.pytorch.org/models/efficientnet_b0_rwightman-7f5810bc.pth" to /root/.cache/torch/hub/checkpoints/efficientnet_b0_rwightman-7f5810bc.pth
100% 20.5M/20.5M [00:00<00:00, 136MB/s] 
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.42737027665843136, 'accuracy': 0.8442356311756631, 'precision': 0.6691018716148708, 'recall': 0.5972346390071123, 'iou': 0.5116588788188022, 'dice': 0.5774768625912459}
Test   -> {'loss': 9.066879272460938, 'accuracy': 0.6136661171913147, 'precision': 0.36879587173461914, 'recall': 0.3377643823623657, 'iou': 0.2142287939786911, 'dice': 0.2735462188720703}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.34147190879220546, 'accuracy': 0.8739560321621272, 'precision': 0.7585953689139823, 'recall': 0.6190471263035484, 'iou': 0.5424665331840515, 'dice': 0.5977032109447148}
Test   -> {'loss': 14.983963012695312, 'accuracy': 0.5814619660377502, 'precision': 0.406218945980072, 'recall': 0.3590698838233948, 'iou': 0.22718720138072968, 'dice': 0.3086143732070923}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.30413641333580016, 'accuracy': 0.8855066403098728, 'precision': 0.7573248026163681, 'recall': 0.6287222711936288, 'iou': 0.5565803937290026, 'dice': 0.606273049634436}
Test   -> {'loss': 12.649781227111816, 'accuracy': 0.5041192173957825, 'precision': 0.29678940773010254, 'recall': 0.3162754476070404, 'iou': 0.18298494815826416, 'dice': 0.25363990664482117}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2839588224887848, 'accuracy': 0.891588465804639, 'precision': 0.7493376086587491, 'recall': 0.633729861871056, 'iou': 0.5643764913082123, 'dice': 0.6111991478049237}
Test   -> {'loss': 9.84204387664795, 'accuracy': 0.43675512075424194, 'precision': 0.4978350102901459, 'recall': 0.3421933650970459, 'iou': 0.1522589921951294, 'dice': 0.21781697869300842}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 3.070903830813325, 'accuracy': 0.8752202995607387, 'precision': 0.7190290101844331, 'recall': 0.6256413113487803, 'iou': 0.5568234308258347, 'dice': 0.6049751053361789}
Test   -> {'loss': 480755.96875, 'accuracy': 0.6058972477912903, 'precision': 0.5653149485588074, 'recall': 0.32802140712738037, 'iou': 0.20607423782348633, 'dice': 0.2592734098434448}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 7.347015748853269, 'accuracy': 0.7211901619382527, 'precision': 0.5136146143726681, 'recall': 0.5157369651224302, 'iou': 0.4018548519391081, 'dice': 0.5013719109737355}
Test   -> {'loss': 135.18406677246094, 'accuracy': 0.43934473395347595, 'precision': 0.3032662868499756, 'recall': 0.31335127353668213, 'iou': 0.19330285489559174, 'dice': 0.29129791259765625}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5853690413029298, 'accuracy': 0.7845060602478359, 'precision': 0.5446526254000871, 'recall': 0.5496300045562827, 'iou': 0.44341101270654926, 'dice': 0.5310957970826522}
Test   -> {'loss': 91.5434799194336, 'accuracy': 0.3806239366531372, 'precision': 0.31191331148147583, 'recall': 0.3141132593154907, 'iou': 0.19367210566997528, 'dice': 0.3115483522415161}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5612951497668806, 'accuracy': 0.7933846341527027, 'precision': 0.5451868505581565, 'recall': 0.5557035915229631, 'iou': 0.45197733860948813, 'dice': 0.5371440956126089}
Test   -> {'loss': 36.741539001464844, 'accuracy': 0.4091908931732178, 'precision': 0.35041970014572144, 'recall': 0.3475987911224365, 'iou': 0.2081311196088791, 'dice': 0.33072495460510254}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5469631263743276, 'accuracy': 0.7982816688392473, 'precision': 0.5605130322601484, 'recall': 0.5590114808600882, 'iou': 0.45683382736599965, 'dice': 0.5406169849893321}
Test   -> {'loss': 38.65022277832031, 'accuracy': 0.42513102293014526, 'precision': 0.3351277709007263, 'recall': 0.34176477789878845, 'iou': 0.20454156398773193, 'dice': 0.3186074495315552}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.537082566903985, 'accuracy': 0.8019255871358125, 'precision': 0.5675025158602258, 'recall': 0.5616757745328157, 'iou': 0.46063066474769426, 'dice': 0.5433227269545845}
Test   -> {'loss': 63.599971771240234, 'accuracy': 0.3818869888782501, 'precision': 0.3570050001144409, 'recall': 0.3483539819717407, 'iou': 0.18873105943202972, 'dice': 0.304740309715271}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.22718720138072968
Test -> {'loss': 14.983963012695312, 'accuracy': 0.5814619660377502, 'precision': 0.406218945980072, 'recall': 0.3590698838233948, 'iou': 0.22718720138072968, 'dice': 0.3086143732070923} 
Train -> {'loss': 0.34147190879220546, 'accuracy': 0.8739560321621272, 'precision': 0.7585953689139823, 'recall': 0.6190471263035484, 'iou': 0.5424665331840515, 'dice': 0.5977032109447148} 

Best model saved for model efficientunet at epoch 10

Trial 1:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.46297651399736817, 'accuracy': 0.8254999342172042, 'precision': 0.610277243282484, 'recall': 0.582392854794212, 'iou': 0.496496858285821, 'dice': 0.5648509258809297}
Test   -> {'loss': 31.816978454589844, 'accuracy': 0.5309168100357056, 'precision': 0.31027981638908386, 'recall': 0.32889458537101746, 'iou': 0.19433936476707458, 'dice': 0.2660791873931885}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.30760690932688506, 'accuracy': 0.884729558488597, 'precision': 0.6828803746596627, 'recall': 0.6275987661403158, 'iou': 0.5557843939117764, 'dice': 0.6061660590379134}
Test   -> {'loss': 25.920669555664062, 'accuracy': 0.616936206817627, 'precision': 0.37259992957115173, 'recall': 0.34434032440185547, 'iou': 0.22964434325695038, 'dice': 0.3005508780479431}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.2615580817927485, 'accuracy': 0.8977210475050885, 'precision': 0.7137508392333984, 'recall': 0.6387898165246715, 'iou': 0.572570774866187, 'dice': 0.6167522808779841}
Test   -> {'loss': 15.651973724365234, 'accuracy': 0.5376783013343811, 'precision': 0.3258277177810669, 'recall': 0.32682228088378906, 'iou': 0.20055359601974487, 'dice': 0.27504491806030273}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.22871068029300026, 'accuracy': 0.9068195700645447, 'precision': 0.7363643552946008, 'recall': 0.6569183665773143, 'iou': 0.5965835462445798, 'dice': 0.646198482617088}
Test   -> {'loss': 6.872037887573242, 'accuracy': 0.6169495582580566, 'precision': 0.3798407018184662, 'recall': 0.3371830880641937, 'iou': 0.2210049033164978, 'dice': 0.28349047899246216}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.21133608429328254, 'accuracy': 0.9127116674962251, 'precision': 0.7528992777285368, 'recall': 0.6833550313244695, 'iou': 0.6260139226913453, 'dice': 0.687964565857597}
Test   -> {'loss': 4.677019119262695, 'accuracy': 0.5664762854576111, 'precision': 0.4990254342556, 'recall': 0.35249489545822144, 'iou': 0.21658329665660858, 'dice': 0.2916320264339447}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.19873916441979617, 'accuracy': 0.9172601943430694, 'precision': 0.7656225505082503, 'recall': 0.6936965185662974, 'iou': 0.6377752977868785, 'dice': 0.7014167899670808}
Test   -> {'loss': 8.893792152404785, 'accuracy': 0.6173989176750183, 'precision': 0.5415021777153015, 'recall': 0.33513471484184265, 'iou': 0.2087157666683197, 'dice': 0.2599484920501709}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.18109330431274745, 'accuracy': 0.9232356848924056, 'precision': 0.7832446108693661, 'recall': 0.7340687062429345, 'iou': 0.6739306874897169, 'dice': 0.7483121421026147}
Test   -> {'loss': 22.761306762695312, 'accuracy': 0.5784189701080322, 'precision': 0.26573818922042847, 'recall': 0.3295815885066986, 'iou': 0.19668561220169067, 'dice': 0.2515788972377777}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.17693325838317042, 'accuracy': 0.925460754270139, 'precision': 0.7909269286238629, 'recall': 0.7416835276976875, 'iou': 0.6812215281569439, 'dice': 0.7562884377396625}
Test   -> {'loss': 21.37809181213379, 'accuracy': 0.5425318479537964, 'precision': 0.3734942376613617, 'recall': 0.3365371823310852, 'iou': 0.19116467237472534, 'dice': 0.25533410906791687}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.16541561069695845, 'accuracy': 0.9297687395759251, 'precision': 0.804111663673235, 'recall': 0.7542948422224626, 'iou': 0.6937371793000594, 'dice': 0.7693220662034076}
Test   -> {'loss': 17.92471694946289, 'accuracy': 0.6035448908805847, 'precision': 0.2739061117172241, 'recall': 0.33364686369895935, 'iou': 0.20192039012908936, 'dice': 0.2522648572921753}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.15542563018591507, 'accuracy': 0.9337847678557686, 'precision': 0.8143888292105301, 'recall': 0.7794828788093898, 'iou': 0.7146950493688169, 'dice': 0.7928069290907487}
Test   -> {'loss': 12.404031753540039, 'accuracy': 0.5841680765151978, 'precision': 0.6013270020484924, 'recall': 0.3340432047843933, 'iou': 0.19600854814052582, 'dice': 0.24832847714424133}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.22964434325695038
Test -> {'loss': 25.920669555664062, 'accuracy': 0.616936206817627, 'precision': 0.37259992957115173, 'recall': 0.34434032440185547, 'iou': 0.22964434325695038, 'dice': 0.3005508780479431} 
Train -> {'loss': 0.30760690932688506, 'accuracy': 0.884729558488597, 'precision': 0.6828803746596627, 'recall': 0.6275987661403158, 'iou': 0.5557843939117764, 'dice': 0.6061660590379134} 

Best model saved for model efficientunet at epoch 10

Trial 2:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 191.3767915761989, 'accuracy': 0.6206702726042789, 'precision': 0.45574255916087525, 'recall': 0.45611284588990003, 'iou': 0.3316628645295682, 'dice': 0.43934793446374976}
Test   -> {'loss': 39.024845123291016, 'accuracy': 0.4825439453125, 'precision': 0.29743272066116333, 'recall': 0.32166463136672974, 'iou': 0.18057039380073547, 'dice': 0.2555786371231079}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.698843551977821, 'accuracy': 0.7521597875201184, 'precision': 0.5220826745033265, 'recall': 0.5248216441144113, 'iou': 0.41385143114172895, 'dice': 0.5105753128943236}
Test   -> {'loss': 31.058862686157227, 'accuracy': 0.5201403498649597, 'precision': 0.2715369164943695, 'recall': 0.30352866649627686, 'iou': 0.19370624423027039, 'dice': 0.2673966586589813}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6538199406603108, 'accuracy': 0.7629474541415339, 'precision': 0.526182096807853, 'recall': 0.5314063244539758, 'iou': 0.4218903746293939, 'dice': 0.5149589046188022}
Test   -> {'loss': 17.66767120361328, 'accuracy': 0.5579771399497986, 'precision': 0.3127356171607971, 'recall': 0.3222404718399048, 'iou': 0.213606059551239, 'dice': 0.2918897569179535}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6214285657457683, 'accuracy': 0.77251412142878, 'precision': 0.5306824141222498, 'recall': 0.5383169193630634, 'iou': 0.43059788488823436, 'dice': 0.52138150450976}
Test   -> {'loss': 15.460344314575195, 'accuracy': 0.5943042635917664, 'precision': 0.2965698838233948, 'recall': 0.32300615310668945, 'iou': 0.21320883929729462, 'dice': 0.27696821093559265}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6095520130966021, 'accuracy': 0.7759241277756899, 'precision': 0.5378378532502962, 'recall': 0.5402856274791386, 'iou': 0.43368705938691676, 'dice': 0.5235728230165398}
Test   -> {'loss': 11.224522590637207, 'accuracy': 0.5100346803665161, 'precision': 0.33939212560653687, 'recall': 0.33873605728149414, 'iou': 0.22358685731887817, 'dice': 0.32582005858421326}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6006508951601774, 'accuracy': 0.7787160277366638, 'precision': 0.5438632397548012, 'recall': 0.5418311541495116, 'iou': 0.43608028461103854, 'dice': 0.5253327981285427}
Test   -> {'loss': 15.56860065460205, 'accuracy': 0.4836500287055969, 'precision': 0.29132309556007385, 'recall': 0.3068539798259735, 'iou': 0.19174641370773315, 'dice': 0.2766062021255493}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5911095340614734, 'accuracy': 0.7822677430899246, 'precision': 0.5480386831190275, 'recall': 0.5440030281958372, 'iou': 0.4394792815913325, 'dice': 0.5278228758469872}
Test   -> {'loss': 13.54573917388916, 'accuracy': 0.5361701846122742, 'precision': 0.3381059169769287, 'recall': 0.3494933545589447, 'iou': 0.22725355625152588, 'dice': 0.32286855578422546}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5827185831640078, 'accuracy': 0.7844979407994643, 'precision': 0.56088716711687, 'recall': 0.5455050087493399, 'iou': 0.44162461511466816, 'dice': 0.5293273004500763}
Test   -> {'loss': 13.448328971862793, 'accuracy': 0.5593897104263306, 'precision': 0.3748033046722412, 'recall': 0.3459321856498718, 'iou': 0.2210581749677658, 'dice': 0.30575358867645264}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5760702346977981, 'accuracy': 0.78681520819664, 'precision': 0.565253063518068, 'recall': 0.5469943173553633, 'iou': 0.4439551488212917, 'dice': 0.5310792286758838}
Test   -> {'loss': 20.10622787475586, 'accuracy': 0.4483742117881775, 'precision': 0.28080272674560547, 'recall': 0.30800482630729675, 'iou': 0.17256979644298553, 'dice': 0.253628134727478}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5740435225808103, 'accuracy': 0.7893941594206768, 'precision': 0.5887059041987295, 'recall': 0.5488807553830354, 'iou': 0.4465370173039644, 'dice': 0.533022283082423}
Test   -> {'loss': 20.353031158447266, 'accuracy': 0.5620366334915161, 'precision': 0.3388344645500183, 'recall': 0.33408135175704956, 'iou': 0.19511184096336365, 'dice': 0.25551098585128784}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 7 with IoU 0.22725355625152588
Test -> {'loss': 13.54573917388916, 'accuracy': 0.5361701846122742, 'precision': 0.3381059169769287, 'recall': 0.3494933545589447, 'iou': 0.22725355625152588, 'dice': 0.32286855578422546} 
Train -> {'loss': 0.5911095340614734, 'accuracy': 0.7822677430899246, 'precision': 0.5480386831190275, 'recall': 0.5440030281958372, 'iou': 0.4394792815913325, 'dice': 0.5278228758469872} 

Best model saved for model efficientunet at epoch 10

Trial 3:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 3439.198243564108, 'accuracy': 0.34683155987573705, 'precision': 0.3412978527338608, 'recall': 0.34050991872082587, 'iou': 0.17048673117938248, 'dice': 0.265052495184152}
Test   -> {'loss': 206347.046875, 'accuracy': 0.28207895159721375, 'precision': 0.282153844833374, 'recall': 0.3090524673461914, 'iou': 0.13452766835689545, 'dice': 0.22433260083198547}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 154.8359739386517, 'accuracy': 0.607320625367372, 'precision': 0.44878929283307945, 'recall': 0.44386756731116256, 'iou': 0.31615112268406415, 'dice': 0.42633140786834384}
Test   -> {'loss': 487.5836181640625, 'accuracy': 0.5153048634529114, 'precision': 0.3428212106227875, 'recall': 0.34315142035484314, 'iou': 0.22771435976028442, 'dice': 0.3300160765647888}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 4.550837539589923, 'accuracy': 0.6806569799132969, 'precision': 0.4923333779625271, 'recall': 0.49196756093398386, 'iou': 0.37479253126227335, 'dice': 0.4897610348203908}
Test   -> {'loss': 158.072021484375, 'accuracy': 0.5059278607368469, 'precision': 0.3560234010219574, 'recall': 0.35854649543762207, 'iou': 0.2405886948108673, 'dice': 0.3531750440597534}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 2.062755315200142, 'accuracy': 0.6876892416373543, 'precision': 0.49731799830561096, 'recall': 0.49645242017248403, 'iou': 0.3805185087349104, 'dice': 0.4951315947200941}
Test   -> {'loss': 76.94441223144531, 'accuracy': 0.4687269330024719, 'precision': 0.3517221212387085, 'recall': 0.3523830771446228, 'iou': 0.23212914168834686, 'dice': 0.35169607400894165}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 1.4549860871356466, 'accuracy': 0.7023736622022546, 'precision': 0.5040829886560855, 'recall': 0.5038114288578863, 'iou': 0.3897755822409754, 'dice': 0.501999573085619}
Test   -> {'loss': 67.41690063476562, 'accuracy': 0.4743480980396271, 'precision': 0.33433854579925537, 'recall': 0.33586639165878296, 'iou': 0.2198367565870285, 'dice': 0.32948192954063416}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 1.2201516078866046, 'accuracy': 0.7128678415132605, 'precision': 0.5101499741492064, 'recall': 0.5087896212287571, 'iou': 0.3962584031664807, 'dice': 0.5064004688159279}
Test   -> {'loss': 50.9396858215332, 'accuracy': 0.49495959281921387, 'precision': 0.33855748176574707, 'recall': 0.34073376655578613, 'iou': 0.22741934657096863, 'dice': 0.33590826392173767}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 1.0587151931679768, 'accuracy': 0.7273885120516238, 'precision': 0.5165647003961646, 'recall': 0.5158064251360686, 'iou': 0.40504477879275447, 'dice': 0.5118555431780608}
Test   -> {'loss': 40.254905700683594, 'accuracy': 0.4228503108024597, 'precision': 0.33626192808151245, 'recall': 0.3382337987422943, 'iou': 0.2107010781764984, 'dice': 0.32897207140922546}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.9736213984696761, 'accuracy': 0.7332214003023894, 'precision': 0.5191489924555239, 'recall': 0.5190063782360242, 'iou': 0.40796603353127187, 'dice': 0.5128630067991173}
Test   -> {'loss': 30.527563095092773, 'accuracy': 0.49468153715133667, 'precision': 0.36101990938186646, 'recall': 0.3618720471858978, 'iou': 0.24302206933498383, 'dice': 0.3613000810146332}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.9010234801665596, 'accuracy': 0.7414172597553419, 'precision': 0.5220322759255119, 'recall': 0.5231746476629506, 'iou': 0.4134241254433342, 'dice': 0.5162689151971237}
Test   -> {'loss': 30.252702713012695, 'accuracy': 0.5080298781394958, 'precision': 0.3673563599586487, 'recall': 0.36936241388320923, 'iou': 0.24940705299377441, 'dice': 0.3678101897239685}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.8288206800170567, 'accuracy': 0.7500855347384577, 'precision': 0.5271529358366261, 'recall': 0.5270789493685183, 'iou': 0.418568638096685, 'dice': 0.5188636173372684}
Test   -> {'loss': 26.531291961669922, 'accuracy': 0.49440187215805054, 'precision': 0.3598882555961609, 'recall': 0.3611540198326111, 'iou': 0.24077489972114563, 'dice': 0.35753703117370605}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 9 with IoU 0.24940705299377441
Test -> {'loss': 30.252702713012695, 'accuracy': 0.5080298781394958, 'precision': 0.3673563599586487, 'recall': 0.36936241388320923, 'iou': 0.24940705299377441, 'dice': 0.3678101897239685} 
Train -> {'loss': 0.9010234801665596, 'accuracy': 0.7414172597553419, 'precision': 0.5220322759255119, 'recall': 0.5231746476629506, 'iou': 0.4134241254433342, 'dice': 0.5162689151971237} 

Best model saved for model efficientunet at epoch 10

Trial 4:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.40501282085543094, 'accuracy': 0.8036574349455211, 'precision': 0.6051036635170812, 'recall': 0.5988311338683833, 'iou': 0.5017890202610389, 'dice': 0.5970889495766681}
Test   -> {'loss': 0.7677749991416931, 'accuracy': 0.4967813193798065, 'precision': 0.35516127943992615, 'recall': 0.3399256467819214, 'iou': 0.18036550283432007, 'dice': 0.2521113157272339}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5253262260685796, 'accuracy': 0.684416914763658, 'precision': 0.49517808660216955, 'recall': 0.4987767181966616, 'iou': 0.3750710483478463, 'dice': 0.4834699759016866}
Test   -> {'loss': 0.6730533838272095, 'accuracy': 0.4191981554031372, 'precision': 0.34021133184432983, 'recall': 0.340937077999115, 'iou': 0.2151215672492981, 'dice': 0.33773073554039}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6027862095314523, 'accuracy': 0.5974276230387066, 'precision': 0.41712703186532724, 'recall': 0.431711603636327, 'iou': 0.29831907839878746, 'dice': 0.40945740471715514}
Test   -> {'loss': 0.7194968461990356, 'accuracy': 0.4187534749507904, 'precision': 0.374950110912323, 'recall': 0.3727358281612396, 'iou': 0.18774738907814026, 'dice': 0.29195624589920044}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6551249620707139, 'accuracy': 0.5447020209353903, 'precision': 0.3711045821075854, 'recall': 0.3804370044366173, 'iou': 0.2545453039848286, 'dice': 0.36532904738965244}
Test   -> {'loss': 0.7618563175201416, 'accuracy': 0.3634020686149597, 'precision': 0.30543944239616394, 'recall': 0.3075977563858032, 'iou': 0.1626465767621994, 'dice': 0.2628341317176819}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7007544338703156, 'accuracy': 0.5007823276778925, 'precision': 0.3278847788986952, 'recall': 0.33118013635925625, 'iou': 0.21808274919572085, 'dice': 0.3195821347443954}
Test   -> {'loss': 0.776331901550293, 'accuracy': 0.3610503375530243, 'precision': 0.3904515206813812, 'recall': 0.3648195266723633, 'iou': 0.14769349992275238, 'dice': 0.23703496158123016}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6975220387396606, 'accuracy': 0.5047112200571143, 'precision': 0.3301271617412567, 'recall': 0.3344777120196301, 'iou': 0.2194376722626064, 'dice': 0.32083783033101454}
Test   -> {'loss': 0.7013010382652283, 'accuracy': 0.44542959332466125, 'precision': 0.3284507095813751, 'recall': 0.33326318860054016, 'iou': 0.20552438497543335, 'dice': 0.31406742334365845}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6125168434951617, 'accuracy': 0.570705100764399, 'precision': 0.4162824554287869, 'recall': 0.4254243377758109, 'iou': 0.28036480403464775, 'dice': 0.3947415055140205}
Test   -> {'loss': 0.6929631233215332, 'accuracy': 0.45637232065200806, 'precision': 0.335274875164032, 'recall': 0.33702248334884644, 'iou': 0.21129155158996582, 'dice': 0.3204096555709839}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5903864355190941, 'accuracy': 0.6043271474216295, 'precision': 0.4378595366426136, 'recall': 0.4495283138492833, 'iou': 0.3032522702994554, 'dice': 0.41703320430672686}
Test   -> {'loss': 0.8620427846908569, 'accuracy': 0.2789593040943146, 'precision': 0.4263169467449188, 'recall': 0.3333408832550049, 'iou': 0.09299105405807495, 'dice': 0.14542104303836823}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5760018475677656, 'accuracy': 0.6290305666301561, 'precision': 0.44447828932948735, 'recall': 0.4568692073873852, 'iou': 0.3199983905191007, 'dice': 0.4325987300147181}
Test   -> {'loss': 0.7150677442550659, 'accuracy': 0.4055674076080322, 'precision': 0.34414947032928467, 'recall': 0.35180503129959106, 'iou': 0.18928641080856323, 'dice': 0.298063725233078}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5717793451703113, 'accuracy': 0.6361926371636598, 'precision': 0.4514514399611432, 'recall': 0.4659048088218855, 'iou': 0.3273729922330898, 'dice': 0.43929288750109463}
Test   -> {'loss': 0.8343383073806763, 'accuracy': 0.26832547783851624, 'precision': 0.396854966878891, 'recall': 0.35212820768356323, 'iou': 0.10115422308444977, 'dice': 0.16948466002941132}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.2151215672492981
Test -> {'loss': 0.6730533838272095, 'accuracy': 0.4191981554031372, 'precision': 0.34021133184432983, 'recall': 0.340937077999115, 'iou': 0.2151215672492981, 'dice': 0.33773073554039} 
Train -> {'loss': 0.5253262260685796, 'accuracy': 0.684416914763658, 'precision': 0.49517808660216955, 'recall': 0.4987767181966616, 'iou': 0.3750710483478463, 'dice': 0.4834699759016866} 

Best model saved for model efficientunet at epoch 10

Trial 5:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4108940083047618, 'accuracy': 0.8050882370575615, 'precision': 0.6060305999672931, 'recall': 0.5978218000868093, 'iou': 0.5048178519891656, 'dice': 0.5930261135101318}
Test   -> {'loss': 0.7529560327529907, 'accuracy': 0.4987640380859375, 'precision': 0.3200087547302246, 'recall': 0.32656583189964294, 'iou': 0.20576772093772888, 'dice': 0.29839015007019043}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.34496681690216063, 'accuracy': 0.8417191505432129, 'precision': 0.6581846553346385, 'recall': 0.6550232488176096, 'iou': 0.5616428038348322, 'dice': 0.6559223791827327}
Test   -> {'loss': 0.7565414309501648, 'accuracy': 0.39324671030044556, 'precision': 0.3075799345970154, 'recall': 0.3078593611717224, 'iou': 0.1871962547302246, 'dice': 0.2978375554084778}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.34392598089964493, 'accuracy': 0.8435197384461113, 'precision': 0.6594671394514001, 'recall': 0.6571860707324484, 'iou': 0.563287836054097, 'dice': 0.6570226938828178}
Test   -> {'loss': 0.7655267715454102, 'accuracy': 0.3609173893928528, 'precision': 0.3434132933616638, 'recall': 0.34407109022140503, 'iou': 0.17105427384376526, 'dice': 0.27916741371154785}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.34634314308995784, 'accuracy': 0.8395076513290405, 'precision': 0.6575668272764786, 'recall': 0.6525380119033481, 'iou': 0.558449095228444, 'dice': 0.6541215321292048}
Test   -> {'loss': 0.6561959385871887, 'accuracy': 0.49686726927757263, 'precision': 0.39278244972229004, 'recall': 0.3967033326625824, 'iou': 0.26105913519859314, 'dice': 0.3887234926223755}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3532323401907216, 'accuracy': 0.8374271905940512, 'precision': 0.6524666485579117, 'recall': 0.6438687889472298, 'iou': 0.5519999566285506, 'dice': 0.6467853432116302}
Test   -> {'loss': 0.818625807762146, 'accuracy': 0.33032381534576416, 'precision': 0.2801821827888489, 'recall': 0.30201977491378784, 'iou': 0.15099477767944336, 'dice': 0.24937617778778076}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.40437793109727943, 'accuracy': 0.8005472577136495, 'precision': 0.6025099054626797, 'recall': 0.598885584914166, 'iou': 0.49866745005483215, 'dice': 0.59759405799534}
Test   -> {'loss': 0.8188285827636719, 'accuracy': 0.32927438616752625, 'precision': 0.3787364363670349, 'recall': 0.35406577587127686, 'iou': 0.13104307651519775, 'dice': 0.2123481035232544}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4170423600984656, 'accuracy': 0.7828377329784891, 'precision': 0.589738448806431, 'recall': 0.5855121959810672, 'iou': 0.48136561694352525, 'dice': 0.5851458062296329}
Test   -> {'loss': 0.7424513101577759, 'accuracy': 0.43671494722366333, 'precision': 0.3434646725654602, 'recall': 0.3578038215637207, 'iou': 0.20892810821533203, 'dice': 0.3213382959365845}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.4471721758013186, 'accuracy': 0.7661424134088599, 'precision': 0.5614892622698908, 'recall': 0.5597999694554702, 'iou': 0.453546253753745, 'dice': 0.5548985722272293}
Test   -> {'loss': 0.6985487937927246, 'accuracy': 0.5975983142852783, 'precision': 0.3961625099182129, 'recall': 0.3550110459327698, 'iou': 0.23672327399253845, 'dice': 0.3203426003456116}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.49525026549463685, 'accuracy': 0.6972274360449418, 'precision': 0.5162479094837022, 'recall': 0.5131104661070782, 'iou': 0.39615008520043415, 'dice': 0.5083944289580635}
Test   -> {'loss': 0.7612295150756836, 'accuracy': 0.5782339572906494, 'precision': 0.24639753997325897, 'recall': 0.32838451862335205, 'iou': 0.194448322057724, 'dice': 0.24764347076416016}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5052970025850378, 'accuracy': 0.6944385601126629, 'precision': 0.501963110073753, 'recall': 0.5062942209451095, 'iou': 0.38690390379532524, 'dice': 0.4978874701520671}
Test   -> {'loss': 0.8237804174423218, 'accuracy': 0.31800031661987305, 'precision': 0.3291923701763153, 'recall': 0.33522915840148926, 'iou': 0.12097015231847763, 'dice': 0.19507408142089844}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 4 with IoU 0.26105913519859314
Test -> {'loss': 0.6561959385871887, 'accuracy': 0.49686726927757263, 'precision': 0.39278244972229004, 'recall': 0.3967033326625824, 'iou': 0.26105913519859314, 'dice': 0.3887234926223755} 
Train -> {'loss': 0.34634314308995784, 'accuracy': 0.8395076513290405, 'precision': 0.6575668272764786, 'recall': 0.6525380119033481, 'iou': 0.558449095228444, 'dice': 0.6541215321292048} 

Best model saved for model efficientunet at epoch 10

Trial 6:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7581081794655842, 'accuracy': 0.3531207624336948, 'precision': 0.3661193811375162, 'recall': 0.3884541065796562, 'iou': 0.17021847820800284, 'dice': 0.24916703305814578}
Test   -> {'loss': 0.7774389982223511, 'accuracy': 0.5215690732002258, 'precision': 0.8405230045318604, 'recall': 0.3333333432674408, 'iou': 0.17385636270046234, 'dice': 0.22852246463298798}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7357422794984735, 'accuracy': 0.32790565561989077, 'precision': 0.3383680939674377, 'recall': 0.34863562881946564, 'iou': 0.16805676367619762, 'dice': 0.26797368332095767}
Test   -> {'loss': 0.6829628944396973, 'accuracy': 0.4185865521430969, 'precision': 0.33698710799217224, 'recall': 0.33676546812057495, 'iou': 0.21375231444835663, 'dice': 0.3352181911468506}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6754649525103362, 'accuracy': 0.42938640402710954, 'precision': 0.3356299805900325, 'recall': 0.3356081265470256, 'iou': 0.2106352141369944, 'dice': 0.32808730692967125}
Test   -> {'loss': 0.703393816947937, 'accuracy': 0.42266348004341125, 'precision': 0.33228790760040283, 'recall': 0.3334997594356537, 'iou': 0.1978524625301361, 'dice': 0.3075554668903351}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6796372493971949, 'accuracy': 0.4435616438803465, 'precision': 0.3313249445479849, 'recall': 0.33127876701562303, 'iou': 0.20970776327278304, 'dice': 0.3238996269910232}
Test   -> {'loss': 0.693494439125061, 'accuracy': 0.4161264896392822, 'precision': 0.3297518491744995, 'recall': 0.32996809482574463, 'iou': 0.20232877135276794, 'dice': 0.3174908459186554}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6779525666133217, 'accuracy': 0.4414383671853853, 'precision': 0.33134896483110343, 'recall': 0.3319625174221785, 'iou': 0.2101725088513416, 'dice': 0.3257261020981747}
Test   -> {'loss': 0.6898825168609619, 'accuracy': 0.4180758595466614, 'precision': 0.33551809191703796, 'recall': 0.3369006812572479, 'iou': 0.20668065547943115, 'dice': 0.32485583424568176}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.691553517009901, 'accuracy': 0.4244168106628501, 'precision': 0.3165414944938991, 'recall': 0.31533381226270096, 'iou': 0.19943617796120436, 'dice': 0.3121420021938241}
Test   -> {'loss': 0.690004825592041, 'accuracy': 0.4105398952960968, 'precision': 0.33535635471343994, 'recall': 0.3372375965118408, 'iou': 0.20353949069976807, 'dice': 0.32102739810943604}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6916186788807744, 'accuracy': 0.4243072673030522, 'precision': 0.31648018243520154, 'recall': 0.31526933143968167, 'iou': 0.19937699132639428, 'dice': 0.3120747141216112}
Test   -> {'loss': 0.6885732412338257, 'accuracy': 0.41123369336128235, 'precision': 0.33593639731407166, 'recall': 0.3376394212245941, 'iou': 0.20683567225933075, 'dice': 0.3263286352157593}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6828803106494572, 'accuracy': 0.4418420601150264, 'precision': 0.32813603126484414, 'recall': 0.32773797006710714, 'iou': 0.20730501614187075, 'dice': 0.32064879873524543}
Test   -> {'loss': 0.7048906087875366, 'accuracy': 0.4495762288570404, 'precision': 0.34074434638023376, 'recall': 0.34501367807388306, 'iou': 0.20474565029144287, 'dice': 0.31204578280448914}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6734107144500898, 'accuracy': 0.4740790536870127, 'precision': 0.3442567256481751, 'recall': 0.3493617480215819, 'iou': 0.21829293201798977, 'dice': 0.3299448628788409}
Test   -> {'loss': 0.6895570755004883, 'accuracy': 0.44386258721351624, 'precision': 0.348054975271225, 'recall': 0.3466142416000366, 'iou': 0.2104264497756958, 'dice': 0.3224983811378479}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6766621045444323, 'accuracy': 0.4519394357567248, 'precision': 0.3357685613891353, 'recall': 0.3373673981946448, 'iou': 0.21251197502664898, 'dice': 0.3268658363300821}
Test   -> {'loss': 0.6992555856704712, 'accuracy': 0.4275325834751129, 'precision': 0.3331460952758789, 'recall': 0.33354687690734863, 'iou': 0.20583701133728027, 'dice': 0.32036757469177246}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.21375231444835663
Test -> {'loss': 0.6829628944396973, 'accuracy': 0.4185865521430969, 'precision': 0.33698710799217224, 'recall': 0.33676546812057495, 'iou': 0.21375231444835663, 'dice': 0.3352181911468506} 
Train -> {'loss': 0.7357422794984735, 'accuracy': 0.32790565561989077, 'precision': 0.3383680939674377, 'recall': 0.34863562881946564, 'iou': 0.16805676367619762, 'dice': 0.26797368332095767} 

Best model saved for model efficientunet at epoch 10

Trial 7:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6285634849382483, 'accuracy': 0.5514959441578906, 'precision': 0.3924005342566449, 'recall': 0.39868840963944147, 'iou': 0.2691052107707314, 'dice': 0.38120776052060334}
Test   -> {'loss': 0.8549023866653442, 'accuracy': 0.3005698025226593, 'precision': 0.4407234191894531, 'recall': 0.33350813388824463, 'iou': 0.10040607303380966, 'dice': 0.15451829135417938}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6160303571949834, 'accuracy': 0.5645550225092018, 'precision': 0.41275701341421706, 'recall': 0.4284350288950879, 'iou': 0.2770732731922813, 'dice': 0.3924911320209503}
Test   -> {'loss': 0.7635500431060791, 'accuracy': 0.5710866451263428, 'precision': 0.19876840710639954, 'recall': 0.3324478268623352, 'iou': 0.19039414823055267, 'dice': 0.24239473044872284}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6207883425380872, 'accuracy': 0.5538017729054326, 'precision': 0.4104093831518422, 'recall': 0.42405607648517774, 'iou': 0.2709394226903501, 'dice': 0.3870877639107082}
Test   -> {'loss': 0.7626953125, 'accuracy': 0.5800796747207642, 'precision': 0.20055417716503143, 'recall': 0.33257561922073364, 'iou': 0.19338658452033997, 'dice': 0.2447994351387024}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6213134252506753, 'accuracy': 0.5537763434907664, 'precision': 0.41021393200625544, 'recall': 0.42387739160786503, 'iou': 0.27096101537994716, 'dice': 0.3870723781378373}
Test   -> {'loss': 0.7538957595825195, 'accuracy': 0.6047518849372864, 'precision': 0.20180675387382507, 'recall': 0.33272597193717957, 'iou': 0.20158396661281586, 'dice': 0.2512338161468506}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6207398756690647, 'accuracy': 0.5538908025492792, 'precision': 0.41018593803696013, 'recall': 0.42412353598553204, 'iou': 0.2709752347158349, 'dice': 0.38708570314490276}
Test   -> {'loss': 0.7602014541625977, 'accuracy': 0.5832319855690002, 'precision': 0.1970607042312622, 'recall': 0.33226579427719116, 'iou': 0.19442163407802582, 'dice': 0.24560755491256714}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6261034224344336, 'accuracy': 0.5475908704425978, 'precision': 0.4060047087462052, 'recall': 0.418821431502052, 'iou': 0.2668855844632439, 'dice': 0.38240750872570534}
Test   -> {'loss': 0.8507238626480103, 'accuracy': 0.29543691873550415, 'precision': 0.3821026682853699, 'recall': 0.33569180965423584, 'iou': 0.1007893979549408, 'dice': 0.15772557258605957}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.701384873493858, 'accuracy': 0.44766143923220425, 'precision': 0.31677286676738575, 'recall': 0.31900178764177406, 'iou': 0.20229478154493416, 'dice': 0.30884461765703947}
Test   -> {'loss': 0.6881031394004822, 'accuracy': 0.4403197467327118, 'precision': 0.33580392599105835, 'recall': 0.33656835556030273, 'iou': 0.21207210421562195, 'dice': 0.3271999955177307}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6715746921041738, 'accuracy': 0.46226370593775873, 'precision': 0.3443295193755108, 'recall': 0.34561243912448053, 'iou': 0.21739654437355374, 'dice': 0.33202816818071446}
Test   -> {'loss': 0.7022927403450012, 'accuracy': 0.4476000666618347, 'precision': 0.3272704780101776, 'recall': 0.3286079168319702, 'iou': 0.20518100261688232, 'dice': 0.3126237392425537}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6725036050962365, 'accuracy': 0.4710083790447401, 'precision': 0.34557446526444474, 'recall': 0.3478931004586427, 'iou': 0.21827739114346711, 'dice': 0.3309895282206328}
Test   -> {'loss': 0.6998350620269775, 'accuracy': 0.4452418088912964, 'precision': 0.327474445104599, 'recall': 0.3284854590892792, 'iou': 0.20490586757659912, 'dice': 0.3128746747970581}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.672517698744069, 'accuracy': 0.4681855100652446, 'precision': 0.34403254778488823, 'recall': 0.3461952621522157, 'iou': 0.21775207558403845, 'dice': 0.33103174282156905}
Test   -> {'loss': 0.7033259272575378, 'accuracy': 0.4350704252719879, 'precision': 0.325248658657074, 'recall': 0.3267627954483032, 'iou': 0.20219306647777557, 'dice': 0.3110755681991577}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 7 with IoU 0.21207210421562195
Test -> {'loss': 0.6881031394004822, 'accuracy': 0.4403197467327118, 'precision': 0.33580392599105835, 'recall': 0.33656835556030273, 'iou': 0.21207210421562195, 'dice': 0.3271999955177307} 
Train -> {'loss': 0.701384873493858, 'accuracy': 0.44766143923220425, 'precision': 0.31677286676738575, 'recall': 0.31900178764177406, 'iou': 0.20229478154493416, 'dice': 0.30884461765703947} 

Best model saved for model efficientunet at epoch 10

Trial 8:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4236623218526011, 'accuracy': 0.817139612203059, 'precision': 0.761438882480497, 'recall': 0.7220321718765341, 'iou': 0.597202875951062, 'dice': 0.7290943130202915}
Test   -> {'loss': 11.317745208740234, 'accuracy': 0.5043172836303711, 'precision': 0.3987613618373871, 'recall': 0.3400144577026367, 'iou': 0.18815545737743378, 'dice': 0.25759950280189514}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.33213954192140827, 'accuracy': 0.8598185736200084, 'precision': 0.8166299864001896, 'recall': 0.7900787936604541, 'iou': 0.6768438489540763, 'dice': 0.7985229613988296}
Test   -> {'loss': 6.298266887664795, 'accuracy': 0.6109656095504761, 'precision': 0.3814734220504761, 'recall': 0.3387314975261688, 'iou': 0.2248929738998413, 'dice': 0.29295629262924194}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.2909291509700858, 'accuracy': 0.8765179970990057, 'precision': 0.8382197613301484, 'recall': 0.8156814202018406, 'iou': 0.7091435860032621, 'dice': 0.8229328624580218}
Test   -> {'loss': 9.434516906738281, 'accuracy': 0.5931894779205322, 'precision': 0.3238449990749359, 'recall': 0.33375829458236694, 'iou': 0.19959282875061035, 'dice': 0.25147831439971924}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.25691230608069376, 'accuracy': 0.8906031665594681, 'precision': 0.8565188340518786, 'recall': 0.8379730932090593, 'iou': 0.7381695273129837, 'dice': 0.844015315822933}
Test   -> {'loss': 7.727134704589844, 'accuracy': 0.5694392919540405, 'precision': 0.5195189714431763, 'recall': 0.33417046070098877, 'iou': 0.19088810682296753, 'dice': 0.24405716359615326}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2337465785767721, 'accuracy': 0.9005702394506205, 'precision': 0.869223401857459, 'recall': 0.8534505476122317, 'iou': 0.7588987918003746, 'dice': 0.8583749688189962}
Test   -> {'loss': 18.058900833129883, 'accuracy': 0.5633906126022339, 'precision': 0.5216034650802612, 'recall': 0.3333333432674408, 'iou': 0.18827012181282043, 'dice': 0.24062995612621307}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.21091241655142412, 'accuracy': 0.9102964771830517, 'precision': 0.8808970383975817, 'recall': 0.8678468219611956, 'iou': 0.7793414714543716, 'dice': 0.8723468117091967}
Test   -> {'loss': 19.773447036743164, 'accuracy': 0.5442591905593872, 'precision': 0.5329796075820923, 'recall': 0.33336400985717773, 'iou': 0.1814999282360077, 'dice': 0.23507097363471985}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.19452320544616036, 'accuracy': 0.9171852135139963, 'precision': 0.8897165197393169, 'recall': 0.8780187057412189, 'iou': 0.794159150901048, 'dice': 0.8821773599023405}
Test   -> {'loss': 15.936528205871582, 'accuracy': 0.6026113033294678, 'precision': 0.5498253703117371, 'recall': 0.3273702561855316, 'iou': 0.20433193445205688, 'dice': 0.2557910680770874}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.18151493895313014, 'accuracy': 0.9226003802340964, 'precision': 0.8973020465477654, 'recall': 0.8861010771730672, 'iou': 0.8062156804229902, 'dice': 0.8899649187274601}
Test   -> {'loss': 5.72324800491333, 'accuracy': 0.6017032265663147, 'precision': 0.5952412486076355, 'recall': 0.35529956221580505, 'iou': 0.23081457614898682, 'dice': 0.29738011956214905}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.16875076352254204, 'accuracy': 0.9281624957271244, 'precision': 0.9041161469791247, 'recall': 0.8949408943238466, 'iou': 0.8191207732843316, 'dice': 0.8982427895069123}
Test   -> {'loss': 12.929728507995605, 'accuracy': 0.47134461998939514, 'precision': 0.3485414683818817, 'recall': 0.341514527797699, 'iou': 0.17142552137374878, 'dice': 0.23689278960227966}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.16170681598393813, 'accuracy': 0.9312148177105447, 'precision': 0.9080936188283174, 'recall': 0.8996643872364708, 'iou': 0.825981377777846, 'dice': 0.9025638867979464}
Test   -> {'loss': 6.809268474578857, 'accuracy': 0.6310611367225647, 'precision': 0.2457873821258545, 'recall': 0.33396244049072266, 'iou': 0.22078494727611542, 'dice': 0.2744351029396057}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 8 with IoU 0.23081457614898682
Test -> {'loss': 5.72324800491333, 'accuracy': 0.6017032265663147, 'precision': 0.5952412486076355, 'recall': 0.35529956221580505, 'iou': 0.23081457614898682, 'dice': 0.29738011956214905} 
Train -> {'loss': 0.18151493895313014, 'accuracy': 0.9226003802340964, 'precision': 0.8973020465477654, 'recall': 0.8861010771730672, 'iou': 0.8062156804229902, 'dice': 0.8899649187274601} 

Best model saved for model efficientunet at epoch 10

Trial 9:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4643795314042465, 'accuracy': 0.7972388376360354, 'precision': 0.7239834313807281, 'recall': 0.6953460045482801, 'iou': 0.5639571184697358, 'dice': 0.6933051586151123}
Test   -> {'loss': 20.731996536254883, 'accuracy': 0.5723605751991272, 'precision': 0.230475515127182, 'recall': 0.3312164545059204, 'iou': 0.19231460988521576, 'dice': 0.24567022919654846}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.30669420400391456, 'accuracy': 0.8702982425689697, 'precision': 0.8263084805530051, 'recall': 0.8018477911534516, 'iou': 0.6919714435287144, 'dice': 0.8102375766505365}
Test   -> {'loss': 47.10272979736328, 'accuracy': 0.5580244660377502, 'precision': 0.2337987720966339, 'recall': 0.3332802951335907, 'iou': 0.18633858859539032, 'dice': 0.23943541944026947}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.25363287485164143, 'accuracy': 0.8913100709085879, 'precision': 0.854764663654825, 'recall': 0.8347944788310839, 'iou': 0.7334098805551944, 'dice': 0.8403936406840449}
Test   -> {'loss': 38.69822311401367, 'accuracy': 0.5466573238372803, 'precision': 0.3529481887817383, 'recall': 0.3392375707626343, 'iou': 0.21551428735256195, 'dice': 0.2991541624069214}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.21718238942001178, 'accuracy': 0.9070132825685584, 'precision': 0.8755101753317791, 'recall': 0.8589292318924614, 'iou': 0.7676047605016957, 'dice': 0.8644087521926217}
Test   -> {'loss': 37.196937561035156, 'accuracy': 0.5855753421783447, 'precision': 0.26206493377685547, 'recall': 0.3340710997581482, 'iou': 0.2015363872051239, 'dice': 0.25779032707214355}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.20019186437129974, 'accuracy': 0.914534080028534, 'precision': 0.8851410471874734, 'recall': 0.8714859553005384, 'iou': 0.784117375249448, 'dice': 0.8754464921743973}
Test   -> {'loss': 85.22177124023438, 'accuracy': 0.5465838313102722, 'precision': 0.3991064429283142, 'recall': 0.3354628086090088, 'iou': 0.18737582862377167, 'dice': 0.24617479741573334}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.1803509894920432, 'accuracy': 0.9225024466929228, 'precision': 0.8960945554401564, 'recall': 0.8838321281516034, 'iou': 0.8022787923398225, 'dice': 0.8873755024827045}
Test   -> {'loss': 44.361751556396484, 'accuracy': 0.5545713305473328, 'precision': 0.35798782110214233, 'recall': 0.33972811698913574, 'iou': 0.22528110444545746, 'dice': 0.3141917884349823}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.1604226140872292, 'accuracy': 0.9314790938211523, 'precision': 0.9068769589714382, 'recall': 0.8984212605849556, 'iou': 0.8243402843889983, 'dice': 0.9015524221503216}
Test   -> {'loss': 56.07455825805664, 'accuracy': 0.5683606266975403, 'precision': 0.3502611517906189, 'recall': 0.331351637840271, 'iou': 0.20222580432891846, 'dice': 0.26499661803245544}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.1500176110993261, 'accuracy': 0.9355015998301299, 'precision': 0.9129191419352656, 'recall': 0.9046435449434364, 'iou': 0.8338363968807718, 'dice': 0.9075206585552381}
Test   -> {'loss': 57.86808776855469, 'accuracy': 0.5673890113830566, 'precision': 0.2361650913953781, 'recall': 0.3347475230693817, 'iou': 0.19351446628570557, 'dice': 0.24906449019908905}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.14499967888645504, 'accuracy': 0.9378187962200331, 'precision': 0.9164769551028376, 'recall': 0.9061952373255854, 'iou': 0.8371073023132656, 'dice': 0.9093672602073006}
Test   -> {'loss': 53.111419677734375, 'accuracy': 0.5726439952850342, 'precision': 0.4379505515098572, 'recall': 0.3460637331008911, 'iou': 0.21629583835601807, 'dice': 0.2917700707912445}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.13507751828950385, 'accuracy': 0.9420987860016201, 'precision': 0.9213441226793372, 'recall': 0.9147149770156197, 'iou': 0.8493879515191783, 'dice': 0.917018489215685}
Test   -> {'loss': 55.98960494995117, 'accuracy': 0.5868103504180908, 'precision': 0.3529776930809021, 'recall': 0.3346118628978729, 'iou': 0.21494895219802856, 'dice': 0.28445419669151306}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.22528110444545746
Test -> {'loss': 44.361751556396484, 'accuracy': 0.5545713305473328, 'precision': 0.35798782110214233, 'recall': 0.33972811698913574, 'iou': 0.22528110444545746, 'dice': 0.3141917884349823} 
Train -> {'loss': 0.1803509894920432, 'accuracy': 0.9225024466929228, 'precision': 0.8960945554401564, 'recall': 0.8838321281516034, 'iou': 0.8022787923398225, 'dice': 0.8873755024827045} 

Best model saved for model efficientunet at epoch 10

Trial 10:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 554.5888514407303, 'accuracy': 0.5714319269942201, 'precision': 0.44145419228336086, 'recall': 0.4369489331284295, 'iou': 0.30214604860090694, 'dice': 0.4262279695790747}
Test   -> {'loss': 21.386322021484375, 'accuracy': 0.45831048488616943, 'precision': 0.35184985399246216, 'recall': 0.3424074053764343, 'iou': 0.20406100153923035, 'dice': 0.3029768168926239}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.8972371808860613, 'accuracy': 0.6685783756815868, 'precision': 0.5215373534223308, 'recall': 0.49905892934488216, 'iou': 0.37070996320765953, 'dice': 0.5015887419814649}
Test   -> {'loss': 22.756486892700195, 'accuracy': 0.49176648259162903, 'precision': 0.39902424812316895, 'recall': 0.35376930236816406, 'iou': 0.2172950953245163, 'dice': 0.3184708058834076}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7160234368365744, 'accuracy': 0.6983077974423119, 'precision': 0.5618261462968329, 'recall': 0.529983611728834, 'iou': 0.40201856390289636, 'dice': 0.5362074016228966}
Test   -> {'loss': 12.021660804748535, 'accuracy': 0.5265839099884033, 'precision': 0.41209468245506287, 'recall': 0.39237499237060547, 'iou': 0.2663602828979492, 'dice': 0.3876074254512787}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6760499736537104, 'accuracy': 0.7079679592795994, 'precision': 0.5769771721052087, 'recall': 0.5459558441587117, 'iou': 0.41677630673284116, 'dice': 0.5532232129055521}
Test   -> {'loss': 7.227054119110107, 'accuracy': 0.5226066708564758, 'precision': 0.4037904739379883, 'recall': 0.4017706513404846, 'iou': 0.27511361241340637, 'dice': 0.4023553729057312}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6415160148040108, 'accuracy': 0.719288210246874, 'precision': 0.5970756056516067, 'recall': 0.5615147509004759, 'iou': 0.43213142791519993, 'dice': 0.5700596266466639}
Test   -> {'loss': 9.093435287475586, 'accuracy': 0.3852713406085968, 'precision': 0.40146467089653015, 'recall': 0.39424341917037964, 'iou': 0.215520977973938, 'dice': 0.3441812992095947}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6295459597007088, 'accuracy': 0.7251294812430507, 'precision': 0.6078665479369786, 'recall': 0.570954353913017, 'iou': 0.44107725879420406, 'dice': 0.5798882029626681}
Test   -> {'loss': 9.06735897064209, 'accuracy': 0.5673018097877502, 'precision': 0.4773115813732147, 'recall': 0.479043573141098, 'iou': 0.3345284163951874, 'dice': 0.47259044647216797}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6099444691253745, 'accuracy': 0.7310959554236868, 'precision': 0.6213013581607653, 'recall': 0.5805740324051484, 'iou': 0.4508785672809767, 'dice': 0.590900531022445}
Test   -> {'loss': 4.702591419219971, 'accuracy': 0.5228034853935242, 'precision': 0.40953612327575684, 'recall': 0.40105801820755005, 'iou': 0.2644549012184143, 'dice': 0.38522690534591675}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6033925681010537, 'accuracy': 0.7340473014375438, 'precision': 0.626928144434224, 'recall': 0.5882110486859861, 'iou': 0.45760762808115585, 'dice': 0.5987204238124516}
Test   -> {'loss': 4.460546493530273, 'accuracy': 0.6141008734703064, 'precision': 0.43532228469848633, 'recall': 0.4119507670402527, 'iou': 0.29763373732566833, 'dice': 0.4100460410118103}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5980871324953826, 'accuracy': 0.7376129287740458, 'precision': 0.6332883547181668, 'recall': 0.5919476001159004, 'iou': 0.46252542254717455, 'dice': 0.6040246031854464}
Test   -> {'loss': 3.5155394077301025, 'accuracy': 0.6134070158004761, 'precision': 0.45083555579185486, 'recall': 0.4360395669937134, 'iou': 0.31769415736198425, 'dice': 0.4409196972846985}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5834424113449843, 'accuracy': 0.7405921868655992, 'precision': 0.6390481865924338, 'recall': 0.5973507715308148, 'iou': 0.46786555453487066, 'dice': 0.610145923624868}
Test   -> {'loss': 3.5393073558807373, 'accuracy': 0.6036526560783386, 'precision': 0.4452316164970398, 'recall': 0.42490214109420776, 'iou': 0.31155240535736084, 'dice': 0.4297305941581726}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.3345284163951874
Test -> {'loss': 9.06735897064209, 'accuracy': 0.5673018097877502, 'precision': 0.4773115813732147, 'recall': 0.479043573141098, 'iou': 0.3345284163951874, 'dice': 0.47259044647216797} 
Train -> {'loss': 0.6295459597007088, 'accuracy': 0.7251294812430507, 'precision': 0.6078665479369786, 'recall': 0.570954353913017, 'iou': 0.44107725879420406, 'dice': 0.5798882029626681} 

Best model saved for model efficientunet at epoch 10

Trial 11:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 137.0043394918027, 'accuracy': 0.4547160734301028, 'precision': 0.3722549321858779, 'recall': 0.37054341642752936, 'iou': 0.2274837050748908, 'dice': 0.3392883241176605}
Test   -> {'loss': 252.49501037597656, 'accuracy': 0.49452611804008484, 'precision': 0.30774518847465515, 'recall': 0.3180203437805176, 'iou': 0.20098736882209778, 'dice': 0.28766828775405884}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 1.2937499056691708, 'accuracy': 0.6427608028702114, 'precision': 0.4862445841664853, 'recall': 0.46921511629353396, 'iou': 0.34397643389909166, 'dice': 0.4708737658417743}
Test   -> {'loss': 48.405487060546875, 'accuracy': 0.5399319529533386, 'precision': 0.30363529920578003, 'recall': 0.32588839530944824, 'iou': 0.19417476654052734, 'dice': 0.26022791862487793}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6754586831383084, 'accuracy': 0.703764748055002, 'precision': 0.5638636309167613, 'recall': 0.528798754837202, 'iou': 0.4046326183754465, 'dice': 0.5385016975195511}
Test   -> {'loss': 40.92158889770508, 'accuracy': 0.5727022290229797, 'precision': 0.33649516105651855, 'recall': 0.33191218972206116, 'iou': 0.20694617927074432, 'dice': 0.2734924852848053}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6327672227569249, 'accuracy': 0.7179054415744284, 'precision': 0.589877750562585, 'recall': 0.55061587250751, 'iou': 0.42569849387459135, 'dice': 0.562790396420852}
Test   -> {'loss': 38.40446090698242, 'accuracy': 0.5167712569236755, 'precision': 0.2764063775539398, 'recall': 0.3279862403869629, 'iou': 0.1800534576177597, 'dice': 0.24241724610328674}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6146762775338215, 'accuracy': 0.7248824871104697, 'precision': 0.6056137541066046, 'recall': 0.5637026320333066, 'iou': 0.4372457815253216, 'dice': 0.57595694479735}
Test   -> {'loss': 29.51872444152832, 'accuracy': 0.5804626941680908, 'precision': 0.32414400577545166, 'recall': 0.33069944381713867, 'iou': 0.2083849310874939, 'dice': 0.27390262484550476}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6038166559260825, 'accuracy': 0.7317304222480111, 'precision': 0.6196822135344796, 'recall': 0.577236004497694, 'iou': 0.4492406204990719, 'dice': 0.5892542683559915}
Test   -> {'loss': 32.985477447509766, 'accuracy': 0.5634435415267944, 'precision': 0.3413979411125183, 'recall': 0.3331816792488098, 'iou': 0.19620206952095032, 'dice': 0.2560705244541168}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5980315928873808, 'accuracy': 0.7340490211611209, 'precision': 0.6265223627505095, 'recall': 0.5807607065076413, 'iou': 0.4528164088726044, 'dice': 0.5933392960092295}
Test   -> {'loss': 28.587923049926758, 'accuracy': 0.5456194281578064, 'precision': 0.3099466860294342, 'recall': 0.3309028446674347, 'iou': 0.19814610481262207, 'dice': 0.26575928926467896}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5974544260812842, 'accuracy': 0.7348104798275491, 'precision': 0.6287870241248089, 'recall': 0.5831333077472189, 'iou': 0.45345634170200516, 'dice': 0.5931148668994074}
Test   -> {'loss': 23.822830200195312, 'accuracy': 0.5543972849845886, 'precision': 0.283485472202301, 'recall': 0.3248750567436218, 'iou': 0.19924525916576385, 'dice': 0.2649890184402466}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5847857578941014, 'accuracy': 0.74064395894175, 'precision': 0.6398923350417096, 'recall': 0.5934494806372601, 'iou': 0.46522631800693015, 'dice': 0.6072650183802065}
Test   -> {'loss': 25.527503967285156, 'accuracy': 0.5740032196044922, 'precision': 0.2930293083190918, 'recall': 0.33466124534606934, 'iou': 0.21210217475891113, 'dice': 0.2800407409667969}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.578838735041411, 'accuracy': 0.74291636477346, 'precision': 0.6447495185810587, 'recall': 0.5984872455182283, 'iou': 0.47006497979164125, 'dice': 0.6128262623496677}
Test   -> {'loss': 24.318134307861328, 'accuracy': 0.5263768434524536, 'precision': 0.32083195447921753, 'recall': 0.33109575510025024, 'iou': 0.1930091828107834, 'dice': 0.26236242055892944}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 9 with IoU 0.21210217475891113
Test -> {'loss': 25.527503967285156, 'accuracy': 0.5740032196044922, 'precision': 0.2930293083190918, 'recall': 0.33466124534606934, 'iou': 0.21210217475891113, 'dice': 0.2800407409667969} 
Train -> {'loss': 0.5847857578941014, 'accuracy': 0.74064395894175, 'precision': 0.6398923350417096, 'recall': 0.5934494806372601, 'iou': 0.46522631800693015, 'dice': 0.6072650183802065} 

Best model saved for model efficientunet at epoch 10

Trial 12:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.42018931922705277, 'accuracy': 0.7588843892449918, 'precision': 0.5899819871653681, 'recall': 0.5828140538671742, 'iou': 0.4623695946905924, 'dice': 0.5817399981229202}
Test   -> {'loss': 0.6004898548126221, 'accuracy': 0.5611971020698547, 'precision': 0.45158109068870544, 'recall': 0.45463788509368896, 'iou': 0.29103508591651917, 'dice': 0.40775784850120544}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4673511722813482, 'accuracy': 0.6995780898177105, 'precision': 0.5430307793876399, 'recall': 0.5392145474319873, 'iou': 0.4114197526289069, 'dice': 0.5364496491525484}
Test   -> {'loss': 0.6878406405448914, 'accuracy': 0.4042208790779114, 'precision': 0.38030537962913513, 'recall': 0.36872440576553345, 'iou': 0.21599844098091125, 'dice': 0.3361082077026367}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6082968740359597, 'accuracy': 0.5472097325584163, 'precision': 0.4219059826239296, 'recall': 0.4269561123588811, 'iou': 0.2895473424507224, 'dice': 0.417571199717729}
Test   -> {'loss': 0.6373801827430725, 'accuracy': 0.4635084271430969, 'precision': 0.4202558994293213, 'recall': 0.41088542342185974, 'iou': 0.24912875890731812, 'dice': 0.3706468939781189}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6292061007541159, 'accuracy': 0.5028005726959395, 'precision': 0.4035657443430113, 'recall': 0.40901903056580086, 'iou': 0.2657075524978016, 'dice': 0.394541156421537}
Test   -> {'loss': 0.6747722625732422, 'accuracy': 0.49620959162712097, 'precision': 0.39233192801475525, 'recall': 0.3734884262084961, 'iou': 0.23872971534729004, 'dice': 0.34726208448410034}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6521233892959097, 'accuracy': 0.4496469189291415, 'precision': 0.3770314264556636, 'recall': 0.37938552395157193, 'iou': 0.23633871655101363, 'dice': 0.3609545872263286}
Test   -> {'loss': 0.6980855464935303, 'accuracy': 0.3695055842399597, 'precision': 0.32939204573631287, 'recall': 0.33012980222702026, 'iou': 0.19938623905181885, 'dice': 0.32344502210617065}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6950624326001043, 'accuracy': 0.3712428691594497, 'precision': 0.3425382160622141, 'recall': 0.34266499617825386, 'iou': 0.19279969652061876, 'dice': 0.3088911086320877}
Test   -> {'loss': 0.6843774914741516, 'accuracy': 0.4117867648601532, 'precision': 0.3298049569129944, 'recall': 0.3299468159675598, 'iou': 0.2075161337852478, 'dice': 0.3272254765033722}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7039286820784859, 'accuracy': 0.3740811333708141, 'precision': 0.33166226109732755, 'recall': 0.3332960951587428, 'iou': 0.18749259865802267, 'dice': 0.29908427466516907}
Test   -> {'loss': 0.7157279253005981, 'accuracy': 0.3112867772579193, 'precision': 0.33220991492271423, 'recall': 0.3314427137374878, 'iou': 0.1750895231962204, 'dice': 0.29329022765159607}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7005826677965081, 'accuracy': 0.3520638531964758, 'precision': 0.33306172839973286, 'recall': 0.33280050171458203, 'iou': 0.184906574630219, 'dice': 0.30275209934815117}
Test   -> {'loss': 0.7024248838424683, 'accuracy': 0.3400517702102661, 'precision': 0.332537442445755, 'recall': 0.3316583037376404, 'iou': 0.18834653496742249, 'dice': 0.3102509677410126}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6974087839541228, 'accuracy': 0.3579463532437449, 'precision': 0.33347027690514275, 'recall': 0.3339146237010541, 'iou': 0.18798174398100895, 'dice': 0.30592830945616184}
Test   -> {'loss': 0.7042704820632935, 'accuracy': 0.34794771671295166, 'precision': 0.33073481917381287, 'recall': 0.33083340525627136, 'iou': 0.1873437762260437, 'dice': 0.3069002330303192}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6992519497871399, 'accuracy': 0.35420706531275875, 'precision': 0.3326736258423847, 'recall': 0.33352688343628595, 'iou': 0.18628741282483804, 'dice': 0.3041095554828644}
Test   -> {'loss': 0.7112032175064087, 'accuracy': 0.3298850357532501, 'precision': 0.33086544275283813, 'recall': 0.3314909338951111, 'iou': 0.17931219935417175, 'dice': 0.29673099517822266}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 1 with IoU 0.29103508591651917
Test -> {'loss': 0.6004898548126221, 'accuracy': 0.5611971020698547, 'precision': 0.45158109068870544, 'recall': 0.45463788509368896, 'iou': 0.29103508591651917, 'dice': 0.40775784850120544} 
Train -> {'loss': 0.42018931922705277, 'accuracy': 0.7588843892449918, 'precision': 0.5899819871653681, 'recall': 0.5828140538671742, 'iou': 0.4623695946905924, 'dice': 0.5817399981229202} 

Best model saved for model efficientunet at epoch 10

Trial 13:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.43733234198197074, 'accuracy': 0.7386543947717418, 'precision': 0.5736721334250077, 'recall': 0.5727108888004138, 'iou': 0.448345141566318, 'dice': 0.5672105156857035}
Test   -> {'loss': 0.751711905002594, 'accuracy': 0.5211997628211975, 'precision': 0.31396913528442383, 'recall': 0.32415568828582764, 'iou': 0.20024123787879944, 'dice': 0.277182400226593}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.39849204602448834, 'accuracy': 0.7849240453346916, 'precision': 0.6063169007715972, 'recall': 0.6029768352923186, 'iou': 0.48908538092737613, 'dice': 0.6034428311430889}
Test   -> {'loss': 0.7684803009033203, 'accuracy': 0.49539026618003845, 'precision': 0.3299851417541504, 'recall': 0.33098968863487244, 'iou': 0.19098663330078125, 'dice': 0.2685108780860901}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.39094759122185085, 'accuracy': 0.793715646992559, 'precision': 0.6137859531070875, 'recall': 0.6108597009078316, 'iou': 0.4988776103309963, 'dice': 0.6111030298730601}
Test   -> {'loss': 0.7388955354690552, 'accuracy': 0.6025041937828064, 'precision': 0.4338638484477997, 'recall': 0.3411901891231537, 'iou': 0.2127957046031952, 'dice': 0.27270978689193726}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3861441218334696, 'accuracy': 0.799113903356635, 'precision': 0.6183704272560452, 'recall': 0.6159909968790801, 'iou': 0.5051549159962198, 'dice': 0.6159442398859107}
Test   -> {'loss': 0.7088155746459961, 'accuracy': 0.5146123170852661, 'precision': 0.39316830039024353, 'recall': 0.35711655020713806, 'iou': 0.22486615180969238, 'dice': 0.3186740577220917}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3835535287857056, 'accuracy': 0.8019399876179902, 'precision': 0.6207969541135041, 'recall': 0.6188053773797076, 'iou': 0.5085217543270277, 'dice': 0.6185399179873259}
Test   -> {'loss': 0.7633664608001709, 'accuracy': 0.4810628890991211, 'precision': 0.34331798553466797, 'recall': 0.3348202705383301, 'iou': 0.21291415393352509, 'dice': 0.3103088140487671}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.38152266170667565, 'accuracy': 0.8045480204665143, 'precision': 0.6232649243396261, 'recall': 0.6206403193266495, 'iou': 0.5111685255299444, 'dice': 0.6206248127895853}
Test   -> {'loss': 0.7102769017219543, 'accuracy': 0.48642247915267944, 'precision': 0.39654165506362915, 'recall': 0.38013380765914917, 'iou': 0.240444153547287, 'dice': 0.35146045684814453}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3797941612160724, 'accuracy': 0.8071442246437073, 'precision': 0.6259800631067027, 'recall': 0.6223006849703582, 'iou': 0.5133832195530768, 'dice': 0.6223706105481024}
Test   -> {'loss': 0.7132932543754578, 'accuracy': 0.4198835492134094, 'precision': 0.3725780248641968, 'recall': 0.3709533214569092, 'iou': 0.2166503667831421, 'dice': 0.3329239785671234}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3890869005866673, 'accuracy': 0.795906548914702, 'precision': 0.6155102460280709, 'recall': 0.6133637640787207, 'iou': 0.5017685071281764, 'dice': 0.6132537945457127}
Test   -> {'loss': 0.7354580760002136, 'accuracy': 0.3835614323616028, 'precision': 0.3496384620666504, 'recall': 0.34746479988098145, 'iou': 0.19703587889671326, 'dice': 0.31007230281829834}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4026539781819219, 'accuracy': 0.7794557182685189, 'precision': 0.6018360023913176, 'recall': 0.6001183976297794, 'iou': 0.4843623881754668, 'dice': 0.599660271147023}
Test   -> {'loss': 0.7319641709327698, 'accuracy': 0.530788779258728, 'precision': 0.369712769985199, 'recall': 0.3471314609050751, 'iou': 0.21830737590789795, 'dice': 0.3046802282333374}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.4183184913966967, 'accuracy': 0.7630713011907495, 'precision': 0.5879550213399141, 'recall': 0.5819137583608213, 'iou': 0.46449738222619763, 'dice': 0.583605342325957}
Test   -> {'loss': 0.8356072902679443, 'accuracy': 0.18081384897232056, 'precision': 0.3046989142894745, 'recall': 0.3244361877441406, 'iou': 0.10333909839391708, 'dice': 0.18566447496414185}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 6 with IoU 0.240444153547287
Test -> {'loss': 0.7102769017219543, 'accuracy': 0.48642247915267944, 'precision': 0.39654165506362915, 'recall': 0.38013380765914917, 'iou': 0.240444153547287, 'dice': 0.35146045684814453} 
Train -> {'loss': 0.38152266170667565, 'accuracy': 0.8045480204665143, 'precision': 0.6232649243396261, 'recall': 0.6206403193266495, 'iou': 0.5111685255299444, 'dice': 0.6206248127895853} 

Best model saved for model efficientunet at epoch 10

Trial 14:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7204659928446231, 'accuracy': 0.37211426418760546, 'precision': 0.33646768927574155, 'recall': 0.3374291602684104, 'iou': 0.18077083366072697, 'dice': 0.28938937245503715}
Test   -> {'loss': 0.6958221197128296, 'accuracy': 0.3379005789756775, 'precision': 0.3330495357513428, 'recall': 0.33102381229400635, 'iou': 0.19228367507457733, 'dice': 0.3180896043777466}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6936248470907626, 'accuracy': 0.3744218419427457, 'precision': 0.33327861091364985, 'recall': 0.33367901431477587, 'iou': 0.19253831862107568, 'dice': 0.3099334618319636}
Test   -> {'loss': 0.7082081437110901, 'accuracy': 0.34848207235336304, 'precision': 0.33431875705718994, 'recall': 0.3343368470668793, 'iou': 0.18771778047084808, 'dice': 0.30795955657958984}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6917276188083317, 'accuracy': 0.38097248492033586, 'precision': 0.336371947630592, 'recall': 0.3363825930201489, 'iou': 0.1953708414150321, 'dice': 0.3114139556884766}
Test   -> {'loss': 0.7000614404678345, 'accuracy': 0.34799256920814514, 'precision': 0.3343847990036011, 'recall': 0.33437222242355347, 'iou': 0.19088086485862732, 'dice': 0.3136748671531677}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7388976555803548, 'accuracy': 0.36534560659657356, 'precision': 0.3184126570172932, 'recall': 0.3013280811517135, 'iou': 0.16775880974272023, 'dice': 0.26351117154826287}
Test   -> {'loss': 0.6802857518196106, 'accuracy': 0.4515268802642822, 'precision': 0.3531671166419983, 'recall': 0.3565915524959564, 'iou': 0.2204136848449707, 'dice': 0.3375174403190613}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7551734167596568, 'accuracy': 0.36143487186535544, 'precision': 0.31213023092435754, 'recall': 0.28832337078840836, 'iou': 0.1584498428132223, 'dice': 0.2468887447015099}
Test   -> {'loss': 0.6797906160354614, 'accuracy': 0.4476953446865082, 'precision': 0.35195255279541016, 'recall': 0.35549241304397583, 'iou': 0.22057220339775085, 'dice': 0.33788734674453735}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7549979865550995, 'accuracy': 0.36176510181116023, 'precision': 0.31211623614249023, 'recall': 0.28870110252629155, 'iou': 0.1586271275644717, 'dice': 0.24711105914219567}
Test   -> {'loss': 0.7039406895637512, 'accuracy': 0.42357775568962097, 'precision': 0.3371385931968689, 'recall': 0.3444335460662842, 'iou': 0.20113502442836761, 'dice': 0.3123760521411896}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7091488651607347, 'accuracy': 0.3400294866250909, 'precision': 0.3345285011374432, 'recall': 0.33115997949372167, 'iou': 0.17923323090957557, 'dice': 0.293833106820998}
Test   -> {'loss': 0.7084003686904907, 'accuracy': 0.36707165837287903, 'precision': 0.33323952555656433, 'recall': 0.33245059847831726, 'iou': 0.1861126869916916, 'dice': 0.2998341917991638}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6962590505247531, 'accuracy': 0.3640715481146522, 'precision': 0.33135286751000775, 'recall': 0.3307562031175779, 'iou': 0.18952528808427893, 'dice': 0.3071352948313174}
Test   -> {'loss': 0.711310625076294, 'accuracy': 0.33768758177757263, 'precision': 0.3288376033306122, 'recall': 0.32890814542770386, 'iou': 0.1863493174314499, 'dice': 0.3070027232170105}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6995748066383859, 'accuracy': 0.3588251564813697, 'precision': 0.3288376079953235, 'recall': 0.32832542320956354, 'iou': 0.18684099750674288, 'dice': 0.3038241526354914}
Test   -> {'loss': 0.7101255655288696, 'accuracy': 0.34182676672935486, 'precision': 0.3274949789047241, 'recall': 0.3282255530357361, 'iou': 0.18683628737926483, 'dice': 0.30721914768218994}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6872719785441523, 'accuracy': 0.3925040728372076, 'precision': 0.3327651030343512, 'recall': 0.33273162245750426, 'iou': 0.19841544556876886, 'dice': 0.31616107678931693}
Test   -> {'loss': 0.719985842704773, 'accuracy': 0.35774075984954834, 'precision': 0.33408603072166443, 'recall': 0.3339654803276062, 'iou': 0.183428093791008, 'dice': 0.29499098658561707}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 5 with IoU 0.22057220339775085
Test -> {'loss': 0.6797906160354614, 'accuracy': 0.4476953446865082, 'precision': 0.35195255279541016, 'recall': 0.35549241304397583, 'iou': 0.22057220339775085, 'dice': 0.33788734674453735} 
Train -> {'loss': 0.7551734167596568, 'accuracy': 0.36143487186535544, 'precision': 0.31213023092435754, 'recall': 0.28832337078840836, 'iou': 0.1584498428132223, 'dice': 0.2468887447015099} 

Best model saved for model efficientunet at epoch 10

Trial 15:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7240500797396121, 'accuracy': 0.356412784172141, 'precision': 0.3399405440558558, 'recall': 0.34058490369630895, 'iou': 0.18154689954674763, 'dice': 0.2874881879143093}
Test   -> {'loss': 0.6957570314407349, 'accuracy': 0.39644014835357666, 'precision': 0.3473955988883972, 'recall': 0.34399113059043884, 'iou': 0.20311307907104492, 'dice': 0.32413172721862793}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7431584710660188, 'accuracy': 0.30941749370616417, 'precision': 0.32392216247061023, 'recall': 0.32871156775433086, 'iou': 0.16068438835766005, 'dice': 0.26763717609903087}
Test   -> {'loss': 0.7158368825912476, 'accuracy': 0.3255798816680908, 'precision': 0.3334120213985443, 'recall': 0.3332875669002533, 'iou': 0.17769324779510498, 'dice': 0.2967720031738281}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7067519675130429, 'accuracy': 0.34777898995772655, 'precision': 0.3334693742835003, 'recall': 0.3329724011213883, 'iou': 0.18126365892265153, 'dice': 0.29744654479234117}
Test   -> {'loss': 0.7044720649719238, 'accuracy': 0.36081522703170776, 'precision': 0.3306834101676941, 'recall': 0.33058667182922363, 'iou': 0.19239285588264465, 'dice': 0.3120311200618744}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6849125027656555, 'accuracy': 0.4036541506000187, 'precision': 0.3321088969707489, 'recall': 0.3321402785570725, 'iou': 0.2020250177901724, 'dice': 0.31859957238902215}
Test   -> {'loss': 0.7403608560562134, 'accuracy': 0.3382459282875061, 'precision': 0.33162832260131836, 'recall': 0.33411189913749695, 'iou': 0.16727954149246216, 'dice': 0.26758337020874023}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.688462129364843, 'accuracy': 0.42882353715274646, 'precision': 0.3332190207813097, 'recall': 0.3337272250134012, 'iou': 0.20278542845145517, 'dice': 0.31485857289770375}
Test   -> {'loss': 0.734308123588562, 'accuracy': 0.3410806357860565, 'precision': 0.33226022124290466, 'recall': 0.3326505124568939, 'iou': 0.17346405982971191, 'dice': 0.27968674898147583}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6876617146574933, 'accuracy': 0.42530482981515966, 'precision': 0.3325312614440918, 'recall': 0.332864174635514, 'iou': 0.20269555501315906, 'dice': 0.31574560066928037}
Test   -> {'loss': 0.7368975281715393, 'accuracy': 0.3496464192867279, 'precision': 0.33238860964775085, 'recall': 0.33458825945854187, 'iou': 0.1704900562763214, 'dice': 0.2713041603565216}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6871100829995197, 'accuracy': 0.4208382935627647, 'precision': 0.33252768568370655, 'recall': 0.3328080011450726, 'iou': 0.20229543447494508, 'dice': 0.31634925733441893}
Test   -> {'loss': 0.7367779016494751, 'accuracy': 0.3428266942501068, 'precision': 0.33099865913391113, 'recall': 0.3321700692176819, 'iou': 0.1708124876022339, 'dice': 0.27435633540153503}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6897675027018008, 'accuracy': 0.4232756485109744, 'precision': 0.3312846847202467, 'recall': 0.33241293663563937, 'iou': 0.20113739319469617, 'dice': 0.3135907639627871}
Test   -> {'loss': 0.733502209186554, 'accuracy': 0.35070332884788513, 'precision': 0.335207998752594, 'recall': 0.3335859775543213, 'iou': 0.17215582728385925, 'dice': 0.27377423644065857}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6863547278487164, 'accuracy': 0.4267071070878402, 'precision': 0.3331620286340299, 'recall': 0.334322058117908, 'iou': 0.20371637888576674, 'dice': 0.3170170986134073}
Test   -> {'loss': 0.7377831339836121, 'accuracy': 0.34854093194007874, 'precision': 0.3337399363517761, 'recall': 0.33372053503990173, 'iou': 0.17104606330394745, 'dice': 0.27209776639938354}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6859044500019239, 'accuracy': 0.42676117627517035, 'precision': 0.333308744430542, 'recall': 0.3342661562173263, 'iou': 0.20400330657544344, 'dice': 0.3174992499144181}
Test   -> {'loss': 0.7308864593505859, 'accuracy': 0.3567862808704376, 'precision': 0.334892213344574, 'recall': 0.33285602927207947, 'iou': 0.17506317794322968, 'dice': 0.2781238257884979}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 1 with IoU 0.20311307907104492
Test -> {'loss': 0.6957570314407349, 'accuracy': 0.39644014835357666, 'precision': 0.3473955988883972, 'recall': 0.34399113059043884, 'iou': 0.20311307907104492, 'dice': 0.32413172721862793} 
Train -> {'loss': 0.7240500797396121, 'accuracy': 0.356412784172141, 'precision': 0.3399405440558558, 'recall': 0.34058490369630895, 'iou': 0.18154689954674763, 'dice': 0.2874881879143093} 

Best model saved for model efficientunet at epoch 10

Trial 16:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4672024855147237, 'accuracy': 0.8168981559898543, 'precision': 0.6651443145845247, 'recall': 0.609559867563455, 'iou': 0.5055444195866585, 'dice': 0.5754063463729361}
Test   -> {'loss': 17.792224884033203, 'accuracy': 0.5491992831230164, 'precision': 0.5342471599578857, 'recall': 0.33387869596481323, 'iou': 0.18369325995445251, 'dice': 0.23760512471199036}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.38535007173600405, 'accuracy': 0.8430523525113645, 'precision': 0.6991416096687317, 'recall': 0.6340846867665001, 'iou': 0.5386001387368078, 'dice': 0.6044688662757044}
Test   -> {'loss': 36.42497253417969, 'accuracy': 0.5360655188560486, 'precision': 0.2958916127681732, 'recall': 0.31417012214660645, 'iou': 0.2119770497083664, 'dice': 0.29606735706329346}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.34329539997422176, 'accuracy': 0.8560742199420929, 'precision': 0.7229062298069829, 'recall': 0.6661747196446295, 'iou': 0.5791253227254619, 'dice': 0.6581256845723028}
Test   -> {'loss': 191.7593536376953, 'accuracy': 0.5687168836593628, 'precision': 0.352463960647583, 'recall': 0.34322845935821533, 'iou': 0.21320270001888275, 'dice': 0.28718191385269165}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.31295493018368015, 'accuracy': 0.8666353972061821, 'precision': 0.7447794574758281, 'recall': 0.6950132258560346, 'iou': 0.6116425840750984, 'dice': 0.697628646052402}
Test   -> {'loss': 52.28660202026367, 'accuracy': 0.4846216142177582, 'precision': 0.3410211503505707, 'recall': 0.34438619017601013, 'iou': 0.21881824731826782, 'dice': 0.3246026039123535}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2848144901187524, 'accuracy': 0.8778441488742829, 'precision': 0.7686504024526347, 'recall': 0.7319239909234254, 'iou': 0.6488442641237507, 'dice': 0.7407218868317811}
Test   -> {'loss': 13.734410285949707, 'accuracy': 0.4457422196865082, 'precision': 0.3605585992336273, 'recall': 0.3612590432167053, 'iou': 0.23256716132164001, 'dice': 0.35898566246032715}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.26603813456452413, 'accuracy': 0.8854438763597737, 'precision': 0.784438568353653, 'recall': 0.7548996909804966, 'iou': 0.6710835666760154, 'dice': 0.7640308465646661}
Test   -> {'loss': 20.69887924194336, 'accuracy': 0.5344250798225403, 'precision': 0.4407655596733093, 'recall': 0.3396197259426117, 'iou': 0.1915757656097412, 'dice': 0.25642532110214233}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.24759995419046152, 'accuracy': 0.8933248154495074, 'precision': 0.7997303890145343, 'recall': 0.778017994372741, 'iou': 0.693010964082635, 'dice': 0.785815949284512}
Test   -> {'loss': 4.8858208656311035, 'accuracy': 0.5328219532966614, 'precision': 0.32773357629776, 'recall': 0.3390422463417053, 'iou': 0.21990478038787842, 'dice': 0.30727118253707886}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2326912016324375, 'accuracy': 0.8996042171250219, 'precision': 0.8118763817393262, 'recall': 0.7929745311322419, 'iou': 0.7084889989832174, 'dice': 0.8001734482205433}
Test   -> {'loss': 3.2579293251037598, 'accuracy': 0.5881746411323547, 'precision': 0.3393905758857727, 'recall': 0.34626245498657227, 'iou': 0.24039416015148163, 'dice': 0.32526537775993347}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.22315742451211681, 'accuracy': 0.9035938198151796, 'precision': 0.8194092089715211, 'recall': 0.8039792724277662, 'iou': 0.719090700926988, 'dice': 0.8098644062228825}
Test   -> {'loss': 7.356141567230225, 'accuracy': 0.5707547068595886, 'precision': 0.37484878301620483, 'recall': 0.34684857726097107, 'iou': 0.22444842755794525, 'dice': 0.30166947841644287}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.21592376478340314, 'accuracy': 0.9067772896393486, 'precision': 0.8259566011636154, 'recall': 0.810376773191535, 'iou': 0.7264696592869966, 'dice': 0.8164108900920205}
Test   -> {'loss': 2.495558261871338, 'accuracy': 0.5953456163406372, 'precision': 0.556541919708252, 'recall': 0.41116762161254883, 'iou': 0.27115553617477417, 'dice': 0.37021273374557495}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.27115553617477417
Test -> {'loss': 2.495558261871338, 'accuracy': 0.5953456163406372, 'precision': 0.556541919708252, 'recall': 0.41116762161254883, 'iou': 0.27115553617477417, 'dice': 0.37021273374557495} 
Train -> {'loss': 0.21592376478340314, 'accuracy': 0.9067772896393486, 'precision': 0.8259566011636154, 'recall': 0.810376773191535, 'iou': 0.7264696592869966, 'dice': 0.8164108900920205} 

Best model saved for model efficientunet at epoch 10

Trial 17:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4897387680800065, 'accuracy': 0.8020112923953844, 'precision': 0.6437887425008028, 'recall': 0.6032181594682776, 'iou': 0.5012850696625917, 'dice': 0.576947908297829}
Test   -> {'loss': 22.049949645996094, 'accuracy': 0.4789637327194214, 'precision': 0.34281036257743835, 'recall': 0.34921514987945557, 'iou': 0.22449231147766113, 'dice': 0.33505091071128845}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.34353456963663515, 'accuracy': 0.8561497962993124, 'precision': 0.7243054721666419, 'recall': 0.6622584612473198, 'iou': 0.5748061117918595, 'dice': 0.6506417575089828}
Test   -> {'loss': 17.73863983154297, 'accuracy': 0.5532951951026917, 'precision': 0.2499721497297287, 'recall': 0.3297569155693054, 'iou': 0.18583230674266815, 'dice': 0.2403300404548645}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.2857597967852717, 'accuracy': 0.876707911491394, 'precision': 0.7669854361078013, 'recall': 0.72962573611218, 'iou': 0.645950116281924, 'dice': 0.7378098638161369}
Test   -> {'loss': 13.387269020080566, 'accuracy': 0.6097196936607361, 'precision': 0.4679287075996399, 'recall': 0.34632524847984314, 'iou': 0.22569411993026733, 'dice': 0.29612427949905396}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2525020148443139, 'accuracy': 0.891123148151066, 'precision': 0.7960657016090725, 'recall': 0.7666312347287717, 'iou': 0.6835006791612376, 'dice': 0.7761438846588135}
Test   -> {'loss': 12.329975128173828, 'accuracy': 0.5710909962654114, 'precision': 0.4634953439235687, 'recall': 0.3347150683403015, 'iou': 0.1985635757446289, 'dice': 0.25782597064971924}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.23564501767573148, 'accuracy': 0.8984375507935234, 'precision': 0.8103121726409249, 'recall': 0.7835575217786043, 'iou': 0.7013145493424457, 'dice': 0.7932143346123074}
Test   -> {'loss': 16.52538299560547, 'accuracy': 0.5482233762741089, 'precision': 0.37474876642227173, 'recall': 0.3447735011577606, 'iou': 0.2109737992286682, 'dice': 0.2871968746185303}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.21693284213542938, 'accuracy': 0.9063160015189129, 'precision': 0.8258356581563535, 'recall': 0.8029665584149568, 'iou': 0.7213049505067908, 'dice': 0.811561600021694}
Test   -> {'loss': 13.451225280761719, 'accuracy': 0.46425798535346985, 'precision': 0.40743693709373474, 'recall': 0.33920904994010925, 'iou': 0.2017868459224701, 'dice': 0.2937504053115845}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.20791524830071823, 'accuracy': 0.9112259232479593, 'precision': 0.8353716093560923, 'recall': 0.8138873136561849, 'iou': 0.7330176840657773, 'dice': 0.821620033616605}
Test   -> {'loss': 27.430763244628906, 'accuracy': 0.5228610634803772, 'precision': 0.35812968015670776, 'recall': 0.333469957113266, 'iou': 0.19878432154655457, 'dice': 0.27622097730636597}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.19052481068217236, 'accuracy': 0.9179255806881449, 'precision': 0.8467399861501611, 'recall': 0.8336512762567271, 'iou': 0.7527433333189592, 'dice': 0.8391343666159589}
Test   -> {'loss': 20.61083984375, 'accuracy': 0.5469930171966553, 'precision': 0.3644334673881531, 'recall': 0.34715136885643005, 'iou': 0.2352355569601059, 'dice': 0.33378908038139343}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.18183202743530275, 'accuracy': 0.9220896985219873, 'precision': 0.8552884729012199, 'recall': 0.8401372043982797, 'iou': 0.7617088773976202, 'dice': 0.846253168064615}
Test   -> {'loss': 20.437335968017578, 'accuracy': 0.5319117307662964, 'precision': 0.3469123840332031, 'recall': 0.33735883235931396, 'iou': 0.22266694903373718, 'dice': 0.3170049786567688}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.17347050944100256, 'accuracy': 0.9255776607471964, 'precision': 0.8620141366253729, 'recall': 0.8482693775840427, 'iou': 0.7705800554026728, 'dice': 0.85351649781932}
Test   -> {'loss': 16.87320327758789, 'accuracy': 0.5232954621315002, 'precision': 0.396698534488678, 'recall': 0.3635365962982178, 'iou': 0.24129679799079895, 'dice': 0.34899359941482544}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 10 with IoU 0.24129679799079895
Test -> {'loss': 16.87320327758789, 'accuracy': 0.5232954621315002, 'precision': 0.396698534488678, 'recall': 0.3635365962982178, 'iou': 0.24129679799079895, 'dice': 0.34899359941482544} 
Train -> {'loss': 0.17347050944100256, 'accuracy': 0.9255776607471964, 'precision': 0.8620141366253729, 'recall': 0.8482693775840427, 'iou': 0.7705800554026728, 'dice': 0.85351649781932} 

Best model saved for model efficientunet at epoch 10

Trial 18:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 126.41249221692915, 'accuracy': 0.6021277906454128, 'precision': 0.46849225824293883, 'recall': 0.4695000772242961, 'iou': 0.33654335944548897, 'dice': 0.45247443791316905}
Test   -> {'loss': 34.20497512817383, 'accuracy': 0.4122214615345001, 'precision': 0.301087886095047, 'recall': 0.30267828702926636, 'iou': 0.18969063460826874, 'dice': 0.29596686363220215}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7552500476007876, 'accuracy': 0.7257171141064686, 'precision': 0.5297948145348093, 'recall': 0.53581757053085, 'iou': 0.40988438634768776, 'dice': 0.5092479419449102}
Test   -> {'loss': 22.798179626464844, 'accuracy': 0.5044667720794678, 'precision': 0.30917561054229736, 'recall': 0.3156367540359497, 'iou': 0.2097950279712677, 'dice': 0.30335813760757446}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7050743634286134, 'accuracy': 0.7389638703802358, 'precision': 0.5397556269946305, 'recall': 0.5451208732698275, 'iou': 0.4201491767945497, 'dice': 0.5152966571890789}
Test   -> {'loss': 17.347400665283203, 'accuracy': 0.6213229298591614, 'precision': 0.3019941449165344, 'recall': 0.32599544525146484, 'iou': 0.22034840285778046, 'dice': 0.2808114290237427}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6830555278321971, 'accuracy': 0.7449551724869272, 'precision': 0.5462542607732441, 'recall': 0.5490429818630218, 'iou': 0.4250594473403433, 'dice': 0.5184206426143646}
Test   -> {'loss': 17.783838272094727, 'accuracy': 0.5377197265625, 'precision': 0.30611228942871094, 'recall': 0.32211795449256897, 'iou': 0.2072155475616455, 'dice': 0.28648099303245544}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6655302921067113, 'accuracy': 0.7503855109214783, 'precision': 0.5510814027941745, 'recall': 0.5528682428857554, 'iou': 0.4301298703836358, 'dice': 0.5221808679725812}
Test   -> {'loss': 18.040809631347656, 'accuracy': 0.5208017826080322, 'precision': 0.31061217188835144, 'recall': 0.32758858799934387, 'iou': 0.19369779527187347, 'dice': 0.2677472233772278}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6577499032020568, 'accuracy': 0.7530588372893955, 'precision': 0.5538476299980413, 'recall': 0.5545601958813875, 'iou': 0.43255275099173834, 'dice': 0.5239040250363557}
Test   -> {'loss': 18.22334098815918, 'accuracy': 0.5154717564582825, 'precision': 0.30952557921409607, 'recall': 0.32526111602783203, 'iou': 0.19171670079231262, 'dice': 0.26617431640625}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6421271013176959, 'accuracy': 0.7579501947631007, 'precision': 0.5620833232350971, 'recall': 0.5582151957180189, 'iou': 0.4372980110023333, 'dice': 0.5272964553988498}
Test   -> {'loss': 18.199106216430664, 'accuracy': 0.6152380704879761, 'precision': 0.3038308024406433, 'recall': 0.3275900185108185, 'iou': 0.213748037815094, 'dice': 0.2710900902748108}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6363504788149958, 'accuracy': 0.7597934305667877, 'precision': 0.5650499470855879, 'recall': 0.5596852242946625, 'iou': 0.439313928199851, 'dice': 0.5288668242485627}
Test   -> {'loss': 15.81053352355957, 'accuracy': 0.6142441034317017, 'precision': 0.3753453493118286, 'recall': 0.3481932282447815, 'iou': 0.231700599193573, 'dice': 0.3051624000072479}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6284793952237004, 'accuracy': 0.7627554823522983, 'precision': 0.5669752880283024, 'recall': 0.562222028815228, 'iou': 0.4423950900202212, 'dice': 0.5312110408492711}
Test   -> {'loss': 18.019027709960938, 'accuracy': 0.6205207705497742, 'precision': 0.3104221224784851, 'recall': 0.3331500291824341, 'iou': 0.22180330753326416, 'dice': 0.2850438356399536}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6183158126862153, 'accuracy': 0.766124464377113, 'precision': 0.5685191250365713, 'recall': 0.5646557862343995, 'iou': 0.4456553065258524, 'dice': 0.5332938855109007}
Test   -> {'loss': 17.97478485107422, 'accuracy': 0.4982897639274597, 'precision': 0.291836678981781, 'recall': 0.3058256506919861, 'iou': 0.19124838709831238, 'dice': 0.2714327275753021}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 8 with IoU 0.231700599193573
Test -> {'loss': 15.81053352355957, 'accuracy': 0.6142441034317017, 'precision': 0.3753453493118286, 'recall': 0.3481932282447815, 'iou': 0.231700599193573, 'dice': 0.3051624000072479} 
Train -> {'loss': 0.6363504788149958, 'accuracy': 0.7597934305667877, 'precision': 0.5650499470855879, 'recall': 0.5596852242946625, 'iou': 0.439313928199851, 'dice': 0.5288668242485627} 

Best model saved for model efficientunet at epoch 10

Trial 19:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1001.9612721526105, 'accuracy': 0.4182256167349608, 'precision': 0.37516942879428034, 'recall': 0.3717523502266925, 'iou': 0.22639138556045035, 'dice': 0.34486269795376323}
Test   -> {'loss': 8256.4697265625, 'accuracy': 0.38567087054252625, 'precision': 0.33237424492836, 'recall': 0.33750849962234497, 'iou': 0.19410336017608643, 'dice': 0.30594560503959656}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 6.317831499680229, 'accuracy': 0.6210802130077197, 'precision': 0.4838601361150327, 'recall': 0.48282048028448354, 'iou': 0.3549226206281911, 'dice': 0.4817406830580338}
Test   -> {'loss': 198.8306884765625, 'accuracy': 0.4640699028968811, 'precision': 0.3605028986930847, 'recall': 0.36484092473983765, 'iou': 0.23447954654693604, 'dice': 0.35674914717674255}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 1.2450552318407142, 'accuracy': 0.6547343378481658, 'precision': 0.5011884228042934, 'recall': 0.5035148791644884, 'iou': 0.3772129963273587, 'dice': 0.5004128378370534}
Test   -> {'loss': 122.9698486328125, 'accuracy': 0.4368622303009033, 'precision': 0.33074626326560974, 'recall': 0.3331817388534546, 'iou': 0.207271546125412, 'dice': 0.31945300102233887}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.9647879066674606, 'accuracy': 0.6791855900183968, 'precision': 0.5127121028692826, 'recall': 0.5165351354557535, 'iou': 0.39146334192027216, 'dice': 0.5095033868499425}
Test   -> {'loss': 101.77025604248047, 'accuracy': 0.385248601436615, 'precision': 0.3719179332256317, 'recall': 0.36494898796081543, 'iou': 0.1962890326976776, 'dice': 0.31584638357162476}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.8544028795283773, 'accuracy': 0.6984623136727707, 'precision': 0.5220172933910204, 'recall': 0.526354388050411, 'iou': 0.40240361638691113, 'dice': 0.5155588232952616}
Test   -> {'loss': 110.2382583618164, 'accuracy': 0.3288838863372803, 'precision': 0.3652876317501068, 'recall': 0.35295289754867554, 'iou': 0.15777115523815155, 'dice': 0.26188141107559204}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.8254248878230219, 'accuracy': 0.7063909053802491, 'precision': 0.5271409428637961, 'recall': 0.531627503167028, 'iou': 0.4076508350994276, 'dice': 0.5183828011803006}
Test   -> {'loss': 76.42354583740234, 'accuracy': 0.389851450920105, 'precision': 0.3827802836894989, 'recall': 0.3750554025173187, 'iou': 0.1956467628479004, 'dice': 0.3137870728969574}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7986547231674195, 'accuracy': 0.7132548446240632, 'precision': 0.5306400537490845, 'recall': 0.5337400405303292, 'iou': 0.409869951268901, 'dice': 0.5175070202868918}
Test   -> {'loss': 107.35345458984375, 'accuracy': 0.3433881402015686, 'precision': 0.37648123502731323, 'recall': 0.3601619601249695, 'iou': 0.16075214743614197, 'dice': 0.26487505435943604}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7767047021699989, 'accuracy': 0.719074595492819, 'precision': 0.5346320395884306, 'recall': 0.538397653206535, 'iou': 0.41475468459336656, 'dice': 0.5211222550143366}
Test   -> {'loss': 48.798828125, 'accuracy': 0.4073760211467743, 'precision': 0.36516353487968445, 'recall': 0.3682595193386078, 'iou': 0.2135365605354309, 'dice': 0.33820468187332153}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7486669851386029, 'accuracy': 0.7274415358253147, 'precision': 0.5396851244180099, 'recall': 0.5419817717179009, 'iou': 0.41822081674700196, 'dice': 0.521132395837618}
Test   -> {'loss': 77.20027160644531, 'accuracy': 0.35059964656829834, 'precision': 0.3843619227409363, 'recall': 0.36542701721191406, 'iou': 0.1734340786933899, 'dice': 0.2839379906654358}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7297243444815926, 'accuracy': 0.732535547795503, 'precision': 0.5428550233011661, 'recall': 0.5447812287703805, 'iou': 0.4212088766305343, 'dice': 0.5221346896627675}
Test   -> {'loss': 72.2587661743164, 'accuracy': 0.3780682682991028, 'precision': 0.37882745265960693, 'recall': 0.3767485022544861, 'iou': 0.1903996467590332, 'dice': 0.30782705545425415}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 2 with IoU 0.23447954654693604
Test -> {'loss': 198.8306884765625, 'accuracy': 0.4640699028968811, 'precision': 0.3605028986930847, 'recall': 0.36484092473983765, 'iou': 0.23447954654693604, 'dice': 0.35674914717674255} 
Train -> {'loss': 6.317831499680229, 'accuracy': 0.6210802130077197, 'precision': 0.4838601361150327, 'recall': 0.48282048028448354, 'iou': 0.3549226206281911, 'dice': 0.4817406830580338} 

Best model saved for model efficientunet at epoch 10

Trial 20:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.45048895918804666, 'accuracy': 0.6835968385572019, 'precision': 0.5798693072536717, 'recall': 0.5599062227684518, 'iou': 0.433007278325765, 'dice': 0.5523457826479622}
Test   -> {'loss': 0.742999792098999, 'accuracy': 0.3407231569290161, 'precision': 0.4037792682647705, 'recall': 0.37734830379486084, 'iou': 0.19774310290813446, 'dice': 0.3244154155254364}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5097165351328643, 'accuracy': 0.6170308487570804, 'precision': 0.5183692054904026, 'recall': 0.501329097022181, 'iou': 0.36906430721282957, 'dice': 0.49497327739777774}
Test   -> {'loss': 0.7467256784439087, 'accuracy': 0.4165225923061371, 'precision': 0.28886064887046814, 'recall': 0.2963483929634094, 'iou': 0.18603989481925964, 'dice': 0.28721219301223755}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6651955184729202, 'accuracy': 0.4173321449238321, 'precision': 0.3494203063456909, 'recall': 0.3501805065766625, 'iou': 0.21796174865701926, 'dice': 0.33889407334120375}
Test   -> {'loss': 0.7090543508529663, 'accuracy': 0.3419824540615082, 'precision': 0.3326495289802551, 'recall': 0.3330751359462738, 'iou': 0.18144439160823822, 'dice': 0.2994615435600281}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6902483427006265, 'accuracy': 0.3530775132386581, 'precision': 0.3337822985389958, 'recall': 0.3336313916289288, 'iou': 0.19150069990883703, 'dice': 0.3136786847010903}
Test   -> {'loss': 0.706831693649292, 'accuracy': 0.34249940514564514, 'precision': 0.33541831374168396, 'recall': 0.3356650471687317, 'iou': 0.18786895275115967, 'dice': 0.30993443727493286}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7008049353309299, 'accuracy': 0.33079781273136966, 'precision': 0.33333839398363363, 'recall': 0.33346824633038563, 'iou': 0.18252504480921705, 'dice': 0.30293771106263867}
Test   -> {'loss': 0.7170542478561401, 'accuracy': 0.3192923367023468, 'precision': 0.33050811290740967, 'recall': 0.33113306760787964, 'iou': 0.17695140838623047, 'dice': 0.29646942019462585}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6869628616001295, 'accuracy': 0.38249545628609866, 'precision': 0.3318213550940804, 'recall': 0.3314479005077611, 'iou': 0.19711577944133593, 'dice': 0.3169528917126034}
Test   -> {'loss': 0.690890371799469, 'accuracy': 0.40916723012924194, 'precision': 0.3325880765914917, 'recall': 0.33141836524009705, 'iou': 0.20280957221984863, 'dice': 0.3204699754714966}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6811163168886434, 'accuracy': 0.41099222859610685, 'precision': 0.33157367486020795, 'recall': 0.3305849438128264, 'iou': 0.20417151263226632, 'dice': 0.32296971873096797}
Test   -> {'loss': 0.6841219663619995, 'accuracy': 0.41214796900749207, 'precision': 0.3351697325706482, 'recall': 0.334100604057312, 'iou': 0.20823106169700623, 'dice': 0.3290944993495941}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6782817350781483, 'accuracy': 0.407758887047353, 'precision': 0.33165259348309556, 'recall': 0.33155513146649235, 'iou': 0.20566772228997687, 'dice': 0.32584375531777093}
Test   -> {'loss': 0.6875709891319275, 'accuracy': 0.4190250337123871, 'precision': 0.33091580867767334, 'recall': 0.3312596082687378, 'iou': 0.20754729211330414, 'dice': 0.3252992033958435}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6717982419159101, 'accuracy': 0.4175515310919803, 'precision': 0.334632264531177, 'recall': 0.3346904516220093, 'iou': 0.21152286361093106, 'dice': 0.3323863501134126}
Test   -> {'loss': 0.6803120970726013, 'accuracy': 0.3760263919830322, 'precision': 0.33584219217300415, 'recall': 0.3360449969768524, 'iou': 0.20256909728050232, 'dice': 0.3265928030014038}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6825358748435975, 'accuracy': 0.3711022930300754, 'precision': 0.33483730373175247, 'recall': 0.3348947399336359, 'iou': 0.1989351428721262, 'dice': 0.3215064311804979}
Test   -> {'loss': 0.7123870849609375, 'accuracy': 0.3401240110397339, 'precision': 0.3313470780849457, 'recall': 0.3310748338699341, 'iou': 0.18505898118019104, 'dice': 0.30437588691711426}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 7 with IoU 0.20823106169700623
Test -> {'loss': 0.6841219663619995, 'accuracy': 0.41214796900749207, 'precision': 0.3351697325706482, 'recall': 0.334100604057312, 'iou': 0.20823106169700623, 'dice': 0.3290944993495941} 
Train -> {'loss': 0.6811163168886434, 'accuracy': 0.41099222859610685, 'precision': 0.33157367486020795, 'recall': 0.3305849438128264, 'iou': 0.20417151263226632, 'dice': 0.32296971873096797} 

Best model saved for model efficientunet at epoch 10

Trial 21:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.39863534181014354, 'accuracy': 0.7795551300048829, 'precision': 0.6235133295473845, 'recall': 0.6120002850242283, 'iou': 0.5064828999664472, 'dice': 0.6047824641932612}
Test   -> {'loss': 0.8007361888885498, 'accuracy': 0.34642183780670166, 'precision': 0.31067603826522827, 'recall': 0.3243619501590729, 'iou': 0.15988950431346893, 'dice': 0.2615850567817688}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.32308258077372676, 'accuracy': 0.8187271522439045, 'precision': 0.6827378889788752, 'recall': 0.676728171887605, 'iou': 0.572886568048726, 'dice': 0.6783455776131672}
Test   -> {'loss': 0.788535475730896, 'accuracy': 0.3926404118537903, 'precision': 0.3017747700214386, 'recall': 0.30348366498947144, 'iou': 0.18380603194236755, 'dice': 0.2920069098472595}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3076754663301551, 'accuracy': 0.8307543003040812, 'precision': 0.7006218495576279, 'recall': 0.6901668196139128, 'iou': 0.5890274016753487, 'dice': 0.6935502290725708}
Test   -> {'loss': 0.7503563761711121, 'accuracy': 0.4491956830024719, 'precision': 0.336465448141098, 'recall': 0.34070611000061035, 'iou': 0.21877658367156982, 'dice': 0.33398741483688354}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.300947033840677, 'accuracy': 0.8343221622964611, 'precision': 0.7084622709647469, 'recall': 0.6973597785700922, 'iou': 0.5956661328025487, 'dice': 0.7002551021783249}
Test   -> {'loss': 0.7418524622917175, 'accuracy': 0.407502144575119, 'precision': 0.3352370262145996, 'recall': 0.33788466453552246, 'iou': 0.20646017789840698, 'dice': 0.32588106393814087}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.29862398479295815, 'accuracy': 0.8338877600172292, 'precision': 0.7080567494682644, 'recall': 0.6998095232507456, 'iou': 0.5973149133765179, 'dice': 0.7022606403931327}
Test   -> {'loss': 0.7949748635292053, 'accuracy': 0.35784912109375, 'precision': 0.3749871850013733, 'recall': 0.35273778438568115, 'iou': 0.15546303987503052, 'dice': 0.2509287893772125}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.301958211608555, 'accuracy': 0.8273558326389479, 'precision': 0.7040316457333772, 'recall': 0.6976849649263465, 'iou': 0.5920989523763242, 'dice': 0.6993548688681229}
Test   -> {'loss': 0.7469340562820435, 'accuracy': 0.35545098781585693, 'precision': 0.4064275026321411, 'recall': 0.3885498642921448, 'iou': 0.1843324601650238, 'dice': 0.3020499646663666}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.29972721908403477, 'accuracy': 0.8269540050755376, 'precision': 0.7041909129723258, 'recall': 0.7007615846136342, 'iou': 0.5938425001890763, 'dice': 0.7016977507135143}
Test   -> {'loss': 0.632144570350647, 'accuracy': 0.4623403549194336, 'precision': 0.45092397928237915, 'recall': 0.4524482190608978, 'iou': 0.260452002286911, 'dice': 0.39719098806381226}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2912014277085014, 'accuracy': 0.8230674204619034, 'precision': 0.712239993136862, 'recall': 0.7159999640091605, 'iou': 0.5996683312499005, 'dice': 0.7103497287501459}
Test   -> {'loss': 0.7011693120002747, 'accuracy': 0.4238611161708832, 'precision': 0.39369794726371765, 'recall': 0.39284372329711914, 'iou': 0.2379584163427353, 'dice': 0.37008774280548096}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.29377739066662995, 'accuracy': 0.810243969378264, 'precision': 0.7099799772967463, 'recall': 0.7194116768629655, 'iou': 0.5921073042828103, 'dice': 0.7070891540983449}
Test   -> {'loss': 0.7692198753356934, 'accuracy': 0.3161602318286896, 'precision': 0.4480230510234833, 'recall': 0.3645789623260498, 'iou': 0.16610315442085266, 'dice': 0.2703116536140442}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.36350193956623905, 'accuracy': 0.7566507862961811, 'precision': 0.6532126944998037, 'recall': 0.6480898774188498, 'iou': 0.5164519328138103, 'dice': 0.6376658014629198}
Test   -> {'loss': 0.809239387512207, 'accuracy': 0.3522021174430847, 'precision': 0.3966671824455261, 'recall': 0.35399216413497925, 'iou': 0.13910388946533203, 'dice': 0.22118662297725677}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 7 with IoU 0.260452002286911
Test -> {'loss': 0.632144570350647, 'accuracy': 0.4623403549194336, 'precision': 0.45092397928237915, 'recall': 0.4524482190608978, 'iou': 0.260452002286911, 'dice': 0.39719098806381226} 
Train -> {'loss': 0.29972721908403477, 'accuracy': 0.8269540050755376, 'precision': 0.7041909129723258, 'recall': 0.7007615846136342, 'iou': 0.5938425001890763, 'dice': 0.7016977507135143} 

Best model saved for model efficientunet at epoch 10

Trial 22:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7585315333760303, 'accuracy': 0.3424761880351149, 'precision': 0.28454691534457, 'recall': 0.2950715665584025, 'iou': 0.1580769360713337, 'dice': 0.2538663781207541}
Test   -> {'loss': 0.742966890335083, 'accuracy': 0.639761745929718, 'precision': 0.8799206614494324, 'recall': 0.3333333432674408, 'iou': 0.2132539451122284, 'dice': 0.2601035535335541}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.8521813929080964, 'accuracy': 0.2241689265422199, 'precision': 0.1954386579601661, 'recall': 0.2188635193783304, 'iou': 0.09104674694978672, 'dice': 0.15599491563828094}
Test   -> {'loss': 0.7670170068740845, 'accuracy': 0.5697731375694275, 'precision': 0.8565911054611206, 'recall': 0.3333333432674408, 'iou': 0.18992438912391663, 'dice': 0.24197685718536377}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.8525704536748969, 'accuracy': 0.22383458180272062, 'precision': 0.1953363396551298, 'recall': 0.21813302551922592, 'iou': 0.0908821781044421, 'dice': 0.1556905640532141}
Test   -> {'loss': 0.7748706340789795, 'accuracy': 0.5332865715026855, 'precision': 0.8444288969039917, 'recall': 0.3333333432674408, 'iou': 0.1777621954679489, 'dice': 0.23187081515789032}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7722364728865416, 'accuracy': 0.3037771598152492, 'precision': 0.26331193349931553, 'recall': 0.27526875760244285, 'iou': 0.14347085191503814, 'dice': 0.23412517785378126}
Test   -> {'loss': 0.6826392412185669, 'accuracy': 0.4392724931240082, 'precision': 0.33500075340270996, 'recall': 0.33476966619491577, 'iou': 0.2137293517589569, 'dice': 0.33061307668685913}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6721636121687682, 'accuracy': 0.42564825817294744, 'precision': 0.3353914691054303, 'recall': 0.3361023661882981, 'iou': 0.21220130492811617, 'dice': 0.3319760579129924}
Test   -> {'loss': 0.6860343217849731, 'accuracy': 0.42007631063461304, 'precision': 0.3441254794597626, 'recall': 0.34474557638168335, 'iou': 0.20758232474327087, 'dice': 0.32565852999687195}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6687538825947306, 'accuracy': 0.4374872430511143, 'precision': 0.3411557407482811, 'recall': 0.34219869763954824, 'iou': 0.2162721427238506, 'dice': 0.3352623843628427}
Test   -> {'loss': 0.6917188167572021, 'accuracy': 0.42962270975112915, 'precision': 0.33458614349365234, 'recall': 0.3351828455924988, 'iou': 0.20702609419822693, 'dice': 0.32112380862236023}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6851737792077272, 'accuracy': 0.4371066688195519, 'precision': 0.33607282599677213, 'recall': 0.33417438774005226, 'iou': 0.2063565747893375, 'dice': 0.3185308382562969}
Test   -> {'loss': 0.704846978187561, 'accuracy': 0.4370366334915161, 'precision': 0.330502986907959, 'recall': 0.33443212509155273, 'iou': 0.20322835445404053, 'dice': 0.3119570314884186}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6840208115785018, 'accuracy': 0.3990617820750112, 'precision': 0.33512178633524026, 'recall': 0.33423251976137575, 'iou': 0.20130781479503798, 'dice': 0.31992199757824774}
Test   -> {'loss': 0.6943932175636292, 'accuracy': 0.39700379967689514, 'precision': 0.33258122205734253, 'recall': 0.33274006843566895, 'iou': 0.19705025851726532, 'dice': 0.3137499988079071}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6819164289080578, 'accuracy': 0.407692496025044, 'precision': 0.3315194898325464, 'recall': 0.3311649454676587, 'iou': 0.20339825140393297, 'dice': 0.3221442091724147}
Test   -> {'loss': 0.6970866322517395, 'accuracy': 0.42746904492378235, 'precision': 0.3313867449760437, 'recall': 0.3320009112358093, 'iou': 0.20607328414916992, 'dice': 0.321458637714386}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6785615503787994, 'accuracy': 0.429438720708308, 'precision': 0.3358028664537098, 'recall': 0.33562141138574353, 'iou': 0.2086762144513752, 'dice': 0.32527212202548983}
Test   -> {'loss': 0.7037488222122192, 'accuracy': 0.4209171235561371, 'precision': 0.3341183364391327, 'recall': 0.334815114736557, 'iou': 0.2047520875930786, 'dice': 0.32013458013534546}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 4 with IoU 0.2137293517589569
Test -> {'loss': 0.6826392412185669, 'accuracy': 0.4392724931240082, 'precision': 0.33500075340270996, 'recall': 0.33476966619491577, 'iou': 0.2137293517589569, 'dice': 0.33061307668685913} 
Train -> {'loss': 0.7722364728865416, 'accuracy': 0.3037771598152492, 'precision': 0.26331193349931553, 'recall': 0.27526875760244285, 'iou': 0.14347085191503814, 'dice': 0.23412517785378126} 

Best model saved for model efficientunet at epoch 10

Trial 23:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7132521048836086, 'accuracy': 0.4461926781612894, 'precision': 0.31827568023101144, 'recall': 0.32355118834454083, 'iou': 0.20391727361990059, 'dice': 0.3054983253064363}
Test   -> {'loss': 0.8481349349021912, 'accuracy': 0.3154056966304779, 'precision': 0.44937944412231445, 'recall': 0.3333818316459656, 'iou': 0.1059175655245781, 'dice': 0.161087766289711}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7428238562915637, 'accuracy': 0.42367583228194194, 'precision': 0.2870497983434926, 'recall': 0.29244992370190825, 'iou': 0.18110253370326498, 'dice': 0.2781635730162911}
Test   -> {'loss': 0.8474055528640747, 'accuracy': 0.32158926129341125, 'precision': 0.45908844470977783, 'recall': 0.3336155414581299, 'iou': 0.10822136700153351, 'dice': 0.1639656126499176}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7157181387362272, 'accuracy': 0.4736957767735357, 'precision': 0.3203116831572159, 'recall': 0.3251296877861023, 'iou': 0.20672117173671722, 'dice': 0.3085023880004883}
Test   -> {'loss': 0.8501267433166504, 'accuracy': 0.3004477322101593, 'precision': 0.44849127531051636, 'recall': 0.3335419297218323, 'iou': 0.10101120173931122, 'dice': 0.15545476973056793}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7143508413563604, 'accuracy': 0.4756894158280414, 'precision': 0.3217487713564997, 'recall': 0.3269329900326936, 'iou': 0.2081555726735488, 'dice': 0.31025961196940877}
Test   -> {'loss': 0.8566123247146606, 'accuracy': 0.2945151627063751, 'precision': 0.4408569931983948, 'recall': 0.3334346413612366, 'iou': 0.09887538850307465, 'dice': 0.15277351438999176}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7035141027492026, 'accuracy': 0.3486736784810605, 'precision': 0.3427655878274337, 'recall': 0.34063829028088116, 'iou': 0.18612889051437378, 'dice': 0.30258744229441104}
Test   -> {'loss': 0.6917563080787659, 'accuracy': 0.3764178156852722, 'precision': 0.3335835635662079, 'recall': 0.33369725942611694, 'iou': 0.1980404108762741, 'dice': 0.3194437026977539}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6930213306261146, 'accuracy': 0.34407119932382, 'precision': 0.340650814253351, 'recall': 0.340497640941454, 'iou': 0.18958399140316506, 'dice': 0.3107877928277721}
Test   -> {'loss': 0.7164758443832397, 'accuracy': 0.3245033621788025, 'precision': 0.3402635455131531, 'recall': 0.342550128698349, 'iou': 0.1787548065185547, 'dice': 0.29761314392089844}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7041958544565283, 'accuracy': 0.32407331466674805, 'precision': 0.3344683323217475, 'recall': 0.3356153861336086, 'iou': 0.18027338256006656, 'dice': 0.2995742196622102}
Test   -> {'loss': 0.7169426679611206, 'accuracy': 0.31518834829330444, 'precision': 0.33631032705307007, 'recall': 0.335199773311615, 'iou': 0.17676156759262085, 'dice': 0.2960408329963684}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6988499159398286, 'accuracy': 0.3325771479502968, 'precision': 0.336434909571772, 'recall': 0.33556485538897307, 'iou': 0.1844809861286827, 'dice': 0.3050524421360182}
Test   -> {'loss': 0.7105622291564941, 'accuracy': 0.34541475772857666, 'precision': 0.3332837224006653, 'recall': 0.3334619402885437, 'iou': 0.1836458146572113, 'dice': 0.3005523085594177}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.690800260460895, 'accuracy': 0.3547124976697175, 'precision': 0.33241977639820264, 'recall': 0.33231144210566643, 'iou': 0.192067047694455, 'dice': 0.3132919350396032}
Test   -> {'loss': 0.7037293910980225, 'accuracy': 0.3647513687610626, 'precision': 0.3282773196697235, 'recall': 0.32817304134368896, 'iou': 0.19181351363658905, 'dice': 0.31058621406555176}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7123721034630485, 'accuracy': 0.34558586633723715, 'precision': 0.3346261555733888, 'recall': 0.33405954423158063, 'iou': 0.17983347799467003, 'dice': 0.2909482321013575}
Test   -> {'loss': 0.7209625840187073, 'accuracy': 0.3454025983810425, 'precision': 0.33387911319732666, 'recall': 0.3330210745334625, 'iou': 0.17843711376190186, 'dice': 0.2890360951423645}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model efficientunet at epoch 10
Best model found at epoch 5 with IoU 0.1980404108762741
Test -> {'loss': 0.6917563080787659, 'accuracy': 0.3764178156852722, 'precision': 0.3335835635662079, 'recall': 0.33369725942611694, 'iou': 0.1980404108762741, 'dice': 0.3194437026977539} 
Train -> {'loss': 0.7035141027492026, 'accuracy': 0.3486736784810605, 'precision': 0.3427655878274337, 'recall': 0.34063829028088116, 'iou': 0.18612889051437378, 'dice': 0.30258744229441104} 

Best model saved for model efficientunet at epoch 10

Best parameters:
Best parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Max IoU: 0.2730
Best metrics: {'loss': 2.406838833457217, 'accuracy': 0.5768358751290759, 'precision': 0.49294526311707254, 'recall': 0.40798888987239423, 'iou': 0.27298913175190914, 'dice': 0.3759467510070421}
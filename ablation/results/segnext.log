Trial 0:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
/usr/local/lib/python3.11/dist-packages/torch/autograd/graph.py:823: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:180.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5923934024313222, 'accuracy': 0.7694880118836527, 'precision': 0.8383652839971625, 'recall': 0.5327882659176122, 'iou': 0.42798523753881457, 'dice': 0.5171513011922007}
Test   -> {'loss': nan, 'accuracy': 0.6683598756790161, 'precision': 0.4742114543914795, 'recall': 0.4688032567501068, 'iou': 0.3437315821647644, 'dice': 0.45477384328842163}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.49526701880537943, 'accuracy': 0.8160397617713265, 'precision': 0.8634133160114288, 'recall': 0.5711031284021295, 'iou': 0.4752436806326327, 'dice': 0.5535161889117697}
Test   -> {'loss': nan, 'accuracy': 0.47280946373939514, 'precision': 0.39105838537216187, 'recall': 0.4101119935512543, 'iou': 0.2349333018064499, 'dice': 0.3526729941368103}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4604183927826259, 'accuracy': 0.8298965363398842, 'precision': 0.800382132374722, 'recall': 0.5830403486023779, 'iou': 0.4909672576448192, 'dice': 0.5643526994663736}
Test   -> {'loss': nan, 'accuracy': 0.3580658435821533, 'precision': 0.5867385864257812, 'recall': 0.3548622131347656, 'iou': 0.14845320582389832, 'dice': 0.23874568939208984}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4265947108683379, 'accuracy': 0.8418063555074775, 'precision': 0.7150294796280239, 'recall': 0.5927812770656917, 'iou': 0.5047377148400183, 'dice': 0.5740357930245606}
Test   -> {'loss': nan, 'accuracy': 0.2839093804359436, 'precision': 0.7613031268119812, 'recall': 0.3333333432674408, 'iou': 0.0946364626288414, 'dice': 0.14741922914981842}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.39063133247520615, 'accuracy': 0.855113039586855, 'precision': 0.6943762380143871, 'recall': 0.603956835684569, 'iou': 0.5205064322637475, 'dice': 0.5847747258518053}
Test   -> {'loss': nan, 'accuracy': 0.28523221611976624, 'precision': 0.7617441415786743, 'recall': 0.3333333432674408, 'iou': 0.09507741779088974, 'dice': 0.14795367419719696}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3414119316184002, 'accuracy': 0.8715228741583617, 'precision': 0.7024157031722691, 'recall': 0.6194828759069028, 'iou': 0.5420821110839429, 'dice': 0.6009013069712598}
Test   -> {'loss': nan, 'accuracy': 0.2746681571006775, 'precision': 0.758222758769989, 'recall': 0.3333333432674408, 'iou': 0.09155605733394623, 'dice': 0.1436547338962555}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.292200619565404, 'accuracy': 0.8870000844416411, 'precision': 0.7178663292656774, 'recall': 0.6368638041226761, 'iou': 0.5670789016329724, 'dice': 0.6237048649269602}
Test   -> {'loss': nan, 'accuracy': 0.26469576358795166, 'precision': 0.7548985481262207, 'recall': 0.3333333432674408, 'iou': 0.08823192119598389, 'dice': 0.13953067362308502}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2559464217528053, 'accuracy': 0.8983720027882119, 'precision': 0.7320366753184278, 'recall': 0.6583160804665606, 'iou': 0.5941996532937754, 'dice': 0.6549549066502115}
Test   -> {'loss': nan, 'accuracy': 0.28850695490837097, 'precision': 0.762835681438446, 'recall': 0.3333333432674408, 'iou': 0.09616898745298386, 'dice': 0.14927196502685547}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2251969478700472, 'accuracy': 0.9079208926014278, 'precision': 0.750670692972515, 'recall': 0.6893793155317721, 'iou': 0.6280785044898157, 'dice': 0.6975160077862118}
Test   -> {'loss': nan, 'accuracy': 0.23301228880882263, 'precision': 0.7443374395370483, 'recall': 0.3333333432674408, 'iou': 0.07767076790332794, 'dice': 0.12598538398742676}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.20346630248038666, 'accuracy': 0.9153974406097246, 'precision': 0.7680044316727183, 'recall': 0.7213659493819528, 'iou': 0.6581992107888927, 'dice': 0.7338503925696663}
Test   -> {'loss': nan, 'accuracy': 0.3074627220630646, 'precision': 0.7691542506217957, 'recall': 0.3333333432674408, 'iou': 0.10248757898807526, 'dice': 0.15677323937416077}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.3437315821647644
Test -> {'loss': nan, 'accuracy': 0.6683598756790161, 'precision': 0.4742114543914795, 'recall': 0.4688032567501068, 'iou': 0.3437315821647644, 'dice': 0.45477384328842163} 
Train -> {'loss': 0.5923934024313222, 'accuracy': 0.7694880118836527, 'precision': 0.8383652839971625, 'recall': 0.5327882659176122, 'iou': 0.42798523753881457, 'dice': 0.5171513011922007} 

Best model saved for model segnext at epoch 10

Trial 1:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6731796565263167, 'accuracy': 0.7119127666172774, 'precision': 0.797044168866199, 'recall': 0.4936472327812858, 'iou': 0.37720131504794824, 'dice': 0.4742535808812017}
Test   -> {'loss': 0.915356457233429, 'accuracy': 0.6957341432571411, 'precision': 0.7859897613525391, 'recall': 0.4779188632965088, 'iou': 0.35668039321899414, 'dice': 0.4580415189266205}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5325939722683118, 'accuracy': 0.8014337233875108, 'precision': 0.8619368252546891, 'recall': 0.5578920125961304, 'iou': 0.45892260826152304, 'dice': 0.5421067875364552}
Test   -> {'loss': nan, 'accuracy': 0.631611704826355, 'precision': 0.7585674524307251, 'recall': 0.44389161467552185, 'iou': 0.3114696145057678, 'dice': 0.41830819845199585}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.491673964002858, 'accuracy': 0.8174816888311635, 'precision': 0.8727285810138868, 'recall': 0.5720004003980885, 'iou': 0.47665687022001846, 'dice': 0.5546931904295217}
Test   -> {'loss': nan, 'accuracy': 0.526817798614502, 'precision': 0.37433522939682007, 'recall': 0.3861634135246277, 'iou': 0.25368571281433105, 'dice': 0.36732161045074463}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.45554077703019846, 'accuracy': 0.8313893955686819, 'precision': 0.8794010488883309, 'recall': 0.5835776878439862, 'iou': 0.49226491762244184, 'dice': 0.5654109021891718}
Test   -> {'loss': nan, 'accuracy': 0.44536760449409485, 'precision': 0.3626020848751068, 'recall': 0.37207478284835815, 'iou': 0.21500742435455322, 'dice': 0.32996809482574463}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4237979629765386, 'accuracy': 0.8432181379069452, 'precision': 0.7900196526361548, 'recall': 0.59301075209742, 'iou': 0.5057364893996197, 'dice': 0.57441013895947}
Test   -> {'loss': nan, 'accuracy': 0.3895842730998993, 'precision': 0.6749429702758789, 'recall': 0.3583325147628784, 'iou': 0.1626867949962616, 'dice': 0.25658270716667175}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3840519423070161, 'accuracy': 0.8571965305701547, 'precision': 0.6804515693498694, 'recall': 0.6052728798078454, 'iou': 0.5225727511488873, 'dice': 0.5857726973036061}
Test   -> {'loss': nan, 'accuracy': 0.2684749662876129, 'precision': 0.4951063394546509, 'recall': 0.32723385095596313, 'iou': 0.09019932150840759, 'dice': 0.1427861750125885}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.33207581535629604, 'accuracy': 0.8748368828193002, 'precision': 0.6942945936451788, 'recall': 0.6214329662530319, 'iou': 0.546120257999586, 'dice': 0.6035120710082676}
Test   -> {'loss': nan, 'accuracy': 0.33122938871383667, 'precision': 0.37711581587791443, 'recall': 0.3389202952384949, 'iou': 0.12622903287410736, 'dice': 0.20173051953315735}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.28311384475749474, 'accuracy': 0.8904307251391204, 'precision': 0.721037963680599, 'recall': 0.6432632544766301, 'iou': 0.5756153376206108, 'dice': 0.634037797347359}
Test   -> {'loss': nan, 'accuracy': 0.2841896414756775, 'precision': 0.761396586894989, 'recall': 0.3333333432674408, 'iou': 0.09472988545894623, 'dice': 0.14753255248069763}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.39022712863009906, 'accuracy': 0.8613448972287385, 'precision': 0.6818882750428241, 'recall': 0.6137871892555901, 'iou': 0.5340136160021243, 'dice': 0.5996490758398305}
Test   -> {'loss': nan, 'accuracy': 0.2662453055381775, 'precision': 0.755415141582489, 'recall': 0.3333333432674408, 'iou': 0.08874844014644623, 'dice': 0.1401757448911667}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2867786744366521, 'accuracy': 0.8892389945361925, 'precision': 0.7133631027263144, 'recall': 0.6438477702762769, 'iou': 0.5757691372995791, 'dice': 0.6357219307318978}
Test   -> {'loss': nan, 'accuracy': 0.311493843793869, 'precision': 0.7704979777336121, 'recall': 0.3333333432674408, 'iou': 0.10383128374814987, 'dice': 0.1583404839038849}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.35668039321899414
Test -> {'loss': 0.915356457233429, 'accuracy': 0.6957341432571411, 'precision': 0.7859897613525391, 'recall': 0.4779188632965088, 'iou': 0.35668039321899414, 'dice': 0.4580415189266205} 
Train -> {'loss': 0.6731796565263167, 'accuracy': 0.7119127666172774, 'precision': 0.797044168866199, 'recall': 0.4936472327812858, 'iou': 0.37720131504794824, 'dice': 0.4742535808812017} 

Best model saved for model segnext at epoch 10

Trial 2:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6000506627818812, 'accuracy': 0.7656867479500563, 'precision': 0.8357083411320396, 'recall': 0.5285471032495084, 'iou': 0.4235650209629017, 'dice': 0.5134181145740592}
Test   -> {'loss': nan, 'accuracy': 0.42069414258003235, 'precision': 0.37024661898612976, 'recall': 0.3741146922111511, 'iou': 0.18893371522426605, 'dice': 0.29405301809310913}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5030453050914018, 'accuracy': 0.8132764891437863, 'precision': 0.8668672660122747, 'recall': 0.5683033989823383, 'iou': 0.47209095916022425, 'dice': 0.5513003846873408}
Test   -> {'loss': nan, 'accuracy': 0.38010576367378235, 'precision': 0.6500349044799805, 'recall': 0.3402477502822876, 'iou': 0.13828450441360474, 'dice': 0.20954817533493042}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4650882974914882, 'accuracy': 0.8278020283450251, 'precision': 0.8130678156147833, 'recall': 0.5812390568463699, 'iou': 0.488563760208047, 'dice': 0.5627537136492522}
Test   -> {'loss': nan, 'accuracy': 0.3277874290943146, 'precision': 0.7759291529655457, 'recall': 0.3333333432674408, 'iou': 0.10926248133182526, 'dice': 0.16457827389240265}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.43595072380874467, 'accuracy': 0.8388129869233008, 'precision': 0.7968979939170505, 'recall': 0.590123311592185, 'iou': 0.5010773853115413, 'dice': 0.57133647436681}
Test   -> {'loss': nan, 'accuracy': 0.30497896671295166, 'precision': 0.7683262825012207, 'recall': 0.3333333432674408, 'iou': 0.10165965557098389, 'dice': 0.15580275654792786}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.40160835165044534, 'accuracy': 0.8510880063409391, 'precision': 0.703560425405917, 'recall': 0.6008047466692717, 'iou': 0.5157296192386877, 'dice': 0.5816026368866796}
Test   -> {'loss': nan, 'accuracy': 0.31336942315101624, 'precision': 0.7711231708526611, 'recall': 0.3333333432674408, 'iou': 0.10445648431777954, 'dice': 0.15906640887260437}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.35616335493067036, 'accuracy': 0.8670976742454197, 'precision': 0.6954626746799635, 'recall': 0.6144180391145789, 'iou': 0.5352609766566235, 'dice': 0.5947262738061988}
Test   -> {'loss': nan, 'accuracy': 0.32717958092689514, 'precision': 0.7757264971733093, 'recall': 0.3333333432674408, 'iou': 0.10905986279249191, 'dice': 0.164348304271698}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3069856455792552, 'accuracy': 0.8827318593211796, 'precision': 0.7106911270514779, 'recall': 0.6303713759650355, 'iou': 0.5580869412940481, 'dice': 0.6135976845803468}
Test   -> {'loss': nan, 'accuracy': 0.21084906160831451, 'precision': 0.7369496822357178, 'recall': 0.3333333432674408, 'iou': 0.07028302550315857, 'dice': 0.11608882248401642}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2698815600379654, 'accuracy': 0.8940650317979896, 'precision': 0.727666853821796, 'recall': 0.6472191727679709, 'iou': 0.58084367669147, 'dice': 0.6380281323971956}
Test   -> {'loss': nan, 'accuracy': 0.3140545189380646, 'precision': 0.7713515162467957, 'recall': 0.3333333432674408, 'iou': 0.10468484461307526, 'dice': 0.1593310534954071}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.22777718337981598, 'accuracy': 0.9069957103418267, 'precision': 0.7481779342112334, 'recall': 0.6863298011862713, 'iou': 0.6247570781604104, 'dice': 0.6934330110964568}
Test   -> {'loss': nan, 'accuracy': 0.36020082235336304, 'precision': 0.7867336273193359, 'recall': 0.3333333432674408, 'iou': 0.12006695568561554, 'dice': 0.1765429824590683}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.20418778657913209, 'accuracy': 0.9150101399939993, 'precision': 0.7671629752801812, 'recall': 0.7188434810742088, 'iou': 0.6561761469944664, 'dice': 0.7314395080442014}
Test   -> {'loss': nan, 'accuracy': 0.2937186062335968, 'precision': 0.7645728588104248, 'recall': 0.3333333432674408, 'iou': 0.0979062020778656, 'dice': 0.1513562649488449}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.18893371522426605
Test -> {'loss': nan, 'accuracy': 0.42069414258003235, 'precision': 0.37024661898612976, 'recall': 0.3741146922111511, 'iou': 0.18893371522426605, 'dice': 0.29405301809310913} 
Train -> {'loss': 0.6000506627818812, 'accuracy': 0.7656867479500563, 'precision': 0.8357083411320396, 'recall': 0.5285471032495084, 'iou': 0.4235650209629017, 'dice': 0.5134181145740592} 

Best model saved for model segnext at epoch 10

Trial 3:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6683854761330977, 'accuracy': 0.7192952905012213, 'precision': 0.8000825871591982, 'recall': 0.49719585491263346, 'iou': 0.38310682592184647, 'dice': 0.4800979344741158}
Test   -> {'loss': 1.2833174467086792, 'accuracy': 0.6353463530540466, 'precision': 0.7995115518569946, 'recall': 0.41309842467308044, 'iou': 0.28434979915618896, 'dice': 0.3828456997871399}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5315859063811924, 'accuracy': 0.8026826267657072, 'precision': 0.8633586826531784, 'recall': 0.5582335855649865, 'iou': 0.459959293966708, 'dice': 0.5428581388100334}
Test   -> {'loss': 1.000077247619629, 'accuracy': 0.6558504700660706, 'precision': 0.7856727838516235, 'recall': 0.44947347044944763, 'iou': 0.3226836323738098, 'dice': 0.42753562331199646}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.48516454774400464, 'accuracy': 0.8198922810347183, 'precision': 0.8745477370593859, 'recall': 0.5739034917043603, 'iou': 0.479361123105754, 'dice': 0.5565698421519736}
Test   -> {'loss': nan, 'accuracy': 0.5997591614723206, 'precision': 0.41688108444213867, 'recall': 0.45119723677635193, 'iou': 0.3062257766723633, 'dice': 0.41972535848617554}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.44975694366123364, 'accuracy': 0.8331266973329627, 'precision': 0.8834046052849811, 'recall': 0.5846962887307872, 'iou': 0.4941679685012154, 'dice': 0.5666974928068078}
Test   -> {'loss': nan, 'accuracy': 0.5546205639839172, 'precision': 0.39327049255371094, 'recall': 0.41737493872642517, 'iou': 0.2774115204811096, 'dice': 0.3925322890281677}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4106194374353989, 'accuracy': 0.8480835759121439, 'precision': 0.7272202274073725, 'recall': 0.5972456175348033, 'iou': 0.5115122116130332, 'dice': 0.5782476062360017}
Test   -> {'loss': nan, 'accuracy': 0.44929224252700806, 'precision': 0.3679932951927185, 'recall': 0.37851768732070923, 'iou': 0.21352750062942505, 'dice': 0.3252203166484833}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.36194362147994663, 'accuracy': 0.8650546763254249, 'precision': 0.7062993111817734, 'recall': 0.6117603172426639, 'iou': 0.5320934046869693, 'dice': 0.5921106338500977}
Test   -> {'loss': nan, 'accuracy': 0.34469011425971985, 'precision': 0.3488044738769531, 'recall': 0.3369075059890747, 'iou': 0.1491626650094986, 'dice': 0.24447254836559296}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.30814223367234933, 'accuracy': 0.8827654807463936, 'precision': 0.7150187735972198, 'recall': 0.6294735234716664, 'iou': 0.5577930756237196, 'dice': 0.6131292876989946}
Test   -> {'loss': nan, 'accuracy': 0.3423813581466675, 'precision': 0.35205143690109253, 'recall': 0.33957046270370483, 'iou': 0.14993152022361755, 'dice': 0.24627618491649628}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.26608778730682703, 'accuracy': 0.8955059113709823, 'precision': 0.7301823242850926, 'recall': 0.653139526947685, 'iou': 0.5879989043526027, 'dice': 0.6483759019685829}
Test   -> {'loss': nan, 'accuracy': 0.2963714599609375, 'precision': 0.32598233222961426, 'recall': 0.3337876796722412, 'iou': 0.10731139779090881, 'dice': 0.1706099957227707}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.23253506033316904, 'accuracy': 0.9059311053027277, 'precision': 0.7479090555854465, 'recall': 0.6825341006983882, 'iou': 0.6208440780639648, 'dice': 0.6889635676923005}
Test   -> {'loss': nan, 'accuracy': 0.3742009401321411, 'precision': 0.42728862166404724, 'recall': 0.36970770359039307, 'iou': 0.16182008385658264, 'dice': 0.25981196761131287}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.20362401280714118, 'accuracy': 0.9154259531394295, 'precision': 0.7680548709371816, 'recall': 0.722487327326899, 'iou': 0.6591052584026171, 'dice': 0.7351850494094517}
Test   -> {'loss': nan, 'accuracy': 0.2858114242553711, 'precision': 0.23778748512268066, 'recall': 0.31436508893966675, 'iou': 0.09996529668569565, 'dice': 0.15922269225120544}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.3226836323738098
Test -> {'loss': 1.000077247619629, 'accuracy': 0.6558504700660706, 'precision': 0.7856727838516235, 'recall': 0.44947347044944763, 'iou': 0.3226836323738098, 'dice': 0.42753562331199646} 
Train -> {'loss': 0.5315859063811924, 'accuracy': 0.8026826267657072, 'precision': 0.8633586826531784, 'recall': 0.5582335855649865, 'iou': 0.459959293966708, 'dice': 0.5428581388100334} 

Best model saved for model segnext at epoch 10

Trial 4:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.8509385397900706, 'accuracy': 0.7154074407142141, 'precision': 0.7682754831469577, 'recall': 0.4836741193481114, 'iou': 0.37138130263141966, 'dice': 0.46232144495715266}
Test   -> {'loss': nan, 'accuracy': 0.25318875908851624, 'precision': 0.7510629892349243, 'recall': 0.3333333432674408, 'iou': 0.08439626544713974, 'dice': 0.13469041883945465}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.585570725409881, 'accuracy': 0.7802684605121613, 'precision': 0.8419304350148077, 'recall': 0.5388558448656745, 'iou': 0.43581929854724716, 'dice': 0.5247614657101424}
Test   -> {'loss': nan, 'accuracy': 0.29446473717689514, 'precision': 0.7648215293884277, 'recall': 0.3333333432674408, 'iou': 0.09815491735935211, 'dice': 0.15165328979492188}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5660341783710148, 'accuracy': 0.7874749699364538, 'precision': 0.8478514108968818, 'recall': 0.5460817198390546, 'iou': 0.4439056818899901, 'dice': 0.530907882814822}
Test   -> {'loss': nan, 'accuracy': 0.3241764008998871, 'precision': 0.7747254371643066, 'recall': 0.3333333432674408, 'iou': 0.10805880278348923, 'dice': 0.16320908069610596}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5480122971793879, 'accuracy': 0.7950065242207569, 'precision': 0.8472450531047323, 'recall': 0.5515652213407599, 'iou': 0.45154392317585323, 'dice': 0.536539141121118}
Test   -> {'loss': nan, 'accuracy': 0.25709253549575806, 'precision': 0.7523641586303711, 'recall': 0.3333333432674408, 'iou': 0.08569751679897308, 'dice': 0.13634240627288818}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5469908595085144, 'accuracy': 0.7972908553869827, 'precision': 0.8370994759642559, 'recall': 0.552766044502673, 'iou': 0.45389923116435177, 'dice': 0.5381925422212351}
Test   -> {'loss': nan, 'accuracy': 0.2520851492881775, 'precision': 0.7506951093673706, 'recall': 0.3333333432674408, 'iou': 0.08402838557958603, 'dice': 0.13422152400016785}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5442103102155353, 'accuracy': 0.798959456578545, 'precision': 0.8197430307450502, 'recall': 0.5533119244420011, 'iou': 0.45518143591673477, 'dice': 0.5390724186016166}
Test   -> {'loss': nan, 'accuracy': 0.3122583329677582, 'precision': 0.7707527875900269, 'recall': 0.3333333432674408, 'iou': 0.10408612340688705, 'dice': 0.15863662958145142}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 1.0523038268089295, 'accuracy': 0.6531742160734924, 'precision': 0.812542787194252, 'recall': 0.3925248105888781, 'iou': 0.26950175528940945, 'dice': 0.3367617964744568}
Test   -> {'loss': nan, 'accuracy': 0.357319712638855, 'precision': 0.6222020983695984, 'recall': 0.3272654712200165, 'iou': 0.15492463111877441, 'dice': 0.2510390877723694}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.8524728705053745, 'accuracy': 0.5991609303847604, 'precision': 0.8663870002912438, 'recall': 0.3333333432674408, 'iou': 0.1997203190041625, 'dice': 0.24968772329713987}
Test   -> {'loss': nan, 'accuracy': 0.36512723565101624, 'precision': 0.4085138440132141, 'recall': 0.3527061641216278, 'iou': 0.14961957931518555, 'dice': 0.2382965087890625}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.8525452341722406, 'accuracy': 0.5991609316805134, 'precision': 0.8663870005503945, 'recall': 0.3333333432674408, 'iou': 0.19972031932810078, 'dice': 0.2496820101271505}
Test   -> {'loss': nan, 'accuracy': 0.352925181388855, 'precision': 0.341343492269516, 'recall': 0.3425285816192627, 'iou': 0.1323072910308838, 'dice': 0.20680062472820282}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.8598551374414692, 'accuracy': 0.5991629761198293, 'precision': 0.8632305824238321, 'recall': 0.33333543655665027, 'iou': 0.19972420004398928, 'dice': 0.24968204802793006}
Test   -> {'loss': nan, 'accuracy': 0.3509359359741211, 'precision': 0.3858635425567627, 'recall': 0.3662700057029724, 'iou': 0.14460144937038422, 'dice': 0.2343660593032837}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 7 with IoU 0.15492463111877441
Test -> {'loss': nan, 'accuracy': 0.357319712638855, 'precision': 0.6222020983695984, 'recall': 0.3272654712200165, 'iou': 0.15492463111877441, 'dice': 0.2510390877723694} 
Train -> {'loss': 1.0523038268089295, 'accuracy': 0.6531742160734924, 'precision': 0.812542787194252, 'recall': 0.3925248105888781, 'iou': 0.26950175528940945, 'dice': 0.3367617964744568} 

Best model saved for model segnext at epoch 10

Trial 5:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.9003582560497781, 'accuracy': 0.645638818844505, 'precision': 0.6127293788868448, 'recall': 0.43041169591571976, 'iou': 0.3065186811530072, 'dice': 0.39445919498153353}
Test   -> {'loss': nan, 'accuracy': 0.29139989614486694, 'precision': 0.7638000249862671, 'recall': 0.3333333432674408, 'iou': 0.09713330119848251, 'dice': 0.15043102204799652}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6169524172078008, 'accuracy': 0.7710180479547252, 'precision': 0.7519495694533639, 'recall': 0.5329222668772159, 'iou': 0.42680747638578, 'dice': 0.5181457706119703}
Test   -> {'loss': nan, 'accuracy': 0.2811649739742279, 'precision': 0.7603883743286133, 'recall': 0.3333333432674408, 'iou': 0.0937216579914093, 'dice': 0.14630693197250366}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5823690025702767, 'accuracy': 0.7823166531065237, 'precision': 0.7823888239653214, 'recall': 0.543701958656311, 'iou': 0.4392052036264668, 'dice': 0.5277193836543871}
Test   -> {'loss': nan, 'accuracy': 0.30272191762924194, 'precision': 0.7675740122795105, 'recall': 0.3333333432674408, 'iou': 0.10090731084346771, 'dice': 0.1549176573753357}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5800765861635623, 'accuracy': 0.7851390501727229, 'precision': 0.8107284457787224, 'recall': 0.5447565990945568, 'iou': 0.4416349348814591, 'dice': 0.5294680512469748}
Test   -> {'loss': nan, 'accuracy': 0.25083890557289124, 'precision': 0.7502796649932861, 'recall': 0.3333333432674408, 'iou': 0.08361297845840454, 'dice': 0.13369104266166687}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5554599456165148, 'accuracy': 0.7927364090214605, 'precision': 0.8232686576635941, 'recall': 0.5505842675333438, 'iou': 0.44948773695074995, 'dice': 0.5352550123048865}
Test   -> {'loss': nan, 'accuracy': 0.31248006224632263, 'precision': 0.7708266973495483, 'recall': 0.3333333432674408, 'iou': 0.10416002571582794, 'dice': 0.15872246026992798}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5421304552451424, 'accuracy': 0.7971597210220669, 'precision': 0.8306139474329741, 'recall': 0.5540724495182867, 'iou': 0.4541686208351799, 'dice': 0.5387098752934}
Test   -> {'loss': nan, 'accuracy': 0.3170745074748993, 'precision': 0.7723581790924072, 'recall': 0.3333333432674408, 'iou': 0.10569151490926743, 'dice': 0.1604943573474884}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5409101309983627, 'accuracy': 0.7988304796426192, 'precision': 0.8063274207322494, 'recall': 0.5559052799058997, 'iou': 0.456195184458857, 'dice': 0.5401593415633492}
Test   -> {'loss': nan, 'accuracy': 0.3012850880622864, 'precision': 0.7670950293540955, 'recall': 0.3333333432674408, 'iou': 0.10042836517095566, 'dice': 0.154352605342865}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5332916601844456, 'accuracy': 0.8011577580286109, 'precision': 0.8156914083854012, 'recall': 0.5571951917980028, 'iou': 0.45843572461086773, 'dice': 0.5417911446612814}
Test   -> {'loss': nan, 'accuracy': 0.29659536480903625, 'precision': 0.7655317783355713, 'recall': 0.3333333432674408, 'iou': 0.09886512160301208, 'dice': 0.15249958634376526}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.518419651363207, 'accuracy': 0.8068583524745444, 'precision': 0.8605990534243376, 'recall': 0.5619091645531032, 'iou': 0.46464682169582533, 'dice': 0.5462446554847386}
Test   -> {'loss': nan, 'accuracy': 0.3166404068470001, 'precision': 0.5114163160324097, 'recall': 0.3384913206100464, 'iou': 0.10886776447296143, 'dice': 0.16854940354824066}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5084541515163753, 'accuracy': 0.8108717674794405, 'precision': 0.8163647501364998, 'recall': 0.566098690032959, 'iou': 0.46938240735427195, 'dice': 0.5496258035950039}
Test   -> {'loss': nan, 'accuracy': 0.2692220211029053, 'precision': 0.7564073801040649, 'recall': 0.3333333432674408, 'iou': 0.08974067866802216, 'dice': 0.14141052961349487}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 9 with IoU 0.10886776447296143
Test -> {'loss': nan, 'accuracy': 0.3166404068470001, 'precision': 0.5114163160324097, 'recall': 0.3384913206100464, 'iou': 0.10886776447296143, 'dice': 0.16854940354824066} 
Train -> {'loss': 0.518419651363207, 'accuracy': 0.8068583524745444, 'precision': 0.8605990534243376, 'recall': 0.5619091645531032, 'iou': 0.46464682169582533, 'dice': 0.5462446554847386} 

Best model saved for model segnext at epoch 10

Trial 6:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7295930134213489, 'accuracy': 0.7223127663135529, 'precision': 0.7744619940933974, 'recall': 0.48994793516138324, 'iou': 0.37764442922628444, 'dice': 0.46786850399297214}
Test   -> {'loss': nan, 'accuracy': 0.3588169515132904, 'precision': 0.786272406578064, 'recall': 0.3333333432674408, 'iou': 0.119605652987957, 'dice': 0.1760438084602356}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5947027342474979, 'accuracy': 0.7785772904105809, 'precision': 0.8320308121650115, 'recall': 0.5381488562926002, 'iou': 0.43439164122809537, 'dice': 0.5236667432214903}
Test   -> {'loss': nan, 'accuracy': 0.2785482406616211, 'precision': 0.7595161199569702, 'recall': 0.3333333432674408, 'iou': 0.09284942597150803, 'dice': 0.14524194598197937}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5918390778095826, 'accuracy': 0.7791721561680669, 'precision': 0.8186950804098793, 'recall': 0.5361357275558555, 'iou': 0.4337259370347728, 'dice': 0.5230022918918859}
Test   -> {'loss': nan, 'accuracy': 0.3302699327468872, 'precision': 0.7767566442489624, 'recall': 0.3333333432674408, 'iou': 0.1100899875164032, 'dice': 0.1655152589082718}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5758430127216422, 'accuracy': 0.7825489466604979, 'precision': 0.8219842695671579, 'recall': 0.5380098616299422, 'iou': 0.4368279536133227, 'dice': 0.525259827401327}
Test   -> {'loss': nan, 'accuracy': 0.33807870745658875, 'precision': 0.7793595790863037, 'recall': 0.3333333432674408, 'iou': 0.11269290745258331, 'dice': 0.1684398651123047}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5761657944192057, 'accuracy': 0.7840916006461434, 'precision': 0.8193463048209315, 'recall': 0.5394126654967017, 'iou': 0.4385445475578308, 'dice': 0.5266135283138441}
Test   -> {'loss': nan, 'accuracy': 0.2944323420524597, 'precision': 0.7648108005523682, 'recall': 0.3333333432674408, 'iou': 0.09814411401748657, 'dice': 0.1516404002904892}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5574684525313585, 'accuracy': 0.7914054531118144, 'precision': 0.7976991586063219, 'recall': 0.5469590153383173, 'iou': 0.4469482544971549, 'dice': 0.5329808115959167}
Test   -> {'loss': nan, 'accuracy': 0.33536699414253235, 'precision': 0.5708214640617371, 'recall': 0.3228317201137543, 'iou': 0.11735855042934418, 'dice': 0.18059226870536804}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 18.203524194074713, 'accuracy': 0.6213168963142063, 'precision': 0.8318612197818963, 'recall': 0.3582760335310646, 'iou': 0.2291919140064198, 'dice': 0.28646058602177576}
Test   -> {'loss': nan, 'accuracy': 0.23955301940441132, 'precision': 0.7465176582336426, 'recall': 0.3333333432674408, 'iou': 0.07985100895166397, 'dice': 0.12883839011192322}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 247.8853083561296, 'accuracy': 0.5987327855566273, 'precision': 0.8489984210418619, 'recall': 0.33331785564837246, 'iou': 0.19975096233513046, 'dice': 0.24986882734557855}
Test   -> {'loss': nan, 'accuracy': 0.2777734696865082, 'precision': 0.7592577934265137, 'recall': 0.3333333432674408, 'iou': 0.09259116649627686, 'dice': 0.1449257880449295}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.873281650180402, 'accuracy': 0.5991598463576773, 'precision': 0.8663866405901701, 'recall': 0.3333333432674408, 'iou': 0.1997199578129727, 'dice': 0.24968643641990165}
Test   -> {'loss': nan, 'accuracy': 0.2918439507484436, 'precision': 0.7639479637145996, 'recall': 0.3333333432674408, 'iou': 0.0972813218832016, 'dice': 0.15060847997665405}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.8524894742862038, 'accuracy': 0.5991598486900329, 'precision': 0.866386641367622, 'recall': 0.3333333432674408, 'iou': 0.19971995820169863, 'dice': 0.24968293957088306}
Test   -> {'loss': nan, 'accuracy': 0.23927773535251617, 'precision': 0.746425986289978, 'recall': 0.3333333432674408, 'iou': 0.07975924760103226, 'dice': 0.12871892750263214}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.119605652987957
Test -> {'loss': nan, 'accuracy': 0.3588169515132904, 'precision': 0.786272406578064, 'recall': 0.3333333432674408, 'iou': 0.119605652987957, 'dice': 0.1760438084602356} 
Train -> {'loss': 0.7295930134213489, 'accuracy': 0.7223127663135529, 'precision': 0.7744619940933974, 'recall': 0.48994793516138324, 'iou': 0.37764442922628444, 'dice': 0.46786850399297214} 

Best model saved for model segnext at epoch 10

Trial 7:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.0320268708726634, 'accuracy': 0.5993258761323017, 'precision': 0.5373252181903175, 'recall': 0.37552415909974474, 'iou': 0.24382038168285203, 'dice': 0.3178938831972039}
Test   -> {'loss': nan, 'accuracy': 0.31768518686294556, 'precision': 0.7725617289543152, 'recall': 0.3333333432674408, 'iou': 0.10589506477117538, 'dice': 0.16072893142700195}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6025066163228906, 'accuracy': 0.77274068231168, 'precision': 0.8306689988011899, 'recall': 0.5337444720060929, 'iou': 0.42843787203664363, 'dice': 0.5193001918170763}
Test   -> {'loss': nan, 'accuracy': 0.29174867272377014, 'precision': 0.7639161944389343, 'recall': 0.3333333432674408, 'iou': 0.09724956005811691, 'dice': 0.15057040750980377}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.580414573006008, 'accuracy': 0.7841172721074975, 'precision': 0.8096334840940392, 'recall': 0.5434644947881284, 'iou': 0.4403039683466372, 'dice': 0.5284597671550253}
Test   -> {'loss': nan, 'accuracy': 0.32347479462623596, 'precision': 0.7261539697647095, 'recall': 0.34179553389549255, 'iou': 0.1138688176870346, 'dice': 0.177755206823349}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5575992604960566, 'accuracy': 0.7912008145581121, 'precision': 0.837636761561684, 'recall': 0.5494003886761872, 'iou': 0.44793918573338054, 'dice': 0.5341419323630955}
Test   -> {'loss': nan, 'accuracy': 0.33948343992233276, 'precision': 0.7798278331756592, 'recall': 0.3333333432674408, 'iou': 0.11316116154193878, 'dice': 0.16896238923072815}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5563482336376024, 'accuracy': 0.7918036175810772, 'precision': 0.7945619427639505, 'recall': 0.5494730897571729, 'iou': 0.4484061425146849, 'dice': 0.5344752778177676}
Test   -> {'loss': nan, 'accuracy': 0.2952260971069336, 'precision': 0.7650753855705261, 'recall': 0.3333333432674408, 'iou': 0.09840871393680573, 'dice': 0.15195602178573608}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5459976258485214, 'accuracy': 0.7960940687552742, 'precision': 0.8162202384160913, 'recall': 0.5537075379620428, 'iou': 0.45325618049372796, 'dice': 0.5380482798037322}
Test   -> {'loss': nan, 'accuracy': 0.2572367191314697, 'precision': 0.7524122595787048, 'recall': 0.3333333432674408, 'iou': 0.08574557304382324, 'dice': 0.13640323281288147}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5321854137856027, 'accuracy': 0.8013463341671487, 'precision': 0.8359779046929401, 'recall': 0.5578520769658296, 'iou': 0.45875025832134747, 'dice': 0.5420164502185324}
Test   -> {'loss': nan, 'accuracy': 0.3469393849372864, 'precision': 0.7823131084442139, 'recall': 0.3333333432674408, 'iou': 0.11564646661281586, 'dice': 0.17171740531921387}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5243973198144333, 'accuracy': 0.8043021202087403, 'precision': 0.7941414382146752, 'recall': 0.5607429654701896, 'iou': 0.4621459535930468, 'dice': 0.5444756756658139}
Test   -> {'loss': nan, 'accuracy': 0.30511099100112915, 'precision': 0.3665858209133148, 'recall': 0.33715760707855225, 'iou': 0.10502132028341293, 'dice': 0.16409997642040253}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.510760616219562, 'accuracy': 0.8104035336038341, 'precision': 0.8327890893687373, 'recall': 0.5665949935498444, 'iou': 0.4690258080544679, 'dice': 0.549361519191576}
Test   -> {'loss': nan, 'accuracy': 0.30249863862991333, 'precision': 0.38304948806762695, 'recall': 0.3373386859893799, 'iou': 0.10424314439296722, 'dice': 0.16313433647155762}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5029676839061406, 'accuracy': 0.8132322834885639, 'precision': 0.8526542741319407, 'recall': 0.5683441089547199, 'iou': 0.4719797810782557, 'dice': 0.5514317274093627}
Test   -> {'loss': nan, 'accuracy': 0.31473681330680847, 'precision': 0.4309389591217041, 'recall': 0.33990341424942017, 'iou': 0.10889239609241486, 'dice': 0.1694849133491516}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 7 with IoU 0.11564646661281586
Test -> {'loss': nan, 'accuracy': 0.3469393849372864, 'precision': 0.7823131084442139, 'recall': 0.3333333432674408, 'iou': 0.11564646661281586, 'dice': 0.17171740531921387} 
Train -> {'loss': 0.5321854137856027, 'accuracy': 0.8013463341671487, 'precision': 0.8359779046929401, 'recall': 0.5578520769658296, 'iou': 0.45875025832134747, 'dice': 0.5420164502185324} 

Best model saved for model segnext at epoch 10

Trial 8:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4537190626496854, 'accuracy': 0.7192677811436031, 'precision': 0.5687875230675158, 'recall': 0.5574010824379714, 'iou': 0.43459756435907404, 'dice': 0.5490972410077634}
Test   -> {'loss': nan, 'accuracy': 0.48195600509643555, 'precision': 0.3517325520515442, 'recall': 0.35228168964385986, 'iou': 0.23476140201091766, 'dice': 0.35187458992004395}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4026711769725965, 'accuracy': 0.7578109974446504, 'precision': 0.6069958404354427, 'recall': 0.6077361104281053, 'iou': 0.4848711271648822, 'dice': 0.5979219879793084}
Test   -> {'loss': nan, 'accuracy': 0.27050283551216125, 'precision': 0.4078094959259033, 'recall': 0.3444708585739136, 'iou': 0.10252436995506287, 'dice': 0.16964074969291687}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3824652099091074, 'accuracy': 0.7749062960562498, 'precision': 0.6256582485592883, 'recall': 0.630800989140635, 'iou': 0.5061505103888719, 'dice': 0.6178952639517576}
Test   -> {'loss': nan, 'accuracy': 0.31339558959007263, 'precision': 0.445281982421875, 'recall': 0.3559732139110565, 'iou': 0.11883725970983505, 'dice': 0.19259682297706604}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3685715815295344, 'accuracy': 0.7855664219545282, 'precision': 0.6373226767000945, 'recall': 0.6470317998658056, 'iou': 0.5205913349338199, 'dice': 0.6313538033029308}
Test   -> {'loss': nan, 'accuracy': 0.35011258721351624, 'precision': 0.24599918723106384, 'recall': 0.31954890489578247, 'iou': 0.12366311252117157, 'dice': 0.1880694329738617}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3544461540553881, 'accuracy': 0.7973095888676851, 'precision': 0.6498836079369421, 'recall': 0.6626438205656798, 'iou': 0.5354999836372293, 'dice': 0.6449907577556112}
Test   -> {'loss': nan, 'accuracy': 0.30480706691741943, 'precision': 0.7682690620422363, 'recall': 0.3333333432674408, 'iou': 0.10160236060619354, 'dice': 0.15573546290397644}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3431746962277786, 'accuracy': 0.805733019631842, 'precision': 0.6594319911106773, 'recall': 0.6761410249316174, 'iou': 0.5473289647827978, 'dice': 0.656006167764249}
Test   -> {'loss': nan, 'accuracy': 0.37006986141204834, 'precision': 0.7900233268737793, 'recall': 0.3333333432674408, 'iou': 0.12335662543773651, 'dice': 0.18007348477840424}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.32968155793521714, 'accuracy': 0.8174232037171073, 'precision': 0.6709809349930804, 'recall': 0.689762421535409, 'iou': 0.5616247951984406, 'dice': 0.6691004421399988}
Test   -> {'loss': nan, 'accuracy': 0.24153603613376617, 'precision': 0.7471787333488464, 'recall': 0.3333333432674408, 'iou': 0.08051201701164246, 'dice': 0.12969742715358734}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3145815263623777, 'accuracy': 0.8284596891506858, 'precision': 0.6839498582093612, 'recall': 0.7071684622246286, 'iou': 0.577762014321659, 'dice': 0.6838356191697328}
Test   -> {'loss': nan, 'accuracy': 0.2909907102584839, 'precision': 0.763663649559021, 'recall': 0.3333333432674408, 'iou': 0.09699690341949463, 'dice': 0.15026739239692688}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.30260464626809824, 'accuracy': 0.8385359849618829, 'precision': 0.6938427373119023, 'recall': 0.7189003812230151, 'iou': 0.5907231320505557, 'dice': 0.6955979285032853}
Test   -> {'loss': nan, 'accuracy': 0.2978179156780243, 'precision': 0.7659393548965454, 'recall': 0.3333333432674408, 'iou': 0.09927265346050262, 'dice': 0.15298393368721008}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.28837715905645617, 'accuracy': 0.8485881313033726, 'precision': 0.7059574793214384, 'recall': 0.7351358644340349, 'iou': 0.6061580030814461, 'dice': 0.7095055033331332}
Test   -> {'loss': nan, 'accuracy': 0.2956380844116211, 'precision': 0.7652127146720886, 'recall': 0.3333333432674408, 'iou': 0.09854604303836823, 'dice': 0.1521196961402893}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.23476140201091766
Test -> {'loss': nan, 'accuracy': 0.48195600509643555, 'precision': 0.3517325520515442, 'recall': 0.35228168964385986, 'iou': 0.23476140201091766, 'dice': 0.35187458992004395} 
Train -> {'loss': 0.4537190626496854, 'accuracy': 0.7192677811436031, 'precision': 0.5687875230675158, 'recall': 0.5574010824379714, 'iou': 0.43459756435907404, 'dice': 0.5490972410077634} 

Best model saved for model segnext at epoch 10

Trial 9:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5015582468198694, 'accuracy': 0.6804743481718976, 'precision': 0.5496868123178896, 'recall': 0.5180242502171061, 'iou': 0.3888402529384779, 'dice': 0.5048355646755385}
Test   -> {'loss': 0.5096255540847778, 'accuracy': 0.6129274964332581, 'precision': 0.5058151483535767, 'recall': 0.5108398795127869, 'iou': 0.37023913860321045, 'dice': 0.5054224729537964}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4160116910934448, 'accuracy': 0.7496704619863759, 'precision': 0.5940477205359418, 'recall': 0.5922193413195402, 'iou': 0.4720382016638051, 'dice': 0.5860148512798807}
Test   -> {'loss': 0.5034499764442444, 'accuracy': 0.6218600869178772, 'precision': 0.5138959288597107, 'recall': 0.5090134143829346, 'iou': 0.37531590461730957, 'dice': 0.5082154273986816}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.39427543101103407, 'accuracy': 0.7647675726724708, 'precision': 0.6151779387308204, 'recall': 0.616772546975509, 'iou': 0.49345231833665265, 'dice': 0.6063342369121054}
Test   -> {'loss': nan, 'accuracy': 0.5757704377174377, 'precision': 0.4699580669403076, 'recall': 0.4786660075187683, 'iou': 0.3330833315849304, 'dice': 0.46978920698165894}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3773963171502818, 'accuracy': 0.7791859450547591, 'precision': 0.6296520316082498, 'recall': 0.6356083579685377, 'iou': 0.5110940238703852, 'dice': 0.6227967847948489}
Test   -> {'loss': nan, 'accuracy': 0.4242706298828125, 'precision': 0.4247533679008484, 'recall': 0.4093756377696991, 'iou': 0.21993139386177063, 'dice': 0.3466344475746155}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3622388689414315, 'accuracy': 0.7901099163552989, 'precision': 0.6433657241904217, 'recall': 0.654483673883521, 'iou': 0.5270160068636355, 'dice': 0.6377215701600779}
Test   -> {'loss': nan, 'accuracy': 0.3399409055709839, 'precision': 0.3991207480430603, 'recall': 0.34517014026641846, 'iou': 0.12958884239196777, 'dice': 0.20524480938911438}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.34999428158221035, 'accuracy': 0.8021476512369903, 'precision': 0.6540155462596727, 'recall': 0.6662426254023677, 'iou': 0.5402486262114151, 'dice': 0.649461427460546}
Test   -> {'loss': nan, 'accuracy': 0.30090394616127014, 'precision': 0.4426290988922119, 'recall': 0.34032511711120605, 'iou': 0.10776571929454803, 'dice': 0.1712220162153244}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.33596257852471395, 'accuracy': 0.8120675895525061, 'precision': 0.6657942486845929, 'recall': 0.6834276645079903, 'iou': 0.5549063630726027, 'dice': 0.6632350579552029}
Test   -> {'loss': nan, 'accuracy': 0.3008824586868286, 'precision': 0.2800968587398529, 'recall': 0.32691678404808044, 'iou': 0.10460127890110016, 'dice': 0.16392645239830017}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3209587107533994, 'accuracy': 0.8239481936330381, 'precision': 0.6785528462866078, 'recall': 0.6994509935379029, 'iou': 0.5707273089367411, 'dice': 0.677748005286507}
Test   -> {'loss': nan, 'accuracy': 0.2609156370162964, 'precision': 0.3956887125968933, 'recall': 0.33691224455833435, 'iou': 0.09230249375104904, 'dice': 0.15040746331214905}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.30812690465346626, 'accuracy': 0.8343496001285056, 'precision': 0.6896061700323354, 'recall': 0.7132468358330105, 'iou': 0.5848313611486684, 'dice': 0.6904814569846444}
Test   -> {'loss': nan, 'accuracy': 0.3063550591468811, 'precision': 0.7687849998474121, 'recall': 0.3333333432674408, 'iou': 0.1021183580160141, 'dice': 0.15634089708328247}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2948877598928369, 'accuracy': 0.8447904187700023, 'precision': 0.7004855498023655, 'recall': 0.7267191534456999, 'iou': 0.5992048377576081, 'dice': 0.7033919246300407}
Test   -> {'loss': nan, 'accuracy': 0.3033914268016815, 'precision': 0.3223647177219391, 'recall': 0.3302226662635803, 'iou': 0.10649218410253525, 'dice': 0.16781112551689148}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.37531590461730957
Test -> {'loss': 0.5034499764442444, 'accuracy': 0.6218600869178772, 'precision': 0.5138959288597107, 'recall': 0.5090134143829346, 'iou': 0.37531590461730957, 'dice': 0.5082154273986816} 
Train -> {'loss': 0.4160116910934448, 'accuracy': 0.7496704619863759, 'precision': 0.5940477205359418, 'recall': 0.5922193413195402, 'iou': 0.4720382016638051, 'dice': 0.5860148512798807} 

Best model saved for model segnext at epoch 10

Trial 10:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.45582944439805073, 'accuracy': 0.7168684714514276, 'precision': 0.5704575267822846, 'recall': 0.5559319318636604, 'iou': 0.43269704949596655, 'dice': 0.547917686726736}
Test   -> {'loss': 0.4887145757675171, 'accuracy': 0.6315195560455322, 'precision': 0.5316876769065857, 'recall': 0.5214250683784485, 'iou': 0.3881652355194092, 'dice': 0.5236700773239136}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4024770920691283, 'accuracy': 0.75800621509552, 'precision': 0.6074197795080102, 'recall': 0.6079596446908039, 'iou': 0.48495700722155366, 'dice': 0.5983028992362645}
Test   -> {'loss': nan, 'accuracy': 0.32956990599632263, 'precision': 0.4373929500579834, 'recall': 0.351895809173584, 'iou': 0.12401963770389557, 'dice': 0.197416290640831}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.38335865787837814, 'accuracy': 0.7733026203901872, 'precision': 0.6245420274527177, 'recall': 0.6301588973273402, 'iou': 0.5048935431501139, 'dice': 0.6168772251709648}
Test   -> {'loss': nan, 'accuracy': 0.3148915767669678, 'precision': 0.7716305255889893, 'recall': 0.3333333432674408, 'iou': 0.10496386140584946, 'dice': 0.15965402126312256}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.36764387799345927, 'accuracy': 0.7856570098711096, 'precision': 0.6381927140381025, 'recall': 0.6480993791766788, 'iou': 0.5210060209035874, 'dice': 0.6320347982904185}
Test   -> {'loss': nan, 'accuracy': 0.40056750178337097, 'precision': 0.800189197063446, 'recall': 0.3333333432674408, 'iou': 0.13352251052856445, 'dice': 0.19066914916038513}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3567831684713778, 'accuracy': 0.7952177037363467, 'precision': 0.6482553414676501, 'recall': 0.6598134323306706, 'iou': 0.5327759931916776, 'dice': 0.6426638722419739}
Test   -> {'loss': nan, 'accuracy': 0.3215668201446533, 'precision': 0.7738556265830994, 'recall': 0.3333333432674408, 'iou': 0.10718894004821777, 'dice': 0.1622149497270584}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.34273699781169065, 'accuracy': 0.8068312147389287, 'precision': 0.6596051941747251, 'recall': 0.6750494340191717, 'iou': 0.5476851275433665, 'dice': 0.6563074376272119}
Test   -> {'loss': nan, 'accuracy': 0.20765654742717743, 'precision': 0.735885500907898, 'recall': 0.3333333432674408, 'iou': 0.06921885162591934, 'dice': 0.11463333666324615}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3303749550943789, 'accuracy': 0.816482156774272, 'precision': 0.6701009470483531, 'recall': 0.6890837197718414, 'iou': 0.5607907389817031, 'dice': 0.6684098023435344}
Test   -> {'loss': nan, 'accuracy': 0.2613811790943146, 'precision': 0.7537937164306641, 'recall': 0.3333333432674408, 'iou': 0.08712705969810486, 'dice': 0.13814550638198853}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.31690344629080397, 'accuracy': 0.8276753161264503, 'precision': 0.6823889338451883, 'recall': 0.7035059275834457, 'iou': 0.5754125136396159, 'dice': 0.6816712910714356}
Test   -> {'loss': nan, 'accuracy': 0.3366774022579193, 'precision': 0.7788925170898438, 'recall': 0.3333333432674408, 'iou': 0.11222580075263977, 'dice': 0.16791754961013794}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.3040532863658407, 'accuracy': 0.8376802726932194, 'precision': 0.6927022358645564, 'recall': 0.7173386169516522, 'iou': 0.5894370675086975, 'dice': 0.694192626942759}
Test   -> {'loss': nan, 'accuracy': 0.21884466707706451, 'precision': 0.7396149039268494, 'recall': 0.3333333432674408, 'iou': 0.07294822484254837, 'dice': 0.1197006031870842}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2919437066368435, 'accuracy': 0.8467714706192846, 'precision': 0.7031561545703722, 'recall': 0.7306992748509282, 'iou': 0.6027201906494473, 'dice': 0.7061178248861562}
Test   -> {'loss': nan, 'accuracy': 0.30942830443382263, 'precision': 0.7698094248771667, 'recall': 0.3333333432674408, 'iou': 0.10314276814460754, 'dice': 0.15753863751888275}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.3881652355194092
Test -> {'loss': 0.4887145757675171, 'accuracy': 0.6315195560455322, 'precision': 0.5316876769065857, 'recall': 0.5214250683784485, 'iou': 0.3881652355194092, 'dice': 0.5236700773239136} 
Train -> {'loss': 0.45582944439805073, 'accuracy': 0.7168684714514276, 'precision': 0.5704575267822846, 'recall': 0.5559319318636604, 'iou': 0.43269704949596655, 'dice': 0.547917686726736} 

Best model saved for model segnext at epoch 10

Trial 11:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.49912725738857106, 'accuracy': 0.6830362615378006, 'precision': 0.5441609745440276, 'recall': 0.5192262820575548, 'iou': 0.39081410972968395, 'dice': 0.5073435695275016}
Test   -> {'loss': 0.489737331867218, 'accuracy': 0.6632624864578247, 'precision': 0.5294369459152222, 'recall': 0.5124855041503906, 'iou': 0.3887558579444885, 'dice': 0.5184972286224365}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4153663687084032, 'accuracy': 0.7488157059835351, 'precision': 0.5947677964749544, 'recall': 0.593265484208646, 'iou': 0.47210859785909237, 'dice': 0.5864047060842099}
Test   -> {'loss': 0.5643042325973511, 'accuracy': 0.6131439208984375, 'precision': 0.49406999349594116, 'recall': 0.4482543468475342, 'iou': 0.3256886601448059, 'dice': 0.4505801200866699}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.39825329365937606, 'accuracy': 0.761016585515893, 'precision': 0.6108712165252023, 'recall': 0.6133446843727776, 'iou': 0.48935529848803644, 'dice': 0.6026923977810403}
Test   -> {'loss': nan, 'accuracy': 0.4621363878250122, 'precision': 0.3907183110713959, 'recall': 0.38552308082580566, 'iou': 0.24052028357982635, 'dice': 0.3692511022090912}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.38439608501351397, 'accuracy': 0.7747912660889004, 'precision': 0.6225919930831246, 'recall': 0.6266444911127506, 'iou': 0.5038693754569344, 'dice': 0.6157212744588437}
Test   -> {'loss': nan, 'accuracy': 0.3911767899990082, 'precision': 0.38068827986717224, 'recall': 0.3597034811973572, 'iou': 0.18794214725494385, 'dice': 0.30202388763427734}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.37122844250305836, 'accuracy': 0.7833413968915525, 'precision': 0.6348930732063626, 'recall': 0.6426131600918977, 'iou': 0.5170616587866907, 'dice': 0.6284539544064066}
Test   -> {'loss': nan, 'accuracy': 0.3189139664173126, 'precision': 0.4119172692298889, 'recall': 0.3473677635192871, 'iou': 0.12490920722484589, 'dice': 0.20281991362571716}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.35843840371007507, 'accuracy': 0.794109386983125, 'precision': 0.6462796625883683, 'recall': 0.6576775146567303, 'iou': 0.5308006504307623, 'dice': 0.6411175966262818}
Test   -> {'loss': nan, 'accuracy': 0.27407804131507874, 'precision': 0.41588544845581055, 'recall': 0.34203004837036133, 'iou': 0.10059668868780136, 'dice': 0.16502362489700317}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3458692395168802, 'accuracy': 0.8038559188013491, 'precision': 0.6573503971099853, 'recall': 0.6716857573260432, 'iou': 0.5438753936601721, 'dice': 0.6532753550488016}
Test   -> {'loss': nan, 'accuracy': 0.3084311783313751, 'precision': 0.44776326417922974, 'recall': 0.33867520093917847, 'iou': 0.1071644276380539, 'dice': 0.16737374663352966}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3300302743911743, 'accuracy': 0.8174100544141687, 'precision': 0.6704891194467959, 'recall': 0.6886595207711924, 'iou': 0.561041487818179, 'dice': 0.6689468824345133}
Test   -> {'loss': nan, 'accuracy': 0.30060094594955444, 'precision': 0.3030586242675781, 'recall': 0.32604536414146423, 'iou': 0.10779821872711182, 'dice': 0.1713007539510727}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.3133530751518581, 'accuracy': 0.8299886993739916, 'precision': 0.6844772566919741, 'recall': 0.7078027683755626, 'iou': 0.5789587611737459, 'dice': 0.6851862741553265}
Test   -> {'loss': nan, 'accuracy': 0.3222843110561371, 'precision': 0.7740947604179382, 'recall': 0.3333333432674408, 'iou': 0.10742810368537903, 'dice': 0.1624886691570282}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.30108612827632736, 'accuracy': 0.8400007315303968, 'precision': 0.6956314667411473, 'recall': 0.7206015529839889, 'iou': 0.5924734229626862, 'dice': 0.6974946130876956}
Test   -> {'loss': nan, 'accuracy': 0.3210741877555847, 'precision': 0.5295197367668152, 'recall': 0.33916598558425903, 'iou': 0.1120942160487175, 'dice': 0.1734929382801056}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.3887558579444885
Test -> {'loss': 0.489737331867218, 'accuracy': 0.6632624864578247, 'precision': 0.5294369459152222, 'recall': 0.5124855041503906, 'iou': 0.3887558579444885, 'dice': 0.5184972286224365} 
Train -> {'loss': 0.49912725738857106, 'accuracy': 0.6830362615378006, 'precision': 0.5441609745440276, 'recall': 0.5192262820575548, 'iou': 0.39081410972968395, 'dice': 0.5073435695275016} 

Best model saved for model segnext at epoch 10

Trial 12:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7519844967385997, 'accuracy': 0.5931000082389168, 'precision': 0.858181297260782, 'recall': 0.3333269453567007, 'iou': 0.19836520759955698, 'dice': 0.24890778641337935}
Test   -> {'loss': nan, 'accuracy': 0.23709417879581451, 'precision': 0.745698094367981, 'recall': 0.3333333432674408, 'iou': 0.07903139293193817, 'dice': 0.12776941061019897}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7519924327083256, 'accuracy': 0.5991623868112979, 'precision': 0.866387486976126, 'recall': 0.3333333432674408, 'iou': 0.19972080504116804, 'dice': 0.2496713808697203}
Test   -> {'loss': nan, 'accuracy': 0.29397767782211304, 'precision': 0.7646592855453491, 'recall': 0.3333333432674408, 'iou': 0.09799256920814514, 'dice': 0.1514594405889511}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7519924363364344, 'accuracy': 0.599162386033846, 'precision': 0.8663874887901803, 'recall': 0.3333333432674408, 'iou': 0.19972080536510634, 'dice': 0.249683206949545}
Test   -> {'loss': nan, 'accuracy': 0.26244866847991943, 'precision': 0.7541496157646179, 'recall': 0.3333333432674408, 'iou': 0.08748289197683334, 'dice': 0.13859239220619202}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7519924340040788, 'accuracy': 0.5991623862929966, 'precision': 0.866387484902921, 'recall': 0.3333333432674408, 'iou': 0.19972080491159272, 'dice': 0.24966907773328864}
Test   -> {'loss': nan, 'accuracy': 0.31506720185279846, 'precision': 0.7716891169548035, 'recall': 0.3333333432674408, 'iou': 0.10502240061759949, 'dice': 0.1597217321395874}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7519924347815307, 'accuracy': 0.5991623878479004, 'precision': 0.8663874874944272, 'recall': 0.3333333432674408, 'iou': 0.19972080393977787, 'dice': 0.24966524081385655}
Test   -> {'loss': nan, 'accuracy': 0.30731573700904846, 'precision': 0.7691053152084351, 'recall': 0.3333333432674408, 'iou': 0.10243858397006989, 'dice': 0.15671589970588684}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7519924334857775, 'accuracy': 0.5991623883662016, 'precision': 0.866387482052264, 'recall': 0.3333333432674408, 'iou': 0.1997208040693532, 'dice': 0.24967536420925804}
Test   -> {'loss': nan, 'accuracy': 0.34709447622299194, 'precision': 0.7823648452758789, 'recall': 0.3333333432674408, 'iou': 0.11569815874099731, 'dice': 0.17177438735961914}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7519924337449281, 'accuracy': 0.5991623873295991, 'precision': 0.8663874856803728, 'recall': 0.3333333432674408, 'iou': 0.19972080452286678, 'dice': 0.2496773997726648}
Test   -> {'loss': nan, 'accuracy': 0.34253552556037903, 'precision': 0.7808451652526855, 'recall': 0.3333333432674408, 'iou': 0.11417850852012634, 'dice': 0.170093834400177}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.751992432449175, 'accuracy': 0.5991623873295991, 'precision': 0.8663874838663184, 'recall': 0.3333333432674408, 'iou': 0.19972080419892851, 'dice': 0.24968427601067916}
Test   -> {'loss': nan, 'accuracy': 0.3125722408294678, 'precision': 0.7708574533462524, 'recall': 0.3333333432674408, 'iou': 0.10419075191020966, 'dice': 0.15875811874866486}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7519924327083256, 'accuracy': 0.5991623878479004, 'precision': 0.8663874872352766, 'recall': 0.3333333432674408, 'iou': 0.19972080510595572, 'dice': 0.2496927724584289}
Test   -> {'loss': nan, 'accuracy': 0.3357282280921936, 'precision': 0.7785760760307312, 'recall': 0.3333333432674408, 'iou': 0.1119094118475914, 'dice': 0.16756314039230347}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7519924337449281, 'accuracy': 0.5991623857746954, 'precision': 0.866387486976126, 'recall': 0.3333333432674408, 'iou': 0.1997208040693532, 'dice': 0.2496718710531359}
Test   -> {'loss': nan, 'accuracy': 0.2352656126022339, 'precision': 0.7450885772705078, 'recall': 0.3333333432674408, 'iou': 0.07842187583446503, 'dice': 0.12697167694568634}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 6 with IoU 0.11569815874099731
Test -> {'loss': nan, 'accuracy': 0.34709447622299194, 'precision': 0.7823648452758789, 'recall': 0.3333333432674408, 'iou': 0.11569815874099731, 'dice': 0.17177438735961914} 
Train -> {'loss': 0.7519924334857775, 'accuracy': 0.5991623883662016, 'precision': 0.866387482052264, 'recall': 0.3333333432674408, 'iou': 0.1997208040693532, 'dice': 0.24967536420925804} 

Best model saved for model segnext at epoch 10

Trial 13:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5136829225913339, 'accuracy': 0.728842749543812, 'precision': 0.7979381970737291, 'recall': 0.5113615849743719, 'iou': 0.3963438472022181, 'dice': 0.4888133821280106}
Test   -> {'loss': nan, 'accuracy': 0.3033774197101593, 'precision': 0.7031564116477966, 'recall': 0.33525797724723816, 'iou': 0.10268381237983704, 'dice': 0.15907105803489685}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.46650558969248895, 'accuracy': 0.7912067812422048, 'precision': 0.8530648729075556, 'recall': 0.5519274426543195, 'iou': 0.4489408192427262, 'dice': 0.5349256759104521}
Test   -> {'loss': nan, 'accuracy': 0.3280583620071411, 'precision': 0.7760194540023804, 'recall': 0.3333333432674408, 'iou': 0.10935278981924057, 'dice': 0.16468070447444916}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4613564055898915, 'accuracy': 0.7976985117663508, 'precision': 0.8574820938317672, 'recall': 0.557663220944612, 'iou': 0.45592462187227994, 'dice': 0.5400448011315387}
Test   -> {'loss': nan, 'accuracy': 0.27592623233795166, 'precision': 0.7586420774459839, 'recall': 0.3333333432674408, 'iou': 0.09197541326284409, 'dice': 0.14417043328285217}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4557618338128795, 'accuracy': 0.8049521529156228, 'precision': 0.8629735024079033, 'recall': 0.5629202640574912, 'iou': 0.46353252322777455, 'dice': 0.5454634972240614}
Test   -> {'loss': nan, 'accuracy': 0.32575365900993347, 'precision': 0.6802092790603638, 'recall': 0.3358510136604309, 'iou': 0.11140884459018707, 'dice': 0.17067575454711914}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4503752060558485, 'accuracy': 0.811916256469229, 'precision': 0.8680240289024684, 'recall': 0.568154878201692, 'iou': 0.4708665228408316, 'dice': 0.5506737558738045}
Test   -> {'loss': nan, 'accuracy': 0.2915396988391876, 'precision': 0.6318264603614807, 'recall': 0.33349335193634033, 'iou': 0.09938296675682068, 'dice': 0.15595608949661255}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.4468321110891259, 'accuracy': 0.8166061074837394, 'precision': 0.8716253638267517, 'recall': 0.571727905066117, 'iou': 0.47585934374643407, 'dice': 0.5541611552238465}
Test   -> {'loss': nan, 'accuracy': 0.29138338565826416, 'precision': 0.7637944221496582, 'recall': 0.3333333432674408, 'iou': 0.09712779521942139, 'dice': 0.15042442083358765}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4447158440299656, 'accuracy': 0.8192971913710885, 'precision': 0.873486330198205, 'recall': 0.5740075608958368, 'iou': 0.4788998344670171, 'dice': 0.5562753055406653}
Test   -> {'loss': nan, 'accuracy': 0.30032938718795776, 'precision': 0.7426379919052124, 'recall': 0.3498409390449524, 'iou': 0.10973020642995834, 'dice': 0.17744849622249603}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.44155461269876234, 'accuracy': 0.8234451024428658, 'precision': 0.8764040231704712, 'recall': 0.5774051023566205, 'iou': 0.4835060803786568, 'dice': 0.5594388832216678}
Test   -> {'loss': nan, 'accuracy': 0.3053445518016815, 'precision': 0.7684482336044312, 'recall': 0.3333333432674408, 'iou': 0.10178151726722717, 'dice': 0.15594583749771118}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4392128384631613, 'accuracy': 0.8263675295788309, 'precision': 0.8785751897355785, 'recall': 0.5797193283620088, 'iou': 0.4868360063304072, 'dice': 0.5617120494013247}
Test   -> {'loss': nan, 'accuracy': 0.3028414845466614, 'precision': 0.7676138281822205, 'recall': 0.3333333432674408, 'iou': 0.10094716399908066, 'dice': 0.1549646258354187}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.4385523407355599, 'accuracy': 0.8273839297501937, 'precision': 0.8793905698734781, 'recall': 0.5803370216618413, 'iou': 0.48781504942023235, 'dice': 0.5623945137728815}
Test   -> {'loss': nan, 'accuracy': 0.30150991678237915, 'precision': 0.7671699523925781, 'recall': 0.3333333432674408, 'iou': 0.10050331801176071, 'dice': 0.15444110333919525}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 4 with IoU 0.11140884459018707
Test -> {'loss': nan, 'accuracy': 0.32575365900993347, 'precision': 0.6802092790603638, 'recall': 0.3358510136604309, 'iou': 0.11140884459018707, 'dice': 0.17067575454711914} 
Train -> {'loss': 0.4557618338128795, 'accuracy': 0.8049521529156228, 'precision': 0.8629735024079033, 'recall': 0.5629202640574912, 'iou': 0.46353252322777455, 'dice': 0.5454634972240614} 

Best model saved for model segnext at epoch 10

Trial 14:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.508041843124058, 'accuracy': 0.7370589248512103, 'precision': 0.8024207921131797, 'recall': 0.5161176938077677, 'iou': 0.4015203775919002, 'dice': 0.4953805107137431}
Test   -> {'loss': nan, 'accuracy': 0.3088814914226532, 'precision': 0.7696272134780884, 'recall': 0.3333333432674408, 'iou': 0.1029604971408844, 'dice': 0.15732592344284058}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4776739646559176, 'accuracy': 0.7760636855726657, 'precision': 0.8229669808045678, 'recall': 0.5422160674696384, 'iou': 0.4343531037154405, 'dice': 0.5239292276942211}
Test   -> {'loss': nan, 'accuracy': 0.3299224078655243, 'precision': 0.6566157341003418, 'recall': 0.36138731241226196, 'iou': 0.140839084982872, 'dice': 0.2319222390651703}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4812209997488105, 'accuracy': 0.7726610429908918, 'precision': 0.8372424089390299, 'recall': 0.5374059852050699, 'iou': 0.43006803237873575, 'dice': 0.5205785677484844}
Test   -> {'loss': nan, 'accuracy': 0.3293008506298065, 'precision': 0.7764336466789246, 'recall': 0.3333333432674408, 'iou': 0.10976695269346237, 'dice': 0.16514989733695984}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5182982011981633, 'accuracy': 0.70299477590167, 'precision': 0.6837473122969918, 'recall': 0.5075036103310793, 'iou': 0.38231343030929565, 'dice': 0.4867517121460127}
Test   -> {'loss': nan, 'accuracy': 0.36358019709587097, 'precision': 0.7277836799621582, 'recall': 0.3592686653137207, 'iou': 0.14084646105766296, 'dice': 0.2219911813735962}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6787395788275677, 'accuracy': 0.5952740079682807, 'precision': 0.6407056992468627, 'recall': 0.37326067711995997, 'iou': 0.25476417334183404, 'dice': 0.34505718719700107}
Test   -> {'loss': nan, 'accuracy': 0.445759654045105, 'precision': 0.6898049116134644, 'recall': 0.3815486431121826, 'iou': 0.19800257682800293, 'dice': 0.3014666438102722}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.739687921171603, 'accuracy': 0.596913548267406, 'precision': 0.6592672357092733, 'recall': 0.34189373669417006, 'iou': 0.21629803096470626, 'dice': 0.28339782583972684}
Test   -> {'loss': nan, 'accuracy': 0.3493490219116211, 'precision': 0.6348695158958435, 'recall': 0.33621954917907715, 'iou': 0.1518058031797409, 'dice': 0.24721992015838623}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7408027864020804, 'accuracy': 0.5990919773993285, 'precision': 0.7411129832267761, 'recall': 0.3400206433690113, 'iou': 0.21209738494261451, 'dice': 0.27460320896428564}
Test   -> {'loss': nan, 'accuracy': 0.37696805596351624, 'precision': 0.6667696833610535, 'recall': 0.3678763508796692, 'iou': 0.16488204896450043, 'dice': 0.264349102973938}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7395197857981143, 'accuracy': 0.6005955074144447, 'precision': 0.7407777073590652, 'recall': 0.3413227191437846, 'iou': 0.2135868897256644, 'dice': 0.2769461191218832}
Test   -> {'loss': nan, 'accuracy': 0.47363904118537903, 'precision': 0.6630765199661255, 'recall': 0.3774448335170746, 'iou': 0.22285747528076172, 'dice': 0.33216965198516846}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7379961133003234, 'accuracy': 0.6016072982031366, 'precision': 0.7434365705303524, 'recall': 0.34246896259162735, 'iou': 0.214973177469295, 'dice': 0.27905639533115467}
Test   -> {'loss': nan, 'accuracy': 0.34372755885124207, 'precision': 0.5804072022438049, 'recall': 0.28174468874931335, 'iou': 0.14901728928089142, 'dice': 0.24351553618907928}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7414291169332421, 'accuracy': 0.6001096554424452, 'precision': 0.7273070693016053, 'recall': 0.3394368490447169, 'iou': 0.21047515674777653, 'dice': 0.2707756988380266}
Test   -> {'loss': nan, 'accuracy': 0.5049588084220886, 'precision': 0.7036633491516113, 'recall': 0.42616891860961914, 'iou': 0.24439309537410736, 'dice': 0.3568265438079834}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 10 with IoU 0.24439309537410736
Test -> {'loss': nan, 'accuracy': 0.5049588084220886, 'precision': 0.7036633491516113, 'recall': 0.42616891860961914, 'iou': 0.24439309537410736, 'dice': 0.3568265438079834} 
Train -> {'loss': 0.7414291169332421, 'accuracy': 0.6001096554424452, 'precision': 0.7273070693016053, 'recall': 0.3394368490447169, 'iou': 0.21047515674777653, 'dice': 0.2707756988380266} 

Best model saved for model segnext at epoch 10

Trial 15:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5314505577087403, 'accuracy': 0.647082273338152, 'precision': 0.5239741848862689, 'recall': 0.49058987316877944, 'iou': 0.3607478971066682, 'dice': 0.47309556655261825}
Test   -> {'loss': nan, 'accuracy': 0.30587238073349, 'precision': 0.44462066888809204, 'recall': 0.34301090240478516, 'iou': 0.11021946370601654, 'dice': 0.1754826307296753}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.435426141904748, 'accuracy': 0.7289712740027386, 'precision': 0.5748539427052374, 'recall': 0.5709237249001212, 'iou': 0.4496717903925025, 'dice': 0.5660224598387014}
Test   -> {'loss': nan, 'accuracy': 0.29393908381462097, 'precision': 0.3057088553905487, 'recall': 0.32241201400756836, 'iou': 0.1124376654624939, 'dice': 0.18344609439373016}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.43361437528029734, 'accuracy': 0.730571218677189, 'precision': 0.5779069123060807, 'recall': 0.5726950158243594, 'iou': 0.45117235391036326, 'dice': 0.5676711393439251}
Test   -> {'loss': nan, 'accuracy': 0.2897077202796936, 'precision': 0.7632359266281128, 'recall': 0.3333333432674408, 'iou': 0.0965692400932312, 'dice': 0.14975368976593018}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.43604947898698887, 'accuracy': 0.7309944375701573, 'precision': 0.5753123827602552, 'recall': 0.5692852362342503, 'iou': 0.44944142440091006, 'dice': 0.5654519640881083}
Test   -> {'loss': nan, 'accuracy': 0.30725720524787903, 'precision': 0.3781866729259491, 'recall': 0.3494166135787964, 'iou': 0.12376584112644196, 'dice': 0.20433752238750458}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.429977241806362, 'accuracy': 0.7371584752331609, 'precision': 0.5805916236794513, 'recall': 0.5750540194304093, 'iou': 0.45598241427670355, 'dice': 0.5712474812632021}
Test   -> {'loss': nan, 'accuracy': 0.279419869184494, 'precision': 0.38987356424331665, 'recall': 0.33616340160369873, 'iou': 0.09851282835006714, 'dice': 0.15832549333572388}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.434397730620011, 'accuracy': 0.7305535150610882, 'precision': 0.5781621818957121, 'recall': 0.5718062193497367, 'iou': 0.4504065461780714, 'dice': 0.5670088197873986}
Test   -> {'loss': nan, 'accuracy': 0.28127333521842957, 'precision': 0.7604244947433472, 'recall': 0.3333333432674408, 'iou': 0.09375779330730438, 'dice': 0.1463509500026703}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.43481644962144933, 'accuracy': 0.730377735780633, 'precision': 0.5751930858777917, 'recall': 0.5721894523371821, 'iou': 0.4509242990742559, 'dice': 0.5667357553606448}
Test   -> {'loss': nan, 'accuracy': 0.34343329071998596, 'precision': 0.7811444997787476, 'recall': 0.3333333432674408, 'iou': 0.11447776854038239, 'dice': 0.170425683259964}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.43728815265323806, 'accuracy': 0.7343373257180918, 'precision': 0.5760572257249251, 'recall': 0.565666187327841, 'iou': 0.44877160761667334, 'dice': 0.5640412719353386}
Test   -> {'loss': nan, 'accuracy': 0.3901270627975464, 'precision': 0.38953715562820435, 'recall': 0.36365482211112976, 'iou': 0.17544770240783691, 'dice': 0.28002628684043884}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.44651425973228787, 'accuracy': 0.7227741853050563, 'precision': 0.5711701299833215, 'recall': 0.5577428936958313, 'iou': 0.4385031396928041, 'dice': 0.5549747410027878}
Test   -> {'loss': nan, 'accuracy': 0.3460005223751068, 'precision': 0.38797497749328613, 'recall': 0.345520943403244, 'iou': 0.1340315043926239, 'dice': 0.21282367408275604}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.46696140558823296, 'accuracy': 0.7191800319630167, 'precision': 0.5438114674194999, 'recall': 0.5378864246865978, 'iou': 0.4212307113668193, 'dice': 0.5351800457290982}
Test   -> {'loss': nan, 'accuracy': 0.30550089478492737, 'precision': 0.7685003280639648, 'recall': 0.3333333432674408, 'iou': 0.10183363407850266, 'dice': 0.15600699186325073}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 8 with IoU 0.17544770240783691
Test -> {'loss': nan, 'accuracy': 0.3901270627975464, 'precision': 0.38953715562820435, 'recall': 0.36365482211112976, 'iou': 0.17544770240783691, 'dice': 0.28002628684043884} 
Train -> {'loss': 0.43728815265323806, 'accuracy': 0.7343373257180918, 'precision': 0.5760572257249251, 'recall': 0.565666187327841, 'iou': 0.44877160761667334, 'dice': 0.5640412719353386} 

Best model saved for model segnext at epoch 10

Trial 16:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.597455592777418, 'accuracy': 0.732535882488541, 'precision': 0.6606078277463499, 'recall': 0.5669657112463661, 'iou': 0.44387694428796354, 'dice': 0.5749063061631244}
Test   -> {'loss': nan, 'accuracy': 0.3658260405063629, 'precision': 0.36084574460983276, 'recall': 0.33443278074264526, 'iou': 0.18348658084869385, 'dice': 0.29930147528648376}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.49522812807041666, 'accuracy': 0.7830144400181978, 'precision': 0.7110723202643188, 'recall': 0.6710831595503766, 'iou': 0.5424458078716112, 'dice': 0.6850400201652361}
Test   -> {'loss': nan, 'accuracy': 0.26946645975112915, 'precision': 0.7564888000488281, 'recall': 0.3333333432674408, 'iou': 0.08982216566801071, 'dice': 0.1415116786956787}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.45169090887774593, 'accuracy': 0.8048755391784336, 'precision': 0.7413070940453074, 'recall': 0.707123081062151, 'iou': 0.5810846168061962, 'dice': 0.7201589431451715}
Test   -> {'loss': nan, 'accuracy': 0.2837187945842743, 'precision': 0.7612396478652954, 'recall': 0.3333333432674408, 'iou': 0.09457294642925262, 'dice': 0.14734214544296265}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.41534044716669166, 'accuracy': 0.8212627143963523, 'precision': 0.7634213792241138, 'recall': 0.7335549149824225, 'iou': 0.6099957714910093, 'dice': 0.7452269333860149}
Test   -> {'loss': nan, 'accuracy': 0.33433812856674194, 'precision': 0.7781127691268921, 'recall': 0.3333333432674408, 'iou': 0.11144604533910751, 'dice': 0.16704319417476654}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.37278042137622835, 'accuracy': 0.8392823486224464, 'precision': 0.7887184518834819, 'recall': 0.7642113133617069, 'iou': 0.6443121560241865, 'dice': 0.773672899733419}
Test   -> {'loss': nan, 'accuracy': 0.25049325823783875, 'precision': 0.7501644492149353, 'recall': 0.3333333432674408, 'iou': 0.08349775522947311, 'dice': 0.1335437148809433}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.31906243847764054, 'accuracy': 0.8628528911134471, 'precision': 0.8195090065831724, 'recall': 0.7996527067992998, 'iou': 0.6881389488344607, 'dice': 0.8077939541443534}
Test   -> {'loss': nan, 'accuracy': 0.29338353872299194, 'precision': 0.7644612193107605, 'recall': 0.3333333432674408, 'iou': 0.09779451787471771, 'dice': 0.15122276544570923}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.27135545442933623, 'accuracy': 0.8833416798840399, 'precision': 0.8462405671244082, 'recall': 0.8306067311245462, 'iou': 0.727458825059559, 'dice': 0.8366903307645217}
Test   -> {'loss': nan, 'accuracy': 0.3291115164756775, 'precision': 0.7763705253601074, 'recall': 0.3333333432674408, 'iou': 0.10970383882522583, 'dice': 0.16507846117019653}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.22894700940536417, 'accuracy': 0.9017406528410704, 'precision': 0.8696058125599571, 'recall': 0.8589878556521042, 'iou': 0.7651411497074625, 'dice': 0.8630142429600591}
Test   -> {'loss': nan, 'accuracy': 0.30053213238716125, 'precision': 0.7668440341949463, 'recall': 0.3333333432674408, 'iou': 0.10017737746238708, 'dice': 0.15405598282814026}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.19460259708373442, 'accuracy': 0.9162256015383679, 'precision': 0.8876370445541714, 'recall': 0.8807348974373029, 'iou': 0.7958470100941866, 'dice': 0.8834289768467779}
Test   -> {'loss': nan, 'accuracy': 0.3362102806568146, 'precision': 0.7787367701530457, 'recall': 0.3333333432674408, 'iou': 0.11207009851932526, 'dice': 0.16774320602416992}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.17122570386399394, 'accuracy': 0.9265896937121516, 'precision': 0.9010179110195325, 'recall': 0.8951116367526676, 'iou': 0.8175733252711918, 'dice': 0.8973372106966765}
Test   -> {'loss': nan, 'accuracy': 0.33852338790893555, 'precision': 0.7795078158378601, 'recall': 0.3333333432674408, 'iou': 0.11284112930297852, 'dice': 0.16860538721084595}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.18348658084869385
Test -> {'loss': nan, 'accuracy': 0.3658260405063629, 'precision': 0.36084574460983276, 'recall': 0.33443278074264526, 'iou': 0.18348658084869385, 'dice': 0.29930147528648376} 
Train -> {'loss': 0.597455592777418, 'accuracy': 0.732535882488541, 'precision': 0.6606078277463499, 'recall': 0.5669657112463661, 'iou': 0.44387694428796354, 'dice': 0.5749063061631244} 

Best model saved for model segnext at epoch 10

Trial 17:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6713741644569066, 'accuracy': 0.6886996186297872, 'precision': 0.5894870524821074, 'recall': 0.4813015378039816, 'iou': 0.36398073616235155, 'dice': 0.47795848276304165}
Test   -> {'loss': 1.7184070348739624, 'accuracy': 0.6046946048736572, 'precision': 0.5475651025772095, 'recall': 0.4124780595302582, 'iou': 0.2822115123271942, 'dice': 0.37740716338157654}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5296623219614444, 'accuracy': 0.766463423811871, 'precision': 0.6852159380912781, 'recall': 0.6349658458129219, 'iou': 0.5098174307657325, 'dice': 0.6538622819859049}
Test   -> {'loss': nan, 'accuracy': 0.48734766244888306, 'precision': 0.37014973163604736, 'recall': 0.3703638017177582, 'iou': 0.24954462051391602, 'dice': 0.3681538701057434}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4777156534402267, 'accuracy': 0.7915772557258606, 'precision': 0.7227109364841295, 'recall': 0.6843979068424391, 'iou': 0.5569947107978489, 'dice': 0.6993319158968718}
Test   -> {'loss': nan, 'accuracy': 0.4905800223350525, 'precision': 0.39119741320610046, 'recall': 0.39116692543029785, 'iou': 0.25948914885520935, 'dice': 0.38850975036621094}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.43755047710045525, 'accuracy': 0.8102568134017613, 'precision': 0.7489108883816263, 'recall': 0.7147125539572342, 'iou': 0.5899179225382598, 'dice': 0.7286984604337942}
Test   -> {'loss': nan, 'accuracy': 0.34299513697624207, 'precision': 0.3665243089199066, 'recall': 0.3406001031398773, 'iou': 0.15923887491226196, 'dice': 0.2639441192150116}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.39577452048011447, 'accuracy': 0.828934645652771, 'precision': 0.774473210003065, 'recall': 0.7452737875606703, 'iou': 0.6234531573627307, 'dice': 0.7570420368858005}
Test   -> {'loss': nan, 'accuracy': 0.3216674029827118, 'precision': 0.34672993421554565, 'recall': 0.32730379700660706, 'iou': 0.14298933744430542, 'dice': 0.2387193739414215}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.34431952989619713, 'accuracy': 0.8526990543241086, 'precision': 0.8059186634810075, 'recall': 0.7837903385576994, 'iou': 0.6683872492417046, 'dice': 0.7931754433590433}
Test   -> {'loss': nan, 'accuracy': 0.34640875458717346, 'precision': 0.4006338119506836, 'recall': 0.3365982472896576, 'iou': 0.12024329602718353, 'dice': 0.18268662691116333}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2884700627430626, 'accuracy': 0.8769402358842933, 'precision': 0.837471924657407, 'recall': 0.8203991029573523, 'iou': 0.7141504241072614, 'dice': 0.827369211031043}
Test   -> {'loss': nan, 'accuracy': 0.27906766533851624, 'precision': 0.3849618434906006, 'recall': 0.3325112462043762, 'iou': 0.0976065993309021, 'dice': 0.1557820737361908}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2410203288430753, 'accuracy': 0.8970055357269618, 'precision': 0.8629185883895211, 'recall': 0.8502308368682862, 'iou': 0.7542076338892397, 'dice': 0.8557059464247331}
Test   -> {'loss': nan, 'accuracy': 0.3155019283294678, 'precision': 0.3669869601726532, 'recall': 0.3350832164287567, 'iou': 0.11045309156179428, 'dice': 0.17190508544445038}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.21181945865568907, 'accuracy': 0.9092289038326429, 'precision': 0.8781078825826231, 'recall': 0.869201427957286, 'iou': 0.7787094494570856, 'dice': 0.8722246828286544}
Test   -> {'loss': nan, 'accuracy': 0.2730756402015686, 'precision': 0.2940332293510437, 'recall': 0.3276098668575287, 'iou': 0.09563791751861572, 'dice': 0.15374429523944855}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.18659822046756744, 'accuracy': 0.9203465005625849, 'precision': 0.8923487808393396, 'recall': 0.8854467728863592, 'iou': 0.8029973289240961, 'dice': 0.8881348065707995}
Test   -> {'loss': nan, 'accuracy': 0.2957448959350586, 'precision': 0.38563141226768494, 'recall': 0.336718887090683, 'iou': 0.11112748086452484, 'dice': 0.1803058683872223}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.2822115123271942
Test -> {'loss': 1.7184070348739624, 'accuracy': 0.6046946048736572, 'precision': 0.5475651025772095, 'recall': 0.4124780595302582, 'iou': 0.2822115123271942, 'dice': 0.37740716338157654} 
Train -> {'loss': 0.6713741644569066, 'accuracy': 0.6886996186297872, 'precision': 0.5894870524821074, 'recall': 0.4813015378039816, 'iou': 0.36398073616235155, 'dice': 0.47795848276304165} 

Best model saved for model segnext at epoch 10

Trial 18:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6072297106618466, 'accuracy': 0.7287119782489279, 'precision': 0.647193023821582, 'recall': 0.5585204112788905, 'iou': 0.4360329960999281, 'dice': 0.567368100259615}
Test   -> {'loss': nan, 'accuracy': 0.5198065042495728, 'precision': 0.3759363293647766, 'recall': 0.3768160343170166, 'iou': 0.25614064931869507, 'dice': 0.3732043504714966}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5092410662899847, 'accuracy': 0.7762881074262702, 'precision': 0.7014347820178323, 'recall': 0.6577377767666527, 'iou': 0.5298585360464843, 'dice': 0.6728653342827506}
Test   -> {'loss': nan, 'accuracy': 0.43513455986976624, 'precision': 0.42735108733177185, 'recall': 0.40736517310142517, 'iou': 0.22604523599147797, 'dice': 0.35407254099845886}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4594107186016829, 'accuracy': 0.8014347200808318, 'precision': 0.7369294309097788, 'recall': 0.7004296839237213, 'iou': 0.5743797797223796, 'dice': 0.7144155652626701}
Test   -> {'loss': nan, 'accuracy': 0.3089064061641693, 'precision': 0.7696355581283569, 'recall': 0.3333333432674408, 'iou': 0.10296880453824997, 'dice': 0.15733562409877777}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.42326903900374535, 'accuracy': 0.8174898694390836, 'precision': 0.7587218681107397, 'recall': 0.7274258232635, 'iou': 0.6034197863029397, 'dice': 0.7394706220730491}
Test   -> {'loss': nan, 'accuracy': 0.29053106904029846, 'precision': 0.4015417695045471, 'recall': 0.3416338860988617, 'iou': 0.11222191154956818, 'dice': 0.185500830411911}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3857108153726744, 'accuracy': 0.8338468556818754, 'precision': 0.7816374988659568, 'recall': 0.7533488211424454, 'iou': 0.633454669299333, 'dice': 0.7646687043749768}
Test   -> {'loss': nan, 'accuracy': 0.2638911008834839, 'precision': 0.754630446434021, 'recall': 0.3333333432674408, 'iou': 0.08796370029449463, 'dice': 0.13919506967067719}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.33234758260457414, 'accuracy': 0.8576799289039944, 'precision': 0.8133361883785414, 'recall': 0.7912558431210726, 'iou': 0.6780042728652125, 'dice': 0.8001483373020006}
Test   -> {'loss': nan, 'accuracy': 0.27935168147087097, 'precision': 0.759783923625946, 'recall': 0.3333333432674408, 'iou': 0.09311722964048386, 'dice': 0.14556939899921417}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2832241518341977, 'accuracy': 0.8784895832123963, 'precision': 0.8406641208607217, 'recall': 0.8237094057642895, 'iou': 0.7183303071104962, 'dice': 0.8301969520423723}
Test   -> {'loss': nan, 'accuracy': 0.30042749643325806, 'precision': 0.7668091654777527, 'recall': 0.3333333432674408, 'iou': 0.10014250129461288, 'dice': 0.1540147364139557}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.24072769115800444, 'accuracy': 0.8965046929276508, 'precision': 0.862195587935655, 'recall': 0.8509543009426283, 'iou': 0.7543259851310564, 'dice': 0.85551419802334}
Test   -> {'loss': nan, 'accuracy': 0.23158730566501617, 'precision': 0.743862509727478, 'recall': 0.3333333432674408, 'iou': 0.07719577103853226, 'dice': 0.12535980343818665}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2038418813244156, 'accuracy': 0.9125377299992935, 'precision': 0.881816507940707, 'recall': 0.875810107200042, 'iou': 0.787627533207769, 'dice': 0.8780283207478731}
Test   -> {'loss': nan, 'accuracy': 0.27327805757522583, 'precision': 0.7577593326568604, 'recall': 0.3333333432674408, 'iou': 0.09109269082546234, 'dice': 0.14308373630046844}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.17652360447075055, 'accuracy': 0.9240081851897033, 'precision': 0.8973854031251824, 'recall': 0.8915841657182445, 'iou': 0.8119309065134629, 'dice': 0.8937693875768911}
Test   -> {'loss': nan, 'accuracy': 0.30206298828125, 'precision': 0.7673543691635132, 'recall': 0.3333333432674408, 'iou': 0.1006876677274704, 'dice': 0.15465867519378662}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.25614064931869507
Test -> {'loss': nan, 'accuracy': 0.5198065042495728, 'precision': 0.3759363293647766, 'recall': 0.3768160343170166, 'iou': 0.25614064931869507, 'dice': 0.3732043504714966} 
Train -> {'loss': 0.6072297106618466, 'accuracy': 0.7287119782489279, 'precision': 0.647193023821582, 'recall': 0.5585204112788905, 'iou': 0.4360329960999281, 'dice': 0.567368100259615} 

Best model saved for model segnext at epoch 10

Trial 19:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6687914589177008, 'accuracy': 0.6925537259682365, 'precision': 0.5971742702567059, 'recall': 0.483654074565224, 'iou': 0.36677222951598787, 'dice': 0.48196899476258653}
Test   -> {'loss': 2.0929253101348877, 'accuracy': 0.583856999874115, 'precision': 0.5331303477287292, 'recall': 0.4004939794540405, 'iou': 0.26427698135375977, 'dice': 0.3535085618495941}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5335202745769335, 'accuracy': 0.7637357100196507, 'precision': 0.6801869247270667, 'recall': 0.6312219599018927, 'iou': 0.5050343871116638, 'dice': 0.6490422238474307}
Test   -> {'loss': nan, 'accuracy': 0.5482990145683289, 'precision': 0.3581175208091736, 'recall': 0.3725442886352539, 'iou': 0.24655620753765106, 'dice': 0.33894404768943787}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.48670503885849664, 'accuracy': 0.7869478562603827, 'precision': 0.715320434777633, 'recall': 0.6753451596135679, 'iou': 0.5485874777254851, 'dice': 0.6915642126746799}
Test   -> {'loss': nan, 'accuracy': 0.5527957081794739, 'precision': 0.43391892313957214, 'recall': 0.4380325675010681, 'iou': 0.2975941300392151, 'dice': 0.42217904329299927}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.44787386370741805, 'accuracy': 0.8053093708079794, 'precision': 0.7411787572114364, 'recall': 0.7052890590999438, 'iou': 0.5799215482628863, 'dice': 0.7199206787606944}
Test   -> {'loss': nan, 'accuracy': 0.3834088444709778, 'precision': 0.3538587987422943, 'recall': 0.3441663682460785, 'iou': 0.1889219731092453, 'dice': 0.30463191866874695}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.40965092855951063, 'accuracy': 0.8228117440057837, 'precision': 0.7661858144013778, 'recall': 0.7351836059404456, 'iou': 0.6121027925740118, 'dice': 0.7476492933605028}
Test   -> {'loss': nan, 'accuracy': 0.3473034203052521, 'precision': 0.35437482595443726, 'recall': 0.33704209327697754, 'iou': 0.1590680181980133, 'dice': 0.2616865336894989}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3614073818144591, 'accuracy': 0.8447475733964339, 'precision': 0.7948815252469934, 'recall': 0.7703883336937946, 'iou': 0.6524891910345658, 'dice': 0.7806798934936523}
Test   -> {'loss': nan, 'accuracy': 0.3256399929523468, 'precision': 0.3549400269985199, 'recall': 0.33595067262649536, 'iou': 0.11694436520338058, 'dice': 0.18260136246681213}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3041197398434515, 'accuracy': 0.8701730593391087, 'precision': 0.8281096095624177, 'recall': 0.8102354547251825, 'iou': 0.7012758037318354, 'dice': 0.8180181835008704}
Test   -> {'loss': nan, 'accuracy': 0.3248599171638489, 'precision': 0.4118683338165283, 'recall': 0.34277328848838806, 'iou': 0.12142536044120789, 'dice': 0.1930849850177765}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2555548421714617, 'accuracy': 0.8906690607900205, 'precision': 0.8556145154911539, 'recall': 0.8411207945450493, 'iou': 0.74165090115174, 'dice': 0.8469145049219546}
Test   -> {'loss': nan, 'accuracy': 0.3066789209842682, 'precision': 0.3265480101108551, 'recall': 0.3288425803184509, 'iou': 0.115162692964077, 'dice': 0.18465733528137207}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.216065913438797, 'accuracy': 0.9076973925466123, 'precision': 0.8761520188787709, 'recall': 0.866531781528307, 'iou': 0.7763093341951784, 'dice': 0.870679787967516}
Test   -> {'loss': nan, 'accuracy': 0.29339566826820374, 'precision': 0.44637298583984375, 'recall': 0.3441072702407837, 'iou': 0.10677671432495117, 'dice': 0.17129366099834442}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.18649153631666432, 'accuracy': 0.9200346982997397, 'precision': 0.8923069632571676, 'recall': 0.8848785975705022, 'iou': 0.8024359630501788, 'dice': 0.8878006634504899}
Test   -> {'loss': nan, 'accuracy': 0.30053991079330444, 'precision': 0.3528575301170349, 'recall': 0.3326042890548706, 'iou': 0.10721349716186523, 'dice': 0.16995827853679657}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 3 with IoU 0.2975941300392151
Test -> {'loss': nan, 'accuracy': 0.5527957081794739, 'precision': 0.43391892313957214, 'recall': 0.4380325675010681, 'iou': 0.2975941300392151, 'dice': 0.42217904329299927} 
Train -> {'loss': 0.48670503885849664, 'accuracy': 0.7869478562603827, 'precision': 0.715320434777633, 'recall': 0.6753451596135679, 'iou': 0.5485874777254851, 'dice': 0.6915642126746799} 

Best model saved for model segnext at epoch 10

Trial 20:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7725291653819706, 'accuracy': 0.6785040743972944, 'precision': 0.5802362870910893, 'recall': 0.46005503340907716, 'iou': 0.3341787398509357, 'dice': 0.4334668138752813}
Test   -> {'loss': nan, 'accuracy': 0.28579774498939514, 'precision': 0.7619325518608093, 'recall': 0.3333333432674408, 'iou': 0.09526591747999191, 'dice': 0.14818181097507477}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6075623682011728, 'accuracy': 0.7298070373742477, 'precision': 0.643912083428839, 'recall': 0.574001403088155, 'iou': 0.44393034706945006, 'dice': 0.5786535351172738}
Test   -> {'loss': nan, 'accuracy': 0.34268996119499207, 'precision': 0.7808966636657715, 'recall': 0.3333333432674408, 'iou': 0.11422999948263168, 'dice': 0.1701509654521942}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5834526553102162, 'accuracy': 0.739304615881132, 'precision': 0.6613088942092398, 'recall': 0.5890901214402655, 'iou': 0.46088554898033973, 'dice': 0.5992179404134336}
Test   -> {'loss': nan, 'accuracy': 0.22383958101272583, 'precision': 0.2807008922100067, 'recall': 0.2969261705875397, 'iou': 0.09028168767690659, 'dice': 0.15778440237045288}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.571883376914522, 'accuracy': 0.7447151642778645, 'precision': 0.6642595913099206, 'recall': 0.605603447297345, 'iou': 0.47635340625825134, 'dice': 0.6177160531282425}
Test   -> {'loss': nan, 'accuracy': 0.3313760459423065, 'precision': 0.47975677251815796, 'recall': 0.3558538556098938, 'iou': 0.13069689273834229, 'dice': 0.21091756224632263}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.568686074666355, 'accuracy': 0.7463400954785554, 'precision': 0.674065425992012, 'recall': 0.6087583899497986, 'iou': 0.47645976012167723, 'dice': 0.615523408677267}
Test   -> {'loss': nan, 'accuracy': 0.3917161524295807, 'precision': 0.4321478307247162, 'recall': 0.3514891266822815, 'iou': 0.15163986384868622, 'dice': 0.23352813720703125}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 19.777181086851204, 'accuracy': 0.6438591675913852, 'precision': 0.82290942442158, 'recall': 0.3389856727226921, 'iou': 0.2202360852257065, 'dice': 0.26970986140810926}
Test   -> {'loss': nan, 'accuracy': 0.42282789945602417, 'precision': 0.6579114198684692, 'recall': 0.36260080337524414, 'iou': 0.1902281939983368, 'dice': 0.2947424650192261}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 292.020009642062, 'accuracy': 0.6417786845694418, 'precision': 0.8727803997371508, 'recall': 0.33344345507414447, 'iou': 0.2140939284277999, 'dice': 0.2605562585203544}
Test   -> {'loss': nan, 'accuracy': 0.26256948709487915, 'precision': 0.7541898488998413, 'recall': 0.3333333432674408, 'iou': 0.08752317726612091, 'dice': 0.13864293694496155}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 1.4174958762915237, 'accuracy': 0.6442512551079626, 'precision': 0.8799696818641994, 'recall': 0.3333298567844474, 'iou': 0.21475081404914026, 'dice': 0.26113892994497134}
Test   -> {'loss': nan, 'accuracy': 0.24383793771266937, 'precision': 0.7479459643363953, 'recall': 0.3333333432674408, 'iou': 0.08127931505441666, 'dice': 0.13069117069244385}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 2.9975828074890636, 'accuracy': 0.6442586567090905, 'precision': 0.8780432719251384, 'recall': 0.33334078814672385, 'iou': 0.21476207407920256, 'dice': 0.26115367859601973}
Test   -> {'loss': nan, 'accuracy': 0.35530930757522583, 'precision': 0.48695552349090576, 'recall': 0.34789109230041504, 'iou': 0.14226481318473816, 'dice': 0.22703877091407776}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.8684977326704109, 'accuracy': 0.6442580352658811, 'precision': 0.8814193678938824, 'recall': 0.3333333432674408, 'iou': 0.2147526885504308, 'dice': 0.2611318483300831}
Test   -> {'loss': nan, 'accuracy': 0.30785635113716125, 'precision': 0.31991252303123474, 'recall': 0.3404005169868469, 'iou': 0.11334583163261414, 'dice': 0.18229924142360687}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 6 with IoU 0.1902281939983368
Test -> {'loss': nan, 'accuracy': 0.42282789945602417, 'precision': 0.6579114198684692, 'recall': 0.36260080337524414, 'iou': 0.1902281939983368, 'dice': 0.2947424650192261} 
Train -> {'loss': 19.777181086851204, 'accuracy': 0.6438591675913852, 'precision': 0.82290942442158, 'recall': 0.3389856727226921, 'iou': 0.2202360852257065, 'dice': 0.26970986140810926} 

Best model saved for model segnext at epoch 10

Trial 21:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.0092654217844423, 'accuracy': 0.6221356537031091, 'precision': 0.38709070889846137, 'recall': 0.3431358788324439, 'iou': 0.22278946560362112, 'dice': 0.2806777895792671}
Test   -> {'loss': nan, 'accuracy': 0.31982421875, 'precision': 0.3823067843914032, 'recall': 0.3505605459213257, 'iou': 0.12577462196350098, 'dice': 0.20442214608192444}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6182110418444094, 'accuracy': 0.7249359892762226, 'precision': 0.6095582765081654, 'recall': 0.5626556614170903, 'iou': 0.4326153991015061, 'dice': 0.5635168158489725}
Test   -> {'loss': nan, 'accuracy': 0.30223268270492554, 'precision': 0.29071861505508423, 'recall': 0.3248678147792816, 'iou': 0.10999718308448792, 'dice': 0.17503541707992554}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5865107956139938, 'accuracy': 0.741351989041204, 'precision': 0.6442649644354116, 'recall': 0.6052080973334935, 'iou': 0.4721197035001672, 'dice': 0.6152284839878912}
Test   -> {'loss': nan, 'accuracy': 0.3659845292568207, 'precision': 0.4040815234184265, 'recall': 0.36023491621017456, 'iou': 0.1571938842535019, 'dice': 0.25325024127960205}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5980872361556343, 'accuracy': 0.7361324714577716, 'precision': 0.6322975241619607, 'recall': 0.5912482795508012, 'iou': 0.46071337902027626, 'dice': 0.6027600998463838}
Test   -> {'loss': nan, 'accuracy': 0.29173994064331055, 'precision': 0.7639133334159851, 'recall': 0.3333333432674408, 'iou': 0.09724664688110352, 'dice': 0.1505669206380844}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5805154333943906, 'accuracy': 0.741368950449902, 'precision': 0.6432252510734227, 'recall': 0.6027315855026245, 'iou': 0.4679311075936193, 'dice': 0.608190685769786}
Test   -> {'loss': nan, 'accuracy': 0.3217032253742218, 'precision': 0.773901104927063, 'recall': 0.3333333432674408, 'iou': 0.1072344109416008, 'dice': 0.16226699948310852}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5566794271054475, 'accuracy': 0.7520456143047498, 'precision': 0.662558653043664, 'recall': 0.6174306268277375, 'iou': 0.48783090632894766, 'dice': 0.6317311597907025}
Test   -> {'loss': nan, 'accuracy': 0.28056398034095764, 'precision': 0.7601879835128784, 'recall': 0.3333333432674408, 'iou': 0.09352132678031921, 'dice': 0.1460627168416977}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5452842017878656, 'accuracy': 0.7572885554769765, 'precision': 0.6691378925157629, 'recall': 0.6304064932076827, 'iou': 0.4985124072302943, 'dice': 0.6427846545758454}
Test   -> {'loss': nan, 'accuracy': 0.2513483762741089, 'precision': 0.750449538230896, 'recall': 0.3333333432674408, 'iou': 0.08378279209136963, 'dice': 0.13390803337097168}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5335072968317115, 'accuracy': 0.7634786388148432, 'precision': 0.6804242082264113, 'recall': 0.6410841195479683, 'iou': 0.5083782434463501, 'dice': 0.6522986821506335}
Test   -> {'loss': nan, 'accuracy': 0.3351636528968811, 'precision': 0.7783879041671753, 'recall': 0.3333333432674408, 'iou': 0.1117212176322937, 'dice': 0.1673521101474762}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5210835850757102, 'accuracy': 0.7706667625385782, 'precision': 0.6882124709046405, 'recall': 0.6527096903842429, 'iou': 0.521023404598236, 'dice': 0.6651505470275879}
Test   -> {'loss': nan, 'accuracy': 0.2748509645462036, 'precision': 0.7582836151123047, 'recall': 0.3333333432674408, 'iou': 0.09161698818206787, 'dice': 0.14372973144054413}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.507914137840271, 'accuracy': 0.7761136982751929, 'precision': 0.6988767945248148, 'recall': 0.65837663774905, 'iou': 0.529049729782602, 'dice': 0.6727331716081371}
Test   -> {'loss': nan, 'accuracy': 0.27139997482299805, 'precision': 0.7571333646774292, 'recall': 0.3333333432674408, 'iou': 0.09046666324138641, 'dice': 0.14231032133102417}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 3 with IoU 0.1571938842535019
Test -> {'loss': nan, 'accuracy': 0.3659845292568207, 'precision': 0.4040815234184265, 'recall': 0.36023491621017456, 'iou': 0.1571938842535019, 'dice': 0.25325024127960205} 
Train -> {'loss': 0.5865107956139938, 'accuracy': 0.741351989041204, 'precision': 0.6442649644354116, 'recall': 0.6052080973334935, 'iou': 0.4721197035001672, 'dice': 0.6152284839878912} 

Best model saved for model segnext at epoch 10

Trial 22:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.9026942323083463, 'accuracy': 0.6483601151601128, 'precision': 0.6825578634505687, 'recall': 0.4143633023552273, 'iou': 0.2844842295931733, 'dice': 0.36340550462836807}
Test   -> {'loss': nan, 'accuracy': 0.28964918851852417, 'precision': 0.7632164359092712, 'recall': 0.3333333432674408, 'iou': 0.09654973447322845, 'dice': 0.14973022043704987}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 3.0547539731730584, 'accuracy': 0.6480528279491092, 'precision': 0.7868328053666198, 'recall': 0.3825768538143324, 'iou': 0.2550873611284339, 'dice': 0.31955849981826284}
Test   -> {'loss': nan, 'accuracy': 0.2802547514438629, 'precision': 0.7600849866867065, 'recall': 0.3333333432674408, 'iou': 0.09341825544834137, 'dice': 0.145936980843544}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 4.839889966664107, 'accuracy': 0.6442157665024633, 'precision': 0.8733073099799779, 'recall': 0.3333256731862607, 'iou': 0.2147470864912738, 'dice': 0.26112897642280747}
Test   -> {'loss': nan, 'accuracy': 0.31983667612075806, 'precision': 0.7732788920402527, 'recall': 0.3333333432674408, 'iou': 0.10661222785711288, 'dice': 0.16155366599559784}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.8684487068134805, 'accuracy': 0.6442418142505314, 'precision': 0.8814139625300532, 'recall': 0.3333333432674408, 'iou': 0.2147472807246706, 'dice': 0.2611397649930871}
Test   -> {'loss': nan, 'accuracy': 0.33828049898147583, 'precision': 0.7794268131256104, 'recall': 0.3333333432674408, 'iou': 0.11276017129421234, 'dice': 0.16851501166820526}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.8685031652450561, 'accuracy': 0.6442418150279833, 'precision': 0.8814139617526013, 'recall': 0.3333333432674408, 'iou': 0.2147472804007323, 'dice': 0.26113946619241135}
Test   -> {'loss': nan, 'accuracy': 0.29945218563079834, 'precision': 0.7263504266738892, 'recall': 0.3606284260749817, 'iou': 0.11591582745313644, 'dice': 0.19171306490898132}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.8685049598631651, 'accuracy': 0.6442418158054352, 'precision': 0.8814139614934506, 'recall': 0.3333333432674408, 'iou': 0.21474728117818417, 'dice': 0.2611451456728189}
Test   -> {'loss': nan, 'accuracy': 0.2653995454311371, 'precision': 0.5810892581939697, 'recall': 0.31695258617401123, 'iou': 0.09692361205816269, 'dice': 0.16062919795513153}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.8684895948223446, 'accuracy': 0.644241816582887, 'precision': 0.8814139648624089, 'recall': 0.3333333432674408, 'iou': 0.2147472809838212, 'dice': 0.2611462072185848}
Test   -> {'loss': nan, 'accuracy': 0.2398606836795807, 'precision': 0.7466201782226562, 'recall': 0.3333333432674408, 'iou': 0.07995356619358063, 'dice': 0.1289718598127365}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.8780122953912486, 'accuracy': 0.6442390325276748, 'precision': 0.8799645162147024, 'recall': 0.33333239892254707, 'iou': 0.21474712076394453, 'dice': 0.2611421071964761}
Test   -> {'loss': nan, 'accuracy': 0.2667423188686371, 'precision': 0.7555807828903198, 'recall': 0.3333333432674408, 'iou': 0.08891411125659943, 'dice': 0.140382319688797}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 13.916017966425937, 'accuracy': 0.6439656871816386, 'precision': 0.8741659957429637, 'recall': 0.33338294845560323, 'iou': 0.21480599829684133, 'dice': 0.2613170715129894}
Test   -> {'loss': nan, 'accuracy': 0.2791561186313629, 'precision': 0.7597187757492065, 'recall': 0.3333333432674408, 'iou': 0.09305204451084137, 'dice': 0.14548973739147186}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.870029987718748, 'accuracy': 0.6442418158054352, 'precision': 0.8814139653807102, 'recall': 0.3333333432674408, 'iou': 0.21474728137254714, 'dice': 0.2611323992843213}
Test   -> {'loss': nan, 'accuracy': 0.3510829210281372, 'precision': 0.7836942672729492, 'recall': 0.3333333432674408, 'iou': 0.1170276552438736, 'dice': 0.17323532700538635}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 10 with IoU 0.1170276552438736
Test -> {'loss': nan, 'accuracy': 0.3510829210281372, 'precision': 0.7836942672729492, 'recall': 0.3333333432674408, 'iou': 0.1170276552438736, 'dice': 0.17323532700538635} 
Train -> {'loss': 0.870029987718748, 'accuracy': 0.6442418158054352, 'precision': 0.8814139653807102, 'recall': 0.3333333432674408, 'iou': 0.21474728137254714, 'dice': 0.2611323992843213} 

Best model saved for model segnext at epoch 10

Trial 23:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.0163877860359523, 'accuracy': 0.6249321623988774, 'precision': 0.39819402927937714, 'recall': 0.3543749477552331, 'iou': 0.2312404788058737, 'dice': 0.2940457574699236}
Test   -> {'loss': nan, 'accuracy': 0.27042558789253235, 'precision': 0.7568085193634033, 'recall': 0.3333333432674408, 'iou': 0.09014186263084412, 'dice': 0.14190813899040222}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6104596215745677, 'accuracy': 0.7266698966855588, 'precision': 0.6148217735083207, 'recall': 0.5697882294654846, 'iou': 0.4375312947708627, 'dice': 0.571564841788748}
Test   -> {'loss': nan, 'accuracy': 0.284760445356369, 'precision': 0.7615868449211121, 'recall': 0.3333333432674408, 'iou': 0.09492015093564987, 'dice': 0.147763192653656}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5858555726383043, 'accuracy': 0.7406559063040692, 'precision': 0.645539841444596, 'recall': 0.5976816317309503, 'iou': 0.4687412759532099, 'dice': 0.611610602295917}
Test   -> {'loss': nan, 'accuracy': 0.3055270314216614, 'precision': 0.768509030342102, 'recall': 0.3333333432674408, 'iou': 0.10184234380722046, 'dice': 0.1560172140598297}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5667203421178071, 'accuracy': 0.7488433957099915, 'precision': 0.6595830259115799, 'recall': 0.6116580196048902, 'iou': 0.48251193424929745, 'dice': 0.6260435928469119}
Test   -> {'loss': nan, 'accuracy': 0.29513269662857056, 'precision': 0.7650442123413086, 'recall': 0.3333333432674408, 'iou': 0.09837757050991058, 'dice': 0.1519189029932022}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5617316971654477, 'accuracy': 0.7502926515496295, 'precision': 0.6642476366913836, 'recall': 0.6093685937964398, 'iou': 0.4783587974050771, 'dice': 0.6174806522286457}
Test   -> {'loss': nan, 'accuracy': 0.28914594650268555, 'precision': 0.7630486488342285, 'recall': 0.3333333432674408, 'iou': 0.09638198465108871, 'dice': 0.14952844381332397}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5452301108318827, 'accuracy': 0.7575671584709831, 'precision': 0.6718122005462647, 'recall': 0.631524888328884, 'iou': 0.5004101162371428, 'dice': 0.6450699578160825}
Test   -> {'loss': nan, 'accuracy': 0.2714223861694336, 'precision': 0.32489877939224243, 'recall': 0.3326466679573059, 'iou': 0.09389834851026535, 'dice': 0.15016743540763855}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5268739653670269, 'accuracy': 0.7675969222317571, 'precision': 0.6876047336536905, 'recall': 0.6454632043838501, 'iou': 0.5161119549170784, 'dice': 0.6605413105176843}
Test   -> {'loss': nan, 'accuracy': 0.2883116900920868, 'precision': 0.43124622106552124, 'recall': 0.3380983769893646, 'iou': 0.10103344917297363, 'dice': 0.16064494848251343}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5140062363251395, 'accuracy': 0.7734325636988101, 'precision': 0.6954670325569484, 'recall': 0.6554618368978086, 'iou': 0.5254578108372896, 'dice': 0.6694286429363748}
Test   -> {'loss': nan, 'accuracy': 0.31016042828559875, 'precision': 0.770053505897522, 'recall': 0.3333333432674408, 'iou': 0.10338681191205978, 'dice': 0.1578231304883957}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4984242182710896, 'accuracy': 0.7819770496824513, 'precision': 0.707604397898135, 'recall': 0.6696415600569352, 'iou': 0.5404581417208133, 'dice': 0.6840459802876349}
Test   -> {'loss': nan, 'accuracy': 0.2733783423900604, 'precision': 0.7577928304672241, 'recall': 0.3333333432674408, 'iou': 0.09112611413002014, 'dice': 0.14312496781349182}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.4842158369396044, 'accuracy': 0.7888424023337987, 'precision': 0.7175921756288279, 'recall': 0.6783922610075578, 'iou': 0.5510463408801867, 'dice': 0.6939058682192927}
Test   -> {'loss': nan, 'accuracy': 0.2993273138999939, 'precision': 0.7664424777030945, 'recall': 0.3333333432674408, 'iou': 0.0997757762670517, 'dice': 0.1535806655883789}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 8 with IoU 0.10338681191205978
Test -> {'loss': nan, 'accuracy': 0.31016042828559875, 'precision': 0.770053505897522, 'recall': 0.3333333432674408, 'iou': 0.10338681191205978, 'dice': 0.1578231304883957} 
Train -> {'loss': 0.5140062363251395, 'accuracy': 0.7734325636988101, 'precision': 0.6954670325569484, 'recall': 0.6554618368978086, 'iou': 0.5254578108372896, 'dice': 0.6694286429363748} 

Best model saved for model segnext at epoch 10

Trial 24:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.3897758688615716, 'accuracy': 0.7130603700876236, 'precision': 0.6234167527893315, 'recall': 0.6239165561354678, 'iou': 0.4709158003978107, 'dice': 0.6165144630100416}
Test   -> {'loss': nan, 'accuracy': 0.30272191762924194, 'precision': 0.2636461555957794, 'recall': 0.3085491359233856, 'iou': 0.1264791488647461, 'dice': 0.20433309674263}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.300070161404817, 'accuracy': 0.7791945022085439, 'precision': 0.7033559832883918, 'recall': 0.7001885717329772, 'iou': 0.5563048767006915, 'dice': 0.7000561724538389}
Test   -> {'loss': nan, 'accuracy': 0.34834879636764526, 'precision': 0.41619715094566345, 'recall': 0.36754387617111206, 'iou': 0.16955316066741943, 'dice': 0.2807800769805908}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.2689347383768662, 'accuracy': 0.8015041014422541, 'precision': 0.7341674478157707, 'recall': 0.7284074106942052, 'iou': 0.5902698620505955, 'dice': 0.7298285598340242}
Test   -> {'loss': nan, 'accuracy': 0.37536245584487915, 'precision': 0.27978652715682983, 'recall': 0.3160303235054016, 'iou': 0.13488641381263733, 'dice': 0.20362631976604462}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.24378615540006887, 'accuracy': 0.8200564228970072, 'precision': 0.7590991243072178, 'recall': 0.7520328674627387, 'iou': 0.61970952205036, 'dice': 0.7543769509895988}
Test   -> {'loss': nan, 'accuracy': 0.38827699422836304, 'precision': 0.5150671005249023, 'recall': 0.35819384455680847, 'iou': 0.15459874272346497, 'dice': 0.24106785655021667}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.21816963164702705, 'accuracy': 0.8384662008803824, 'precision': 0.7855191054551498, 'recall': 0.777400446197261, 'iou': 0.651567591532417, 'dice': 0.7801373911940533}
Test   -> {'loss': nan, 'accuracy': 0.30170300602912903, 'precision': 0.7672343254089355, 'recall': 0.3333333432674408, 'iou': 0.10056766867637634, 'dice': 0.15451708436012268}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.19277308583259584, 'accuracy': 0.8567556199820145, 'precision': 0.8116869820200878, 'recall': 0.8013213994710342, 'iou': 0.6840490019839743, 'dice': 0.8051118257253066}
Test   -> {'loss': nan, 'accuracy': 0.3096163868904114, 'precision': 0.7698721289634705, 'recall': 0.3333333432674408, 'iou': 0.10320546478033066, 'dice': 0.15761175751686096}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.1698355918345244, 'accuracy': 0.8733603728854138, 'precision': 0.834574315081472, 'recall': 0.8241519772488138, 'iou': 0.7152097787546075, 'dice': 0.8282445262307706}
Test   -> {'loss': nan, 'accuracy': 0.2934296131134033, 'precision': 0.7644765377044678, 'recall': 0.3333333432674408, 'iou': 0.09780987352132797, 'dice': 0.15124112367630005}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.15058930101601975, 'accuracy': 0.8874334656673929, 'precision': 0.8530025386292002, 'recall': 0.8441311926945396, 'iou': 0.7426500421503316, 'dice': 0.8476644547089286}
Test   -> {'loss': nan, 'accuracy': 0.25379788875579834, 'precision': 0.7512660026550293, 'recall': 0.3333333432674408, 'iou': 0.08459930121898651, 'dice': 0.13494884967803955}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.135196133022723, 'accuracy': 0.8986372698908267, 'precision': 0.8678214594073917, 'recall': 0.8607071350450101, 'iou': 0.7655058632726255, 'dice': 0.8633596902308257}
Test   -> {'loss': nan, 'accuracy': 0.35028573870658875, 'precision': 0.7834286093711853, 'recall': 0.3333333432674408, 'iou': 0.11676191538572311, 'dice': 0.17294400930404663}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.1212756071401679, 'accuracy': 0.909047150871028, 'precision': 0.8815579328847968, 'recall': 0.8750956934431325, 'iou': 0.7868642128032187, 'dice': 0.8776319462320079}
Test   -> {'loss': nan, 'accuracy': 0.2904227077960968, 'precision': 0.7634742259979248, 'recall': 0.3333333432674408, 'iou': 0.0968075692653656, 'dice': 0.15004009008407593}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.16955316066741943
Test -> {'loss': nan, 'accuracy': 0.34834879636764526, 'precision': 0.41619715094566345, 'recall': 0.36754387617111206, 'iou': 0.16955316066741943, 'dice': 0.2807800769805908} 
Train -> {'loss': 0.300070161404817, 'accuracy': 0.7791945022085439, 'precision': 0.7033559832883918, 'recall': 0.7001885717329772, 'iou': 0.5563048767006915, 'dice': 0.7000561724538389} 

Best model saved for model segnext at epoch 10

Trial 25:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4726595754208772, 'accuracy': 0.648168160604394, 'precision': 0.5626795354096786, 'recall': 0.5574552955834762, 'iou': 0.3970827499161596, 'dice': 0.5396985240604566}
Test   -> {'loss': 0.5536454916000366, 'accuracy': 0.5899997353553772, 'precision': 0.5642642974853516, 'recall': 0.46305426955223083, 'iou': 0.3209596574306488, 'dice': 0.44330835342407227}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.34142818554587984, 'accuracy': 0.7512826821078424, 'precision': 0.6667114133420198, 'recall': 0.6629530248434647, 'iou': 0.5158811522566754, 'dice': 0.6636424743610879}
Test   -> {'loss': 0.6317537426948547, 'accuracy': 0.6018745303153992, 'precision': 0.5435826182365417, 'recall': 0.397183358669281, 'iou': 0.272072970867157, 'dice': 0.3689356744289398}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3003964268642923, 'accuracy': 0.779407669150311, 'precision': 0.7047513215438179, 'recall': 0.6993953549343607, 'iou': 0.5563570649727531, 'dice': 0.7010023707928865}
Test   -> {'loss': nan, 'accuracy': 0.44106119871139526, 'precision': 0.3882916569709778, 'recall': 0.38538169860839844, 'iou': 0.24511384963989258, 'dice': 0.37431979179382324}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2707860283229662, 'accuracy': 0.8007759482964225, 'precision': 0.733098890988723, 'recall': 0.7268572273461715, 'iou': 0.588466707519863, 'dice': 0.7289915043374766}
Test   -> {'loss': nan, 'accuracy': 0.35186269879341125, 'precision': 0.3362852931022644, 'recall': 0.3217082619667053, 'iou': 0.16632457077503204, 'dice': 0.2736457586288452}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2439477588819421, 'accuracy': 0.8193929324979368, 'precision': 0.7596723924512448, 'recall': 0.752664794092593, 'iou': 0.6194939141688139, 'dice': 0.7552126449087392}
Test   -> {'loss': nan, 'accuracy': 0.3090088367462158, 'precision': 0.3364882171154022, 'recall': 0.3316218852996826, 'iou': 0.11589743942022324, 'dice': 0.18713125586509705}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.21863462406656017, 'accuracy': 0.8381109279135, 'precision': 0.7844256629114565, 'recall': 0.7762043476104736, 'iou': 0.6502109558685966, 'dice': 0.7796234711356785}
Test   -> {'loss': nan, 'accuracy': 0.30264031887054443, 'precision': 0.11366130411624908, 'recall': 0.31880050897598267, 'iou': 0.10104858130216599, 'dice': 0.15524564683437347}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.19436769692794137, 'accuracy': 0.8556387942770253, 'precision': 0.8092622280120849, 'recall': 0.799884669677071, 'iou': 0.6816565145616946, 'dice': 0.8039284307023753}
Test   -> {'loss': nan, 'accuracy': 0.3196333348751068, 'precision': 0.3617776334285736, 'recall': 0.33531343936920166, 'iou': 0.1217138022184372, 'dice': 0.1953367292881012}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.17075651573098224, 'accuracy': 0.8729045137115147, 'precision': 0.8336703948352648, 'recall': 0.8228407398514126, 'iou': 0.7138191658517589, 'dice': 0.8275957874629809}
Test   -> {'loss': nan, 'accuracy': 0.2775212526321411, 'precision': 0.3593211770057678, 'recall': 0.33462613821029663, 'iou': 0.09779473394155502, 'dice': 0.15714780986309052}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.15337319166763969, 'accuracy': 0.8852203363957613, 'precision': 0.8510285491528718, 'recall': 0.8410427425218665, 'iou': 0.7384905327921328, 'dice': 0.8451390064280966}
Test   -> {'loss': nan, 'accuracy': 0.2722790837287903, 'precision': 0.2549135386943817, 'recall': 0.3037789463996887, 'iou': 0.10139061510562897, 'dice': 0.16719260811805725}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.13516968125882356, 'accuracy': 0.8989016973454019, 'precision': 0.8685522789540499, 'recall': 0.8594511876935544, 'iou': 0.7653111426726632, 'dice': 0.8635579990304034}
Test   -> {'loss': nan, 'accuracy': 0.3093239963054657, 'precision': 0.4295348525047302, 'recall': 0.33710429072380066, 'iou': 0.10809063166379929, 'dice': 0.16793160140514374}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.3209596574306488
Test -> {'loss': 0.5536454916000366, 'accuracy': 0.5899997353553772, 'precision': 0.5642642974853516, 'recall': 0.46305426955223083, 'iou': 0.3209596574306488, 'dice': 0.44330835342407227} 
Train -> {'loss': 0.4726595754208772, 'accuracy': 0.648168160604394, 'precision': 0.5626795354096786, 'recall': 0.5574552955834762, 'iou': 0.3970827499161596, 'dice': 0.5396985240604566} 

Best model saved for model segnext at epoch 10

Trial 26:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.39445637697758884, 'accuracy': 0.7086846053600311, 'precision': 0.6202420290397561, 'recall': 0.6196128755807877, 'iou': 0.4665533692940422, 'dice': 0.6122163031412208}
Test   -> {'loss': nan, 'accuracy': 0.30543363094329834, 'precision': 0.4336436986923218, 'recall': 0.3653728663921356, 'iou': 0.148198202252388, 'dice': 0.25296342372894287}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.30347232196642004, 'accuracy': 0.7767963126949642, 'precision': 0.700134416507638, 'recall': 0.6981300455072652, 'iou': 0.5532635820948559, 'dice': 0.6975241961686508}
Test   -> {'loss': nan, 'accuracy': 0.30526670813560486, 'precision': 0.7684223055839539, 'recall': 0.3333333432674408, 'iou': 0.10175557434558868, 'dice': 0.15591537952423096}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.2742275974024897, 'accuracy': 0.7972941831402157, 'precision': 0.7279482064039811, 'recall': 0.7251670378705729, 'iou': 0.5843669809724974, 'dice': 0.724946477620498}
Test   -> {'loss': nan, 'accuracy': 0.3535056412220001, 'precision': 0.4132213592529297, 'recall': 0.3460918664932251, 'iou': 0.14181873202323914, 'dice': 0.22530484199523926}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2486228582651719, 'accuracy': 0.8162967438283174, 'precision': 0.7547079767869866, 'recall': 0.748309950724892, 'iou': 0.614036526369012, 'dice': 0.7499246695767279}
Test   -> {'loss': nan, 'accuracy': 0.27489611506462097, 'precision': 0.7582987546920776, 'recall': 0.3333333432674408, 'iou': 0.09163203835487366, 'dice': 0.14374825358390808}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.22624111849328746, 'accuracy': 0.8327550066554028, 'precision': 0.7773122595704121, 'recall': 0.7695159409357154, 'iou': 0.6410577457884084, 'dice': 0.7719390343064847}
Test   -> {'loss': nan, 'accuracy': 0.3145041763782501, 'precision': 0.7715014219284058, 'recall': 0.3333333432674408, 'iou': 0.10483473539352417, 'dice': 0.15950460731983185}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.1996116218359574, 'accuracy': 0.8514588314553966, 'precision': 0.8040547609329224, 'recall': 0.7952209306799847, 'iou': 0.6751960653325786, 'dice': 0.7985218636367633}
Test   -> {'loss': nan, 'accuracy': 0.3196834623813629, 'precision': 0.773227870464325, 'recall': 0.3333333432674408, 'iou': 0.10656115412712097, 'dice': 0.16149502992630005}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.17593108389688575, 'accuracy': 0.8692821090636046, 'precision': 0.8283294252727342, 'recall': 0.8184681760228198, 'iou': 0.7071398644343666, 'dice': 0.8222978677438653}
Test   -> {'loss': nan, 'accuracy': 0.22834372520446777, 'precision': 0.7427812814712524, 'recall': 0.3333333432674408, 'iou': 0.07611458003520966, 'dice': 0.1239304170012474}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.15533547893814417, 'accuracy': 0.8835603973139887, 'precision': 0.8484847050646077, 'recall': 0.8391114157179128, 'iou': 0.7357556210911792, 'dice': 0.8428959027580593}
Test   -> {'loss': nan, 'accuracy': 0.30050721764564514, 'precision': 0.7668356895446777, 'recall': 0.3333333432674408, 'iou': 0.10016907751560211, 'dice': 0.1540461629629135}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.13816050265146337, 'accuracy': 0.8964518946150075, 'precision': 0.8651098541591479, 'recall': 0.8572945651800736, 'iou': 0.7610671434713446, 'dice': 0.8604016011175902}
Test   -> {'loss': nan, 'accuracy': 0.33575063943862915, 'precision': 0.7785835266113281, 'recall': 0.3333333432674408, 'iou': 0.11191689223051071, 'dice': 0.1675715297460556}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.12369799536207447, 'accuracy': 0.9070013473863187, 'precision': 0.8794818595699642, 'recall': 0.8720303716866866, 'iou': 0.782959869115249, 'dice': 0.8750354295191558}
Test   -> {'loss': nan, 'accuracy': 0.26105359196662903, 'precision': 0.7536845207214355, 'recall': 0.3333333432674408, 'iou': 0.08701786398887634, 'dice': 0.1380082070827484}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.148198202252388
Test -> {'loss': nan, 'accuracy': 0.30543363094329834, 'precision': 0.4336436986923218, 'recall': 0.3653728663921356, 'iou': 0.148198202252388, 'dice': 0.25296342372894287} 
Train -> {'loss': 0.39445637697758884, 'accuracy': 0.7086846053600311, 'precision': 0.6202420290397561, 'recall': 0.6196128755807877, 'iou': 0.4665533692940422, 'dice': 0.6122163031412208} 

Best model saved for model segnext at epoch 10

Trial 27:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4759175570114799, 'accuracy': 0.6411115275776904, 'precision': 0.5608264119728752, 'recall': 0.5550120540287183, 'iou': 0.39219201077585636, 'dice': 0.5341903603595236}
Test   -> {'loss': 0.609711229801178, 'accuracy': 0.5719903111457825, 'precision': 0.580227255821228, 'recall': 0.4371196925640106, 'iou': 0.29185783863067627, 'dice': 0.3975444734096527}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.338176181005395, 'accuracy': 0.7541096765062083, 'precision': 0.6681179621945257, 'recall': 0.6669369345125945, 'iou': 0.51935809539712, 'dice': 0.6667273915332297}
Test   -> {'loss': 0.66227787733078, 'accuracy': 0.55724036693573, 'precision': 0.53753662109375, 'recall': 0.39821261167526245, 'iou': 0.2612417936325073, 'dice': 0.3498111665248871}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.298354288806086, 'accuracy': 0.7808539971061375, 'precision': 0.7056472021600474, 'recall': 0.7016704538594122, 'iou': 0.5582451317621314, 'dice': 0.7026011995647264}
Test   -> {'loss': nan, 'accuracy': 0.5357096195220947, 'precision': 0.39438876509666443, 'recall': 0.395573228597641, 'iou': 0.2663249671459198, 'dice': 0.37612825632095337}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.26674839931985606, 'accuracy': 0.8039799783540809, 'precision': 0.7375586162442747, 'recall': 0.7307358441145524, 'iou': 0.5932429220365442, 'dice': 0.7330045969589897}
Test   -> {'loss': nan, 'accuracy': 0.37448805570602417, 'precision': 0.35434573888778687, 'recall': 0.33524614572525024, 'iou': 0.18781960010528564, 'dice': 0.3050227165222168}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2409459393957387, 'accuracy': 0.8222338826760002, 'precision': 0.7634158279584802, 'recall': 0.7541196615799614, 'iou': 0.6230463349300882, 'dice': 0.7578767227089923}
Test   -> {'loss': nan, 'accuracy': 0.2815968990325928, 'precision': 0.3356386423110962, 'recall': 0.3313278555870056, 'iou': 0.10110600292682648, 'dice': 0.16323283314704895}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.21220782114111858, 'accuracy': 0.8426178942555966, 'precision': 0.791327074299688, 'recall': 0.7826537298119587, 'iou': 0.6586825417435688, 'dice': 0.7863748695539392}
Test   -> {'loss': nan, 'accuracy': 0.3057689964771271, 'precision': 0.3091610372066498, 'recall': 0.33220258355140686, 'iou': 0.10406512022018433, 'dice': 0.1609169840812683}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.1860553653343864, 'accuracy': 0.8616752028465271, 'precision': 0.8180682902750762, 'recall': 0.8071993262871452, 'iou': 0.6926247347956118, 'dice': 0.8121470492819082}
Test   -> {'loss': nan, 'accuracy': 0.3112879991531372, 'precision': 0.7704293131828308, 'recall': 0.3333333432674408, 'iou': 0.1037626788020134, 'dice': 0.15826070308685303}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.16410294926684835, 'accuracy': 0.8777511876562367, 'precision': 0.8405393102894658, 'recall': 0.829158441916756, 'iou': 0.7230297866074935, 'dice': 0.8342049059660538}
Test   -> {'loss': nan, 'accuracy': 0.275727242231369, 'precision': 0.7585757970809937, 'recall': 0.3333333432674408, 'iou': 0.09190908074378967, 'dice': 0.14408892393112183}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.14458033416582192, 'accuracy': 0.8918571586194246, 'precision': 0.8594857651254405, 'recall': 0.8495586001354715, 'iou': 0.7512731344803519, 'dice': 0.854035554761472}
Test   -> {'loss': nan, 'accuracy': 0.3271602690219879, 'precision': 0.7757201194763184, 'recall': 0.3333333432674408, 'iou': 0.10905342549085617, 'dice': 0.164341002702713}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.12984060619188392, 'accuracy': 0.9028330331263335, 'precision': 0.873801154675691, 'recall': 0.864801547838294, 'iou': 0.773240562107252, 'dice': 0.8688849495804828}
Test   -> {'loss': nan, 'accuracy': 0.2916698753833771, 'precision': 0.7638899683952332, 'recall': 0.3333333432674408, 'iou': 0.09722329676151276, 'dice': 0.15053892135620117}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.29185783863067627
Test -> {'loss': 0.609711229801178, 'accuracy': 0.5719903111457825, 'precision': 0.580227255821228, 'recall': 0.4371196925640106, 'iou': 0.29185783863067627, 'dice': 0.3975444734096527} 
Train -> {'loss': 0.4759175570114799, 'accuracy': 0.6411115275776904, 'precision': 0.5608264119728752, 'recall': 0.5550120540287183, 'iou': 0.39219201077585636, 'dice': 0.5341903603595236} 

Best model saved for model segnext at epoch 10

Trial 28:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5120625514051188, 'accuracy': 0.6339818804808285, 'precision': 0.5165787490813628, 'recall': 0.5207198425479557, 'iou': 0.3690110973689867, 'dice': 0.5011588189912879}
Test   -> {'loss': nan, 'accuracy': 0.29505640268325806, 'precision': 0.7650188207626343, 'recall': 0.3333333432674408, 'iou': 0.09835213422775269, 'dice': 0.15188857913017273}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4755497414132823, 'accuracy': 0.6850888954556507, 'precision': 0.5593383235775906, 'recall': 0.5548882775980494, 'iou': 0.4041411624006603, 'dice': 0.5400565528351328}
Test   -> {'loss': nan, 'accuracy': 0.32380643486976624, 'precision': 0.7746021747589111, 'recall': 0.3333333432674408, 'iou': 0.10793548822402954, 'dice': 0.16306838393211365}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6851820979429328, 'accuracy': 0.609824471110883, 'precision': 0.6348106454248014, 'recall': 0.3877091661743496, 'iou': 0.2483593450292297, 'dice': 0.3257793423274289}
Test   -> {'loss': nan, 'accuracy': 0.22558468580245972, 'precision': 0.7418615818023682, 'recall': 0.3333333432674408, 'iou': 0.07519489526748657, 'dice': 0.12270861119031906}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7400945510553277, 'accuracy': 0.6442091154015582, 'precision': 0.7904034993570784, 'recall': 0.3333451512067214, 'iou': 0.21478059764789498, 'dice': 0.26122180255858796}
Test   -> {'loss': nan, 'accuracy': 0.30853769183158875, 'precision': 0.7695125937461853, 'recall': 0.3333333432674408, 'iou': 0.10284589976072311, 'dice': 0.15719211101531982}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7401020011176234, 'accuracy': 0.644206073232319, 'precision': 0.8019487566922022, 'recall': 0.33332561111968495, 'iou': 0.2147601239707159, 'dice': 0.26116618028153543}
Test   -> {'loss': nan, 'accuracy': 0.2383061647415161, 'precision': 0.7461020350456238, 'recall': 0.3333333432674408, 'iou': 0.07943539321422577, 'dice': 0.1282968521118164}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7400994070198225, 'accuracy': 0.6442185005416041, 'precision': 0.7975716321364693, 'recall': 0.3333343552506488, 'iou': 0.2147673268680987, 'dice': 0.26118126019187593}
Test   -> {'loss': nan, 'accuracy': 0.2541852593421936, 'precision': 0.7513951063156128, 'recall': 0.3333333432674408, 'iou': 0.0847284197807312, 'dice': 0.13511309027671814}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7400729573291281, 'accuracy': 0.6442266391671222, 'precision': 0.7882603851349458, 'recall': 0.3333463261956754, 'iou': 0.2147825460071149, 'dice': 0.26120998639127485}
Test   -> {'loss': nan, 'accuracy': 0.30348795652389526, 'precision': 0.7678293585777283, 'recall': 0.3333333432674408, 'iou': 0.10116266459226608, 'dice': 0.15521840751171112}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7401195463926896, 'accuracy': 0.6442077805166659, 'precision': 0.7851846267347751, 'recall': 0.3333224398934323, 'iou': 0.2147533852768981, 'dice': 0.26115211572336117}
Test   -> {'loss': nan, 'accuracy': 0.2808999717235565, 'precision': 0.7603000402450562, 'recall': 0.3333333432674408, 'iou': 0.09363332390785217, 'dice': 0.1461992859840393}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7399969725505166, 'accuracy': 0.644210426962894, 'precision': 0.7737949343479198, 'recall': 0.33336491507032645, 'iou': 0.21481971578753511, 'dice': 0.26129413162884507}
Test   -> {'loss': nan, 'accuracy': 0.2849407494068146, 'precision': 0.7616469264030457, 'recall': 0.3333333432674408, 'iou': 0.09498025476932526, 'dice': 0.14783599972724915}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7395053980143174, 'accuracy': 0.6442368776901909, 'precision': 0.6968524638725364, 'recall': 0.33355895125347634, 'iou': 0.2151105672121048, 'dice': 0.26187690489965937}
Test   -> {'loss': nan, 'accuracy': 0.33990478515625, 'precision': 0.77996826171875, 'recall': 0.3333333432674408, 'iou': 0.1133015975356102, 'dice': 0.16911888122558594}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 10 with IoU 0.1133015975356102
Test -> {'loss': nan, 'accuracy': 0.33990478515625, 'precision': 0.77996826171875, 'recall': 0.3333333432674408, 'iou': 0.1133015975356102, 'dice': 0.16911888122558594} 
Train -> {'loss': 0.7395053980143174, 'accuracy': 0.6442368776901909, 'precision': 0.6968524638725364, 'recall': 0.33355895125347634, 'iou': 0.2151105672121048, 'dice': 0.26187690489965937} 

Best model saved for model segnext at epoch 10

Trial 29:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5393436670303344, 'accuracy': 0.5941147003484809, 'precision': 0.5006284827771394, 'recall': 0.49349319157393085, 'iou': 0.3348660176214964, 'dice': 0.46503990810850393}
Test   -> {'loss': nan, 'accuracy': 0.31426161527633667, 'precision': 0.34243243932724, 'recall': 0.33676382899284363, 'iou': 0.10869475454092026, 'dice': 0.16900750994682312}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.37627642932145494, 'accuracy': 0.7244362012199733, 'precision': 0.6282135237818179, 'recall': 0.6280809594237287, 'iou': 0.4779974543530008, 'dice': 0.6268498280773992}
Test   -> {'loss': nan, 'accuracy': 0.27014967799186707, 'precision': 0.4307292401790619, 'recall': 0.34452661871910095, 'iou': 0.10179030895233154, 'dice': 0.16811582446098328}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.346466410678366, 'accuracy': 0.745048421362172, 'precision': 0.6561469212822292, 'recall': 0.6557555240133535, 'iou': 0.5068411111831665, 'dice': 0.6551111941752227}
Test   -> {'loss': nan, 'accuracy': 0.31519022583961487, 'precision': 0.31552574038505554, 'recall': 0.3213989734649658, 'iou': 0.12399689853191376, 'dice': 0.20024660229682922}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3283919189287269, 'accuracy': 0.7576473883960558, 'precision': 0.6731301369874374, 'recall': 0.6727964810703112, 'iou': 0.5244963319405266, 'dice': 0.6719416773837545}
Test   -> {'loss': nan, 'accuracy': 0.3174077272415161, 'precision': 0.44919130206108093, 'recall': 0.34394699335098267, 'iou': 0.11556099355220795, 'dice': 0.18279722332954407}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.31014124258704806, 'accuracy': 0.770835981161698, 'precision': 0.6913917821386586, 'recall': 0.689711608575738, 'iou': 0.5435621417087058, 'dice': 0.6895252248515253}
Test   -> {'loss': nan, 'accuracy': 0.2507800757884979, 'precision': 0.750260055065155, 'recall': 0.3333333432674408, 'iou': 0.08359336107969284, 'dice': 0.13366596400737762}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.30005308234173317, 'accuracy': 0.7777475237846374, 'precision': 0.7017364942509196, 'recall': 0.6997020887291949, 'iou': 0.5545513883880947, 'dice': 0.6995239288910575}
Test   -> {'loss': nan, 'accuracy': 0.29774412512779236, 'precision': 0.3560156524181366, 'recall': 0.33366966247558594, 'iou': 0.10568677634000778, 'dice': 0.16781924664974213}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2911528805027837, 'accuracy': 0.7856757044792175, 'precision': 0.7102575364320175, 'recall': 0.7065940333449322, 'iou': 0.5638567691263945, 'dice': 0.7076088055320408}
Test   -> {'loss': nan, 'accuracy': 0.28259214758872986, 'precision': 0.4822157621383667, 'recall': 0.33939823508262634, 'iou': 0.09957390278577805, 'dice': 0.15924468636512756}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.28420208848041034, 'accuracy': 0.7899821395459382, 'precision': 0.7189216012540071, 'recall': 0.711944343732751, 'iou': 0.5714060866314432, 'dice': 0.7144065032834592}
Test   -> {'loss': nan, 'accuracy': 0.2566724419593811, 'precision': 0.7522241473197937, 'recall': 0.3333333432674408, 'iou': 0.0855574831366539, 'dice': 0.13616514205932617}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.27931935061579166, 'accuracy': 0.7949939157651819, 'precision': 0.7249580709830574, 'recall': 0.7162556741548621, 'iou': 0.5775868519492772, 'dice': 0.7195704102516174}
Test   -> {'loss': nan, 'accuracy': 0.27081671357154846, 'precision': 0.7569389343261719, 'recall': 0.3333333432674408, 'iou': 0.09027224034070969, 'dice': 0.14206965267658234}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.26869057883387026, 'accuracy': 0.8018154678137406, 'precision': 0.7348514577616816, 'recall': 0.7258620272512021, 'iou': 0.5890417845352837, 'dice': 0.7295571570811065}
Test   -> {'loss': nan, 'accuracy': 0.32071951031684875, 'precision': 0.7735731601715088, 'recall': 0.3333333432674408, 'iou': 0.10690650343894958, 'dice': 0.16189131140708923}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 3 with IoU 0.12399689853191376
Test -> {'loss': nan, 'accuracy': 0.31519022583961487, 'precision': 0.31552574038505554, 'recall': 0.3213989734649658, 'iou': 0.12399689853191376, 'dice': 0.20024660229682922} 
Train -> {'loss': 0.346466410678366, 'accuracy': 0.745048421362172, 'precision': 0.6561469212822292, 'recall': 0.6557555240133535, 'iou': 0.5068411111831665, 'dice': 0.6551111941752227} 

Best model saved for model segnext at epoch 10

Trial 30:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.528031870852346, 'accuracy': 0.6298654418924581, 'precision': 0.4964890039485434, 'recall': 0.509185807082964, 'iou': 0.3567139481720717, 'dice': 0.48881468850633375}
Test   -> {'loss': nan, 'accuracy': 0.23853161931037903, 'precision': 0.4458366334438324, 'recall': 0.3460679054260254, 'iou': 0.08997892588376999, 'dice': 0.1513351947069168}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5322635645451753, 'accuracy': 0.6701056381930476, 'precision': 0.5426463442004246, 'recall': 0.5052920784639275, 'iou': 0.36172756954379703, 'dice': 0.47795683365801106}
Test   -> {'loss': nan, 'accuracy': 0.3024553656578064, 'precision': 0.7674851417541504, 'recall': 0.3333333432674408, 'iou': 0.1008184552192688, 'dice': 0.15481291711330414}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5063944324203159, 'accuracy': 0.6477359287116838, 'precision': 0.5375446061725202, 'recall': 0.5379883650852286, 'iou': 0.37422839584557904, 'dice': 0.5077846924895826}
Test   -> {'loss': nan, 'accuracy': 0.32741373777389526, 'precision': 0.7758046388626099, 'recall': 0.3333333432674408, 'iou': 0.10913792252540588, 'dice': 0.164436936378479}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5749685455923496, 'accuracy': 0.6930654043736665, 'precision': 0.6652007432087608, 'recall': 0.4599905708561773, 'iou': 0.3392685478148253, 'dice': 0.4323688041904698}
Test   -> {'loss': nan, 'accuracy': 0.33376017212867737, 'precision': 0.777920126914978, 'recall': 0.3333333432674408, 'iou': 0.11125339567661285, 'dice': 0.16682669520378113}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.612807676066523, 'accuracy': 0.6195739711108414, 'precision': 0.6444089179453643, 'recall': 0.4341060468684072, 'iou': 0.29644688387279927, 'dice': 0.3962050814991412}
Test   -> {'loss': nan, 'accuracy': 0.27968302369117737, 'precision': 0.7598943710327148, 'recall': 0.3333333432674408, 'iou': 0.09322767704725266, 'dice': 0.14570432901382446}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6629250300967175, 'accuracy': 0.5899108494105546, 'precision': 0.5197087916343108, 'recall': 0.39346901269062706, 'iou': 0.2585501375405685, 'dice': 0.34869402193504834}
Test   -> {'loss': nan, 'accuracy': 0.3521902859210968, 'precision': 0.784063458442688, 'recall': 0.3333333432674408, 'iou': 0.1173967644572258, 'dice': 0.1736394166946411}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7261094365430915, 'accuracy': 0.642457198837529, 'precision': 0.6179259226374004, 'recall': 0.34100049332432125, 'iou': 0.2270865671660589, 'dice': 0.2855727055798406}
Test   -> {'loss': nan, 'accuracy': 0.3899286985397339, 'precision': 0.7966429591178894, 'recall': 0.3333333432674408, 'iou': 0.12997624278068542, 'dice': 0.1870257705450058}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7263721196547799, 'accuracy': 0.6424558206744816, 'precision': 0.6097030914348105, 'recall': 0.34086103504118714, 'iou': 0.22689062791026157, 'dice': 0.28519575945709064}
Test   -> {'loss': nan, 'accuracy': 0.3138004243373871, 'precision': 0.7712668180465698, 'recall': 0.3333333432674408, 'iou': 0.10460014641284943, 'dice': 0.15923292934894562}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7273085931073064, 'accuracy': 0.6415224155654078, 'precision': 0.5301976090540057, 'recall': 0.34011410267456715, 'iou': 0.22611115270334742, 'dice': 0.28398830864740454}
Test   -> {'loss': nan, 'accuracy': 0.37982177734375, 'precision': 0.79327392578125, 'recall': 0.3333333432674408, 'iou': 0.1266072690486908, 'dice': 0.18351249396800995}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.728965158307034, 'accuracy': 0.6379810820455136, 'precision': 0.4252900741022566, 'recall': 0.33828860404698746, 'iou': 0.22461240647927574, 'dice': 0.28246637271798175}
Test   -> {'loss': nan, 'accuracy': 0.2435663938522339, 'precision': 0.747855544090271, 'recall': 0.3333333432674408, 'iou': 0.08118879795074463, 'dice': 0.13057413697242737}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 7 with IoU 0.12997624278068542
Test -> {'loss': nan, 'accuracy': 0.3899286985397339, 'precision': 0.7966429591178894, 'recall': 0.3333333432674408, 'iou': 0.12997624278068542, 'dice': 0.1870257705450058} 
Train -> {'loss': 0.7261094365430915, 'accuracy': 0.642457198837529, 'precision': 0.6179259226374004, 'recall': 0.34100049332432125, 'iou': 0.2270865671660589, 'dice': 0.2855727055798406} 

Best model saved for model segnext at epoch 10

Trial 31:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5503692150115966, 'accuracy': 0.6029341184574625, 'precision': 0.4922265317129052, 'recall': 0.4784988911255546, 'iou': 0.33306529146173725, 'dice': 0.45722972128702244}
Test   -> {'loss': nan, 'accuracy': 0.2949707508087158, 'precision': 0.7649902701377869, 'recall': 0.3333333432674408, 'iou': 0.09832358360290527, 'dice': 0.15185454487800598}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.37393248599508533, 'accuracy': 0.7244173635607181, 'precision': 0.6291260133618893, 'recall': 0.6323764614436937, 'iou': 0.48004321170889813, 'dice': 0.6291417873424032}
Test   -> {'loss': nan, 'accuracy': 0.30825120210647583, 'precision': 0.7694170475006104, 'recall': 0.3333333432674408, 'iou': 0.10275040566921234, 'dice': 0.1570805460214615}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3522896621538245, 'accuracy': 0.7404198693192523, 'precision': 0.6500041780264482, 'recall': 0.6510830599328746, 'iou': 0.5003777161888454, 'dice': 0.6489515719206437}
Test   -> {'loss': nan, 'accuracy': 0.2966420650482178, 'precision': 0.45641350746154785, 'recall': 0.3383939266204834, 'iou': 0.10369384288787842, 'dice': 0.16372844576835632}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3440522940262504, 'accuracy': 0.74615122805471, 'precision': 0.6574045207189477, 'recall': 0.6592283590980198, 'iou': 0.5087428243263908, 'dice': 0.6570777633915776}
Test   -> {'loss': nan, 'accuracy': 0.28088876605033875, 'precision': 0.7602962851524353, 'recall': 0.3333333432674408, 'iou': 0.09362959116697311, 'dice': 0.146194726228714}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3359693433927453, 'accuracy': 0.7521111514257348, 'precision': 0.6659292972606161, 'recall': 0.665262304181638, 'iou': 0.516351508575937, 'dice': 0.6643974247186081}
Test   -> {'loss': nan, 'accuracy': 0.32478395104408264, 'precision': 0.7749279737472534, 'recall': 0.3333333432674408, 'iou': 0.10826131701469421, 'dice': 0.16343995928764343}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.32959544451340383, 'accuracy': 0.7570026496182317, 'precision': 0.6717429243999978, 'recall': 0.6729707344718602, 'iou': 0.5233667943788611, 'dice': 0.6707997456840847}
Test   -> {'loss': nan, 'accuracy': 0.3187592029571533, 'precision': 0.772919774055481, 'recall': 0.3333333432674408, 'iou': 0.10625307261943817, 'dice': 0.16114097833633423}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3272709934607796, 'accuracy': 0.7584575606429058, 'precision': 0.6747961749201236, 'recall': 0.6731730373009391, 'iou': 0.525413892061814, 'dice': 0.6727968521740125}
Test   -> {'loss': nan, 'accuracy': 0.32198941707611084, 'precision': 0.7739965319633484, 'recall': 0.3333333432674408, 'iou': 0.10732980817556381, 'dice': 0.16237619519233704}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3315560382345448, 'accuracy': 0.7563627730245176, 'precision': 0.6707084075264309, 'recall': 0.6700723316358483, 'iou': 0.5212291082610254, 'dice': 0.6686621282411658}
Test   -> {'loss': nan, 'accuracy': 0.3238821029663086, 'precision': 0.42266353964805603, 'recall': 0.3398059010505676, 'iou': 0.11666910350322723, 'dice': 0.1827804446220398}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.33878080171087516, 'accuracy': 0.7490283281906791, 'precision': 0.6596734192060387, 'recall': 0.6670115533082381, 'iou': 0.5138248464335566, 'dice': 0.661920184156169}
Test   -> {'loss': nan, 'accuracy': 0.29104116559028625, 'precision': 0.7636803984642029, 'recall': 0.3333333432674408, 'iou': 0.09701372683048248, 'dice': 0.15028756856918335}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.3540587041689002, 'accuracy': 0.7394122362136841, 'precision': 0.6488940197488536, 'recall': 0.650058699172476, 'iou': 0.49886094124420827, 'dice': 0.6477438558702884}
Test   -> {'loss': nan, 'accuracy': 0.2738659977912903, 'precision': 0.7579553127288818, 'recall': 0.3333333432674408, 'iou': 0.09128867089748383, 'dice': 0.14332538843154907}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 8 with IoU 0.11666910350322723
Test -> {'loss': nan, 'accuracy': 0.3238821029663086, 'precision': 0.42266353964805603, 'recall': 0.3398059010505676, 'iou': 0.11666910350322723, 'dice': 0.1827804446220398} 
Train -> {'loss': 0.3315560382345448, 'accuracy': 0.7563627730245176, 'precision': 0.6707084075264309, 'recall': 0.6700723316358483, 'iou': 0.5212291082610254, 'dice': 0.6686621282411658} 

Best model saved for model segnext at epoch 10

Trial 32:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6521752665872159, 'accuracy': 0.7408208567811095, 'precision': 0.8207893703294837, 'recall': 0.5433497159377388, 'iou': 0.42126265699448795, 'dice': 0.512078460338323}
Test   -> {'loss': nan, 'accuracy': 0.5527144074440002, 'precision': 0.7092307806015015, 'recall': 0.44074833393096924, 'iou': 0.2752019762992859, 'dice': 0.3876000642776489}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5567354114159294, 'accuracy': 0.7854700326919556, 'precision': 0.6842630991469258, 'recall': 0.5806314496890358, 'iou': 0.4665420017812563, 'dice': 0.5489049483900484}
Test   -> {'loss': nan, 'accuracy': 0.33926454186439514, 'precision': 0.31356534361839294, 'recall': 0.33851158618927, 'iou': 0.12951838970184326, 'dice': 0.20691238343715668}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5132488695175751, 'accuracy': 0.7999480296736178, 'precision': 0.6653289693853129, 'recall': 0.5965123072914456, 'iou': 0.4873241134311842, 'dice': 0.5693478820116623}
Test   -> {'loss': nan, 'accuracy': 0.31183484196662903, 'precision': 0.7706116437911987, 'recall': 0.3333333432674408, 'iou': 0.10394494980573654, 'dice': 0.15847261250019073}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.47774847655192665, 'accuracy': 0.8121403168077054, 'precision': 0.6746556665586388, 'recall': 0.613458876506142, 'iou': 0.5092647711867871, 'dice': 0.5938676546449246}
Test   -> {'loss': nan, 'accuracy': 0.31580835580825806, 'precision': 0.7719361186027527, 'recall': 0.3333333432674408, 'iou': 0.10526945441961288, 'dice': 0.1600072681903839}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.43915564301221266, 'accuracy': 0.8246100218399711, 'precision': 0.6927318992822067, 'recall': 0.6341216742992402, 'iou': 0.5350643409335095, 'dice': 0.6234900762205539}
Test   -> {'loss': nan, 'accuracy': 0.33018648624420166, 'precision': 0.7767288088798523, 'recall': 0.3333333432674408, 'iou': 0.11006216704845428, 'dice': 0.16548381745815277}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.38437564891317616, 'accuracy': 0.8431759585504947, 'precision': 0.7170956505381543, 'recall': 0.6703462406345035, 'iou': 0.5781164467334747, 'dice': 0.6719020125658616}
Test   -> {'loss': nan, 'accuracy': 0.23914694786071777, 'precision': 0.7463823556900024, 'recall': 0.3333333432674408, 'iou': 0.07971565425395966, 'dice': 0.1286621391773224}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3300317472089892, 'accuracy': 0.8615490379540817, 'precision': 0.7462182301542033, 'recall': 0.7125173654245294, 'iou': 0.6228868634804435, 'dice': 0.719416629490645}
Test   -> {'loss': nan, 'accuracy': 0.26932820677757263, 'precision': 0.7564427256584167, 'recall': 0.3333333432674408, 'iou': 0.08977606892585754, 'dice': 0.14145447313785553}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.28656303565139357, 'accuracy': 0.8775640697582908, 'precision': 0.7740783966105917, 'recall': 0.7504392587620279, 'iou': 0.6616359306418378, 'dice': 0.7582007322622382}
Test   -> {'loss': nan, 'accuracy': 0.3425467312335968, 'precision': 0.7808489203453064, 'recall': 0.3333333432674408, 'iou': 0.114182248711586, 'dice': 0.17009799182415009}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.24919722766979882, 'accuracy': 0.8926588110301805, 'precision': 0.8007375232551409, 'recall': 0.7855634414631387, 'iou': 0.6971465965975886, 'dice': 0.7915659090747004}
Test   -> {'loss': nan, 'accuracy': 0.32548803091049194, 'precision': 0.7751626968383789, 'recall': 0.3333333432674408, 'iou': 0.10849601030349731, 'dice': 0.16370727121829987}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.22438605680413867, 'accuracy': 0.9027353431867516, 'precision': 0.8184522921624391, 'recall': 0.8077055578646453, 'iou': 0.7203245898951655, 'dice': 0.8120884446994118}
Test   -> {'loss': nan, 'accuracy': 0.23232720792293549, 'precision': 0.7441090941429138, 'recall': 0.3333333432674408, 'iou': 0.07744240760803223, 'dice': 0.12568481266498566}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.2752019762992859
Test -> {'loss': nan, 'accuracy': 0.5527144074440002, 'precision': 0.7092307806015015, 'recall': 0.44074833393096924, 'iou': 0.2752019762992859, 'dice': 0.3876000642776489} 
Train -> {'loss': 0.6521752665872159, 'accuracy': 0.7408208567811095, 'precision': 0.8207893703294837, 'recall': 0.5433497159377388, 'iou': 0.42126265699448795, 'dice': 0.512078460338323} 

Best model saved for model segnext at epoch 10

Trial 33:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7427897520687269, 'accuracy': 0.6903975937677467, 'precision': 0.7814584840898928, 'recall': 0.5050752650136533, 'iou': 0.3747655583464581, 'dice': 0.47482560562050863}
Test   -> {'loss': 0.9742375612258911, 'accuracy': 0.6512052416801453, 'precision': 0.7786357402801514, 'recall': 0.46048325300216675, 'iou': 0.3284621238708496, 'dice': 0.4344205856323242}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5945263499798982, 'accuracy': 0.7727739956067956, 'precision': 0.8447257404742033, 'recall': 0.5674819873726886, 'iou': 0.4514842134454976, 'dice': 0.5373163746750873}
Test   -> {'loss': 1.0259815454483032, 'accuracy': 0.6747037768363953, 'precision': 0.43846461176872253, 'recall': 0.45828282833099365, 'iou': 0.3357052206993103, 'dice': 0.43839359283447266}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5420483765394791, 'accuracy': 0.7898483131242835, 'precision': 0.6838665329891702, 'recall': 0.5835722228755121, 'iou': 0.47066505162612254, 'dice': 0.5514396387597789}
Test   -> {'loss': nan, 'accuracy': 0.5629297494888306, 'precision': 0.4199499487876892, 'recall': 0.43805259466171265, 'iou': 0.2899629473686218, 'dice': 0.40808242559432983}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.49856528095577074, 'accuracy': 0.8052575018094934, 'precision': 0.6724666849426602, 'recall': 0.5990920460742453, 'iou': 0.49119556934937186, 'dice': 0.5698977221613345}
Test   -> {'loss': nan, 'accuracy': 0.5055214762687683, 'precision': 0.3966427743434906, 'recall': 0.41386470198631287, 'iou': 0.24795293807983398, 'dice': 0.36363252997398376}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.45722893839297085, 'accuracy': 0.8191360919371895, 'precision': 0.6856086160825646, 'recall': 0.6183776814004649, 'iou': 0.5167622182680213, 'dice': 0.5985929950423863}
Test   -> {'loss': nan, 'accuracy': 0.4145604372024536, 'precision': 0.3759325444698334, 'recall': 0.36964255571365356, 'iou': 0.19237154722213745, 'dice': 0.30236324667930603}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.39810052980547367, 'accuracy': 0.8380947512129079, 'precision': 0.7083738622458084, 'recall': 0.655611815141595, 'iou': 0.5621835402820421, 'dice': 0.6522235880727353}
Test   -> {'loss': nan, 'accuracy': 0.30358168482780457, 'precision': 0.2397526204586029, 'recall': 0.32643064856529236, 'iou': 0.10478632152080536, 'dice': 0.16377806663513184}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.344038966168528, 'accuracy': 0.8566208341847296, 'precision': 0.738202647022579, 'recall': 0.6982230528541233, 'iou': 0.6088170124136884, 'dice': 0.7037657374921052}
Test   -> {'loss': nan, 'accuracy': 0.28577810525894165, 'precision': 0.3894767761230469, 'recall': 0.3401230275630951, 'iou': 0.10077514499425888, 'dice': 0.161653533577919}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.32938690185546876, 'accuracy': 0.8651049396266108, 'precision': 0.7533236892327019, 'recall': 0.7192955017089844, 'iou': 0.6302936662798343, 'dice': 0.7258939654930778}
Test   -> {'loss': nan, 'accuracy': 0.31850293278694153, 'precision': 0.3416198194026947, 'recall': 0.334011971950531, 'iou': 0.1129186749458313, 'dice': 0.17729023098945618}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2831011886182039, 'accuracy': 0.878747630637625, 'precision': 0.7760171817696613, 'recall': 0.7516826899155327, 'iou': 0.6631228498790576, 'dice': 0.7591175659843113}
Test   -> {'loss': nan, 'accuracy': 0.33311212062835693, 'precision': 0.34162411093711853, 'recall': 0.3328430950641632, 'iou': 0.13821068406105042, 'dice': 0.22545258700847626}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.22742310412552047, 'accuracy': 0.9017258929169696, 'precision': 0.8165510623351387, 'recall': 0.8054255241933076, 'iou': 0.7178514687911324, 'dice': 0.810081652454708}
Test   -> {'loss': nan, 'accuracy': 0.3187548518180847, 'precision': 0.3411971926689148, 'recall': 0.33509230613708496, 'iou': 0.11552648991346359, 'dice': 0.18201220035552979}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.3357052206993103
Test -> {'loss': 1.0259815454483032, 'accuracy': 0.6747037768363953, 'precision': 0.43846461176872253, 'recall': 0.45828282833099365, 'iou': 0.3357052206993103, 'dice': 0.43839359283447266} 
Train -> {'loss': 0.5945263499798982, 'accuracy': 0.7727739956067956, 'precision': 0.8447257404742033, 'recall': 0.5674819873726886, 'iou': 0.4514842134454976, 'dice': 0.5373163746750873} 

Best model saved for model segnext at epoch 10

Trial 34:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6566180855035781, 'accuracy': 0.7406367932972701, 'precision': 0.8216363588105078, 'recall': 0.5422028012897657, 'iou': 0.4207171179678129, 'dice': 0.5121501920663792}
Test   -> {'loss': nan, 'accuracy': 0.6191917061805725, 'precision': 0.707985520362854, 'recall': 0.406563401222229, 'iou': 0.2857542634010315, 'dice': 0.3874715268611908}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5550645333269368, 'accuracy': 0.786095093385033, 'precision': 0.7286991851485294, 'recall': 0.5808407361092774, 'iou': 0.4668237481428229, 'dice': 0.5485751888026362}
Test   -> {'loss': nan, 'accuracy': 0.28191763162612915, 'precision': 0.7606391906738281, 'recall': 0.3333333432674408, 'iou': 0.09397255629301071, 'dice': 0.14661246538162231}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5123447854881701, 'accuracy': 0.8000999904197196, 'precision': 0.6637567323187124, 'recall': 0.5961836506491122, 'iou': 0.4870464865280234, 'dice': 0.5684884190559387}
Test   -> {'loss': nan, 'accuracy': 0.29402127861976624, 'precision': 0.7646738290786743, 'recall': 0.3333333432674408, 'iou': 0.09800710529088974, 'dice': 0.15147680044174194}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4749178027329238, 'accuracy': 0.8129544758278391, 'precision': 0.678659279709277, 'recall': 0.6142645949902742, 'iou': 0.510385723217674, 'dice': 0.5947082988593889}
Test   -> {'loss': nan, 'accuracy': 0.30638402700424194, 'precision': 0.7687947154045105, 'recall': 0.3333333432674408, 'iou': 0.10212801396846771, 'dice': 0.1563522070646286}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4327437216820924, 'accuracy': 0.8268837913222935, 'precision': 0.6964561783749125, 'recall': 0.6367073440033456, 'iou': 0.5387298723925715, 'dice': 0.6266069007956463}
Test   -> {'loss': nan, 'accuracy': 0.3177228569984436, 'precision': 0.7725743055343628, 'recall': 0.3333333432674408, 'iou': 0.1059076189994812, 'dice': 0.16074340045452118}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3707659787457922, 'accuracy': 0.8473430685375047, 'precision': 0.722524410745372, 'recall': 0.6790665745735168, 'iou': 0.5877621684385382, 'dice': 0.6822867707065914}
Test   -> {'loss': nan, 'accuracy': 0.25083330273628235, 'precision': 0.7502777576446533, 'recall': 0.3333333432674408, 'iou': 0.08361110091209412, 'dice': 0.13368865847587585}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.31296401943849483, 'accuracy': 0.8674895807452824, 'precision': 0.7557005985923435, 'recall': 0.7253148283647455, 'iou': 0.6365613880364791, 'dice': 0.7330184822497161}
Test   -> {'loss': nan, 'accuracy': 0.33418741822242737, 'precision': 0.7780625224113464, 'recall': 0.3333333432674408, 'iou': 0.11139580607414246, 'dice': 0.16698674857616425}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2741966219699901, 'accuracy': 0.8827997982501984, 'precision': 0.7831136978190878, 'recall': 0.7624031281989554, 'iou': 0.6736380457878113, 'dice': 0.769604993643968}
Test   -> {'loss': nan, 'accuracy': 0.2918862998485565, 'precision': 0.7639621496200562, 'recall': 0.3333333432674408, 'iou': 0.09729543328285217, 'dice': 0.15062539279460907}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.23880341370468555, 'accuracy': 0.8972448159819064, 'precision': 0.8087651737358259, 'recall': 0.7953897154849509, 'iou': 0.7074589379455732, 'dice': 0.8007579440655915}
Test   -> {'loss': nan, 'accuracy': 0.3615024983882904, 'precision': 0.7871675491333008, 'recall': 0.3333333432674408, 'iou': 0.1205008327960968, 'dice': 0.17701154947280884}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.21163460631733355, 'accuracy': 0.9087915892186372, 'precision': 0.8296946808047917, 'recall': 0.8211945510428885, 'iou': 0.7347832441329956, 'dice': 0.8247240639251211}
Test   -> {'loss': nan, 'accuracy': 0.39312368631362915, 'precision': 0.7977079153060913, 'recall': 0.3333333432674408, 'iou': 0.1310412436723709, 'dice': 0.18812577426433563}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.2857542634010315
Test -> {'loss': nan, 'accuracy': 0.6191917061805725, 'precision': 0.707985520362854, 'recall': 0.406563401222229, 'iou': 0.2857542634010315, 'dice': 0.3874715268611908} 
Train -> {'loss': 0.6566180855035781, 'accuracy': 0.7406367932972701, 'precision': 0.8216363588105078, 'recall': 0.5422028012897657, 'iou': 0.4207171179678129, 'dice': 0.5121501920663792} 

Best model saved for model segnext at epoch 10

Trial 35:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.729662635533706, 'accuracy': 0.6966958823411361, 'precision': 0.7634013466213061, 'recall': 0.5093950867652893, 'iou': 0.3812945163768271, 'dice': 0.4809676678284355}
Test   -> {'loss': 0.8488749861717224, 'accuracy': 0.693061351776123, 'precision': 0.611065149307251, 'recall': 0.4910905361175537, 'iou': 0.36460229754447937, 'dice': 0.4671563506126404}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5882394609243974, 'accuracy': 0.7747617555701214, 'precision': 0.7502212446668873, 'recall': 0.5694368844446929, 'iou': 0.4536821028460627, 'dice': 0.5389596348223479}
Test   -> {'loss': 0.8183623552322388, 'accuracy': 0.7063916325569153, 'precision': 0.47888708114624023, 'recall': 0.4835805296897888, 'iou': 0.3616362512111664, 'dice': 0.4616929888725281}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5428836889888929, 'accuracy': 0.7899330574533213, 'precision': 0.6381914962892947, 'recall': 0.5838466058606687, 'iou': 0.4710816062015036, 'dice': 0.5521342189415641}
Test   -> {'loss': nan, 'accuracy': 0.5786011219024658, 'precision': 0.41652369499206543, 'recall': 0.42191505432128906, 'iou': 0.29719483852386475, 'dice': 0.41644760966300964}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5020423474519149, 'accuracy': 0.8034076089444367, 'precision': 0.6645127555598384, 'recall': 0.5984654416208682, 'iou': 0.4906242634939111, 'dice': 0.5712897622066996}
Test   -> {'loss': nan, 'accuracy': 0.5525901913642883, 'precision': 0.42277759313583374, 'recall': 0.4358512759208679, 'iou': 0.2934706211090088, 'dice': 0.4181034564971924}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4640480865602908, 'accuracy': 0.8167733767758245, 'precision': 0.684025646292645, 'recall': 0.6176176548004151, 'iou': 0.5153060192647188, 'dice': 0.5994034803431967}
Test   -> {'loss': nan, 'accuracy': 0.41592031717300415, 'precision': 0.37381190061569214, 'recall': 0.3750113248825073, 'iou': 0.20171760022640228, 'dice': 0.31735754013061523}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.4168657746004022, 'accuracy': 0.8324152288229569, 'precision': 0.7021176327829776, 'recall': 0.6457891754482104, 'iou': 0.5505847708038661, 'dice': 0.6404234969097635}
Test   -> {'loss': nan, 'accuracy': 0.4121931195259094, 'precision': 0.3958326280117035, 'recall': 0.3732481002807617, 'iou': 0.18776951730251312, 'dice': 0.2954491078853607}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.35116449102111486, 'accuracy': 0.8545093821442645, 'precision': 0.7351909704830335, 'recall': 0.6949428268100905, 'iou': 0.6054439741632213, 'dice': 0.7016318145005599}
Test   -> {'loss': nan, 'accuracy': 0.3199515640735626, 'precision': 0.3274770677089691, 'recall': 0.3319082260131836, 'iou': 0.1114082857966423, 'dice': 0.17223487794399261}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.29984391901804053, 'accuracy': 0.873272800963858, 'precision': 0.7675332328547602, 'recall': 0.740129103867904, 'iou': 0.6515853601953258, 'dice': 0.7489164513090383}
Test   -> {'loss': nan, 'accuracy': 0.316950261592865, 'precision': 0.33666783571243286, 'recall': 0.3354475498199463, 'iou': 0.11193577945232391, 'dice': 0.17489022016525269}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.25925211660240005, 'accuracy': 0.8884317517280579, 'precision': 0.7931061672127765, 'recall': 0.7748359835666159, 'iou': 0.6865604587223219, 'dice': 0.7816689107729041}
Test   -> {'loss': nan, 'accuracy': 0.28993380069732666, 'precision': 0.25454312562942505, 'recall': 0.31783527135849, 'iou': 0.10362593829631805, 'dice': 0.16585323214530945}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.227410103963769, 'accuracy': 0.901415897452313, 'precision': 0.8158759853114252, 'recall': 0.8045403947000919, 'iou': 0.7170693874359131, 'dice': 0.8093902365021084}
Test   -> {'loss': nan, 'accuracy': 0.3135366439819336, 'precision': 0.4172375202178955, 'recall': 0.3449394702911377, 'iou': 0.11556772887706757, 'dice': 0.18495431542396545}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.36460229754447937
Test -> {'loss': 0.8488749861717224, 'accuracy': 0.693061351776123, 'precision': 0.611065149307251, 'recall': 0.4910905361175537, 'iou': 0.36460229754447937, 'dice': 0.4671563506126404} 
Train -> {'loss': 0.729662635533706, 'accuracy': 0.6966958823411361, 'precision': 0.7634013466213061, 'recall': 0.5093950867652893, 'iou': 0.3812945163768271, 'dice': 0.4809676678284355} 

Best model saved for model segnext at epoch 10

Trial 36:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.8322507832361304, 'accuracy': 0.6683606708827226, 'precision': 0.6767827256866124, 'recall': 0.4765699674253878, 'iou': 0.34644530214693237, 'dice': 0.43960231153861334}
Test   -> {'loss': nan, 'accuracy': 0.39133623242378235, 'precision': 0.444694846868515, 'recall': 0.38120633363723755, 'iou': 0.17514172196388245, 'dice': 0.27760469913482666}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.673113126858421, 'accuracy': 0.7432041302971218, 'precision': 0.8121881189553634, 'recall': 0.5403308729762616, 'iou': 0.4197177074525667, 'dice': 0.5132184794415598}
Test   -> {'loss': nan, 'accuracy': 0.30639398097991943, 'precision': 0.6821898818016052, 'recall': 0.34844598174095154, 'iou': 0.11428117752075195, 'dice': 0.18518221378326416}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6485809670842212, 'accuracy': 0.7513463525668435, 'precision': 0.8162626738133638, 'recall': 0.5477013492065927, 'iou': 0.4283923452315123, 'dice': 0.5198652279117834}
Test   -> {'loss': nan, 'accuracy': 0.3225720524787903, 'precision': 0.7741906642913818, 'recall': 0.3333333432674408, 'iou': 0.10752402245998383, 'dice': 0.1625983566045761}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6278155306111212, 'accuracy': 0.7588820016902426, 'precision': 0.8047055954518525, 'recall': 0.5546938082446222, 'iou': 0.43641472808692766, 'dice': 0.5260183325280314}
Test   -> {'loss': nan, 'accuracy': 0.25213125348091125, 'precision': 0.7507104277610779, 'recall': 0.3333333432674408, 'iou': 0.08404375612735748, 'dice': 0.13424111902713776}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 3.6685169279575347, 'accuracy': 0.6901235401630401, 'precision': 0.7381617380225141, 'recall': 0.47933642358883566, 'iou': 0.3517443073184594, 'dice': 0.4317107122229493}
Test   -> {'loss': nan, 'accuracy': 0.27105215191841125, 'precision': 0.7570173740386963, 'recall': 0.3333333432674408, 'iou': 0.09035071730613708, 'dice': 0.14216682314872742}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.9342827361562978, 'accuracy': 0.5589952746163244, 'precision': 0.8524190547673599, 'recall': 0.33333853820095893, 'iou': 0.18633637175611828, 'dice': 0.23893256342929342}
Test   -> {'loss': nan, 'accuracy': 0.26506197452545166, 'precision': 0.7550206184387207, 'recall': 0.3333333432674408, 'iou': 0.08835399150848389, 'dice': 0.13968327641487122}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 61.70578291390253, 'accuracy': 0.5589911248372949, 'precision': 0.8451862523089284, 'recall': 0.33335108523783474, 'iou': 0.18636371175880018, 'dice': 0.23898216557243596}
Test   -> {'loss': nan, 'accuracy': 0.22258026897907257, 'precision': 0.7408601641654968, 'recall': 0.3333333432674408, 'iou': 0.07419342547655106, 'dice': 0.12137186527252197}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 827.6914454016996, 'accuracy': 0.5587128727332406, 'precision': 0.8304241290558939, 'recall': 0.333660433344219, 'iou': 0.186734509014565, 'dice': 0.23974507418663604}
Test   -> {'loss': nan, 'accuracy': 0.35984957218170166, 'precision': 0.37394285202026367, 'recall': 0.3626440167427063, 'iou': 0.16520366072654724, 'dice': 0.26855579018592834}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.9998551684877147, 'accuracy': 0.5589904515639595, 'precision': 0.8518675884474879, 'recall': 0.3333334180323974, 'iou': 0.18633096237545427, 'dice': 0.23891207925651384}
Test   -> {'loss': nan, 'accuracy': 0.28974011540412903, 'precision': 0.31666651368141174, 'recall': 0.31227922439575195, 'iou': 0.1345881074666977, 'dice': 0.2308608591556549}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 10.274714500748592, 'accuracy': 0.559029866690221, 'precision': 0.852783410186353, 'recall': 0.33337550707485364, 'iou': 0.18638161362513253, 'dice': 0.23901056731524675}
Test   -> {'loss': nan, 'accuracy': 0.38150957226753235, 'precision': 0.35183247923851013, 'recall': 0.32442551851272583, 'iou': 0.1735645979642868, 'dice': 0.2776497006416321}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.17514172196388245
Test -> {'loss': nan, 'accuracy': 0.39133623242378235, 'precision': 0.444694846868515, 'recall': 0.38120633363723755, 'iou': 0.17514172196388245, 'dice': 0.27760469913482666} 
Train -> {'loss': 0.8322507832361304, 'accuracy': 0.6683606708827226, 'precision': 0.6767827256866124, 'recall': 0.4765699674253878, 'iou': 0.34644530214693237, 'dice': 0.43960231153861334} 

Best model saved for model segnext at epoch 10

Trial 37:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.0413946120635322, 'accuracy': 0.6130766995575117, 'precision': 0.5259297637835793, 'recall': 0.43638621154038804, 'iou': 0.29608022415119667, 'dice': 0.3899736090846684}
Test   -> {'loss': nan, 'accuracy': 0.28824660181999207, 'precision': 0.2895705997943878, 'recall': 0.33281591534614563, 'iou': 0.09779642522335052, 'dice': 0.15327394008636475}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6640557169914245, 'accuracy': 0.7484527484230373, 'precision': 0.6904691177865733, 'recall': 0.5490323341411093, 'iou': 0.42666173473648406, 'dice': 0.5189439934232961}
Test   -> {'loss': nan, 'accuracy': 0.30508485436439514, 'precision': 0.7683615684509277, 'recall': 0.3333333432674408, 'iou': 0.10169495642185211, 'dice': 0.15584421157836914}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6361902003702911, 'accuracy': 0.7574759312297987, 'precision': 0.752121437114218, 'recall': 0.5556882308877032, 'iou': 0.43564584229303444, 'dice': 0.5256738362104997}
Test   -> {'loss': nan, 'accuracy': 0.2970898747444153, 'precision': 0.76569664478302, 'recall': 0.3333333432674408, 'iou': 0.09902995824813843, 'dice': 0.15269559621810913}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6275817907374838, 'accuracy': 0.7610453683397044, 'precision': 0.6770752046419226, 'recall': 0.5584995326788529, 'iou': 0.43939748795136163, 'dice': 0.528499896629997}
Test   -> {'loss': nan, 'accuracy': 0.30627065896987915, 'precision': 0.7687568664550781, 'recall': 0.3333333432674408, 'iou': 0.10209023207426071, 'dice': 0.15630792081356049}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7232901578364165, 'accuracy': 0.7322408359983693, 'precision': 0.6242202567017596, 'recall': 0.5274370989073878, 'iou': 0.40603962670201843, 'dice': 0.5010593906692836}
Test   -> {'loss': nan, 'accuracy': 0.32486990094184875, 'precision': 0.39342987537384033, 'recall': 0.3425029218196869, 'iou': 0.12076316773891449, 'dice': 0.192192941904068}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7192112767178079, 'accuracy': 0.7319931709248086, 'precision': 0.7108307340870733, 'recall': 0.5239474706027819, 'iou': 0.4046207806338435, 'dice': 0.5008253698763641}
Test   -> {'loss': nan, 'accuracy': 0.35111406445503235, 'precision': 0.7666060328483582, 'recall': 0.3416152596473694, 'iou': 0.122564397752285, 'dice': 0.18661567568778992}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6910671690235968, 'accuracy': 0.7384674035984536, 'precision': 0.7750071167945862, 'recall': 0.530684979583906, 'iou': 0.4122809788455134, 'dice': 0.5074277504630711}
Test   -> {'loss': nan, 'accuracy': 0.35456255078315735, 'precision': 0.7006895542144775, 'recall': 0.3428707718849182, 'iou': 0.12698429822921753, 'dice': 0.1952553689479828}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6621014076730479, 'accuracy': 0.7445776804633762, 'precision': 0.7773731218731922, 'recall': 0.5377725533817126, 'iou': 0.4194642538609712, 'dice': 0.512955595617709}
Test   -> {'loss': nan, 'accuracy': 0.3360387086868286, 'precision': 0.7786795496940613, 'recall': 0.3333333432674408, 'iou': 0.11201290786266327, 'dice': 0.16767913103103638}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.644750704454339, 'accuracy': 0.7493642112483149, 'precision': 0.7219069517177085, 'recall': 0.5430402895678644, 'iou': 0.42508888503779535, 'dice': 0.5175571130669635}
Test   -> {'loss': nan, 'accuracy': 0.2959389090538025, 'precision': 0.4561071991920471, 'recall': 0.33936816453933716, 'iou': 0.10209333896636963, 'dice': 0.16099488735198975}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6351965178614077, 'accuracy': 0.7562090827071148, 'precision': 0.7751301615134529, 'recall': 0.549758021209551, 'iou': 0.43276708488878995, 'dice': 0.5234708744546641}
Test   -> {'loss': nan, 'accuracy': 0.3269541263580322, 'precision': 0.7756513953208923, 'recall': 0.3333333432674408, 'iou': 0.10898470878601074, 'dice': 0.16426296532154083}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 7 with IoU 0.12698429822921753
Test -> {'loss': nan, 'accuracy': 0.35456255078315735, 'precision': 0.7006895542144775, 'recall': 0.3428707718849182, 'iou': 0.12698429822921753, 'dice': 0.1952553689479828} 
Train -> {'loss': 0.6910671690235968, 'accuracy': 0.7384674035984536, 'precision': 0.7750071167945862, 'recall': 0.530684979583906, 'iou': 0.4122809788455134, 'dice': 0.5074277504630711} 

Best model saved for model segnext at epoch 10

Trial 38:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 16}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.814799188790114, 'accuracy': 0.6924858973725982, 'precision': 0.6825752034135487, 'recall': 0.4990325071241545, 'iou': 0.37072755422281184, 'dice': 0.46440605048252187}
Test   -> {'loss': nan, 'accuracy': 0.3663255274295807, 'precision': 0.7887751460075378, 'recall': 0.3333333432674408, 'iou': 0.12210851162672043, 'dice': 0.1787400096654892}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7176410923833433, 'accuracy': 0.7267970828906349, 'precision': 0.747275925848795, 'recall': 0.5189407650543296, 'iou': 0.3988418550594993, 'dice': 0.4956349139628203}
Test   -> {'loss': nan, 'accuracy': 0.30881422758102417, 'precision': 0.6112878322601318, 'recall': 0.32962170243263245, 'iou': 0.1135156899690628, 'dice': 0.1822611689567566}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6827572946963103, 'accuracy': 0.7392656041228253, 'precision': 0.7805089221052501, 'recall': 0.5333887685900149, 'iou': 0.41399911901225217, 'dice': 0.5084732713906661}
Test   -> {'loss': nan, 'accuracy': 0.24983058869838715, 'precision': 0.7499436140060425, 'recall': 0.3333333432674408, 'iou': 0.08327686786651611, 'dice': 0.1332610547542572}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6476451282915862, 'accuracy': 0.7524989021861035, 'precision': 0.7806669210610182, 'recall': 0.5481605606234592, 'iou': 0.42939065228337825, 'dice': 0.5204468662324159}
Test   -> {'loss': nan, 'accuracy': 0.3361031711101532, 'precision': 0.7787010669708252, 'recall': 0.3333333432674408, 'iou': 0.1120343953371048, 'dice': 0.16770319640636444}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6216143667697906, 'accuracy': 0.7616571346054907, 'precision': 0.7588548822247464, 'recall': 0.5573112469652425, 'iou': 0.4395280353401018, 'dice': 0.528368469943171}
Test   -> {'loss': nan, 'accuracy': 0.2957763671875, 'precision': 0.7652587890625, 'recall': 0.3333333432674408, 'iou': 0.0985921248793602, 'dice': 0.15217459201812744}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6089858130268428, 'accuracy': 0.7668048143386841, 'precision': 0.7849813371896743, 'recall': 0.5619205941324649, 'iou': 0.44506312738294185, 'dice': 0.5324502928101498}
Test   -> {'loss': nan, 'accuracy': 0.25152212381362915, 'precision': 0.7505073547363281, 'recall': 0.3333333432674408, 'iou': 0.08384072035551071, 'dice': 0.13398200273513794}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 39.28558604017548, 'accuracy': 0.5802965944227965, 'precision': 0.7850943078165469, 'recall': 0.358119122100913, 'iou': 0.21471986401340235, 'dice': 0.27327957101490186}
Test   -> {'loss': nan, 'accuracy': 0.30597546696662903, 'precision': 0.7686585187911987, 'recall': 0.3333333432674408, 'iou': 0.10199182480573654, 'dice': 0.15619255602359772}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 25.868488603830336, 'accuracy': 0.5589657834042674, 'precision': 0.8420754008966943, 'recall': 0.333337718118792, 'iou': 0.18635317268578902, 'dice': 0.2389894589781761}
Test   -> {'loss': nan, 'accuracy': 0.2844076156616211, 'precision': 0.7614692449569702, 'recall': 0.3333333432674408, 'iou': 0.09480255097150803, 'dice': 0.14762064814567566}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.9340381026268005, 'accuracy': 0.5589861597703851, 'precision': 0.8529953264671823, 'recall': 0.3333338232144066, 'iou': 0.18632912648760755, 'dice': 0.23892333565846732}
Test   -> {'loss': nan, 'accuracy': 0.33831289410591125, 'precision': 0.3466314673423767, 'recall': 0.3450157642364502, 'iou': 0.13281719386577606, 'dice': 0.21128907799720764}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.9344759767470152, 'accuracy': 0.5589858161366504, 'precision': 0.8515460146510083, 'recall': 0.3333337988542474, 'iou': 0.18632931378872497, 'dice': 0.23890885639449824}
Test   -> {'loss': nan, 'accuracy': 0.2706224024295807, 'precision': 0.7568740844726562, 'recall': 0.3333333432674408, 'iou': 0.09020747244358063, 'dice': 0.14198942482471466}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 9 with IoU 0.13281719386577606
Test -> {'loss': nan, 'accuracy': 0.33831289410591125, 'precision': 0.3466314673423767, 'recall': 0.3450157642364502, 'iou': 0.13281719386577606, 'dice': 0.21128907799720764} 
Train -> {'loss': 0.9340381026268005, 'accuracy': 0.5589861597703851, 'precision': 0.8529953264671823, 'recall': 0.3333338232144066, 'iou': 0.18632912648760755, 'dice': 0.23892333565846732} 

Best model saved for model segnext at epoch 10

Trial 39:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'ca_50_1e-6', 'batch_size': 64}
segnext
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.0853381255398626, 'accuracy': 0.5451500338056813, 'precision': 0.5312685404134834, 'recall': 0.35945065384325775, 'iou': 0.21496450486390487, 'dice': 0.29025846382846004}
Test   -> {'loss': nan, 'accuracy': 0.3832079768180847, 'precision': 0.3669707477092743, 'recall': 0.3453826606273651, 'iou': 0.1696920394897461, 'dice': 0.27064985036849976}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6984342486962029, 'accuracy': 0.7305402698724166, 'precision': 0.6358299146527829, 'recall': 0.5333891557610553, 'iou': 0.40860837050106213, 'dice': 0.5047129517016203}
Test   -> {'loss': nan, 'accuracy': 0.3008759021759033, 'precision': 0.7669586539268494, 'recall': 0.3333333432674408, 'iou': 0.10029196739196777, 'dice': 0.15419146418571472}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6858693475308626, 'accuracy': 0.7467528405396835, 'precision': 0.633679805631223, 'recall': 0.5462367638297703, 'iou': 0.4244677004606827, 'dice': 0.5173354579054791}
Test   -> {'loss': nan, 'accuracy': 0.28948038816452026, 'precision': 0.7631601691246033, 'recall': 0.3333333432674408, 'iou': 0.09649347513914108, 'dice': 0.1496625542640686}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7097339718238167, 'accuracy': 0.7355714658032293, 'precision': 0.6980821246686189, 'recall': 0.5326317719791247, 'iou': 0.41125193082767986, 'dice': 0.5067749199659928}
Test   -> {'loss': nan, 'accuracy': 0.32044732570648193, 'precision': 0.42175328731536865, 'recall': 0.33776208758354187, 'iou': 0.11060717701911926, 'dice': 0.17088578641414642}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.9683548294979593, 'accuracy': 0.701447452151257, 'precision': 0.6373538395632868, 'recall': 0.48933052964832474, 'iou': 0.3669126412142878, 'dice': 0.4652914959451427}
Test   -> {'loss': nan, 'accuracy': 0.30268391966819763, 'precision': 0.7675613164901733, 'recall': 0.3333333432674408, 'iou': 0.10089464485645294, 'dice': 0.15490272641181946}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 2.72243769272514, 'accuracy': 0.5619429075199625, 'precision': 0.6826303860415583, 'recall': 0.338036663895068, 'iou': 0.1916896913362586, 'dice': 0.24590746915858724}
Test   -> {'loss': nan, 'accuracy': 0.3224552571773529, 'precision': 0.7741518020629883, 'recall': 0.3333333432674408, 'iou': 0.1074850857257843, 'dice': 0.1625538468360901}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.947672294533771, 'accuracy': 0.5589948213618735, 'precision': 0.8472013924432837, 'recall': 0.3333331188429957, 'iou': 0.1863317432610885, 'dice': 0.23902096541031548}
Test   -> {'loss': nan, 'accuracy': 0.31570714712142944, 'precision': 0.7719024419784546, 'recall': 0.3333333432674408, 'iou': 0.10523571819067001, 'dice': 0.159968301653862}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.9340241675791533, 'accuracy': 0.5589952116427215, 'precision': 0.8529984194299449, 'recall': 0.3333333432674408, 'iou': 0.18633174481599227, 'dice': 0.23899980200373608}
Test   -> {'loss': nan, 'accuracy': 0.25839948654174805, 'precision': 0.6209241151809692, 'recall': 0.332611083984375, 'iou': 0.08893249928951263, 'dice': 0.1439749300479889}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.9339866493059241, 'accuracy': 0.5589963389479595, 'precision': 0.8529986205308334, 'recall': 0.3333344208157581, 'iou': 0.186333023465198, 'dice': 0.23900519363258196}
Test   -> {'loss': nan, 'accuracy': 0.29727017879486084, 'precision': 0.6220989227294922, 'recall': 0.33262550830841064, 'iou': 0.10511445999145508, 'dice': 0.1673964262008667}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 2.3710396559342093, 'accuracy': 0.5586811324824458, 'precision': 0.8177986181300619, 'recall': 0.33324795883634817, 'iou': 0.18643533198729806, 'dice': 0.23936008266780687}
Test   -> {'loss': nan, 'accuracy': 0.3552650809288025, 'precision': 0.7098084688186646, 'recall': 0.34569668769836426, 'iou': 0.12949475646018982, 'dice': 0.20060592889785767}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.1696920394897461
Test -> {'loss': nan, 'accuracy': 0.3832079768180847, 'precision': 0.3669707477092743, 'recall': 0.3453826606273651, 'iou': 0.1696920394897461, 'dice': 0.27064985036849976} 
Train -> {'loss': 1.0853381255398626, 'accuracy': 0.5451500338056813, 'precision': 0.5312685404134834, 'recall': 0.35945065384325775, 'iou': 0.21496450486390487, 'dice': 0.29025846382846004} 

Best model saved for model segnext at epoch 10
Max trials reached.

Best parameters:
Best parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Max IoU: 0.1856
Best metrics: {'loss': nan, 'accuracy': 0.4035377184030112, 'precision': 0.36220265471275703, 'recall': 0.3300814041733319, 'iou': 0.18561335596410544, 'dice': 0.28994097621767745}
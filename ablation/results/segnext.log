Trial 0:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
/usr/local/lib/python3.11/dist-packages/torch/autograd/graph.py:823: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:180.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.47457912020061327, 'accuracy': 0.8209857676340186, 'precision': 0.846945579285207, 'recall': 0.5226426171219867, 'iou': 0.4336199645762858, 'dice': 0.5118038700974505}
Test   -> {'loss': 'nan', 'accuracy': 0.4658203125, 'precision': 0.6437456011772156, 'recall': 0.35764145851135254, 'iou': 0.21122348308563232, 'dice': 0.3164064884185791}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.38263681582782577, 'accuracy': 0.8622645331465679, 'precision': 0.8531246781349182, 'recall': 0.5746038781559986, 'iou': 0.49164625185987226, 'dice': 0.5621841360693393}
Test   -> {'loss': 'nan', 'accuracy': 0.3663766086101532, 'precision': 0.40053293108940125, 'recall': 0.3693607747554779, 'iou': 0.16402912139892578, 'dice': 0.2662723958492279}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.34721503620562344, 'accuracy': 0.8747878085012021, 'precision': 0.7213651745215707, 'recall': 0.588587965135989, 'iou': 0.5099537921988446, 'dice': 0.5756265806115192}
Test   -> {'loss': 'nan', 'accuracy': 0.2929513156414032, 'precision': 0.7643171548843384, 'recall': 0.3333333432674408, 'iou': 0.0976504385471344, 'dice': 0.15105044841766357}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3169606415473897, 'accuracy': 0.8844630109227222, 'precision': 0.6998615601788396, 'recall': 0.5997263581856437, 'iou': 0.5248433302278104, 'dice': 0.5868118467538254}
Test   -> {'loss': 'nan', 'accuracy': 0.2839093804359436, 'precision': 0.7613031268119812, 'recall': 0.3333333432674408, 'iou': 0.0946364626288414, 'dice': 0.14741922914981842}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2864738689816516, 'accuracy': 0.8941555435242861, 'precision': 0.7096948084623917, 'recall': 0.6121208095032236, 'iou': 0.5408415843611178, 'dice': 0.5993007999399435}
Test   -> {'loss': 'nan', 'accuracy': 0.28523221611976624, 'precision': 0.7617441415786743, 'recall': 0.3333333432674408, 'iou': 0.09507741779088974, 'dice': 0.14795367419719696}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.24838725023943445, 'accuracy': 0.9061879443085712, 'precision': 0.7215236560158108, 'recall': 0.6302143757757933, 'iou': 0.563782657229382, 'dice': 0.6198755735936372}
Test   -> {'loss': 'nan', 'accuracy': 0.2746681571006775, 'precision': 0.758222758769989, 'recall': 0.3333333432674408, 'iou': 0.09155605733394623, 'dice': 0.1436547338962555}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.21266954016426334, 'accuracy': 0.9171365766421609, 'precision': 0.7392148764237113, 'recall': 0.6528286863928255, 'iou': 0.5913306402123493, 'dice': 0.6496895538723987}
Test   -> {'loss': 'nan', 'accuracy': 0.26469576358795166, 'precision': 0.7548985481262207, 'recall': 0.3333333432674408, 'iou': 0.08823192119598389, 'dice': 0.13953067362308502}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.18579321212094763, 'accuracy': 0.9251221480576889, 'precision': 0.7511910264906676, 'recall': 0.6835209462953651, 'iou': 0.6246839196785636, 'dice': 0.6916858014853104}
Test   -> {'loss': 'nan', 'accuracy': 0.28850695490837097, 'precision': 0.762835681438446, 'recall': 0.3333333432674408, 'iou': 0.09616898745298386, 'dice': 0.14927196502685547}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1626552816318429, 'accuracy': 0.9328473891900934, 'precision': 0.7736123805460723, 'recall': 0.7210190430931424, 'iou': 0.6605718309464662, 'dice': 0.7350216588248377}
Test   -> {'loss': 'nan', 'accuracy': 0.23301228880882263, 'precision': 0.7443374395370483, 'recall': 0.3333333432674408, 'iou': 0.07767076790332794, 'dice': 0.12598538398742676}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.14641045137591985, 'accuracy': 0.938568632758182, 'precision': 0.7904265554054923, 'recall': 0.7503655718720478, 'iou': 0.6866312936596248, 'dice': 0.7642342043959576}
Test   -> {'loss': 'nan', 'accuracy': 0.3074627220630646, 'precision': 0.7691542506217957, 'recall': 0.3333333432674408, 'iou': 0.10248757898807526, 'dice': 0.15677323937416077}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.21122348308563232
Test -> {'loss': 'nan', 'accuracy': 0.4658203125, 'precision': 0.6437456011772156, 'recall': 0.35764145851135254, 'iou': 0.21122348308563232, 'dice': 0.3164064884185791} 
Train -> {'loss': 0.47457912020061327, 'accuracy': 0.8209857676340186, 'precision': 0.846945579285207, 'recall': 0.5226426171219867, 'iou': 0.4336199645762858, 'dice': 0.5118038700974505} 

Best model saved for model segnext at epoch 10

Trial 1:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5541709262391795, 'accuracy': 0.7701051428266193, 'precision': 0.8119915034459985, 'recall': 0.4580454769341842, 'iou': 0.3652159880036893, 'dice': 0.4422925301220106}
Test   -> {'loss': 1.215590476989746, 'accuracy': 0.6475403308868408, 'precision': 0.8154042959213257, 'recall': 0.39791423082351685, 'iou': 0.27536943554878235, 'dice': 0.36698853969573975}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4251326205937759, 'accuracy': 0.8462352985921113, 'precision': 0.8717198724332063, 'recall': 0.5551118420517963, 'iou': 0.4691120505332947, 'dice': 0.5458169087119724}
Test   -> {'loss': 1183187840.0, 'accuracy': 0.5929166674613953, 'precision': 0.450067937374115, 'recall': 0.41965633630752563, 'iou': 0.292073130607605, 'dice': 0.40688344836235046}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3788686013740042, 'accuracy': 0.8632526667221733, 'precision': 0.8799092919930168, 'recall': 0.5760146628255429, 'iou': 0.4929046558297199, 'dice': 0.5632703869239144}
Test   -> {'loss': 'nan', 'accuracy': 0.5788359045982361, 'precision': 0.3874814510345459, 'recall': 0.3630286157131195, 'iou': 0.2434096336364746, 'dice': 0.33788836002349854}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.34093909237695774, 'accuracy': 0.8766333580017089, 'precision': 0.7463847186254419, 'recall': 0.5896403815435327, 'iou': 0.5118391244307808, 'dice': 0.5765515177146249}
Test   -> {'loss': 'nan', 'accuracy': 0.46708834171295166, 'precision': 0.3503035008907318, 'recall': 0.37572309374809265, 'iou': 0.22071555256843567, 'dice': 0.33160609006881714}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.31118462500364885, 'accuracy': 0.8865951045699741, 'precision': 0.6926939155744469, 'recall': 0.6013868031294449, 'iou': 0.5271030249802963, 'dice': 0.5878699090169823}
Test   -> {'loss': 'nan', 'accuracy': 0.47030919790267944, 'precision': 0.3525747060775757, 'recall': 0.3666958808898926, 'iou': 0.2239850014448166, 'dice': 0.3369724452495575}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2754102090130682, 'accuracy': 0.8982654633729354, 'precision': 0.6986310482025146, 'recall': 0.6174336713293325, 'iou': 0.5475185570509538, 'dice': 0.6047014977620996}
Test   -> {'loss': 'nan', 'accuracy': 0.30376043915748596, 'precision': 0.36146292090415955, 'recall': 0.3440011739730835, 'iou': 0.11872701346874237, 'dice': 0.19461485743522644}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.23338607497837233, 'accuracy': 0.9110850904298865, 'precision': 0.7236039514126985, 'recall': 0.6403747092122617, 'iou': 0.576880767552749, 'dice': 0.6348505118618841}
Test   -> {'loss': 'nan', 'accuracy': 0.31634458899497986, 'precision': 0.44644126296043396, 'recall': 0.3347078561782837, 'iou': 0.1080617904663086, 'dice': 0.16655802726745605}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.30269128732059314, 'accuracy': 0.8914758360904196, 'precision': 0.6863515237103338, 'recall': 0.6140345542327218, 'iou': 0.5411105420278466, 'dice': 0.6036184782567231}
Test   -> {'loss': 'nan', 'accuracy': 0.2841896414756775, 'precision': 0.761396586894989, 'recall': 0.3333333432674408, 'iou': 0.09472988545894623, 'dice': 0.14753255248069763}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.294676434216292, 'accuracy': 0.8919273132863252, 'precision': 0.6948913708977077, 'recall': 0.6110297244528066, 'iou': 0.5377318268236907, 'dice': 0.5976521626762722}
Test   -> {'loss': 'nan', 'accuracy': 0.2662453055381775, 'precision': 0.755415141582489, 'recall': 0.3333333432674408, 'iou': 0.08874844014644623, 'dice': 0.1401757448911667}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2663717297108277, 'accuracy': 0.9009133110875669, 'precision': 0.7015028798061869, 'recall': 0.6258908012638922, 'iou': 0.5573897392853446, 'dice': 0.6168551901112432}
Test   -> {'loss': 'nan', 'accuracy': 0.311493843793869, 'precision': 0.7704979777336121, 'recall': 0.3333333432674408, 'iou': 0.10383128374814987, 'dice': 0.1583404839038849}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.292073130607605
Test -> {'loss': 1183187840.0, 'accuracy': 0.5929166674613953, 'precision': 0.450067937374115, 'recall': 0.41965633630752563, 'iou': 0.292073130607605, 'dice': 0.40688344836235046} 
Train -> {'loss': 0.4251326205937759, 'accuracy': 0.8462352985921113, 'precision': 0.8717198724332063, 'recall': 0.5551118420517963, 'iou': 0.4691120505332947, 'dice': 0.5458169087119724} 

Best model saved for model segnext at epoch 10

Trial 2:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5957534009995668, 'accuracy': 0.7875817662995794, 'precision': 0.7329827350118886, 'recall': 0.47701317188532455, 'iou': 0.38283965833809064, 'dice': 0.45948757671791574}
Test   -> {'loss': 'nan', 'accuracy': 0.3066481053829193, 'precision': 0.7688827514648438, 'recall': 0.3333333432674408, 'iou': 0.10221603512763977, 'dice': 0.15645533800125122}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 1.699217448545539, 'accuracy': 0.7258147191742192, 'precision': 0.8565855701980384, 'recall': 0.33949479979017505, 'iou': 0.24855417913716774, 'dice': 0.28990100790625034}
Test   -> {'loss': 'nan', 'accuracy': 0.36448824405670166, 'precision': 0.7881627082824707, 'recall': 0.3333333432674408, 'iou': 0.12149608135223389, 'dice': 0.17808300256729126}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7225864322289176, 'accuracy': 0.7255992389243582, 'precision': 0.9085330553676771, 'recall': 0.3333339926989182, 'iou': 0.24186702143886815, 'dice': 0.28026323240736256}
Test   -> {'loss': 'nan', 'accuracy': 0.3277874290943146, 'precision': 0.7759291529655457, 'recall': 0.3333333432674408, 'iou': 0.10926248133182526, 'dice': 0.16457827389240265}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.723312316770139, 'accuracy': 0.7255971289199331, 'precision': 0.9043077730614206, 'recall': 0.33333293044048806, 'iou': 0.24186624690242436, 'dice': 0.2802731835323831}
Test   -> {'loss': 'nan', 'accuracy': 0.30497896671295166, 'precision': 0.7683262825012207, 'recall': 0.3333333432674408, 'iou': 0.10165965557098389, 'dice': 0.15580275654792786}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7223075607548589, 'accuracy': 0.7255987403185471, 'precision': 0.9070838293303614, 'recall': 0.3333333432674408, 'iou': 0.2418664259755093, 'dice': 0.28026455031788866}
Test   -> {'loss': 'nan', 'accuracy': 0.31336942315101624, 'precision': 0.7711231708526611, 'recall': 0.3333333432674408, 'iou': 0.10445648431777954, 'dice': 0.15906640887260437}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.7222550703131634, 'accuracy': 0.7255984174168628, 'precision': 0.907083630302678, 'recall': 0.3333331938671029, 'iou': 0.24186614985051363, 'dice': 0.28027153105839436}
Test   -> {'loss': 'nan', 'accuracy': 0.32717958092689514, 'precision': 0.7757264971733093, 'recall': 0.3333333432674408, 'iou': 0.10905986279249191, 'dice': 0.164348304271698}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 27.77479262844376, 'accuracy': 0.723470803382604, 'precision': 0.8928690793721572, 'recall': 0.3332173693439235, 'iou': 0.24121227487921715, 'dice': 0.2797325323457303}
Test   -> {'loss': 'nan', 'accuracy': 0.21084906160831451, 'precision': 0.7369496822357178, 'recall': 0.3333333432674408, 'iou': 0.07028302550315857, 'dice': 0.11608882248401642}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 335.50730139561324, 'accuracy': 0.7253566003364066, 'precision': 0.889337065168049, 'recall': 0.3335763604744621, 'iou': 0.24215243821558746, 'dice': 0.28083821016809213}
Test   -> {'loss': 'nan', 'accuracy': 0.3140545189380646, 'precision': 0.7713515162467957, 'recall': 0.3333333432674408, 'iou': 0.10468484461307526, 'dice': 0.1593310534954071}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7305646010067152, 'accuracy': 0.7255987400593965, 'precision': 0.9085329384907432, 'recall': 0.3333333432674408, 'iou': 0.24186625804590142, 'dice': 0.2802685964366664}
Test   -> {'loss': 'nan', 'accuracy': 0.36020082235336304, 'precision': 0.7867336273193359, 'recall': 0.3333333432674408, 'iou': 0.12006695568561554, 'dice': 0.1765429824590683}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7222538789977198, 'accuracy': 0.7255987400593965, 'precision': 0.9085329390090445, 'recall': 0.3333333432674408, 'iou': 0.2418662573332372, 'dice': 0.2802680807269138}
Test   -> {'loss': 'nan', 'accuracy': 0.2937186062335968, 'precision': 0.7645728588104248, 'recall': 0.3333333432674408, 'iou': 0.0979062020778656, 'dice': 0.1513562649488449}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.12149608135223389
Test -> {'loss': 'nan', 'accuracy': 0.36448824405670166, 'precision': 0.7881627082824707, 'recall': 0.3333333432674408, 'iou': 0.12149608135223389, 'dice': 0.17808300256729126} 
Train -> {'loss': 1.699217448545539, 'accuracy': 0.7258147191742192, 'precision': 0.8565855701980384, 'recall': 0.33949479979017505, 'iou': 0.24855417913716774, 'dice': 0.28990100790625034} 

Best model saved for model segnext at epoch 10

Trial 3:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.915901473812435, 'accuracy': 0.7045384896838147, 'precision': 0.5393798029941062, 'recall': 0.3487089931964874, 'iou': 0.2518499809762706, 'dice': 0.30223313466362334}
Test   -> {'loss': 'nan', 'accuracy': 0.3101797103881836, 'precision': 0.7700599431991577, 'recall': 0.3333333432674408, 'iou': 0.10339324921369553, 'dice': 0.1578306257724762}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5129622752251832, 'accuracy': 0.8096079556838326, 'precision': 0.7216611374979434, 'recall': 0.5133771015250165, 'iou': 0.4198056044785873, 'dice': 0.5055551461551501}
Test   -> {'loss': 'nan', 'accuracy': 0.324489027261734, 'precision': 0.7748297452926636, 'recall': 0.3333333432674408, 'iou': 0.108163021504879, 'dice': 0.1633279174566269}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4688091765279355, 'accuracy': 0.8297021487484808, 'precision': 0.7828777572383051, 'recall': 0.5366115621898485, 'iou': 0.4468131425588027, 'dice': 0.5286824952001157}
Test   -> {'loss': 'nan', 'accuracy': 0.28166136145591736, 'precision': 0.7605538368225098, 'recall': 0.3333333432674408, 'iou': 0.09388712048530579, 'dice': 0.14650847017765045}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4567834856717483, 'accuracy': 0.8341455957163935, 'precision': 0.7562528568765391, 'recall': 0.5409721244936404, 'iou': 0.45241487078044723, 'dice': 0.5331062249515368}
Test   -> {'loss': 'nan', 'accuracy': 0.32328298687934875, 'precision': 0.7744276523590088, 'recall': 0.3333333432674408, 'iou': 0.10776099562644958, 'dice': 0.1628691554069519}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.442621339144914, 'accuracy': 0.8391398087791775, 'precision': 0.821362260631893, 'recall': 0.5472803530485734, 'iou': 0.45949078020842177, 'dice': 0.5386017628338026}
Test   -> {'loss': 'nan', 'accuracy': 0.31838709115982056, 'precision': 0.7727956771850586, 'recall': 0.3333333432674408, 'iou': 0.10612903535366058, 'dice': 0.16099828481674194}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.4301132541635762, 'accuracy': 0.8439369694046353, 'precision': 0.834610102487647, 'recall': 0.5538494472918303, 'iou': 0.4663435052270475, 'dice': 0.5438293410384136}
Test   -> {'loss': 'nan', 'accuracy': 0.29584890604019165, 'precision': 0.7652829885482788, 'recall': 0.3333333432674408, 'iou': 0.09861631691455841, 'dice': 0.15220341086387634}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.41433562973271243, 'accuracy': 0.8495807974234871, 'precision': 0.8679901625799096, 'recall': 0.5602076224658801, 'iou': 0.4740173497925634, 'dice': 0.549552787905154}
Test   -> {'loss': 'nan', 'accuracy': 0.29422929883003235, 'precision': 0.7647430896759033, 'recall': 0.3333333432674408, 'iou': 0.09807643294334412, 'dice': 0.15155960619449615}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.4020709118117457, 'accuracy': 0.8540916924891264, 'precision': 0.8424699358318163, 'recall': 0.5660949012507563, 'iou': 0.4803692050602125, 'dice': 0.5542438704034557}
Test   -> {'loss': 'nan', 'accuracy': 0.2916225492954254, 'precision': 0.7638742327690125, 'recall': 0.3333333432674408, 'iou': 0.09720751643180847, 'dice': 0.15052001178264618}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.3918397333310998, 'accuracy': 0.858789615009142, 'precision': 0.8085457749988721, 'recall': 0.5716304032698921, 'iou': 0.486916632755943, 'dice': 0.5590026762174524}
Test   -> {'loss': 'nan', 'accuracy': 0.3034091889858246, 'precision': 0.7678030729293823, 'recall': 0.3333333432674408, 'iou': 0.10113640129566193, 'dice': 0.1551874876022339}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.37438691828561865, 'accuracy': 0.8643685594848964, 'precision': 0.7975273598795352, 'recall': 0.5768927724465079, 'iou': 0.4945130042407824, 'dice': 0.5644233164579971}
Test   -> {'loss': 'nan', 'accuracy': 0.29697027802467346, 'precision': 0.7656568288803101, 'recall': 0.3333333432674408, 'iou': 0.09899009764194489, 'dice': 0.1526482105255127}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.108163021504879
Test -> {'loss': 'nan', 'accuracy': 0.324489027261734, 'precision': 0.7748297452926636, 'recall': 0.3333333432674408, 'iou': 0.108163021504879, 'dice': 0.1633279174566269} 
Train -> {'loss': 0.5129622752251832, 'accuracy': 0.8096079556838326, 'precision': 0.7216611374979434, 'recall': 0.5133771015250165, 'iou': 0.4198056044785873, 'dice': 0.5055551461551501} 

Best model saved for model segnext at epoch 10

Trial 4:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.44019372981527577, 'accuracy': 0.7765616182399833, 'precision': 0.57823507733967, 'recall': 0.5759430137665376, 'iou': 0.45461343714724417, 'dice': 0.5615610972046852}
Test   -> {'loss': 'nan', 'accuracy': 0.344813734292984, 'precision': 0.3675714433193207, 'recall': 0.3584432303905487, 'iou': 0.15236805379390717, 'dice': 0.2509361207485199}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.37846502920855646, 'accuracy': 0.8200307628382807, 'precision': 0.6272007144015769, 'recall': 0.631334058875623, 'iou': 0.5129246307455975, 'dice': 0.6187812584897746}
Test   -> {'loss': 'nan', 'accuracy': 0.29446473717689514, 'precision': 0.7648215293884277, 'recall': 0.3333333432674408, 'iou': 0.09815491735935211, 'dice': 0.15165328979492188}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.355143833419551, 'accuracy': 0.8346610641997794, 'precision': 0.6475775615028713, 'recall': 0.657156628370285, 'iou': 0.5359599114760109, 'dice': 0.6412270004334657}
Test   -> {'loss': 'nan', 'accuracy': 0.3241764008998871, 'precision': 0.7747254371643066, 'recall': 0.3333333432674408, 'iou': 0.10805880278348923, 'dice': 0.16320908069610596}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.33787354464116304, 'accuracy': 0.8467748416506726, 'precision': 0.6636019641938417, 'recall': 0.6728519447471785, 'iou': 0.5530258027107819, 'dice': 0.6568801387496617}
Test   -> {'loss': 'nan', 'accuracy': 0.25709253549575806, 'precision': 0.7523641586303711, 'recall': 0.3333333432674408, 'iou': 0.08569751679897308, 'dice': 0.13634240627288818}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.32205774991408637, 'accuracy': 0.8563406138316445, 'precision': 0.6775213824666064, 'recall': 0.6903230037378228, 'iou': 0.5692525465851245, 'dice': 0.6724784001060155}
Test   -> {'loss': 'nan', 'accuracy': 0.2520851492881775, 'precision': 0.7506951093673706, 'recall': 0.3333333432674408, 'iou': 0.08402838557958603, 'dice': 0.13422152400016785}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3083503914915997, 'accuracy': 0.8650331188803134, 'precision': 0.6883461420950683, 'recall': 0.703798614895862, 'iou': 0.5833015428937, 'dice': 0.6852057713529338}
Test   -> {'loss': 'nan', 'accuracy': 0.3122583329677582, 'precision': 0.7707527875900269, 'recall': 0.3333333432674408, 'iou': 0.10408612340688705, 'dice': 0.15863662958145142}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2947562539059183, 'accuracy': 0.873429250717163, 'precision': 0.7007980432199395, 'recall': 0.7168570166048797, 'iou': 0.5972030142079229, 'dice': 0.6980591846548992}
Test   -> {'loss': 'nan', 'accuracy': 0.28661733865737915, 'precision': 0.7622057795524597, 'recall': 0.3333333432674408, 'iou': 0.09553912281990051, 'dice': 0.1485120952129364}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2802541504735532, 'accuracy': 0.8812801871610725, 'precision': 0.712681947324587, 'recall': 0.7327009004095326, 'iou': 0.6121034808780836, 'dice': 0.7119397352571073}
Test   -> {'loss': 'nan', 'accuracy': 0.3173317313194275, 'precision': 0.772443950176239, 'recall': 0.3333333432674408, 'iou': 0.10577724874019623, 'dice': 0.160593181848526}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2669669200544772, 'accuracy': 0.8895745101182357, 'precision': 0.7240246511023978, 'recall': 0.7452185229114864, 'iou': 0.6263790192811386, 'dice': 0.7249430166638415}
Test   -> {'loss': 'nan', 'accuracy': 0.329860121011734, 'precision': 0.776620090007782, 'recall': 0.3333333432674408, 'iou': 0.1099533885717392, 'dice': 0.16536082327365875}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2554809762083966, 'accuracy': 0.8960464690042579, 'precision': 0.7338202543880629, 'recall': 0.7567046517911165, 'iou': 0.6385888669801795, 'dice': 0.7360492071379786}
Test   -> {'loss': 'nan', 'accuracy': 0.26959228515625, 'precision': 0.75653076171875, 'recall': 0.3333333432674408, 'iou': 0.0898640975356102, 'dice': 0.14156371355056763}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.15236805379390717
Test -> {'loss': 'nan', 'accuracy': 0.344813734292984, 'precision': 0.3675714433193207, 'recall': 0.3584432303905487, 'iou': 0.15236805379390717, 'dice': 0.2509361207485199} 
Train -> {'loss': 0.44019372981527577, 'accuracy': 0.7765616182399833, 'precision': 0.57823507733967, 'recall': 0.5759430137665376, 'iou': 0.45461343714724417, 'dice': 0.5615610972046852} 

Best model saved for model segnext at epoch 10

Trial 5:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4939976894337198, 'accuracy': 0.7365479339724001, 'precision': 0.5477296735929407, 'recall': 0.5325429356616477, 'iou': 0.4048834754073102, 'dice': 0.512249226414639}
Test   -> {'loss': 0.5497161746025085, 'accuracy': 0.6520074009895325, 'precision': 0.5662259459495544, 'recall': 0.45495283603668213, 'iou': 0.33625245094299316, 'dice': 0.45458683371543884}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.39764319917430047, 'accuracy': 0.8087633278058923, 'precision': 0.6112196466197138, 'recall': 0.6116344099459441, 'iou': 0.4959665920423425, 'dice': 0.6025720311247784}
Test   -> {'loss': 0.507613480091095, 'accuracy': 0.661917507648468, 'precision': 0.5482574701309204, 'recall': 0.4899441599845886, 'iou': 0.37294554710388184, 'dice': 0.5003843903541565}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3686510687289031, 'accuracy': 0.8272873038830965, 'precision': 0.6378600307132887, 'recall': 0.6400947036950485, 'iou': 0.5229800618213156, 'dice': 0.6287234337433525}
Test   -> {'loss': 'nan', 'accuracy': 0.5918656587600708, 'precision': 0.4654383063316345, 'recall': 0.46055659651756287, 'iou': 0.3289809226989746, 'dice': 0.4623072147369385}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.34735988948656166, 'accuracy': 0.8409000645513119, 'precision': 0.6564304165218188, 'recall': 0.6627032860465671, 'iou': 0.5439058262368907, 'dice': 0.6484104669612387}
Test   -> {'loss': 'nan', 'accuracy': 0.43955370783805847, 'precision': 0.4002701938152313, 'recall': 0.3963431715965271, 'iou': 0.22108373045921326, 'dice': 0.34296831488609314}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3272898658462193, 'accuracy': 0.8535241598668306, 'precision': 0.6733996163243833, 'recall': 0.6825590807458629, 'iou': 0.5632840602294259, 'dice': 0.66693827069324}
Test   -> {'loss': 'nan', 'accuracy': 0.36897027492523193, 'precision': 0.3850514888763428, 'recall': 0.3528924584388733, 'iou': 0.1697126030921936, 'dice': 0.2760835289955139}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3114895830983701, 'accuracy': 0.8632447719573975, 'precision': 0.6861052782639213, 'recall': 0.6991323543631512, 'iou': 0.5795674044152964, 'dice': 0.6820186480231907}
Test   -> {'loss': 'nan', 'accuracy': 0.3392978608608246, 'precision': 0.4172421395778656, 'recall': 0.3456401824951172, 'iou': 0.12792053818702698, 'dice': 0.20218661427497864}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.29665994592334916, 'accuracy': 0.8722980789516284, 'precision': 0.6989156619362209, 'recall': 0.7134359986885734, 'iou': 0.5943382584530374, 'dice': 0.6958334497783495}
Test   -> {'loss': 'nan', 'accuracy': 0.3073042333126068, 'precision': 0.3140721917152405, 'recall': 0.32738205790519714, 'iou': 0.11341004073619843, 'dice': 0.18199817836284637}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.28214231263036316, 'accuracy': 0.8815964149392169, 'precision': 0.7115254578383072, 'recall': 0.7279973610587742, 'iou': 0.6100887521453525, 'dice': 0.7103120124858359}
Test   -> {'loss': 'nan', 'accuracy': 0.2901100516319275, 'precision': 0.241275355219841, 'recall': 0.31937175989151, 'iou': 0.10211815685033798, 'dice': 0.16246095299720764}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.26656857366147246, 'accuracy': 0.8899393014285876, 'precision': 0.7240557312965393, 'recall': 0.7438733349675718, 'iou': 0.6259441645249076, 'dice': 0.7250304906264595}
Test   -> {'loss': 'nan', 'accuracy': 0.32482317090034485, 'precision': 0.35451024770736694, 'recall': 0.33583706617355347, 'iou': 0.1230202242732048, 'dice': 0.1970876306295395}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2555870657381804, 'accuracy': 0.8961426957793858, 'precision': 0.7339274898819301, 'recall': 0.7558472913244496, 'iou': 0.6382423229839491, 'dice': 0.7361889237942902}
Test   -> {'loss': 'nan', 'accuracy': 0.2702864110469818, 'precision': 0.2757556140422821, 'recall': 0.3273753523826599, 'iou': 0.09407594054937363, 'dice': 0.15140819549560547}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.37294554710388184
Test -> {'loss': 0.507613480091095, 'accuracy': 0.661917507648468, 'precision': 0.5482574701309204, 'recall': 0.4899441599845886, 'iou': 0.37294554710388184, 'dice': 0.5003843903541565} 
Train -> {'loss': 0.39764319917430047, 'accuracy': 0.8087633278058923, 'precision': 0.6112196466197138, 'recall': 0.6116344099459441, 'iou': 0.4959665920423425, 'dice': 0.6025720311247784} 

Best model saved for model segnext at epoch 10

Trial 6:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5060110190640326, 'accuracy': 0.789662332508875, 'precision': 0.8167035983956379, 'recall': 0.5148971376211747, 'iou': 0.41037400941485946, 'dice': 0.4969001763540766}
Test   -> {'loss': 'nan', 'accuracy': 0.3588169515132904, 'precision': 0.786272406578064, 'recall': 0.3333333432674408, 'iou': 0.119605652987957, 'dice': 0.1760438084602356}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.488898269508196, 'accuracy': 0.8112434817397076, 'precision': 0.836773505418197, 'recall': 0.525880905078805, 'iou': 0.4271635494802309, 'dice': 0.5126652549142423}
Test   -> {'loss': 'nan', 'accuracy': 0.2785482406616211, 'precision': 0.7595161199569702, 'recall': 0.3333333432674408, 'iou': 0.09284942597150803, 'dice': 0.14524194598197937}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5047959786394368, 'accuracy': 0.7846758181634157, 'precision': 0.814302801049274, 'recall': 0.5280886985685515, 'iou': 0.40900519218133846, 'dice': 0.4990238692449487}
Test   -> {'loss': 'nan', 'accuracy': 0.35209810733795166, 'precision': 0.6199753284454346, 'recall': 0.325508177280426, 'iou': 0.14069139957427979, 'dice': 0.22561529278755188}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5596624006395755, 'accuracy': 0.7104154853717141, 'precision': 0.7478990887818129, 'recall': 0.4916634019302285, 'iou': 0.3503359326849813, 'dice': 0.44931725652321525}
Test   -> {'loss': 'nan', 'accuracy': 0.4323207139968872, 'precision': 0.7456744909286499, 'recall': 0.38983434438705444, 'iou': 0.1851167380809784, 'dice': 0.2839173972606659}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5717725287313047, 'accuracy': 0.7106220626312754, 'precision': 0.7751545211543207, 'recall': 0.4705697426329488, 'iou': 0.34021924772988194, 'dice': 0.43770720569983773}
Test   -> {'loss': 'nan', 'accuracy': 0.2944323420524597, 'precision': 0.7648108005523682, 'recall': 0.3333333432674408, 'iou': 0.09814411401748657, 'dice': 0.1516404002904892}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5288904464763143, 'accuracy': 0.7472091672213181, 'precision': 0.7908772554086603, 'recall': 0.5108544300431791, 'iou': 0.3799039768136066, 'dice': 0.47509888151417606}
Test   -> {'loss': 'nan', 'accuracy': 0.3826206624507904, 'precision': 0.6593072414398193, 'recall': 0.3491060733795166, 'iou': 0.15302333235740662, 'dice': 0.2396661937236786}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5665163278579712, 'accuracy': 0.6889681222646132, 'precision': 0.7628482893757198, 'recall': 0.4874919731979785, 'iou': 0.33829093951246014, 'dice': 0.43999545366867726}
Test   -> {'loss': 'nan', 'accuracy': 0.27610933780670166, 'precision': 0.637360692024231, 'recall': 0.3379754424095154, 'iou': 0.10556910932064056, 'dice': 0.17677216231822968}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5615040330783181, 'accuracy': 0.7001097777615423, 'precision': 0.7631382361702297, 'recall': 0.4877001211695049, 'iou': 0.3443762166344601, 'dice': 0.4448767281096915}
Test   -> {'loss': 'nan', 'accuracy': 0.2777734696865082, 'precision': 0.7592577934265137, 'recall': 0.3333333432674408, 'iou': 0.09259116649627686, 'dice': 0.1449257880449295}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5954385863698047, 'accuracy': 0.6656803467999334, 'precision': 0.7452858608701954, 'recall': 0.4661523983530376, 'iou': 0.31910102406273716, 'dice': 0.4220439312250718}
Test   -> {'loss': 'nan', 'accuracy': 0.2918439507484436, 'precision': 0.7639479637145996, 'recall': 0.3333333432674408, 'iou': 0.0972813218832016, 'dice': 0.15060847997665405}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6967320564000503, 'accuracy': 0.5080529478581055, 'precision': 0.7123869452787482, 'recall': 0.4125809088997219, 'iou': 0.23300221695200257, 'dice': 0.3306683090717896}
Test   -> {'loss': 'nan', 'accuracy': 0.2738024592399597, 'precision': 0.681425929069519, 'recall': 0.3461112678050995, 'iou': 0.10175196826457977, 'dice': 0.16913637518882751}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 4 with IoU 0.1851167380809784
Test -> {'loss': 'nan', 'accuracy': 0.4323207139968872, 'precision': 0.7456744909286499, 'recall': 0.38983434438705444, 'iou': 0.1851167380809784, 'dice': 0.2839173972606659} 
Train -> {'loss': 0.5596624006395755, 'accuracy': 0.7104154853717141, 'precision': 0.7478990887818129, 'recall': 0.4916634019302285, 'iou': 0.3503359326849813, 'dice': 0.44931725652321525} 

Best model saved for model segnext at epoch 10

Trial 7:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6986614439798438, 'accuracy': 0.6860990244409312, 'precision': 0.6341461891713349, 'recall': 0.3514862226403278, 'iou': 0.25401601506316146, 'dice': 0.31666572197623877}
Test   -> {'loss': 'nan', 'accuracy': 0.32710638642311096, 'precision': 0.6873227953910828, 'recall': 0.33798569440841675, 'iou': 0.11345090717077255, 'dice': 0.1749488115310669}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5917869495308917, 'accuracy': 0.7681718411652938, 'precision': 0.7839682454648225, 'recall': 0.44390732049942017, 'iou': 0.3463815660580345, 'dice': 0.41901201890862505}
Test   -> {'loss': 'nan', 'accuracy': 0.29174867272377014, 'precision': 0.7639161944389343, 'recall': 0.3333333432674408, 'iou': 0.09724956005811691, 'dice': 0.15057040750980377}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.47867276253907576, 'accuracy': 0.8187984409539596, 'precision': 0.8409123342970143, 'recall': 0.5392551266628763, 'iou': 0.43873149648956633, 'dice': 0.5226691982020503}
Test   -> {'loss': 'nan', 'accuracy': 0.3073160648345947, 'precision': 0.7691053748130798, 'recall': 0.3333333432674408, 'iou': 0.10243868827819824, 'dice': 0.1567160189151764}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.47349986045256903, 'accuracy': 0.8249379028444704, 'precision': 0.8471066402352374, 'recall': 0.5424446857493856, 'iou': 0.44498910748440285, 'dice': 0.5275034121845079}
Test   -> {'loss': 'nan', 'accuracy': 0.35229864716529846, 'precision': 0.6816598176956177, 'recall': 0.3394845128059387, 'iou': 0.12489444017410278, 'dice': 0.1911948323249817}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4719774069993392, 'accuracy': 0.8258698245753413, 'precision': 0.8477308625760286, 'recall': 0.5449184542116912, 'iou': 0.4467944194441256, 'dice': 0.5289808817531751}
Test   -> {'loss': 'nan', 'accuracy': 0.33190855383872986, 'precision': 0.6866031885147095, 'recall': 0.34898585081100464, 'iou': 0.12599438428878784, 'dice': 0.20180734992027283}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.47236457389333975, 'accuracy': 0.8258159559705983, 'precision': 0.8479903967484184, 'recall': 0.5436798375585805, 'iou': 0.4461340958657472, 'dice': 0.5284524181614751}
Test   -> {'loss': 'nan', 'accuracy': 0.40901681780815125, 'precision': 0.6646482944488525, 'recall': 0.36980652809143066, 'iou': 0.18397819995880127, 'dice': 0.288280725479126}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.47126063367594845, 'accuracy': 0.8261494465496229, 'precision': 0.8479521424874016, 'recall': 0.5464432866676994, 'iou': 0.447569799941519, 'dice': 0.5296363281167071}
Test   -> {'loss': 'nan', 'accuracy': 0.5058767795562744, 'precision': 0.6875149607658386, 'recall': 0.4050781726837158, 'iou': 0.24742728471755981, 'dice': 0.36087507009506226}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.46817128347313924, 'accuracy': 0.8305378748022991, 'precision': 0.85333803632985, 'recall': 0.5462113276771877, 'iou': 0.45125156796496846, 'dice': 0.5324005406835804}
Test   -> {'loss': 'nan', 'accuracy': 0.33307692408561707, 'precision': 0.6789776682853699, 'recall': 0.3494524359703064, 'iou': 0.12606453895568848, 'dice': 0.20129179954528809}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4727007368336553, 'accuracy': 0.8260059299676314, 'precision': 0.8494693719822427, 'recall': 0.541136882616126, 'iou': 0.44553502694420194, 'dice': 0.5279245459515115}
Test   -> {'loss': 'nan', 'accuracy': 0.3122110068798065, 'precision': 0.6704503893852234, 'recall': 0.3397255837917328, 'iou': 0.11255889385938644, 'dice': 0.17900650203227997}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.47023622523183406, 'accuracy': 0.8284701248873835, 'precision': 0.8516282890153968, 'recall': 0.5444132618282153, 'iou': 0.4488499579222306, 'dice': 0.5305493810902471}
Test   -> {'loss': 'nan', 'accuracy': 0.35766974091529846, 'precision': 0.6759917736053467, 'recall': 0.35400766134262085, 'iou': 0.14415311813354492, 'dice': 0.23065614700317383}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 7 with IoU 0.24742728471755981
Test -> {'loss': 'nan', 'accuracy': 0.5058767795562744, 'precision': 0.6875149607658386, 'recall': 0.4050781726837158, 'iou': 0.24742728471755981, 'dice': 0.36087507009506226} 
Train -> {'loss': 0.47126063367594845, 'accuracy': 0.8261494465496229, 'precision': 0.8479521424874016, 'recall': 0.5464432866676994, 'iou': 0.447569799941519, 'dice': 0.5296363281167071} 

Best model saved for model segnext at epoch 10

Trial 8:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4447149868892587, 'accuracy': 0.8105476593193801, 'precision': 0.6733395459859267, 'recall': 0.5410383172657178, 'iou': 0.4437582451688207, 'dice': 0.5570878031461135}
Test   -> {'loss': 'nan', 'accuracy': 0.2743717133998871, 'precision': 0.2368759959936142, 'recall': 0.31290799379348755, 'iou': 0.09904324263334274, 'dice': 0.16152793169021606}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3457283767021221, 'accuracy': 0.8544716770234315, 'precision': 0.7399047825647437, 'recall': 0.6768114823362101, 'iou': 0.5673620144958081, 'dice': 0.699499140355898}
Test   -> {'loss': 'nan', 'accuracy': 0.2503774166107178, 'precision': 0.7501258254051208, 'recall': 0.3333333432674408, 'iou': 0.08345913887023926, 'dice': 0.1334943175315857}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.30588161647319795, 'accuracy': 0.8734513676684835, 'precision': 0.7760245097720104, 'recall': 0.7245860713979472, 'iou': 0.6170102065024169, 'dice': 0.7453216226204582}
Test   -> {'loss': 'nan', 'accuracy': 0.2734188139438629, 'precision': 0.7578063011169434, 'recall': 0.3333333432674408, 'iou': 0.09113960713148117, 'dice': 0.14314161241054535}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.27329795775206195, 'accuracy': 0.8860361228818479, 'precision': 0.7998329968556114, 'recall': 0.7547125930371492, 'iou': 0.649926212300425, 'dice': 0.7734609038933463}
Test   -> {'loss': 'nan', 'accuracy': 0.36266714334487915, 'precision': 0.7875556945800781, 'recall': 0.3333333432674408, 'iou': 0.12088906019926071, 'dice': 0.17743006348609924}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.24125044741060422, 'accuracy': 0.8985939686713011, 'precision': 0.8226196377173715, 'recall': 0.7855074545611506, 'iou': 0.6833981368852698, 'dice': 0.8007086025631946}
Test   -> {'loss': 'nan', 'accuracy': 0.30480706691741943, 'precision': 0.7682690620422363, 'recall': 0.3333333432674408, 'iou': 0.10160236060619354, 'dice': 0.15573546290397644}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.20446044413939765, 'accuracy': 0.913549802614295, 'precision': 0.8477913654368857, 'recall': 0.8199120594107586, 'iou': 0.723873238719028, 'dice': 0.831605710413145}
Test   -> {'loss': 'nan', 'accuracy': 0.37006986141204834, 'precision': 0.7900233268737793, 'recall': 0.3333333432674408, 'iou': 0.12335662543773651, 'dice': 0.18007348477840424}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.1685673119581264, 'accuracy': 0.9282145290271095, 'precision': 0.870783354665922, 'recall': 0.8527827529803567, 'iou': 0.7636029790277067, 'dice': 0.8602007207663163}
Test   -> {'loss': 'nan', 'accuracy': 0.24153603613376617, 'precision': 0.7471787333488464, 'recall': 0.3333333432674408, 'iou': 0.08051201701164246, 'dice': 0.12969742715358734}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.14342271439407184, 'accuracy': 0.9389099678267603, 'precision': 0.8892199239005213, 'recall': 0.875720572212468, 'iou': 0.794608035294906, 'dice': 0.8813900589942932}
Test   -> {'loss': 'nan', 'accuracy': 0.2909907102584839, 'precision': 0.763663649559021, 'recall': 0.3333333432674408, 'iou': 0.09699690341949463, 'dice': 0.15026739239692688}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.12167151761443719, 'accuracy': 0.9479531749435093, 'precision': 0.9043423802956291, 'recall': 0.8960589258567146, 'iou': 0.8224251420601555, 'dice': 0.899561192419218}
Test   -> {'loss': 'nan', 'accuracy': 0.2978179156780243, 'precision': 0.7659393548965454, 'recall': 0.3333333432674408, 'iou': 0.09927265346050262, 'dice': 0.15298393368721008}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.10849165294481361, 'accuracy': 0.9536388241726419, 'precision': 0.9138202776079593, 'recall': 0.9073398362035336, 'iou': 0.8390411649061286, 'dice': 0.9100483109121738}
Test   -> {'loss': 'nan', 'accuracy': 0.2956380844116211, 'precision': 0.7652127146720886, 'recall': 0.3333333432674408, 'iou': 0.09854604303836823, 'dice': 0.1521196961402893}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 6 with IoU 0.12335662543773651
Test -> {'loss': 'nan', 'accuracy': 0.37006986141204834, 'precision': 0.7900233268737793, 'recall': 0.3333333432674408, 'iou': 0.12335662543773651, 'dice': 0.18007348477840424} 
Train -> {'loss': 0.20446044413939765, 'accuracy': 0.913549802614295, 'precision': 0.8477913654368857, 'recall': 0.8199120594107586, 'iou': 0.723873238719028, 'dice': 0.831605710413145} 

Best model saved for model segnext at epoch 10

Trial 9:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5129750262136045, 'accuracy': 0.780047792714575, 'precision': 0.6505349309548087, 'recall': 0.4420403527176898, 'iou': 0.35562820019929303, 'dice': 0.44034507300542747}
Test   -> {'loss': 1.7800148725509644, 'accuracy': 0.5659276247024536, 'precision': 0.5469566583633423, 'recall': 0.37488290667533875, 'iou': 0.23503994941711426, 'dice': 0.3137786090373993}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3897955360619918, 'accuracy': 0.8338145271591518, 'precision': 0.6927306185597959, 'recall': 0.6097700891287431, 'iou': 0.5075354487999626, 'dice': 0.6395896408868873}
Test   -> {'loss': 'nan', 'accuracy': 0.5355607271194458, 'precision': 0.3760300576686859, 'recall': 0.3757135272026062, 'iou': 0.2582924962043762, 'dice': 0.3658422827720642}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.33745714659276216, 'accuracy': 0.8571048601813939, 'precision': 0.7431219261625539, 'recall': 0.6811465978622436, 'iou': 0.5720365918200949, 'dice': 0.704687377680903}
Test   -> {'loss': 'nan', 'accuracy': 0.5616492629051208, 'precision': 0.3912616968154907, 'recall': 0.3841129243373871, 'iou': 0.26796412467956543, 'dice': 0.3777138590812683}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.29851282524025957, 'accuracy': 0.8751291617103245, 'precision': 0.7781645049219547, 'recall': 0.7271874158278756, 'iou': 0.6193528263465218, 'dice': 0.7482691034026768}
Test   -> {'loss': 'nan', 'accuracy': 0.3818764090538025, 'precision': 0.34654760360717773, 'recall': 0.329628586769104, 'iou': 0.18813173472881317, 'dice': 0.3037101626396179}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2568981100683627, 'accuracy': 0.8924211113349251, 'precision': 0.8094978073368901, 'recall': 0.7695396646209385, 'iou': 0.6648719538813052, 'dice': 0.7864042302836542}
Test   -> {'loss': 'nan', 'accuracy': 0.42617204785346985, 'precision': 0.35739731788635254, 'recall': 0.35096460580825806, 'iou': 0.21639768779277802, 'dice': 0.33755993843078613}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2173749564782433, 'accuracy': 0.9084960486577904, 'precision': 0.8366049382997596, 'recall': 0.8079303772553154, 'iou': 0.7082691161528878, 'dice': 0.820280787219172}
Test   -> {'loss': 'nan', 'accuracy': 0.4897037446498871, 'precision': 0.3836958408355713, 'recall': 0.3808693587779999, 'iou': 0.25640061497688293, 'dice': 0.37993860244750977}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.17995196956655254, 'accuracy': 0.9241022021874138, 'precision': 0.8634875515232916, 'recall': 0.8417098491088204, 'iou': 0.7496410318042921, 'dice': 0.8504904622616976}
Test   -> {'loss': 'nan', 'accuracy': 0.3876302242279053, 'precision': 0.35468634963035583, 'recall': 0.33890649676322937, 'iou': 0.20370998978614807, 'dice': 0.32715970277786255}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.14856458073076995, 'accuracy': 0.9370183970617212, 'precision': 0.8847933302754941, 'recall': 0.8712678442830625, 'iou': 0.7875863526178443, 'dice': 0.8768622792285422}
Test   -> {'loss': 'nan', 'accuracy': 0.3787832260131836, 'precision': 0.36538466811180115, 'recall': 0.34557971358299255, 'iou': 0.19164445996284485, 'dice': 0.3095187544822693}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1306279886028041, 'accuracy': 0.9444319009780884, 'precision': 0.8967829802761907, 'recall': 0.887082274582075, 'iou': 0.808523472495701, 'dice': 0.8906296916629957}
Test   -> {'loss': 'nan', 'accuracy': 0.36028677225112915, 'precision': 0.33923420310020447, 'recall': 0.32421061396598816, 'iou': 0.17372381687164307, 'dice': 0.28451043367385864}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.11046582589978757, 'accuracy': 0.9530186062273772, 'precision': 0.9129379189532736, 'recall': 0.9049395353897758, 'iou': 0.836347658737846, 'dice': 0.9084668325341266}
Test   -> {'loss': 'nan', 'accuracy': 0.3321405351161957, 'precision': 0.3054930865764618, 'recall': 0.29138216376304626, 'iou': 0.15974906086921692, 'dice': 0.2657659649848938}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 3 with IoU 0.26796412467956543
Test -> {'loss': 'nan', 'accuracy': 0.5616492629051208, 'precision': 0.3912616968154907, 'recall': 0.3841129243373871, 'iou': 0.26796412467956543, 'dice': 0.3777138590812683} 
Train -> {'loss': 0.33745714659276216, 'accuracy': 0.8571048601813939, 'precision': 0.7431219261625539, 'recall': 0.6811465978622436, 'iou': 0.5720365918200949, 'dice': 0.704687377680903} 

Best model saved for model segnext at epoch 10

Trial 10:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5754205191912858, 'accuracy': 0.7772069426010484, 'precision': 0.6004470963840899, 'recall': 0.43556663329186646, 'iou': 0.34470401765859643, 'dice': 0.42407625868268634}
Test   -> {'loss': 'nan', 'accuracy': 0.37158575654029846, 'precision': 0.7905286550521851, 'recall': 0.3333333432674408, 'iou': 0.12386192381381989, 'dice': 0.1806112825870514}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 2.3854963504749795, 'accuracy': 0.7619021099546681, 'precision': 0.806043520245863, 'recall': 0.3333330396724784, 'iou': 0.25412127038706905, 'dice': 0.288545611889466}
Test   -> {'loss': 'nan', 'accuracy': 0.29793375730514526, 'precision': 0.7659779787063599, 'recall': 0.3333333432674408, 'iou': 0.09931126236915588, 'dice': 0.15302978456020355}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6987094150937122, 'accuracy': 0.7622059008349543, 'precision': 0.9207353275755178, 'recall': 0.3333333432674408, 'iou': 0.2540686470011006, 'dice': 0.2883154349482578}
Test   -> {'loss': 'nan', 'accuracy': 0.3148915767669678, 'precision': 0.7716305255889893, 'recall': 0.3333333432674408, 'iou': 0.10496386140584946, 'dice': 0.15965402126312256}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6853869318962097, 'accuracy': 0.7622058990208999, 'precision': 0.9207353247248609, 'recall': 0.3333333432674408, 'iou': 0.2540686479729155, 'dice': 0.28830420867256495}
Test   -> {'loss': 'nan', 'accuracy': 0.40056750178337097, 'precision': 0.800189197063446, 'recall': 0.3333333432674408, 'iou': 0.13352251052856445, 'dice': 0.19066914916038513}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7208703686361727, 'accuracy': 0.7622039815653925, 'precision': 0.9192858981049579, 'recall': 0.33333250271237413, 'iou': 0.2540680085187373, 'dice': 0.28831702082053473}
Test   -> {'loss': 'nan', 'accuracy': 0.3215668201446533, 'precision': 0.7738556265830994, 'recall': 0.3333333432674408, 'iou': 0.10718894004821777, 'dice': 0.1622149497270584}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6854036092758179, 'accuracy': 0.7622058992800506, 'precision': 0.9207353244657102, 'recall': 0.3333333432674408, 'iou': 0.25406864713067595, 'dice': 0.28831212637217146}
Test   -> {'loss': 'nan', 'accuracy': 0.25191450119018555, 'precision': 0.6749677062034607, 'recall': 0.3477211892604828, 'iou': 0.09529139846563339, 'dice': 0.1623171865940094}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6853831685107687, 'accuracy': 0.7622058992800506, 'precision': 0.9207353223925051, 'recall': 0.3333333432674408, 'iou': 0.2540686460940734, 'dice': 0.28830869690231653}
Test   -> {'loss': 'nan', 'accuracy': 0.2613811790943146, 'precision': 0.7537937164306641, 'recall': 0.3333333432674408, 'iou': 0.08712705969810486, 'dice': 0.13814550638198853}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6854248280110566, 'accuracy': 0.7622059005758036, 'precision': 0.9207353267980658, 'recall': 0.3333333432674408, 'iou': 0.2540686473250389, 'dice': 0.28830707099126734}
Test   -> {'loss': 'nan', 'accuracy': 0.3366774022579193, 'precision': 0.7788925170898438, 'recall': 0.3333333432674408, 'iou': 0.11222580075263977, 'dice': 0.16791754961013794}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6853727480639582, 'accuracy': 0.762205900316653, 'precision': 0.9207353244657102, 'recall': 0.3333333432674408, 'iou': 0.2540686473250389, 'dice': 0.2883133601883183}
Test   -> {'loss': 'nan', 'accuracy': 0.21884466707706451, 'precision': 0.7396149039268494, 'recall': 0.3333333432674408, 'iou': 0.07294822484254837, 'dice': 0.1197006031870842}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.849992512360863, 'accuracy': 0.7621992595817731, 'precision': 0.9164182891016421, 'recall': 0.33333122069421023, 'iou': 0.25406745762928673, 'dice': 0.2883142642352892}
Test   -> {'loss': 'nan', 'accuracy': 0.30942830443382263, 'precision': 0.7698094248771667, 'recall': 0.3333333432674408, 'iou': 0.10314276814460754, 'dice': 0.15753863751888275}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 4 with IoU 0.13352251052856445
Test -> {'loss': 'nan', 'accuracy': 0.40056750178337097, 'precision': 0.800189197063446, 'recall': 0.3333333432674408, 'iou': 0.13352251052856445, 'dice': 0.19066914916038513} 
Train -> {'loss': 0.6853869318962097, 'accuracy': 0.7622058990208999, 'precision': 0.9207353247248609, 'recall': 0.3333333432674408, 'iou': 0.2540686479729155, 'dice': 0.28830420867256495} 

Best model saved for model segnext at epoch 10

Trial 11:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.8618729246699292, 'accuracy': 0.7375921319360318, 'precision': 0.43376508173735245, 'recall': 0.33441735661548116, 'iou': 0.250691715012426, 'dice': 0.2908697387446528}
Test   -> {'loss': 'nan', 'accuracy': 0.2860238254070282, 'precision': 0.7620079517364502, 'recall': 0.3333333432674408, 'iou': 0.0953412801027298, 'dice': 0.14827296137809753}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4799760963605798, 'accuracy': 0.7969043037165766, 'precision': 0.5964011503302533, 'recall': 0.48980440315992935, 'iou': 0.39120045589364094, 'dice': 0.4848273101060287}
Test   -> {'loss': 'nan', 'accuracy': 0.31191423535346985, 'precision': 0.770638108253479, 'recall': 0.3333333432674408, 'iou': 0.10397141426801682, 'dice': 0.15850338339805603}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.45356608992037567, 'accuracy': 0.8076891075009885, 'precision': 0.63402608477551, 'recall': 0.5386625543884609, 'iou': 0.4366637566815252, 'dice': 0.5530351555865743}
Test   -> {'loss': 'nan', 'accuracy': 0.30647027492523193, 'precision': 0.34888917207717896, 'recall': 0.3339199721813202, 'iou': 0.10568481683731079, 'dice': 0.16484205424785614}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4274222482805667, 'accuracy': 0.8170733151228532, 'precision': 0.6497686044029568, 'recall': 0.5757649530535159, 'iou': 0.46853191282438195, 'dice': 0.5947812101115351}
Test   -> {'loss': 'nan', 'accuracy': 0.33195868134498596, 'precision': 0.777319610118866, 'recall': 0.3333333432674408, 'iou': 0.11065289378166199, 'dice': 0.16615065932273865}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4225539705027705, 'accuracy': 0.8206093347590903, 'precision': 0.6615994183913522, 'recall': 0.5798540923906409, 'iou': 0.4719237068425054, 'dice': 0.5956648987272511}
Test   -> {'loss': 'nan', 'accuracy': 0.3096447288990021, 'precision': 0.39986318349838257, 'recall': 0.3422980010509491, 'iou': 0.1117994636297226, 'dice': 0.17817048728466034}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.44601556684659877, 'accuracy': 0.818824275161909, 'precision': 0.6553898977196735, 'recall': 0.5723567094491876, 'iou': 0.46707626736682395, 'dice': 0.5897230625152587}
Test   -> {'loss': 'nan', 'accuracy': 0.2554324269294739, 'precision': 0.7518107891082764, 'recall': 0.3333333432674408, 'iou': 0.08514414727687836, 'dice': 0.1356411576271057}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6260898937349734, 'accuracy': 0.7644406852514848, 'precision': 0.5430651079053465, 'recall': 0.3744653403759003, 'iou': 0.2917265091253364, 'dice': 0.34892445077066836}
Test   -> {'loss': 'nan', 'accuracy': 0.33850565552711487, 'precision': 0.3623252809047699, 'recall': 0.35016700625419617, 'iou': 0.1290203183889389, 'dice': 0.20617607235908508}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5232929711756499, 'accuracy': 0.7621606095977451, 'precision': 0.7511682686598404, 'recall': 0.3333198492941649, 'iou': 0.2540572171625884, 'dice': 0.28834242976230123}
Test   -> {'loss': 'nan', 'accuracy': 0.2996259331703186, 'precision': 0.21384963393211365, 'recall': 0.32779771089553833, 'iou': 0.10188900679349899, 'dice': 0.15849260985851288}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.8855857968330383, 'accuracy': 0.7481151692245318, 'precision': 0.6618583990179974, 'recall': 0.3939078538314156, 'iou': 0.2922226392056631, 'dice': 0.3469939137282579}
Test   -> {'loss': 'nan', 'accuracy': 0.3343253433704376, 'precision': 0.627321720123291, 'recall': 0.3344072699546814, 'iou': 0.12132994830608368, 'dice': 0.19003421068191528}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 7.551851309900698, 'accuracy': 0.761803860768028, 'precision': 0.820262480818707, 'recall': 0.3333414919998335, 'iou': 0.25415392647618834, 'dice': 0.28867994365484817}
Test   -> {'loss': 'nan', 'accuracy': 0.3136584162712097, 'precision': 0.7712194919586182, 'recall': 0.3333333432674408, 'iou': 0.10455280542373657, 'dice': 0.15917807817459106}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 7 with IoU 0.1290203183889389
Test -> {'loss': 'nan', 'accuracy': 0.33850565552711487, 'precision': 0.3623252809047699, 'recall': 0.35016700625419617, 'iou': 0.1290203183889389, 'dice': 0.20617607235908508} 
Train -> {'loss': 0.6260898937349734, 'accuracy': 0.7644406852514848, 'precision': 0.5430651079053465, 'recall': 0.3744653403759003, 'iou': 0.2917265091253364, 'dice': 0.34892445077066836} 

Best model saved for model segnext at epoch 10

Trial 12:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.3945548438507578, 'accuracy': 0.7825840608581253, 'precision': 0.6131850877533789, 'recall': 0.6274520406256552, 'iou': 0.4774498712109483, 'dice': 0.6096888150857842}
Test   -> {'loss': 'nan', 'accuracy': 0.2438977211713791, 'precision': 0.3779480457305908, 'recall': 0.3331662118434906, 'iou': 0.09336092323064804, 'dice': 0.15681402385234833}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.28665199383445406, 'accuracy': 0.8443908792474996, 'precision': 0.7099456737870755, 'recall': 0.7118452178395313, 'iou': 0.5744478193314179, 'dice': 0.7086012472277102}
Test   -> {'loss': 'nan', 'accuracy': 0.29397767782211304, 'precision': 0.7646592855453491, 'recall': 0.3333333432674408, 'iou': 0.09799256920814514, 'dice': 0.1514594405889511}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.24372284671534664, 'accuracy': 0.8662835997083913, 'precision': 0.7536167961099873, 'recall': 0.748134559392929, 'iou': 0.6196261473323987, 'dice': 0.749179375430812}
Test   -> {'loss': 'nan', 'accuracy': 0.26244866847991943, 'precision': 0.7541496157646179, 'recall': 0.3333333432674408, 'iou': 0.08748289197683334, 'dice': 0.13859239220619202}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2166688786900562, 'accuracy': 0.8807526316331781, 'precision': 0.7831867689671723, 'recall': 0.7718102089736772, 'iou': 0.6517136760379957, 'dice': 0.7759118375570878}
Test   -> {'loss': 'nan', 'accuracy': 0.31506720185279846, 'precision': 0.7716891169548035, 'recall': 0.3333333432674408, 'iou': 0.10502240061759949, 'dice': 0.1597217321395874}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.19231430706770525, 'accuracy': 0.8939405075881792, 'precision': 0.8099472877771958, 'recall': 0.7939049928084664, 'iou': 0.6825051857077558, 'dice': 0.8003574550151825}
Test   -> {'loss': 'nan', 'accuracy': 0.30731573700904846, 'precision': 0.7691053152084351, 'recall': 0.3333333432674408, 'iou': 0.10243858397006989, 'dice': 0.15671589970588684}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.16928116912427155, 'accuracy': 0.905277725406315, 'precision': 0.8329740322154501, 'recall': 0.8160407382508983, 'iou': 0.7118720811346303, 'dice': 0.8229828772337541}
Test   -> {'loss': 'nan', 'accuracy': 0.34709447622299194, 'precision': 0.7823648452758789, 'recall': 0.3333333432674408, 'iou': 0.11569815874099731, 'dice': 0.17177438735961914}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.14878427852755008, 'accuracy': 0.916210375920586, 'precision': 0.8541167075219361, 'recall': 0.8359587848186493, 'iou': 0.7404709248439125, 'dice': 0.8438089927901392}
Test   -> {'loss': 'nan', 'accuracy': 0.34253552556037903, 'precision': 0.7808451652526855, 'recall': 0.3333333432674408, 'iou': 0.11417850852012634, 'dice': 0.170093834400177}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.1322132584841355, 'accuracy': 0.9247714918592702, 'precision': 0.8710587817689647, 'recall': 0.8537092698656994, 'iou': 0.7648542940616607, 'dice': 0.8610867191915926}
Test   -> {'loss': 'nan', 'accuracy': 0.3125722408294678, 'precision': 0.7708574533462524, 'recall': 0.3333333432674408, 'iou': 0.10419075191020966, 'dice': 0.15875811874866486}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.11917584201563959, 'accuracy': 0.9320477275744729, 'precision': 0.8825498409893202, 'recall': 0.8684627351553543, 'iou': 0.7844304996988047, 'dice': 0.8745645774447399}
Test   -> {'loss': 'nan', 'accuracy': 0.3357282280921936, 'precision': 0.7785760760307312, 'recall': 0.3333333432674408, 'iou': 0.1119094118475914, 'dice': 0.16756314039230347}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.10982649248579274, 'accuracy': 0.9370393333227738, 'precision': 0.8923569953959921, 'recall': 0.8793620459411455, 'iou': 0.7999464193116064, 'dice': 0.8848598855993022}
Test   -> {'loss': 'nan', 'accuracy': 0.2352656126022339, 'precision': 0.7450885772705078, 'recall': 0.3333333432674408, 'iou': 0.07842187583446503, 'dice': 0.12697167694568634}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 6 with IoU 0.11569815874099731
Test -> {'loss': 'nan', 'accuracy': 0.34709447622299194, 'precision': 0.7823648452758789, 'recall': 0.3333333432674408, 'iou': 0.11569815874099731, 'dice': 0.17177438735961914} 
Train -> {'loss': 0.16928116912427155, 'accuracy': 0.905277725406315, 'precision': 0.8329740322154501, 'recall': 0.8160407382508983, 'iou': 0.7118720811346303, 'dice': 0.8229828772337541} 

Best model saved for model segnext at epoch 10

Trial 13:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4751038603160692, 'accuracy': 0.7315152702124222, 'precision': 0.562025701481363, 'recall': 0.564027100024016, 'iou': 0.4104690759078316, 'dice': 0.5374854010084401}
Test   -> {'loss': 0.6098220944404602, 'accuracy': 0.6172317266464233, 'precision': 0.5560111403465271, 'recall': 0.42169106006622314, 'iou': 0.2951962351799011, 'dice': 0.40054672956466675}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.32288696506749026, 'accuracy': 0.8291684979977815, 'precision': 0.6784028592317001, 'recall': 0.6840175188106039, 'iou': 0.5433207423790641, 'dice': 0.6800070845562479}
Test   -> {'loss': 'nan', 'accuracy': 0.5614440441131592, 'precision': 0.4876837134361267, 'recall': 0.45294976234436035, 'iou': 0.3052079379558563, 'dice': 0.4262242317199707}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.26928421984548156, 'accuracy': 0.85427609215612, 'precision': 0.7291737349137016, 'recall': 0.7259985768276712, 'iou': 0.593099602409031, 'dice': 0.7265699034151823}
Test   -> {'loss': 'nan', 'accuracy': 0.41598883271217346, 'precision': 0.35959944128990173, 'recall': 0.3486778140068054, 'iou': 0.2206035852432251, 'dice': 0.3426685333251953}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.23421704095342885, 'accuracy': 0.8719040507855622, 'precision': 0.7671019372732742, 'recall': 0.7543552284655364, 'iou': 0.6309684670489767, 'dice': 0.7594607933707859}
Test   -> {'loss': 'nan', 'accuracy': 0.4041804075241089, 'precision': 0.3946555256843567, 'recall': 0.3658688962459564, 'iou': 0.2023249864578247, 'dice': 0.32281064987182617}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.20511979745781939, 'accuracy': 0.8872354460799176, 'precision': 0.7976218938827515, 'recall': 0.779696059745291, 'iou': 0.6654672379079072, 'dice': 0.7876702795857968}
Test   -> {'loss': 'nan', 'accuracy': 0.3146810531616211, 'precision': 0.36753401160240173, 'recall': 0.3368961215019226, 'iou': 0.12809397280216217, 'dice': 0.2109837830066681}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.17906681973001232, 'accuracy': 0.9003231753473696, 'precision': 0.8238176200700843, 'recall': 0.805175839299741, 'iou': 0.69857955030773, 'dice': 0.8135177850723266}
Test   -> {'loss': 'nan', 'accuracy': 0.29807546734809875, 'precision': 0.33635270595550537, 'recall': 0.3325697183609009, 'iou': 0.10589201748371124, 'dice': 0.16846999526023865}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.15633499363194342, 'accuracy': 0.9119037586709727, 'precision': 0.8471597687057827, 'recall': 0.8262410868769107, 'iou': 0.7288039684295654, 'dice': 0.8359934542490088}
Test   -> {'loss': 'nan', 'accuracy': 0.28611722588539124, 'precision': 0.4000198543071747, 'recall': 0.3384881019592285, 'iou': 0.10753821581602097, 'dice': 0.17620353400707245}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.1364347571912019, 'accuracy': 0.9222380627756533, 'precision': 0.8666552320770595, 'recall': 0.847518719797549, 'iou': 0.7572484793870345, 'dice': 0.8562942261281221}
Test   -> {'loss': 'nan', 'accuracy': 0.3053445518016815, 'precision': 0.7684482336044312, 'recall': 0.3333333432674408, 'iou': 0.10178151726722717, 'dice': 0.15594583749771118}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.12097262092258619, 'accuracy': 0.9305837283963743, 'precision': 0.8826103117154992, 'recall': 0.8634667349898297, 'iou': 0.7805774460668149, 'dice': 0.8722621145455733}
Test   -> {'loss': 'nan', 'accuracy': 0.28919607400894165, 'precision': 0.23387524485588074, 'recall': 0.3147190511226654, 'iou': 0.10180172324180603, 'dice': 0.16172075271606445}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.11077469276345295, 'accuracy': 0.9360905517702517, 'precision': 0.8920146693354067, 'recall': 0.8748210580452629, 'iou': 0.7964680070462434, 'dice': 0.8828881927158522}
Test   -> {'loss': 'nan', 'accuracy': 0.30150991678237915, 'precision': 0.7671699523925781, 'recall': 0.3333333432674408, 'iou': 0.10050331801176071, 'dice': 0.15444110333919525}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 2 with IoU 0.3052079379558563
Test -> {'loss': 'nan', 'accuracy': 0.5614440441131592, 'precision': 0.4876837134361267, 'recall': 0.45294976234436035, 'iou': 0.3052079379558563, 'dice': 0.4262242317199707} 
Train -> {'loss': 0.32288696506749026, 'accuracy': 0.8291684979977815, 'precision': 0.6784028592317001, 'recall': 0.6840175188106039, 'iou': 0.5433207423790641, 'dice': 0.6800070845562479} 

Best model saved for model segnext at epoch 10

Trial 14:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.787362862151602, 'accuracy': 0.3794573177462039, 'precision': 0.4884776591606762, 'recall': 0.3541618816230608, 'iou': 0.1619860888823219, 'dice': 0.22411643503152806}
Test   -> {'loss': 'nan', 'accuracy': 0.4001539647579193, 'precision': 0.33008068799972534, 'recall': 0.324601411819458, 'iou': 0.205195352435112, 'dice': 0.3209438920021057}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6089776723281197, 'accuracy': 0.7151348956253217, 'precision': 0.7311450276685798, 'recall': 0.43743059842482857, 'iou': 0.32159819330858147, 'dice': 0.40838359698005344}
Test   -> {'loss': 'nan', 'accuracy': 0.28879591822624207, 'precision': 0.3830367922782898, 'recall': 0.35797882080078125, 'iou': 0.1402377039194107, 'dice': 0.24024727940559387}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6874424426451974, 'accuracy': 0.7235754982284878, 'precision': 0.8125023494596066, 'recall': 0.36241114994753965, 'iou': 0.2673923587669497, 'dice': 0.32350537116112915}
Test   -> {'loss': 'nan', 'accuracy': 0.3293008506298065, 'precision': 0.7764336466789246, 'recall': 0.3333333432674408, 'iou': 0.10976695269346237, 'dice': 0.16514989733695984}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.7124064681322678, 'accuracy': 0.7622103942477185, 'precision': 0.9207368236521016, 'recall': 0.3333333432674408, 'iou': 0.25407014599312905, 'dice': 0.2883122521898021}
Test   -> {'loss': 'nan', 'accuracy': 0.3160425126552582, 'precision': 0.7720141410827637, 'recall': 0.3333333432674408, 'iou': 0.10534751415252686, 'dice': 0.1600974202156067}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.7124064681322678, 'accuracy': 0.7622103945068691, 'precision': 0.9207368241704028, 'recall': 0.3333333432674408, 'iou': 0.25407014521567717, 'dice': 0.28830952346324923}
Test   -> {'loss': 'nan', 'accuracy': 0.35357415676116943, 'precision': 0.7845247983932495, 'recall': 0.3333333432674408, 'iou': 0.11785805225372314, 'dice': 0.1741434782743454}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.712406469428021, 'accuracy': 0.7622103937294172, 'precision': 0.9207368236521016, 'recall': 0.3333333432674408, 'iou': 0.25407014573397846, 'dice': 0.28831336485302966}
Test   -> {'loss': 'nan', 'accuracy': 0.2579059302806854, 'precision': 0.7526353597640991, 'recall': 0.3333333432674408, 'iou': 0.08596864342689514, 'dice': 0.1366853266954422}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.7124064665773641, 'accuracy': 0.7622103950251704, 'precision': 0.9207368233929509, 'recall': 0.3333333432674408, 'iou': 0.2540701456691908, 'dice': 0.2883049401252166}
Test   -> {'loss': 'nan', 'accuracy': 0.2304425835609436, 'precision': 0.7434808611869812, 'recall': 0.3333333432674408, 'iou': 0.076814204454422, 'dice': 0.12485620379447937}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.7124064689097197, 'accuracy': 0.7622103942477185, 'precision': 0.9207368252070054, 'recall': 0.3333333432674408, 'iou': 0.25407014541004014, 'dice': 0.288310344322868}
Test   -> {'loss': 'nan', 'accuracy': 0.2861788868904114, 'precision': 0.7620596289634705, 'recall': 0.3333333432674408, 'iou': 0.09539296478033066, 'dice': 0.14833545684814453}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.7124064678731172, 'accuracy': 0.7622103939885678, 'precision': 0.9207368249478547, 'recall': 0.3333333432674408, 'iou': 0.25407014586355375, 'dice': 0.2883088623699935}
Test   -> {'loss': 'nan', 'accuracy': 0.30904465913772583, 'precision': 0.7696815729141235, 'recall': 0.3333333432674408, 'iou': 0.10301488637924194, 'dice': 0.15738941729068756}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.7124064660590628, 'accuracy': 0.7622103958026223, 'precision': 0.9207368249478547, 'recall': 0.3333333432674408, 'iou': 0.25407014541004014, 'dice': 0.28830975423688476}
Test   -> {'loss': 'nan', 'accuracy': 0.27232515811920166, 'precision': 0.7574416995048523, 'recall': 0.3333333432674408, 'iou': 0.09077505767345428, 'dice': 0.14269161224365234}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.205195352435112
Test -> {'loss': 'nan', 'accuracy': 0.4001539647579193, 'precision': 0.33008068799972534, 'recall': 0.324601411819458, 'iou': 0.205195352435112, 'dice': 0.3209438920021057} 
Train -> {'loss': 0.787362862151602, 'accuracy': 0.3794573177462039, 'precision': 0.4884776591606762, 'recall': 0.3541618816230608, 'iou': 0.1619860888823219, 'dice': 0.22411643503152806} 

Best model saved for model segnext at epoch 10

Trial 15:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5302218374998673, 'accuracy': 0.7229097151237985, 'precision': 0.49937298349712206, 'recall': 0.4959153766217439, 'iou': 0.37064964343672213, 'dice': 0.4784212343070818}
Test   -> {'loss': 'nan', 'accuracy': 0.3067474365234375, 'precision': 0.4598633050918579, 'recall': 0.344158411026001, 'iou': 0.11285647004842758, 'dice': 0.1807599514722824}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.40600983267245083, 'accuracy': 0.7831638149593187, 'precision': 0.5945123413334722, 'recall': 0.6153198283651601, 'iou': 0.4654043073239534, 'dice': 0.6003639672113501}
Test   -> {'loss': 'nan', 'accuracy': 0.29465654492378235, 'precision': 0.7648855447769165, 'recall': 0.3333333432674408, 'iou': 0.09821885079145432, 'dice': 0.15172958374023438}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.37807874368584676, 'accuracy': 0.797577236527982, 'precision': 0.6217488672422327, 'recall': 0.6331658119740693, 'iou': 0.4879760319771974, 'dice': 0.6249343110167462}
Test   -> {'loss': 'nan', 'accuracy': 0.2897077202796936, 'precision': 0.7632359266281128, 'recall': 0.3333333432674408, 'iou': 0.0965692400932312, 'dice': 0.14975368976593018}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3736500252848086, 'accuracy': 0.7998371279757955, 'precision': 0.6231937812722248, 'recall': 0.6364647093026534, 'iou': 0.49118554125661434, 'dice': 0.6280994306439939}
Test   -> {'loss': 'nan', 'accuracy': 0.2659609913825989, 'precision': 0.7553203105926514, 'recall': 0.3333333432674408, 'iou': 0.08865366876125336, 'dice': 0.1400575041770935}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.37029542611992877, 'accuracy': 0.8008416098097096, 'precision': 0.6238368096558944, 'recall': 0.6419606353925622, 'iou': 0.4926923746648042, 'dice': 0.6292536668155504}
Test   -> {'loss': 'nan', 'accuracy': 0.270416259765625, 'precision': 0.756805419921875, 'recall': 0.3333333432674408, 'iou': 0.0901387557387352, 'dice': 0.1419042944908142}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.38760756306026295, 'accuracy': 0.7927632140076679, 'precision': 0.6115113636721735, 'recall': 0.6292035450106082, 'iou': 0.4787333141202512, 'dice': 0.6143677436787149}
Test   -> {'loss': 'nan', 'accuracy': 0.28127333521842957, 'precision': 0.7604244947433472, 'recall': 0.3333333432674408, 'iou': 0.09375779330730438, 'dice': 0.1463509500026703}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.39436745695445846, 'accuracy': 0.7891490459442139, 'precision': 0.6030612308046092, 'recall': 0.6275770353234332, 'iou': 0.474065959971884, 'dice': 0.6094240136768507}
Test   -> {'loss': 'nan', 'accuracy': 0.34343329071998596, 'precision': 0.7811444997787476, 'recall': 0.3333333432674408, 'iou': 0.11447776854038239, 'dice': 0.170425683259964}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3926138504691746, 'accuracy': 0.7857514790866686, 'precision': 0.6008997896443242, 'recall': 0.6275814180788787, 'iou': 0.4728423631709555, 'dice': 0.6088584485261337}
Test   -> {'loss': 'nan', 'accuracy': 0.38735058903694153, 'precision': 0.43217283487319946, 'recall': 0.3721352815628052, 'iou': 0.16874735057353973, 'dice': 0.268787145614624}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.40871596440025, 'accuracy': 0.7744267173435377, 'precision': 0.5902702611425649, 'recall': 0.6118272605149643, 'iou': 0.45920642096063363, 'dice': 0.5952388887820037}
Test   -> {'loss': 'nan', 'accuracy': 0.34519055485725403, 'precision': 0.46969151496887207, 'recall': 0.35060662031173706, 'iou': 0.13204430043697357, 'dice': 0.20878610014915466}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.43441353466199795, 'accuracy': 0.7614276642384736, 'precision': 0.5637302901433862, 'recall': 0.5902210406635119, 'iou': 0.437839602905771, 'dice': 0.5711347662884256}
Test   -> {'loss': 'nan', 'accuracy': 0.510918140411377, 'precision': 0.4082847535610199, 'recall': 0.41054388880729675, 'iou': 0.27562063932418823, 'dice': 0.4021146297454834}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 10 with IoU 0.27562063932418823
Test -> {'loss': 'nan', 'accuracy': 0.510918140411377, 'precision': 0.4082847535610199, 'recall': 0.41054388880729675, 'iou': 0.27562063932418823, 'dice': 0.4021146297454834} 
Train -> {'loss': 0.43441353466199795, 'accuracy': 0.7614276642384736, 'precision': 0.5637302901433862, 'recall': 0.5902210406635119, 'iou': 0.437839602905771, 'dice': 0.5711347662884256} 

Best model saved for model segnext at epoch 10

Trial 16:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5330484627381615, 'accuracy': 0.795491978785266, 'precision': 0.8004263071910195, 'recall': 0.5352201667816743, 'iou': 0.4308516472578049, 'dice': 0.5116156898762869}
Test   -> {'loss': 'nan', 'accuracy': 0.5027503371238708, 'precision': 0.4317667484283447, 'recall': 0.4125196933746338, 'iou': 0.23908820748329163, 'dice': 0.35026130080223083}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4283394234335941, 'accuracy': 0.8376770872136821, 'precision': 0.6691343623658885, 'recall': 0.5921838190244592, 'iou': 0.49360843987568565, 'dice': 0.5717014206492382}
Test   -> {'loss': 'nan', 'accuracy': 0.30877062678337097, 'precision': 0.3326031565666199, 'recall': 0.33212152123451233, 'iou': 0.13150186836719513, 'dice': 0.2196110486984253}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.38323601199233015, 'accuracy': 0.8520942397739576, 'precision': 0.6960144639015198, 'recall': 0.6213927154955656, 'iou': 0.5299447980911836, 'dice': 0.6156778413316478}
Test   -> {'loss': 'nan', 'accuracy': 0.2837187945842743, 'precision': 0.7612396478652954, 'recall': 0.3333333432674408, 'iou': 0.09457294642925262, 'dice': 0.14734214544296265}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.350190230426581, 'accuracy': 0.8628277192945065, 'precision': 0.7156854328901872, 'recall': 0.6446408546489218, 'iou': 0.5572955986727839, 'dice': 0.6467846689016923}
Test   -> {'loss': 'nan', 'accuracy': 0.33433812856674194, 'precision': 0.7781127691268921, 'recall': 0.3333333432674408, 'iou': 0.11144604533910751, 'dice': 0.16704319417476654}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3110772267631862, 'accuracy': 0.8748257320860158, 'precision': 0.7338122046512107, 'recall': 0.6750285210816757, 'iou': 0.5901747089365255, 'dice': 0.6829265729240749}
Test   -> {'loss': 'nan', 'accuracy': 0.25049325823783875, 'precision': 0.7501644492149353, 'recall': 0.3333333432674408, 'iou': 0.08349775522947311, 'dice': 0.1335437148809433}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2649455878397693, 'accuracy': 0.8901819625626439, 'precision': 0.7593924112941908, 'recall': 0.7168039376321046, 'iou': 0.6338825928128284, 'dice': 0.7281225435111833}
Test   -> {'loss': 'nan', 'accuracy': 0.29338353872299194, 'precision': 0.7644612193107605, 'recall': 0.3333333432674408, 'iou': 0.09779451787471771, 'dice': 0.15122276544570923}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.22555990866992784, 'accuracy': 0.9045743664969569, 'precision': 0.7875170541846234, 'recall': 0.7605884357638981, 'iou': 0.6763472308283267, 'dice': 0.770466271949851}
Test   -> {'loss': 'nan', 'accuracy': 0.3291115164756775, 'precision': 0.7763705253601074, 'recall': 0.3333333432674408, 'iou': 0.10970383882522583, 'dice': 0.16507846117019653}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.19897674451703612, 'accuracy': 0.9150709577228712, 'precision': 0.81052674677061, 'recall': 0.7910641221896462, 'iou': 0.706735406751218, 'dice': 0.7989004554955855}
Test   -> {'loss': 'nan', 'accuracy': 0.30053213238716125, 'precision': 0.7668440341949463, 'recall': 0.3333333432674408, 'iou': 0.10017737746238708, 'dice': 0.15405598282814026}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1732893957068091, 'accuracy': 0.9254250710425169, 'precision': 0.8318309060905291, 'recall': 0.8197927024053491, 'iou': 0.7362758436928625, 'dice': 0.8250059900076493}
Test   -> {'loss': 'nan', 'accuracy': 0.3362102806568146, 'precision': 0.7787367701530457, 'recall': 0.3333333432674408, 'iou': 0.11207009851932526, 'dice': 0.16774320602416992}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.1558450270606124, 'accuracy': 0.9328843813875447, 'precision': 0.8477174644884856, 'recall': 0.8400768570278002, 'iou': 0.7580312581165977, 'dice': 0.8433805167675018}
Test   -> {'loss': 'nan', 'accuracy': 0.33852338790893555, 'precision': 0.7795078158378601, 'recall': 0.3333333432674408, 'iou': 0.11284112930297852, 'dice': 0.16860538721084595}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.23908820748329163
Test -> {'loss': 'nan', 'accuracy': 0.5027503371238708, 'precision': 0.4317667484283447, 'recall': 0.4125196933746338, 'iou': 0.23908820748329163, 'dice': 0.35026130080223083} 
Train -> {'loss': 0.5330484627381615, 'accuracy': 0.795491978785266, 'precision': 0.8004263071910195, 'recall': 0.5352201667816743, 'iou': 0.4308516472578049, 'dice': 0.5116156898762869} 

Best model saved for model segnext at epoch 10

Trial 17:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6088098945824997, 'accuracy': 0.7523053635721622, 'precision': 0.7652253456737684, 'recall': 0.48359965967095414, 'iou': 0.37793485625930456, 'dice': 0.4630523344744807}
Test   -> {'loss': 1.300321340560913, 'accuracy': 0.6568703055381775, 'precision': 0.7926117181777954, 'recall': 0.4219301640987396, 'iou': 0.3003995418548584, 'dice': 0.3992489278316498}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4706081600292869, 'accuracy': 0.8240311752194943, 'precision': 0.7653283606404844, 'recall': 0.5710467494052389, 'iou': 0.4689013035401054, 'dice': 0.5469381316848423}
Test   -> {'loss': 'nan', 'accuracy': 0.5830121636390686, 'precision': 0.42117080092430115, 'recall': 0.41634508967399597, 'iou': 0.28860753774642944, 'dice': 0.403287410736084}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4198411065599193, 'accuracy': 0.840423333644867, 'precision': 0.6725354816602624, 'recall': 0.5929714451665463, 'iou': 0.49520223348037057, 'dice': 0.5707812454389489}
Test   -> {'loss': 'nan', 'accuracy': 0.43121087551116943, 'precision': 0.3585059642791748, 'recall': 0.3737308382987976, 'iou': 0.20041410624980927, 'dice': 0.3092416524887085}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.37864984584891276, 'accuracy': 0.8531691680783811, 'precision': 0.6947328007739523, 'recall': 0.6191296048786329, 'iou': 0.5281794978224713, 'dice': 0.6114609085995218}
Test   -> {'loss': 'nan', 'accuracy': 0.3229563236236572, 'precision': 0.3353804051876068, 'recall': 0.3353935182094574, 'iou': 0.1326998770236969, 'dice': 0.21804776787757874}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3453681919885718, 'accuracy': 0.8639865849329078, 'precision': 0.7137055272641389, 'recall': 0.6452764490376348, 'iou': 0.5588339784870977, 'dice': 0.6480725231377975}
Test   -> {'loss': 'nan', 'accuracy': 0.29909032583236694, 'precision': 0.5981540679931641, 'recall': 0.3318934440612793, 'iou': 0.10213252902030945, 'dice': 0.15939944982528687}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3031420433002969, 'accuracy': 0.8776830953100453, 'precision': 0.7354322993237039, 'recall': 0.6808685396028602, 'iou': 0.5970121217810589, 'dice': 0.6899694893671119}
Test   -> {'loss': 'nan', 'accuracy': 0.34843599796295166, 'precision': 0.3955685496330261, 'recall': 0.3381440043449402, 'iou': 0.12300574779510498, 'dice': 0.1877487748861313}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.25458713147951206, 'accuracy': 0.8938776197640792, 'precision': 0.7662047697150189, 'recall': 0.7285470703373784, 'iou': 0.6452194607776144, 'dice': 0.7400293386500815}
Test   -> {'loss': 'nan', 'accuracy': 0.2771783769130707, 'precision': 0.32478928565979004, 'recall': 0.3300529718399048, 'iou': 0.09802254289388657, 'dice': 0.1571783721446991}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2193746382775514, 'accuracy': 0.9068766293318375, 'precision': 0.7925529340039129, 'recall': 0.7671505052110423, 'iou': 0.6830219942590464, 'dice': 0.7770179209501847}
Test   -> {'loss': 'nan', 'accuracy': 0.31032857298851013, 'precision': 0.7701095342636108, 'recall': 0.3333333432674408, 'iou': 0.10344286262989044, 'dice': 0.15788844227790833}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1900150444196618, 'accuracy': 0.9188531880793365, 'precision': 0.8174580392630204, 'recall': 0.801242472814477, 'iou': 0.7167513997658439, 'dice': 0.8080166189566903}
Test   -> {'loss': 'nan', 'accuracy': 0.2729109227657318, 'precision': 0.7576370239257812, 'recall': 0.3333333432674408, 'iou': 0.09097030758857727, 'dice': 0.1429327130317688}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.17101830814195715, 'accuracy': 0.9265773332637289, 'precision': 0.8336106124131576, 'recall': 0.8234915479369785, 'iou': 0.7395781377087469, 'dice': 0.8279614743979081}
Test   -> {'loss': 'nan', 'accuracy': 0.2870888113975525, 'precision': 0.32856276631355286, 'recall': 0.3329792618751526, 'iou': 0.09841668605804443, 'dice': 0.1552387923002243}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.3003995418548584
Test -> {'loss': 1.300321340560913, 'accuracy': 0.6568703055381775, 'precision': 0.7926117181777954, 'recall': 0.4219301640987396, 'iou': 0.3003995418548584, 'dice': 0.3992489278316498} 
Train -> {'loss': 0.6088098945824997, 'accuracy': 0.7523053635721622, 'precision': 0.7652253456737684, 'recall': 0.48359965967095414, 'iou': 0.37793485625930456, 'dice': 0.4630523344744807} 

Best model saved for model segnext at epoch 10

Trial 18:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6722903138917425, 'accuracy': 0.7587536655042483, 'precision': 0.7178014841416608, 'recall': 0.4896711492020151, 'iou': 0.38015280029048093, 'dice': 0.4603117346763611}
Test   -> {'loss': 'nan', 'accuracy': 0.2530965805053711, 'precision': 0.7510322332382202, 'recall': 0.3333333432674408, 'iou': 0.08436553925275803, 'dice': 0.1346512883901596}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5414207089206446, 'accuracy': 0.8005502737086753, 'precision': 0.819716523522916, 'recall': 0.5393496631280236, 'iou': 0.43610911939455116, 'dice': 0.521054431407348}
Test   -> {'loss': 'nan', 'accuracy': 0.2515158951282501, 'precision': 0.7505053281784058, 'recall': 0.3333333432674408, 'iou': 0.08383864164352417, 'dice': 0.13397935032844543}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5282445014818855, 'accuracy': 0.8054028853126194, 'precision': 0.8291691441898761, 'recall': 0.5450457502966342, 'iou': 0.4428424042204152, 'dice': 0.5265500774850016}
Test   -> {'loss': 'nan', 'accuracy': 0.3089064061641693, 'precision': 0.7696355581283569, 'recall': 0.3333333432674408, 'iou': 0.10296880453824997, 'dice': 0.15733562409877777}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 1.830884986338408, 'accuracy': 0.7375103554000025, 'precision': 0.7933251359540483, 'recall': 0.42062187168909154, 'iou': 0.31855170014111894, 'dice': 0.3789762261769046}
Test   -> {'loss': 'nan', 'accuracy': 0.26406174898147583, 'precision': 0.7546872496604919, 'recall': 0.3333333432674408, 'iou': 0.08802058547735214, 'dice': 0.13926628232002258}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 154.5312791585922, 'accuracy': 0.6888870278778283, 'precision': 0.8918304007986317, 'recall': 0.33334789081760074, 'iou': 0.22967133155983427, 'dice': 0.2717183574386265}
Test   -> {'loss': 'nan', 'accuracy': 0.29144659638404846, 'precision': 0.5906425714492798, 'recall': 0.3164636790752411, 'iou': 0.11567788571119308, 'dice': 0.19314321875572205}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 8.945439246944758, 'accuracy': 0.6912154993285303, 'precision': 0.8784312191216842, 'recall': 0.3333790247854979, 'iou': 0.230477358530397, 'dice': 0.2725360271723374}
Test   -> {'loss': 'nan', 'accuracy': 0.39287832379341125, 'precision': 0.623013436794281, 'recall': 0.3226258456707001, 'iou': 0.17442727088928223, 'dice': 0.2757236361503601}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.804943139915881, 'accuracy': 0.6912317957567132, 'precision': 0.8970772883166438, 'recall': 0.3333333432674408, 'iou': 0.23041060819574025, 'dice': 0.27240318059921265}
Test   -> {'loss': 'nan', 'accuracy': 0.4801361560821533, 'precision': 0.6807667016983032, 'recall': 0.3994606137275696, 'iou': 0.2309468686580658, 'dice': 0.34267187118530273}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.8048935874648716, 'accuracy': 0.6912394220414368, 'precision': 0.8970789359963458, 'recall': 0.33334329516991323, 'iou': 0.23042220576949743, 'dice': 0.2724314653355142}
Test   -> {'loss': 'nan', 'accuracy': 0.3071625232696533, 'precision': 0.602453351020813, 'recall': 0.3047260046005249, 'iou': 0.12950722873210907, 'dice': 0.21688251197338104}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.8048867098663164, 'accuracy': 0.6912317960158638, 'precision': 0.8970772880574931, 'recall': 0.3333333432674408, 'iou': 0.23041060787180195, 'dice': 0.27239835508491683}
Test   -> {'loss': 'nan', 'accuracy': 0.3689238727092743, 'precision': 0.32373175024986267, 'recall': 0.3444758355617523, 'iou': 0.1676195114850998, 'dice': 0.27016136050224304}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.8129644956277764, 'accuracy': 0.6912310144175654, 'precision': 0.8956279288167539, 'recall': 0.3333329641300699, 'iou': 0.23041034865638485, 'dice': 0.27239822615747866}
Test   -> {'loss': 'nan', 'accuracy': 0.3328683078289032, 'precision': 0.6164273619651794, 'recall': 0.3320743441581726, 'iou': 0.13316106796264648, 'dice': 0.21568068861961365}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 7 with IoU 0.2309468686580658
Test -> {'loss': 'nan', 'accuracy': 0.4801361560821533, 'precision': 0.6807667016983032, 'recall': 0.3994606137275696, 'iou': 0.2309468686580658, 'dice': 0.34267187118530273} 
Train -> {'loss': 0.804943139915881, 'accuracy': 0.6912317957567132, 'precision': 0.8970772883166438, 'recall': 0.3333333432674408, 'iou': 0.23041060819574025, 'dice': 0.27240318059921265} 

Best model saved for model segnext at epoch 10

Trial 19:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.9894716169523157, 'accuracy': 0.6717806422192117, 'precision': 0.48544281565624736, 'recall': 0.3651329729868018, 'iou': 0.2563957382803378, 'dice': 0.31952704268953075}
Test   -> {'loss': 'nan', 'accuracy': 0.29489508271217346, 'precision': 0.7649650573730469, 'recall': 0.3333333432674408, 'iou': 0.09829836338758469, 'dice': 0.1518244445323944}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.5647341795589613, 'accuracy': 0.7871534342351167, 'precision': 0.6999161590700564, 'recall': 0.5277138186537701, 'iou': 0.4202990710735321, 'dice': 0.508242987031522}
Test   -> {'loss': 'nan', 'accuracy': 0.29429128766059875, 'precision': 0.7647637724876404, 'recall': 0.3333333432674408, 'iou': 0.09809710085391998, 'dice': 0.15158426761627197}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5233256796131963, 'accuracy': 0.8058960173441017, 'precision': 0.7739340616309125, 'recall': 0.5516115017559218, 'iou': 0.4452210055745166, 'dice': 0.5287460695142331}
Test   -> {'loss': 'nan', 'accuracy': 0.2610760033130646, 'precision': 0.7536920309066772, 'recall': 0.3333333432674408, 'iou': 0.08702533692121506, 'dice': 0.13801759481430054}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5096246955187425, 'accuracy': 0.8106404599936112, 'precision': 0.811219947234444, 'recall': 0.5578376863313758, 'iou': 0.45158383017000947, 'dice': 0.5336869177610978}
Test   -> {'loss': 'nan', 'accuracy': 0.2972508668899536, 'precision': 0.7657502889633179, 'recall': 0.3333333432674408, 'iou': 0.09908362478017807, 'dice': 0.15275938808918}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5029031831285228, 'accuracy': 0.8134577958480171, 'precision': 0.8379892468452453, 'recall': 0.5602358030236285, 'iou': 0.45505905306857564, 'dice': 0.536365212564883}
Test   -> {'loss': 'nan', 'accuracy': 0.3060638904571533, 'precision': 0.7686879634857178, 'recall': 0.3333333432674408, 'iou': 0.10202129930257797, 'dice': 0.15622712671756744}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.489313157485879, 'accuracy': 0.8178450278613878, 'precision': 0.8153151947519054, 'recall': 0.5630565467088119, 'iou': 0.46037277216496675, 'dice': 0.5403870940208435}
Test   -> {'loss': 'nan', 'accuracy': 0.31795984506607056, 'precision': 0.7726532816886902, 'recall': 0.3333333432674408, 'iou': 0.10598661750555038, 'dice': 0.16083437204360962}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4756484443726747, 'accuracy': 0.8222304504850636, 'precision': 0.8512332579363947, 'recall': 0.5688539613848147, 'iou': 0.466409788183544, 'dice': 0.5449389820513518}
Test   -> {'loss': 'nan', 'accuracy': 0.3049961030483246, 'precision': 0.7683320045471191, 'recall': 0.3333333432674408, 'iou': 0.10166537016630173, 'dice': 0.1558094620704651}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.46039349307184635, 'accuracy': 0.828402839017951, 'precision': 0.805202477392943, 'recall': 0.5748338854831198, 'iou': 0.4746465343496074, 'dice': 0.5510160767513773}
Test   -> {'loss': 'nan', 'accuracy': 0.30573099851608276, 'precision': 0.7685770392417908, 'recall': 0.3333333432674408, 'iou': 0.10191034525632858, 'dice': 0.15609699487686157}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.468803306247877, 'accuracy': 0.8281205405359683, 'precision': 0.7306800655696704, 'recall': 0.5745624521504278, 'iou': 0.47456279941227125, 'dice': 0.5507032057513361}
Test   -> {'loss': 'nan', 'accuracy': 0.27673307061195374, 'precision': 0.7589110732078552, 'recall': 0.3333333432674408, 'iou': 0.09224437177181244, 'dice': 0.14450062811374664}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 7.799030599386795, 'accuracy': 0.72376033378684, 'precision': 0.557167626204698, 'recall': 0.39898602159126945, 'iou': 0.29566428272620493, 'dice': 0.35552618503570554}
Test   -> {'loss': 'nan', 'accuracy': 0.29607000946998596, 'precision': 0.765356719493866, 'recall': 0.3333333432674408, 'iou': 0.09869000315666199, 'dice': 0.1522911787033081}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 6 with IoU 0.10598661750555038
Test -> {'loss': 'nan', 'accuracy': 0.31795984506607056, 'precision': 0.7726532816886902, 'recall': 0.3333333432674408, 'iou': 0.10598661750555038, 'dice': 0.16083437204360962} 
Train -> {'loss': 0.489313157485879, 'accuracy': 0.8178450278613878, 'precision': 0.8153151947519054, 'recall': 0.5630565467088119, 'iou': 0.46037277216496675, 'dice': 0.5403870940208435} 

Best model saved for model segnext at epoch 10

Trial 20:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4211529985718105, 'accuracy': 0.7454353189986686, 'precision': 0.5974806535503139, 'recall': 0.5925649548354356, 'iou': 0.4612547001760939, 'dice': 0.5816421782192976}
Test   -> {'loss': 'nan', 'accuracy': 0.2840401828289032, 'precision': 0.2626785635948181, 'recall': 0.3076140880584717, 'iou': 0.10796014964580536, 'dice': 0.1783573031425476}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3522190806658372, 'accuracy': 0.7938521382601365, 'precision': 0.6532700766687808, 'recall': 0.6537787351919258, 'iou': 0.525073936322461, 'dice': 0.6448615823103034}
Test   -> {'loss': 'nan', 'accuracy': 0.34268996119499207, 'precision': 0.7808966636657715, 'recall': 0.3333333432674408, 'iou': 0.11422999948263168, 'dice': 0.1701509654521942}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.32188833822374757, 'accuracy': 0.8147860770640166, 'precision': 0.6802674765172212, 'recall': 0.6831367106541343, 'iou': 0.5548744327348212, 'dice': 0.6731657878212307}
Test   -> {'loss': 'nan', 'accuracy': 0.21893310546875, 'precision': 0.7396444082260132, 'recall': 0.3333333432674408, 'iou': 0.0729777067899704, 'dice': 0.11974029242992401}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3031527638435364, 'accuracy': 0.8280122515947922, 'precision': 0.6975290687187858, 'recall': 0.701462697982788, 'iou': 0.5746307860250058, 'dice': 0.6912843623886937}
Test   -> {'loss': 'nan', 'accuracy': 0.29554468393325806, 'precision': 0.7651815414428711, 'recall': 0.3333333432674408, 'iou': 0.09851489961147308, 'dice': 0.15208259224891663}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2846233948417332, 'accuracy': 0.8407653256602909, 'precision': 0.7142002056474271, 'recall': 0.7190298992654551, 'iou': 0.5939507821331853, 'dice': 0.7087990553482719}
Test   -> {'loss': 'nan', 'accuracy': 0.3629685938358307, 'precision': 0.7876561880111694, 'recall': 0.3333333432674408, 'iou': 0.12098953127861023, 'dice': 0.17753826081752777}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.26599520989086317, 'accuracy': 0.8531524518261785, 'precision': 0.7310016943060833, 'recall': 0.7374761545139811, 'iou': 0.6142080078954282, 'dice': 0.7269332183443982}
Test   -> {'loss': 'nan', 'accuracy': 0.33452123403549194, 'precision': 0.7781738042831421, 'recall': 0.3333333432674408, 'iou': 0.11150708049535751, 'dice': 0.16711173951625824}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2470040298026541, 'accuracy': 0.8651937158211418, 'precision': 0.747567199624103, 'recall': 0.7556681319423344, 'iou': 0.6347137264583422, 'dice': 0.7452126715494238}
Test   -> {'loss': 'nan', 'accuracy': 0.26256948709487915, 'precision': 0.7541898488998413, 'recall': 0.3333333432674408, 'iou': 0.08752317726612091, 'dice': 0.13864293694496155}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2300568261872167, 'accuracy': 0.8765331833258919, 'precision': 0.7633599045483962, 'recall': 0.7725186640801637, 'iou': 0.6545688201551852, 'dice': 0.7621835454650547}
Test   -> {'loss': 'nan', 'accuracy': 0.24383793771266937, 'precision': 0.7479459643363953, 'recall': 0.3333333432674408, 'iou': 0.08127931505441666, 'dice': 0.13069117069244385}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2151675364245539, 'accuracy': 0.8852635243664617, 'precision': 0.7765785261340763, 'recall': 0.7873041837111764, 'iou': 0.6713987570741903, 'dice': 0.7767894972925601}
Test   -> {'loss': 'nan', 'accuracy': 0.3143559694290161, 'precision': 0.7714519500732422, 'recall': 0.3333333432674408, 'iou': 0.10478532314300537, 'dice': 0.15944740176200867}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.20118252298106318, 'accuracy': 0.8938524025937785, 'precision': 0.7891948020976522, 'recall': 0.8011636529279792, 'iou': 0.6879579735838849, 'dice': 0.7905621971773065}
Test   -> {'loss': 'nan', 'accuracy': 0.28525713086128235, 'precision': 0.7617523670196533, 'recall': 0.3333333432674408, 'iou': 0.09508571028709412, 'dice': 0.1479637324810028}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 5 with IoU 0.12098953127861023
Test -> {'loss': 'nan', 'accuracy': 0.3629685938358307, 'precision': 0.7876561880111694, 'recall': 0.3333333432674408, 'iou': 0.12098953127861023, 'dice': 0.17753826081752777} 
Train -> {'loss': 0.2846233948417332, 'accuracy': 0.8407653256602909, 'precision': 0.7142002056474271, 'recall': 0.7190298992654551, 'iou': 0.5939507821331853, 'dice': 0.7087990553482719} 

Best model saved for model segnext at epoch 10

Trial 21:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4867853869562564, 'accuracy': 0.6950966029063516, 'precision': 0.5518673305926116, 'recall': 0.5404106129770694, 'iou': 0.39997529879860255, 'dice': 0.5182664650937785}
Test   -> {'loss': 0.5275127291679382, 'accuracy': 0.6383455395698547, 'precision': 0.5296759009361267, 'recall': 0.474153995513916, 'iou': 0.3514586389064789, 'dice': 0.48008549213409424}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.37709819855897325, 'accuracy': 0.7782239520031473, 'precision': 0.6319675813550535, 'recall': 0.6290575452472853, 'iou': 0.5021664313648058, 'dice': 0.6232117932775746}
Test   -> {'loss': 'nan', 'accuracy': 0.6107813119888306, 'precision': 0.46922826766967773, 'recall': 0.4422561824321747, 'iou': 0.32218608260154724, 'dice': 0.44445985555648804}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3459933384605076, 'accuracy': 0.7997391908065132, 'precision': 0.6601250995760378, 'recall': 0.6586748055789782, 'iou': 0.5318387192228566, 'dice': 0.6516468348710434}
Test   -> {'loss': 'nan', 'accuracy': 0.5023025274276733, 'precision': 0.40258336067199707, 'recall': 0.40455231070518494, 'iou': 0.26843804121017456, 'dice': 0.39881381392478943}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.32173583714858345, 'accuracy': 0.8175350220307059, 'precision': 0.6829375583192576, 'recall': 0.6804768510486768, 'iou': 0.5557151960289997, 'dice': 0.6740395323089932}
Test   -> {'loss': 'nan', 'accuracy': 0.30782613158226013, 'precision': 0.39617571234703064, 'recall': 0.3401583135128021, 'iou': 0.11254057288169861, 'dice': 0.179904043674469}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3041980681212052, 'accuracy': 0.8277955853420755, 'precision': 0.6977139504059501, 'recall': 0.6986073364382205, 'iou': 0.5729339822478916, 'dice': 0.690217749968819}
Test   -> {'loss': 'nan', 'accuracy': 0.3217032253742218, 'precision': 0.773901104927063, 'recall': 0.3333333432674408, 'iou': 0.1072344109416008, 'dice': 0.16226699948310852}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.28069938835890396, 'accuracy': 0.843782741608827, 'precision': 0.7178889367891395, 'recall': 0.7213434525158094, 'iou': 0.5975820966388868, 'dice': 0.7125422596931458}
Test   -> {'loss': 'nan', 'accuracy': 0.2771942615509033, 'precision': 0.18043607473373413, 'recall': 0.3297582268714905, 'iou': 0.09350203722715378, 'dice': 0.14698298275470734}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.26202747407166854, 'accuracy': 0.8560352164766063, 'precision': 0.7338229034257971, 'recall': 0.7396788534910782, 'iou': 0.6175921424575473, 'dice': 0.730469880933347}
Test   -> {'loss': 'nan', 'accuracy': 0.2601800858974457, 'precision': 0.35421282052993774, 'recall': 0.33400553464889526, 'iou': 0.0921403095126152, 'dice': 0.15063896775245667}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.24127568991287895, 'accuracy': 0.8693216992461164, 'precision': 0.7526587817979895, 'recall': 0.7599015261815942, 'iou': 0.6405631023904551, 'dice': 0.7506279230117798}
Test   -> {'loss': 'nan', 'accuracy': 0.3354495167732239, 'precision': 0.4362822473049164, 'recall': 0.3338707387447357, 'iou': 0.11504331231117249, 'dice': 0.17419978976249695}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.22342290152674135, 'accuracy': 0.8807611911193184, 'precision': 0.769316177782805, 'recall': 0.7769227064174155, 'iou': 0.6609606794689012, 'dice': 0.7682738190111906}
Test   -> {'loss': 'nan', 'accuracy': 0.2748509645462036, 'precision': 0.7582836151123047, 'recall': 0.3333333432674408, 'iou': 0.09161698818206787, 'dice': 0.14372973144054413}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.20748177611309548, 'accuracy': 0.8901929466620736, 'precision': 0.7836742240449657, 'recall': 0.7929168701171875, 'iou': 0.679410940149556, 'dice': 0.7839606513147769}
Test   -> {'loss': 'nan', 'accuracy': 0.27139997482299805, 'precision': 0.7571333646774292, 'recall': 0.3333333432674408, 'iou': 0.09046666324138641, 'dice': 0.14231032133102417}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 1 with IoU 0.3514586389064789
Test -> {'loss': 0.5275127291679382, 'accuracy': 0.6383455395698547, 'precision': 0.5296759009361267, 'recall': 0.474153995513916, 'iou': 0.3514586389064789, 'dice': 0.48008549213409424} 
Train -> {'loss': 0.4867853869562564, 'accuracy': 0.6950966029063516, 'precision': 0.5518673305926116, 'recall': 0.5404106129770694, 'iou': 0.39997529879860255, 'dice': 0.5182664650937785} 

Best model saved for model segnext at epoch 10

Trial 22:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.485509840560996, 'accuracy': 0.730261973388817, 'precision': 0.5739448481279871, 'recall': 0.5375639200210571, 'iou': 0.41278797504694564, 'dice': 0.5203040993731954}
Test   -> {'loss': 'nan', 'accuracy': 0.28964918851852417, 'precision': 0.7632164359092712, 'recall': 0.3333333432674408, 'iou': 0.09654973447322845, 'dice': 0.14973022043704987}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.46280246376991274, 'accuracy': 0.7096454511518063, 'precision': 0.5458363172800644, 'recall': 0.5550451482119767, 'iou': 0.41944629744343137, 'dice': 0.540884527693624}
Test   -> {'loss': 'nan', 'accuracy': 0.2802547514438629, 'precision': 0.7600849866867065, 'recall': 0.3333333432674408, 'iou': 0.09341825544834137, 'dice': 0.145936980843544}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4851036019947218, 'accuracy': 0.7302306929360265, 'precision': 0.5358135529186414, 'recall': 0.5286676298017087, 'iou': 0.4059377773948338, 'dice': 0.5182857195968213}
Test   -> {'loss': 'nan', 'accuracy': 0.31983667612075806, 'precision': 0.7732788920402527, 'recall': 0.3333333432674408, 'iou': 0.10661222785711288, 'dice': 0.16155366599559784}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5275669761326002, 'accuracy': 0.7420398844325025, 'precision': 0.6223193547000055, 'recall': 0.5228458383808965, 'iou': 0.3875274480684944, 'dice': 0.48259716979835343}
Test   -> {'loss': 'nan', 'accuracy': 0.33828049898147583, 'precision': 0.7794268131256104, 'recall': 0.3333333432674408, 'iou': 0.11276017129421234, 'dice': 0.16851501166820526}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5564100071139958, 'accuracy': 0.7592633327712184, 'precision': 0.7508180388937826, 'recall': 0.46299959693265996, 'iou': 0.3661500185728073, 'dice': 0.4556041490772496}
Test   -> {'loss': 'nan', 'accuracy': 0.3199276030063629, 'precision': 0.6798380613327026, 'recall': 0.3619152009487152, 'iou': 0.1308073103427887, 'dice': 0.21586564183235168}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.632018110026484, 'accuracy': 0.5600107931572458, 'precision': 0.4719434512698132, 'recall': 0.45984709858894346, 'iou': 0.26988514733055363, 'dice': 0.3764482361466988}
Test   -> {'loss': 'nan', 'accuracy': 0.29636678099632263, 'precision': 0.36555537581443787, 'recall': 0.3498084247112274, 'iou': 0.11076971888542175, 'dice': 0.18106216192245483}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5801337216211402, 'accuracy': 0.6127101508171662, 'precision': 0.4440538139446922, 'recall': 0.4855206076217734, 'iou': 0.31142145343448807, 'dice': 0.42481256036654763}
Test   -> {'loss': 'nan', 'accuracy': 0.2398606836795807, 'precision': 0.7466201782226562, 'recall': 0.3333333432674408, 'iou': 0.07995356619358063, 'dice': 0.1289718598127365}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6782114474669747, 'accuracy': 0.6706812957058782, 'precision': 0.5730000328758489, 'recall': 0.3665054509173269, 'iou': 0.26164376282173657, 'dice': 0.33442656384861985}
Test   -> {'loss': 'nan', 'accuracy': 0.2667423188686371, 'precision': 0.7555807828903198, 'recall': 0.3333333432674408, 'iou': 0.08891411125659943, 'dice': 0.140382319688797}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6951402324697246, 'accuracy': 0.6744920673577682, 'precision': 0.6225702433482461, 'recall': 0.3490909967733466, 'iou': 0.2517794088177059, 'dice': 0.3183588973853899}
Test   -> {'loss': 'nan', 'accuracy': 0.2791561186313629, 'precision': 0.7597187757492065, 'recall': 0.3333333432674408, 'iou': 0.09305204451084137, 'dice': 0.14548973739147186}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6954547475213589, 'accuracy': 0.6755308470000392, 'precision': 0.6145331043264141, 'recall': 0.3497263984835666, 'iou': 0.25249603889558625, 'dice': 0.319347412949023}
Test   -> {'loss': 'nan', 'accuracy': 0.3510829210281372, 'precision': 0.7836942672729492, 'recall': 0.3333333432674408, 'iou': 0.1170276552438736, 'dice': 0.17323532700538635}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 5 with IoU 0.1308073103427887
Test -> {'loss': 'nan', 'accuracy': 0.3199276030063629, 'precision': 0.6798380613327026, 'recall': 0.3619152009487152, 'iou': 0.1308073103427887, 'dice': 0.21586564183235168} 
Train -> {'loss': 0.5564100071139958, 'accuracy': 0.7592633327712184, 'precision': 0.7508180388937826, 'recall': 0.46299959693265996, 'iou': 0.3661500185728073, 'dice': 0.4556041490772496} 

Best model saved for model segnext at epoch 10

Trial 23:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5111652156581049, 'accuracy': 0.6868942203729049, 'precision': 0.518340423832769, 'recall': 0.5150681210600812, 'iou': 0.38368351226267605, 'dice': 0.49440753744996113}
Test   -> {'loss': 'nan', 'accuracy': 0.2781577408313751, 'precision': 0.4282599687576294, 'recall': 0.33763062953948975, 'iou': 0.09618678689002991, 'dice': 0.15313836932182312}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.39830295313959535, 'accuracy': 0.7599133139071257, 'precision': 0.6103988409042358, 'recall': 0.6088842402333798, 'iou': 0.47945916341698686, 'dice': 0.6020250154578167}
Test   -> {'loss': 'nan', 'accuracy': 0.28916776180267334, 'precision': 0.45809683203697205, 'recall': 0.3357665240764618, 'iou': 0.09864978492259979, 'dice': 0.15492641925811768}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.38643463176229725, 'accuracy': 0.7680200799651767, 'precision': 0.6210225530292677, 'recall': 0.6207886058351267, 'iou': 0.49052128014357194, 'dice': 0.612716197449228}
Test   -> {'loss': 'nan', 'accuracy': 0.3055270314216614, 'precision': 0.768509030342102, 'recall': 0.3333333432674408, 'iou': 0.10184234380722046, 'dice': 0.1560172140598297}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.38588190441546233, 'accuracy': 0.7688941877821217, 'precision': 0.6233022212982178, 'recall': 0.619553674303967, 'iou': 0.4906571108361949, 'dice': 0.613044315835704}
Test   -> {'loss': 'nan', 'accuracy': 0.29513269662857056, 'precision': 0.7650442123413086, 'recall': 0.3333333432674408, 'iou': 0.09837757050991058, 'dice': 0.1519189029932022}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3791458834772525, 'accuracy': 0.7738222407258075, 'precision': 0.6293193278105362, 'recall': 0.6273591850114906, 'iou': 0.4972752498543781, 'dice': 0.6193541806677113}
Test   -> {'loss': 'nan', 'accuracy': 0.31705987453460693, 'precision': 0.4079684615135193, 'recall': 0.34753453731536865, 'iou': 0.11906774342060089, 'dice': 0.1911751627922058}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3704520987427753, 'accuracy': 0.7813515492107557, 'precision': 0.63570724207422, 'recall': 0.6337326049804688, 'iou': 0.5059592117433963, 'dice': 0.6270342847575312}
Test   -> {'loss': 'nan', 'accuracy': 0.2687290608882904, 'precision': 0.756243109703064, 'recall': 0.3333333432674408, 'iou': 0.089576356112957, 'dice': 0.14120644330978394}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3674071146094281, 'accuracy': 0.77992022814958, 'precision': 0.6376823871032051, 'recall': 0.6402831419654514, 'iou': 0.5084352081236632, 'dice': 0.6304292554440706}
Test   -> {'loss': 'nan', 'accuracy': 0.2852368950843811, 'precision': 0.3720141649246216, 'recall': 0.3356505036354065, 'iou': 0.10184770822525024, 'dice': 0.1629633605480194}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3643052132233329, 'accuracy': 0.7837049261383389, 'precision': 0.6429564797359965, 'recall': 0.6417381794556327, 'iou': 0.5109947497430055, 'dice': 0.6330077839934307}
Test   -> {'loss': 'nan', 'accuracy': 0.31016042828559875, 'precision': 0.770053505897522, 'recall': 0.3333333432674408, 'iou': 0.10338681191205978, 'dice': 0.1578231304883957}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.3690651333850363, 'accuracy': 0.7836551987606546, 'precision': 0.6384474158287048, 'recall': 0.6349167305490245, 'iou': 0.5073676124863002, 'dice': 0.6284311755843784}
Test   -> {'loss': 'nan', 'accuracy': 0.29186543822288513, 'precision': 0.4445036053657532, 'recall': 0.34385836124420166, 'iou': 0.10451927036046982, 'dice': 0.16784773766994476}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.3753677046817282, 'accuracy': 0.7732211232185364, 'precision': 0.6286631449409154, 'recall': 0.6321267552997755, 'iou': 0.4996718873148379, 'dice': 0.622422502870145}
Test   -> {'loss': 'nan', 'accuracy': 0.2993273138999939, 'precision': 0.7664424777030945, 'recall': 0.3333333432674408, 'iou': 0.0997757762670517, 'dice': 0.1535806655883789}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnext at epoch 10
Best model found at epoch 5 with IoU 0.11906774342060089
Test -> {'loss': 'nan', 'accuracy': 0.31705987453460693, 'precision': 0.4079684615135193, 'recall': 0.34753453731536865, 'iou': 0.11906774342060089, 'dice': 0.1911751627922058} 
Train -> {'loss': 0.3791458834772525, 'accuracy': 0.7738222407258075, 'precision': 0.6293193278105362, 'recall': 0.6273591850114906, 'iou': 0.4972752498543781, 'dice': 0.6193541806677113} 

Best model saved for model segnext at epoch 10

Best parameters:
Best parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Max IoU: 0.2607
Best metrics: {'loss': 'nan', 'accuracy': 0.5060225501554998, 'precision': 0.3941158060158069, 'recall': 0.39495716069952674, 'iou': 0.26068911601328076, 'dice': 0.375354403856828}
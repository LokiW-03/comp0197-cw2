Trial 0:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
/usr/local/lib/python3.11/dist-packages/torch/autograd/graph.py:823: UserWarning: Attempting to run cuBLAS, but there was no current CUDA context! Attempting to set the primary context... (Triggered internally at /pytorch/aten/src/ATen/cuda/CublasHandlePool.cpp:180.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Downloading: "https://download.pytorch.org/models/vgg16_bn-6c64b313.pth" to /root/.cache/torch/hub/checkpoints/vgg16_bn-6c64b313.pth
100% 528M/528M [00:02<00:00, 211MB/s]
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4991257232168446, 'accuracy': 0.8157089907190074, 'precision': 0.853479866877846, 'recall': 0.5711667136005734, 'iou': 0.4764145908148392, 'dice': 0.5524814292788506}
Test   -> {'loss': 1.029396653175354, 'accuracy': 0.6665325164794922, 'precision': 0.7723445892333984, 'recall': 0.48425230383872986, 'iou': 0.3530198931694031, 'dice': 0.45954009890556335}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4223054826259613, 'accuracy': 0.8448880579160607, 'precision': 0.8921906427196834, 'recall': 0.5949085383311562, 'iou': 0.5078355045422264, 'dice': 0.5756131734537042}
Test   -> {'loss': 0.915576159954071, 'accuracy': 0.6976704597473145, 'precision': 0.7636129260063171, 'recall': 0.5142573714256287, 'iou': 0.36000511050224304, 'dice': 0.4589740037918091}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3994831923557364, 'accuracy': 0.8524553332639777, 'precision': 0.8974637477294258, 'recall': 0.6013034517350404, 'iou': 0.5166976161625074, 'dice': 0.5813817133074222}
Test   -> {'loss': 0.8148780465126038, 'accuracy': 0.7022891640663147, 'precision': 0.7926579713821411, 'recall': 0.5348382592201233, 'iou': 0.3900044858455658, 'dice': 0.4895298480987549}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3813139073226763, 'accuracy': 0.858843604637229, 'precision': 0.9019760606081589, 'recall': 0.6064932703971863, 'iou': 0.5242666573628135, 'dice': 0.5862011481886324}
Test   -> {'loss': 0.8582300543785095, 'accuracy': 0.7084375619888306, 'precision': 0.7695186138153076, 'recall': 0.4787796437740326, 'iou': 0.3570120930671692, 'dice': 0.4555226266384125}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3627849904091462, 'accuracy': 0.8653877737729446, 'precision': 0.9061984095884406, 'recall': 0.6121729122555775, 'iou': 0.5319951240135276, 'dice': 0.5911386461361595}
Test   -> {'loss': 0.8267733454704285, 'accuracy': 0.7520889043807983, 'precision': 0.8076488971710205, 'recall': 0.5324487686157227, 'iou': 0.4090268611907959, 'dice': 0.501688539981842}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3414372162974399, 'accuracy': 0.8722421752369922, 'precision': 0.9103392282257909, 'recall': 0.6181626037411068, 'iou': 0.5404011059066524, 'dice': 0.5963791243408038}
Test   -> {'loss': 0.9495946764945984, 'accuracy': 0.7203406095504761, 'precision': 0.80375736951828, 'recall': 0.5273079872131348, 'iou': 0.3988592326641083, 'dice': 0.4962410628795624}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.32407197939312976, 'accuracy': 0.8776848904464556, 'precision': 0.9142626876416413, 'recall': 0.6224075428817584, 'iou': 0.5470379178938658, 'dice': 0.6004778584708338}
Test   -> {'loss': 1.2461574077606201, 'accuracy': 0.6675962805747986, 'precision': 0.7821005582809448, 'recall': 0.4925770163536072, 'iou': 0.357066810131073, 'dice': 0.4626339375972748}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.30784041356781255, 'accuracy': 0.8827570783055347, 'precision': 0.8822606265544891, 'recall': 0.6264434677103291, 'iou': 0.5532602398291878, 'dice': 0.6042682655479596}
Test   -> {'loss': 0.9857956767082214, 'accuracy': 0.6983405947685242, 'precision': 0.8001046180725098, 'recall': 0.5179110765457153, 'iou': 0.3859894275665283, 'dice': 0.48719900846481323}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.28825164346591287, 'accuracy': 0.8886318152365478, 'precision': 0.7605579827142799, 'recall': 0.6314374871875928, 'iou': 0.5606049864188485, 'dice': 0.6087728746559309}
Test   -> {'loss': 1.1104966402053833, 'accuracy': 0.7378527522087097, 'precision': 0.5439748167991638, 'recall': 0.5077835917472839, 'iou': 0.3900555372238159, 'dice': 0.4859636723995209}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.26836525687704915, 'accuracy': 0.8945099644038988, 'precision': 0.7175528088341588, 'recall': 0.637326462113339, 'iou': 0.5694785911103953, 'dice': 0.6159127429775569}
Test   -> {'loss': 1.2353771924972534, 'accuracy': 0.7021322250366211, 'precision': 0.4934542179107666, 'recall': 0.5042557716369629, 'iou': 0.3764175772666931, 'dice': 0.4778338372707367}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 5 with IoU 0.4090268611907959
Test -> {'loss': 0.8267733454704285, 'accuracy': 0.7520889043807983, 'precision': 0.8076488971710205, 'recall': 0.5324487686157227, 'iou': 0.4090268611907959, 'dice': 0.501688539981842} 
Train -> {'loss': 0.3627849904091462, 'accuracy': 0.8653877737729446, 'precision': 0.9061984095884406, 'recall': 0.6121729122555775, 'iou': 0.5319951240135276, 'dice': 0.5911386461361595} 

Best model saved for model segnet at epoch 10

Trial 1:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.527176851293315, 'accuracy': 0.8022666832675105, 'precision': 0.6729218555533367, 'recall': 0.5589361330737238, 'iou': 0.4657813048881033, 'dice': 0.5417243840901748}
Test   -> {'loss': 0.983692467212677, 'accuracy': 0.6971049308776855, 'precision': 0.44093093276023865, 'recall': 0.48977184295654297, 'iou': 0.3625986576080322, 'dice': 0.4635953903198242}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3901571740274844, 'accuracy': 0.8557572131571562, 'precision': 0.859224095551864, 'recall': 0.6037856169368909, 'iou': 0.5205223267493041, 'dice': 0.5839699123216712}
Test   -> {'loss': 1.1645971536636353, 'accuracy': 0.6528725028038025, 'precision': 0.7686924934387207, 'recall': 0.4097481667995453, 'iou': 0.28975602984428406, 'dice': 0.3848894536495209}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.35507336077482804, 'accuracy': 0.8686424695927164, 'precision': 0.8994780934375265, 'recall': 0.6141228499619857, 'iou': 0.5357771603957466, 'dice': 0.5936056220013163}
Test   -> {'loss': 1.0962990522384644, 'accuracy': 0.704534113407135, 'precision': 0.7876743078231812, 'recall': 0.48882126808166504, 'iou': 0.36594051122665405, 'dice': 0.4655418395996094}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3332882645337478, 'accuracy': 0.8747997439425924, 'precision': 0.8604888247407001, 'recall': 0.6196724819100421, 'iou': 0.5434254231660263, 'dice': 0.598341208955516}
Test   -> {'loss': 1.144126296043396, 'accuracy': 0.6948229670524597, 'precision': 0.7833611369132996, 'recall': 0.5228988528251648, 'iou': 0.37929651141166687, 'dice': 0.4805574417114258}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.30372442862261895, 'accuracy': 0.8839508974033853, 'precision': 0.7929234380307405, 'recall': 0.6271062498507293, 'iou': 0.5545904138813849, 'dice': 0.6051834795785986}
Test   -> {'loss': 1.2624919414520264, 'accuracy': 0.6595458984375, 'precision': 0.7556099891662598, 'recall': 0.45250043272972107, 'iou': 0.3273085355758667, 'dice': 0.4314382076263428}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2771594021631324, 'accuracy': 0.8920023793759553, 'precision': 0.7220683906389319, 'recall': 0.6343521330667579, 'iou': 0.5659296305283256, 'dice': 0.6134125004643979}
Test   -> {'loss': 1.5091681480407715, 'accuracy': 0.6528734564781189, 'precision': 0.4824763536453247, 'recall': 0.4626736640930176, 'iou': 0.3320082426071167, 'dice': 0.4376987814903259}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2571954001551089, 'accuracy': 0.8976660702539527, 'precision': 0.7134332962658094, 'recall': 0.6413557550181513, 'iou': 0.5755594937697701, 'dice': 0.6224084812661875}
Test   -> {'loss': 1.5872503519058228, 'accuracy': 0.6502554416656494, 'precision': 0.4804117679595947, 'recall': 0.4515206515789032, 'iou': 0.32394200563430786, 'dice': 0.4297640025615692}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.23936791912369107, 'accuracy': 0.9029690141263216, 'precision': 0.7243443286937216, 'recall': 0.6606900495031606, 'iou': 0.5987059261487878, 'dice': 0.6549974161645641}
Test   -> {'loss': 1.4838958978652954, 'accuracy': 0.673851490020752, 'precision': 0.502558171749115, 'recall': 0.47907882928848267, 'iou': 0.35574397444725037, 'dice': 0.46689948439598083}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.22109511676041976, 'accuracy': 0.9086538066034732, 'precision': 0.7409722944964533, 'recall': 0.6874559309171594, 'iou': 0.6269355711729631, 'dice': 0.6937851822894553}
Test   -> {'loss': 1.6644642353057861, 'accuracy': 0.6728110909461975, 'precision': 0.5250333547592163, 'recall': 0.471539705991745, 'iou': 0.35202640295028687, 'dice': 0.4660700559616089}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.20621424200742142, 'accuracy': 0.9137766314589459, 'precision': 0.7572286979011867, 'recall': 0.7140734294186468, 'iou': 0.6515122465465379, 'dice': 0.7250591329906297}
Test   -> {'loss': 1.3093124628067017, 'accuracy': 0.7075403928756714, 'precision': 0.5297155380249023, 'recall': 0.5113113522529602, 'iou': 0.39557451009750366, 'dice': 0.5121713876724243}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 10 with IoU 0.39557451009750366
Test -> {'loss': 1.3093124628067017, 'accuracy': 0.7075403928756714, 'precision': 0.5297155380249023, 'recall': 0.5113113522529602, 'iou': 0.39557451009750366, 'dice': 0.5121713876724243} 
Train -> {'loss': 0.20621424200742142, 'accuracy': 0.9137766314589459, 'precision': 0.7572286979011867, 'recall': 0.7140734294186468, 'iou': 0.6515122465465379, 'dice': 0.7250591329906297} 

Best model saved for model segnet at epoch 10

Trial 2:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7108354672141697, 'accuracy': 0.722451500011527, 'precision': 0.6971597814689512, 'recall': 0.4869438668955927, 'iou': 0.37100618410369623, 'dice': 0.4563150493995003}
Test   -> {'loss': 5.361504554748535, 'accuracy': 0.5637767314910889, 'precision': 0.3566300868988037, 'recall': 0.35008764266967773, 'iou': 0.23464171588420868, 'dice': 0.32726120948791504}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6112004077952841, 'accuracy': 0.7728319212146427, 'precision': 0.7503190293260242, 'recall': 0.5340543630330459, 'iou': 0.428727980411571, 'dice': 0.519485177423643}
Test   -> {'loss': 0.7933088541030884, 'accuracy': 0.6976616978645325, 'precision': 0.7650301456451416, 'recall': 0.4955568313598633, 'iou': 0.3612764775753021, 'dice': 0.4614129662513733}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.5986502488022265, 'accuracy': 0.7757344637228095, 'precision': 0.7634311438902565, 'recall': 0.5375585633775463, 'iou': 0.4321954487458519, 'dice': 0.5221428003000177}
Test   -> {'loss': 0.7754628658294678, 'accuracy': 0.7054293751716614, 'precision': 0.7941464781761169, 'recall': 0.5128241777420044, 'iou': 0.38401901721954346, 'dice': 0.48508429527282715}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.5908271596483562, 'accuracy': 0.7782069968140644, 'precision': 0.7968110643003298, 'recall': 0.5395916123753008, 'iou': 0.4347621649503708, 'dice': 0.5240666233974954}
Test   -> {'loss': 0.8561172485351562, 'accuracy': 0.6656680703163147, 'precision': 0.41925615072250366, 'recall': 0.40700799226760864, 'iou': 0.2930964529514313, 'dice': 0.3858729600906372}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5853688965673032, 'accuracy': 0.7799224011276079, 'precision': 0.8103655736083569, 'recall': 0.5402748915164367, 'iou': 0.4362124601136083, 'dice': 0.5251940009386643}
Test   -> {'loss': 0.8073761463165283, 'accuracy': 0.6953560709953308, 'precision': 0.7677420377731323, 'recall': 0.49833282828330994, 'iou': 0.362595796585083, 'dice': 0.46377038955688477}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.577183920663336, 'accuracy': 0.7828779109146284, 'precision': 0.8217050539410633, 'recall': 0.5430096631464751, 'iou': 0.4393581451281257, 'dice': 0.527526864150296}
Test   -> {'loss': 0.7251282334327698, 'accuracy': 0.7223747372627258, 'precision': 0.4462319314479828, 'recall': 0.49411290884017944, 'iou': 0.37087470293045044, 'dice': 0.4689398407936096}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.565382029440092, 'accuracy': 0.7876500329245691, 'precision': 0.8303345680236817, 'recall': 0.5466797561749168, 'iou': 0.4443274177934812, 'dice': 0.5312037601419117}
Test   -> {'loss': 0.8154069781303406, 'accuracy': 0.6811684966087341, 'precision': 0.7821836471557617, 'recall': 0.48367446660995483, 'iou': 0.35584092140197754, 'dice': 0.45941075682640076}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5470394051593283, 'accuracy': 0.7957286433033322, 'precision': 0.8566598016282786, 'recall': 0.5536173194646835, 'iou': 0.4530197577631992, 'dice': 0.5376140111166497}
Test   -> {'loss': 0.8096652030944824, 'accuracy': 0.6903561949729919, 'precision': 0.7670795321464539, 'recall': 0.5102584362030029, 'iou': 0.3649935722351074, 'dice': 0.4664188623428345}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5276754079953484, 'accuracy': 0.8034454591896223, 'precision': 0.8627797233021778, 'recall': 0.5594039800374404, 'iou': 0.46106162732062134, 'dice': 0.5434444277182869}
Test   -> {'loss': 0.9611246585845947, 'accuracy': 0.6181553602218628, 'precision': 0.7393398284912109, 'recall': 0.4815078377723694, 'iou': 0.3306882977485657, 'dice': 0.4405287206172943}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5144674479961395, 'accuracy': 0.8093166848887567, 'precision': 0.8674633256767107, 'recall': 0.5651837278967319, 'iou': 0.4677590352037679, 'dice': 0.548268902560939}
Test   -> {'loss': 0.992455780506134, 'accuracy': 0.5999456644058228, 'precision': 0.6912636756896973, 'recall': 0.3414739966392517, 'iou': 0.2108595371246338, 'dice': 0.27146103978157043}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 3 with IoU 0.38401901721954346
Test -> {'loss': 0.7754628658294678, 'accuracy': 0.7054293751716614, 'precision': 0.7941464781761169, 'recall': 0.5128241777420044, 'iou': 0.38401901721954346, 'dice': 0.48508429527282715} 
Train -> {'loss': 0.5986502488022265, 'accuracy': 0.7757344637228095, 'precision': 0.7634311438902565, 'recall': 0.5375585633775463, 'iou': 0.4321954487458519, 'dice': 0.5221428003000177} 

Best model saved for model segnet at epoch 10

Trial 3:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.9048724744630896, 'accuracy': 0.5930464428404103, 'precision': 0.6008057228896929, 'recall': 0.33338156472081726, 'iou': 0.19927544671556224, 'dice': 0.2511092294817385}
Test   -> {'loss': 75.24510955810547, 'accuracy': 0.5520225167274475, 'precision': 0.5835267305374146, 'recall': 0.324127733707428, 'iou': 0.19048021733760834, 'dice': 0.2504035234451294}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.8071046834406645, 'accuracy': 0.6180648212847503, 'precision': 0.6875433678212373, 'recall': 0.3789017615110978, 'iou': 0.24660538849623306, 'dice': 0.3185135996860007}
Test   -> {'loss': 3.5627031326293945, 'accuracy': 0.5638440251350403, 'precision': 0.31834346055984497, 'recall': 0.3346579968929291, 'iou': 0.20341649651527405, 'dice': 0.27108052372932434}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6613756983176522, 'accuracy': 0.7569003053333448, 'precision': 0.7716213355893674, 'recall': 0.5319317625916522, 'iou': 0.4176301528578219, 'dice': 0.5115580294443214}
Test   -> {'loss': 6.876825332641602, 'accuracy': 0.564534068107605, 'precision': 0.28764569759368896, 'recall': 0.3304070830345154, 'iou': 0.20165430009365082, 'dice': 0.26799917221069336}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6308176299800043, 'accuracy': 0.76800195393355, 'precision': 0.7874644766683164, 'recall': 0.5310221599495929, 'iou': 0.42419838775759156, 'dice': 0.5162530261537303}
Test   -> {'loss': 11.93447208404541, 'accuracy': 0.5714522004127502, 'precision': 0.6499578356742859, 'recall': 0.3344162404537201, 'iou': 0.19425389170646667, 'dice': 0.25029292702674866}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6207846076592155, 'accuracy': 0.7692423110422881, 'precision': 0.8163665823314501, 'recall': 0.5304140744001969, 'iou': 0.4247278254965077, 'dice': 0.516597288587819}
Test   -> {'loss': 84.46078491210938, 'accuracy': 0.53778076171875, 'precision': 0.6561746001243591, 'recall': 0.3623136281967163, 'iou': 0.23783676326274872, 'dice': 0.3384213447570801}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6160956631536069, 'accuracy': 0.7695657320644544, 'precision': 0.8011115996733956, 'recall': 0.5300568238548611, 'iou': 0.4247685707133749, 'dice': 0.5166403221047443}
Test   -> {'loss': 12.542094230651855, 'accuracy': 0.5628148317337036, 'precision': 0.6850761771202087, 'recall': 0.4024249315261841, 'iou': 0.267599493265152, 'dice': 0.3751451373100281}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6147642586542212, 'accuracy': 0.7699176041976266, 'precision': 0.7997538006823995, 'recall': 0.5311057863028154, 'iou': 0.42547326036121536, 'dice': 0.5171748741813328}
Test   -> {'loss': 1.4384832382202148, 'accuracy': 0.6285278797149658, 'precision': 0.7366473078727722, 'recall': 0.4113703668117523, 'iou': 0.28710994124412537, 'dice': 0.38734960556030273}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6112034533334815, 'accuracy': 0.770943866605344, 'precision': 0.817091385177944, 'recall': 0.5320472478866577, 'iou': 0.4265601774920588, 'dice': 0.5180236702379973}
Test   -> {'loss': 4.341203212738037, 'accuracy': 0.5971240401268005, 'precision': 0.7181929349899292, 'recall': 0.42170509696006775, 'iou': 0.28805503249168396, 'dice': 0.39526957273483276}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6017696385798247, 'accuracy': 0.773351001739502, 'precision': 0.7897638434949128, 'recall': 0.5340391480404397, 'iou': 0.42905919551849364, 'dice': 0.5199362153592317}
Test   -> {'loss': 2.6526968479156494, 'accuracy': 0.6354777812957764, 'precision': 0.739967942237854, 'recall': 0.44284695386886597, 'iou': 0.3137487769126892, 'dice': 0.419907808303833}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5952260022578032, 'accuracy': 0.7751576418462007, 'precision': 0.8438077874805616, 'recall': 0.5349670182103696, 'iou': 0.4306373020877009, 'dice': 0.5211203948311184}
Test   -> {'loss': 1.114125370979309, 'accuracy': 0.5743734836578369, 'precision': 0.3487966060638428, 'recall': 0.3916320502758026, 'iou': 0.2646532654762268, 'dice': 0.3688931167125702}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 9 with IoU 0.3137487769126892
Test -> {'loss': 2.6526968479156494, 'accuracy': 0.6354777812957764, 'precision': 0.739967942237854, 'recall': 0.44284695386886597, 'iou': 0.3137487769126892, 'dice': 0.419907808303833} 
Train -> {'loss': 0.6017696385798247, 'accuracy': 0.773351001739502, 'precision': 0.7897638434949128, 'recall': 0.5340391480404397, 'iou': 0.42905919551849364, 'dice': 0.5199362153592317} 

Best model saved for model segnet at epoch 10

Trial 4:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4028393996798474, 'accuracy': 0.7623943794032801, 'precision': 0.6097340842951899, 'recall': 0.6134408185015554, 'iou': 0.4885154181200525, 'dice': 0.600221061706543}
Test   -> {'loss': 0.5415545701980591, 'accuracy': 0.5910544991493225, 'precision': 0.4907703399658203, 'recall': 0.4825616776943207, 'iou': 0.34581780433654785, 'dice': 0.4836561679840088}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.36932390047156294, 'accuracy': 0.7874217056709787, 'precision': 0.6376743674278259, 'recall': 0.6461399485235629, 'iou': 0.5212865307279255, 'dice': 0.6316236703292183}
Test   -> {'loss': 0.48909711837768555, 'accuracy': 0.6532854437828064, 'precision': 0.5327867269515991, 'recall': 0.5256650447845459, 'iou': 0.39630722999572754, 'dice': 0.5284363031387329}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.35663781788038174, 'accuracy': 0.7975165411182071, 'precision': 0.6488037531790526, 'recall': 0.660391514715941, 'iou': 0.5346148290064023, 'dice': 0.6438297984392747}
Test   -> {'loss': 0.529099702835083, 'accuracy': 0.6197634339332581, 'precision': 0.49691981077194214, 'recall': 0.4909455180168152, 'iou': 0.35978421568870544, 'dice': 0.49306362867355347}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.34935593890107197, 'accuracy': 0.8033045198606408, 'precision': 0.655453146799751, 'recall': 0.667978802193766, 'iou': 0.5420888672704282, 'dice': 0.650751800381619}
Test   -> {'loss': 0.5366992950439453, 'accuracy': 0.5978468060493469, 'precision': 0.4763142466545105, 'recall': 0.4805206060409546, 'iou': 0.34412726759910583, 'dice': 0.4776301085948944}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3415357390175695, 'accuracy': 0.8093193769454956, 'precision': 0.6614604758179706, 'recall': 0.6773091479488041, 'iou': 0.5504443013149759, 'dice': 0.658243874622428}
Test   -> {'loss': 0.6096327304840088, 'accuracy': 0.46582654118537903, 'precision': 0.4492969512939453, 'recall': 0.44829607009887695, 'iou': 0.2678607702255249, 'dice': 0.4070885181427002}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.33527667548345486, 'accuracy': 0.8143108590789463, 'precision': 0.6670020489589028, 'recall': 0.684746643771296, 'iou': 0.5575242286143096, 'dice': 0.664558212912601}
Test   -> {'loss': 0.5005109906196594, 'accuracy': 0.6627632975578308, 'precision': 0.5211727023124695, 'recall': 0.5217040777206421, 'iou': 0.39318642020225525, 'dice': 0.5212906002998352}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.33022650635760764, 'accuracy': 0.8173865030641141, 'precision': 0.6705253746198572, 'recall': 0.6907125022100365, 'iou': 0.5624100143494813, 'dice': 0.6692201523677163}
Test   -> {'loss': 0.5943830013275146, 'accuracy': 0.628437876701355, 'precision': 0.4963139295578003, 'recall': 0.4505314826965332, 'iou': 0.329764187335968, 'dice': 0.451444149017334}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3245552622753641, 'accuracy': 0.8223962576492972, 'precision': 0.6756004123584084, 'recall': 0.6967861548714016, 'iou': 0.5686661503885103, 'dice': 0.6748263107693714}
Test   -> {'loss': 0.48612070083618164, 'accuracy': 0.6604103446006775, 'precision': 0.5337664484977722, 'recall': 0.5412389039993286, 'iou': 0.4038439691066742, 'dice': 0.5366026163101196}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.3199177322180375, 'accuracy': 0.8269338493761809, 'precision': 0.6790510664815488, 'recall': 0.7008416502372078, 'iou': 0.5740142594213071, 'dice': 0.6795014505800994}
Test   -> {'loss': 0.5453354120254517, 'accuracy': 0.6412577629089355, 'precision': 0.4797566831111908, 'recall': 0.4631703794002533, 'iou': 0.3440328538417816, 'dice': 0.4680957794189453}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.3170665730600772, 'accuracy': 0.828342608783556, 'precision': 0.6823704688445381, 'recall': 0.7051978295264036, 'iou': 0.5769920665284861, 'dice': 0.6823890121086784}
Test   -> {'loss': 0.48699289560317993, 'accuracy': 0.6487937569618225, 'precision': 0.5284428000450134, 'recall': 0.5333213210105896, 'iou': 0.39712271094322205, 'dice': 0.52982497215271}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 8 with IoU 0.4038439691066742
Test -> {'loss': 0.48612070083618164, 'accuracy': 0.6604103446006775, 'precision': 0.5337664484977722, 'recall': 0.5412389039993286, 'iou': 0.4038439691066742, 'dice': 0.5366026163101196} 
Train -> {'loss': 0.3245552622753641, 'accuracy': 0.8223962576492972, 'precision': 0.6756004123584084, 'recall': 0.6967861548714016, 'iou': 0.5686661503885103, 'dice': 0.6748263107693714} 

Best model saved for model segnet at epoch 10

Trial 5:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.41960664158282074, 'accuracy': 0.7572512154993803, 'precision': 0.5962140145509139, 'recall': 0.5979271132013072, 'iou': 0.4779496731965438, 'dice': 0.5855700788290604}
Test   -> {'loss': 0.5747877955436707, 'accuracy': 0.5185447335243225, 'precision': 0.4582793116569519, 'recall': 0.4571823477745056, 'iou': 0.3048638701438904, 'dice': 0.44370120763778687}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3521703595700471, 'accuracy': 0.8018255047176195, 'precision': 0.6520860915598662, 'recall': 0.6665743055550949, 'iou': 0.5405645857686582, 'dice': 0.6490182150965151}
Test   -> {'loss': 0.5936591625213623, 'accuracy': 0.526067316532135, 'precision': 0.4818274676799774, 'recall': 0.4757409691810608, 'iou': 0.299426794052124, 'dice': 0.4342431426048279}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3367203738378442, 'accuracy': 0.814056628683339, 'precision': 0.6642366782478665, 'recall': 0.6833949317102846, 'iou': 0.5566304673319278, 'dice': 0.6637219973232436}
Test   -> {'loss': 0.5448213815689087, 'accuracy': 0.5779014229774475, 'precision': 0.491196870803833, 'recall': 0.4951821565628052, 'iou': 0.3378022611141205, 'dice': 0.47231537103652954}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3279220213060794, 'accuracy': 0.8207625119582467, 'precision': 0.6725130091542783, 'recall': 0.693408335291821, 'iou': 0.5661304717478545, 'dice': 0.6723756292591925}
Test   -> {'loss': 0.5030689239501953, 'accuracy': 0.6384320855140686, 'precision': 0.5105695724487305, 'recall': 0.5274166464805603, 'iou': 0.3801714777946472, 'dice': 0.5115257501602173}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3177721889122673, 'accuracy': 0.8281184574832087, 'precision': 0.6807925053264784, 'recall': 0.7048871952554454, 'iou': 0.5768073009408039, 'dice': 0.6818865988565528}
Test   -> {'loss': 0.5253235697746277, 'accuracy': 0.6404951214790344, 'precision': 0.49782776832580566, 'recall': 0.4978591799736023, 'iou': 0.36830008029937744, 'dice': 0.497842013835907}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3097785421039747, 'accuracy': 0.8348908704260122, 'precision': 0.6877438130586043, 'recall': 0.71302446178768, 'iou': 0.58554076941117, 'dice': 0.6898077529409657}
Test   -> {'loss': 0.5062083005905151, 'accuracy': 0.6685367226600647, 'precision': 0.5345468521118164, 'recall': 0.5057576894760132, 'iou': 0.3844897150993347, 'dice': 0.513786792755127}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3009353347446608, 'accuracy': 0.841972990139671, 'precision': 0.694874816355498, 'recall': 0.7226651274639627, 'iou': 0.5955068126968716, 'dice': 0.6983613309652908}
Test   -> {'loss': 0.48539304733276367, 'accuracy': 0.6728655695915222, 'precision': 0.5402441024780273, 'recall': 0.5358307361602783, 'iou': 0.40669411420822144, 'dice': 0.5374919772148132}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.29387246577636056, 'accuracy': 0.8464918509773586, 'precision': 0.7009586365326591, 'recall': 0.7309178145035453, 'iou': 0.602743369081746, 'dice': 0.7050821972929913}
Test   -> {'loss': 0.49176347255706787, 'accuracy': 0.6538699269294739, 'precision': 0.5228687524795532, 'recall': 0.5262305736541748, 'iou': 0.39352044463157654, 'dice': 0.5241737365722656}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.28613899220591005, 'accuracy': 0.852140880667645, 'precision': 0.7070723429970119, 'recall': 0.739103565008744, 'iou': 0.6107737997303838, 'dice': 0.7127409261205923}
Test   -> {'loss': 0.5556488633155823, 'accuracy': 0.6758519411087036, 'precision': 0.5291869640350342, 'recall': 0.473516047000885, 'iou': 0.3613201975822449, 'dice': 0.48367199301719666}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.27970124534938645, 'accuracy': 0.8576651946358059, 'precision': 0.7130006007526232, 'recall': 0.7446010485939357, 'iou': 0.6181054312249888, 'dice': 0.7191253760586614}
Test   -> {'loss': 0.5324708223342896, 'accuracy': 0.6742226481437683, 'precision': 0.5144397020339966, 'recall': 0.48558372259140015, 'iou': 0.3699495196342468, 'dice': 0.4938313961029053}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 7 with IoU 0.40669411420822144
Test -> {'loss': 0.48539304733276367, 'accuracy': 0.6728655695915222, 'precision': 0.5402441024780273, 'recall': 0.5358307361602783, 'iou': 0.40669411420822144, 'dice': 0.5374919772148132} 
Train -> {'loss': 0.3009353347446608, 'accuracy': 0.841972990139671, 'precision': 0.694874816355498, 'recall': 0.7226651274639627, 'iou': 0.5955068126968716, 'dice': 0.6983613309652908} 

Best model saved for model segnet at epoch 10

Trial 6:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4792018530161484, 'accuracy': 0.7201798436434372, 'precision': 0.6402917364369268, 'recall': 0.53101263810759, 'iou': 0.41257949756539386, 'dice': 0.5181498192574667}
Test   -> {'loss': 0.5800392627716064, 'accuracy': 0.5480695366859436, 'precision': 0.44275498390197754, 'recall': 0.45045751333236694, 'iou': 0.30118274688720703, 'dice': 0.4298364818096161}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4447271139725395, 'accuracy': 0.7190692852372709, 'precision': 0.5651110418464826, 'recall': 0.561328999892525, 'iou': 0.4395976720944695, 'dice': 0.5565111779648325}
Test   -> {'loss': 0.5903269052505493, 'accuracy': 0.541475236415863, 'precision': 0.43711957335472107, 'recall': 0.44302091002464294, 'iou': 0.30004557967185974, 'dice': 0.4314403533935547}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4402777964654176, 'accuracy': 0.7231617652851602, 'precision': 0.5696257355420485, 'recall': 0.5660420044608738, 'iou': 0.44410328398580134, 'dice': 0.5608262121677399}
Test   -> {'loss': 0.5372104048728943, 'accuracy': 0.6155320405960083, 'precision': 0.4788611829280853, 'recall': 0.4841439723968506, 'iou': 0.3511753976345062, 'dice': 0.48089513182640076}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4389144145924112, 'accuracy': 0.72369885807452, 'precision': 0.5716939464859341, 'recall': 0.5677241680414781, 'iou': 0.4454210769871007, 'dice': 0.5622042604114699}
Test   -> {'loss': 0.5241677761077881, 'accuracy': 0.6395151615142822, 'precision': 0.49020272493362427, 'recall': 0.5062305927276611, 'iou': 0.3660108745098114, 'dice': 0.49420714378356934}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.43833971490030704, 'accuracy': 0.724768507739772, 'precision': 0.5720448398071787, 'recall': 0.5681000636971515, 'iou': 0.446264044875684, 'dice': 0.5628304642179738}
Test   -> {'loss': 0.5248501300811768, 'accuracy': 0.6242762804031372, 'precision': 0.49920177459716797, 'recall': 0.514581024646759, 'iou': 0.3660050332546234, 'dice': 0.4994083046913147}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.43621143128560935, 'accuracy': 0.7278967841811802, 'precision': 0.5740888935068379, 'recall': 0.570033328688663, 'iou': 0.4485286075135936, 'dice': 0.5648667431395987}
Test   -> {'loss': 0.5257871150970459, 'accuracy': 0.6175487041473389, 'precision': 0.5267714262008667, 'recall': 0.49721068143844604, 'iou': 0.36381101608276367, 'dice': 0.498574823141098}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.43509815698084625, 'accuracy': 0.7271807344063469, 'precision': 0.5754428057566933, 'recall': 0.571998711772587, 'iou': 0.4494640023812004, 'dice': 0.5659899043000263}
Test   -> {'loss': 0.5201029181480408, 'accuracy': 0.6312990784645081, 'precision': 0.5198347568511963, 'recall': 0.4914921224117279, 'iou': 0.3667084872722626, 'dice': 0.4971451163291931}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.4341308479723723, 'accuracy': 0.7281500437985295, 'precision': 0.5765059937601504, 'recall': 0.5729779437832211, 'iou': 0.4504741638898849, 'dice': 0.5669451550297115}
Test   -> {'loss': 0.5850282907485962, 'accuracy': 0.5929552912712097, 'precision': 0.4716148376464844, 'recall': 0.437288761138916, 'iou': 0.31554168462753296, 'dice': 0.43970632553100586}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.4330768121325451, 'accuracy': 0.728975366509479, 'precision': 0.57758334952852, 'recall': 0.5742410566495812, 'iou': 0.45167738613875014, 'dice': 0.5680718429710554}
Test   -> {'loss': 0.5199910402297974, 'accuracy': 0.6235027313232422, 'precision': 0.5146709680557251, 'recall': 0.4934057593345642, 'iou': 0.3625125586986542, 'dice': 0.4967444837093353}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.43432850086170693, 'accuracy': 0.7277222394943237, 'precision': 0.5760955204134403, 'recall': 0.5729831249817557, 'iou': 0.45017396755840466, 'dice': 0.5667588868866796}
Test   -> {'loss': 0.5240390300750732, 'accuracy': 0.6070444583892822, 'precision': 0.48545750975608826, 'recall': 0.491299569606781, 'iou': 0.3506067395210266, 'dice': 0.4867252707481384}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 7 with IoU 0.3667084872722626
Test -> {'loss': 0.5201029181480408, 'accuracy': 0.6312990784645081, 'precision': 0.5198347568511963, 'recall': 0.4914921224117279, 'iou': 0.3667084872722626, 'dice': 0.4971451163291931} 
Train -> {'loss': 0.43509815698084625, 'accuracy': 0.7271807344063469, 'precision': 0.5754428057566933, 'recall': 0.571998711772587, 'iou': 0.4494640023812004, 'dice': 0.5659899043000263} 

Best model saved for model segnet at epoch 10

Trial 7:
Parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5520282776459403, 'accuracy': 0.6803210999654687, 'precision': 0.742586977067201, 'recall': 0.4674314255299776, 'iou': 0.33959931796011716, 'dice': 0.43073498373446256}
Test   -> {'loss': 0.8338817358016968, 'accuracy': 0.3122904300689697, 'precision': 0.4329001307487488, 'recall': 0.34306788444519043, 'iou': 0.10999070107936859, 'dice': 0.17323815822601318}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4610314913417982, 'accuracy': 0.7309801594070766, 'precision': 0.5440979677697887, 'recall': 0.5472157716751098, 'iou': 0.42911374776259714, 'dice': 0.5397504822067593}
Test   -> {'loss': 0.7441010475158691, 'accuracy': 0.3892613649368286, 'precision': 0.41536951065063477, 'recall': 0.3812485635280609, 'iou': 0.17469358444213867, 'dice': 0.2778050899505615}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.45040150621662967, 'accuracy': 0.7188903932986053, 'precision': 0.5578247142874676, 'recall': 0.5568366620851599, 'iou': 0.4352383509926174, 'dice': 0.5515785823697629}
Test   -> {'loss': 0.6746643781661987, 'accuracy': 0.4473313093185425, 'precision': 0.4063578248023987, 'recall': 0.3967226445674896, 'iou': 0.22054040431976318, 'dice': 0.339202344417572}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4451574963072072, 'accuracy': 0.7170995007390562, 'precision': 0.5639089418494183, 'recall': 0.5617630378059719, 'iou': 0.43859641603801564, 'dice': 0.556299724786178}
Test   -> {'loss': 0.6743369102478027, 'accuracy': 0.453730046749115, 'precision': 0.3681366443634033, 'recall': 0.3633781373500824, 'iou': 0.22752688825130463, 'dice': 0.3501283526420593}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.4441408079603444, 'accuracy': 0.7188976070155269, 'precision': 0.5655241038488306, 'recall': 0.5619884408038596, 'iou': 0.439650777630184, 'dice': 0.5571715976880944}
Test   -> {'loss': 0.584843635559082, 'accuracy': 0.5508634448051453, 'precision': 0.43591952323913574, 'recall': 0.43356674909591675, 'iou': 0.3002481460571289, 'dice': 0.43281835317611694}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.44205628996310026, 'accuracy': 0.7201305612273838, 'precision': 0.56691386077715, 'recall': 0.565152134584344, 'iou': 0.44185472208520643, 'dice': 0.5593939340632895}
Test   -> {'loss': 0.6258419752120972, 'accuracy': 0.5278578400611877, 'precision': 0.4071204364299774, 'recall': 0.41031724214553833, 'iou': 0.27274465560913086, 'dice': 0.39704394340515137}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.4431100368499756, 'accuracy': 0.7187911536382592, 'precision': 0.5656771996746892, 'recall': 0.5641110440959101, 'iou': 0.4405351540316706, 'dice': 0.5582629976065262}
Test   -> {'loss': 0.7182245254516602, 'accuracy': 0.39237040281295776, 'precision': 0.40591365098953247, 'recall': 0.38273605704307556, 'iou': 0.18603627383708954, 'dice': 0.2962495982646942}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.4417275641275489, 'accuracy': 0.7205511538878732, 'precision': 0.567866587638855, 'recall': 0.5651011472162993, 'iou': 0.4419143894444341, 'dice': 0.5595514390779578}
Test   -> {'loss': 0.5573654770851135, 'accuracy': 0.5893202424049377, 'precision': 0.4654015302658081, 'recall': 0.4762052893638611, 'iou': 0.32942700386047363, 'dice': 0.46000921726226807}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.445331044819044, 'accuracy': 0.7181896981985673, 'precision': 0.5632454177607661, 'recall': 0.5611238894255265, 'iou': 0.43876134338586226, 'dice': 0.556132263722627}
Test   -> {'loss': 0.4990335702896118, 'accuracy': 0.6527809500694275, 'precision': 0.5298299789428711, 'recall': 0.5096536874771118, 'iou': 0.38454246520996094, 'dice': 0.5158044695854187}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.43995484891145126, 'accuracy': 0.7228104316669962, 'precision': 0.5696287217347519, 'recall': 0.5668448551841404, 'iou': 0.4442406441854394, 'dice': 0.5613843311434207}
Test   -> {'loss': 0.5422374606132507, 'accuracy': 0.6142522096633911, 'precision': 0.5170072913169861, 'recall': 0.4657667577266693, 'iou': 0.3397265076637268, 'dice': 0.4659860134124756}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 9 with IoU 0.38454246520996094
Test -> {'loss': 0.4990335702896118, 'accuracy': 0.6527809500694275, 'precision': 0.5298299789428711, 'recall': 0.5096536874771118, 'iou': 0.38454246520996094, 'dice': 0.5158044695854187} 
Train -> {'loss': 0.445331044819044, 'accuracy': 0.7181896981985673, 'precision': 0.5632454177607661, 'recall': 0.5611238894255265, 'iou': 0.43876134338586226, 'dice': 0.556132263722627} 

Best model saved for model segnet at epoch 10

Trial 8:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4831068243669427, 'accuracy': 0.7971273303031922, 'precision': 0.7347666898499364, 'recall': 0.6885060819594756, 'iou': 0.5653617783733036, 'dice': 0.703577567960905}
Test   -> {'loss': 1.2865285873413086, 'accuracy': 0.6286633610725403, 'precision': 0.5644432306289673, 'recall': 0.43422219157218933, 'iou': 0.29847970604896545, 'dice': 0.39668628573417664}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.41206895955230877, 'accuracy': 0.8252014517784119, 'precision': 0.7692242370999378, 'recall': 0.7392164865265722, 'iou': 0.6172048939310986, 'dice': 0.7512908987377}
Test   -> {'loss': 1.4175033569335938, 'accuracy': 0.5384907722473145, 'precision': 0.5302995443344116, 'recall': 0.45827716588974, 'iou': 0.2987087368965149, 'dice': 0.42083001136779785}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.37951935529708863, 'accuracy': 0.8390787834706513, 'precision': 0.7883419581081557, 'recall': 0.7602687675019969, 'iou': 0.6418209524258324, 'dice': 0.771667812699857}
Test   -> {'loss': 1.1156935691833496, 'accuracy': 0.5701941251754761, 'precision': 0.5600064992904663, 'recall': 0.5142905116081238, 'iou': 0.34126073122024536, 'dice': 0.48144492506980896}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3547091245651245, 'accuracy': 0.8488853589348171, 'precision': 0.8007752973100414, 'recall': 0.7770498109900433, 'iou': 0.6607491158920785, 'dice': 0.7867324284885241}
Test   -> {'loss': 0.9871538281440735, 'accuracy': 0.6370862126350403, 'precision': 0.6066536903381348, 'recall': 0.5324086546897888, 'iou': 0.3834149241447449, 'dice': 0.5159282684326172}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3339782384426697, 'accuracy': 0.8570217855598615, 'precision': 0.8113624199577, 'recall': 0.788330147318218, 'iou': 0.6749180477598439, 'dice': 0.7976259739502617}
Test   -> {'loss': 1.4568339586257935, 'accuracy': 0.5723777413368225, 'precision': 0.5578311681747437, 'recall': 0.4786287248134613, 'iou': 0.32380154728889465, 'dice': 0.44926947355270386}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.31858401317959245, 'accuracy': 0.8641554811726446, 'precision': 0.8203551486782406, 'recall': 0.8011861541996832, 'iou': 0.6893961489200592, 'dice': 0.8087348917256231}
Test   -> {'loss': 1.2982691526412964, 'accuracy': 0.6341179013252258, 'precision': 0.613275945186615, 'recall': 0.5260583162307739, 'iou': 0.3732576370239258, 'dice': 0.504454493522644}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2914378603515418, 'accuracy': 0.8750316523987314, 'precision': 0.8345486526903899, 'recall': 0.8174832525460617, 'iou': 0.7102680055991463, 'dice': 0.8241777199765911}
Test   -> {'loss': 1.6163257360458374, 'accuracy': 0.5859275460243225, 'precision': 0.5775972604751587, 'recall': 0.481597900390625, 'iou': 0.32496994733810425, 'dice': 0.4515717029571533}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.27429989634648616, 'accuracy': 0.8829651918100274, 'precision': 0.8437078869861105, 'recall': 0.8289722287136575, 'iou': 0.7252441333687824, 'dice': 0.8349774508372597}
Test   -> {'loss': 1.9582310914993286, 'accuracy': 0.5460952520370483, 'precision': 0.5916904807090759, 'recall': 0.48890185356140137, 'iou': 0.3148654103279114, 'dice': 0.44400376081466675}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.25651027534319004, 'accuracy': 0.8897491141505863, 'precision': 0.8526482504347096, 'recall': 0.8402143605377363, 'iou': 0.7393410503864288, 'dice': 0.8451416857864545}
Test   -> {'loss': 1.8651719093322754, 'accuracy': 0.5853184461593628, 'precision': 0.5952953696250916, 'recall': 0.5048025846481323, 'iou': 0.3384578824043274, 'dice': 0.4722587764263153}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.2300894426262897, 'accuracy': 0.9010495696378791, 'precision': 0.867126385802808, 'recall': 0.8571838031644406, 'iou': 0.7622398817020913, 'dice': 0.8609231313933496}
Test   -> {'loss': 2.0914466381073, 'accuracy': 0.624605119228363, 'precision': 0.5620187520980835, 'recall': 0.4715768098831177, 'iou': 0.3316054344177246, 'dice': 0.4505075216293335}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 4 with IoU 0.3834149241447449
Test -> {'loss': 0.9871538281440735, 'accuracy': 0.6370862126350403, 'precision': 0.6066536903381348, 'recall': 0.5324086546897888, 'iou': 0.3834149241447449, 'dice': 0.5159282684326172} 
Train -> {'loss': 0.3547091245651245, 'accuracy': 0.8488853589348171, 'precision': 0.8007752973100414, 'recall': 0.7770498109900433, 'iou': 0.6607491158920785, 'dice': 0.7867324284885241} 

Best model saved for model segnet at epoch 10

Trial 9:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5547682681809301, 'accuracy': 0.7714459836483002, 'precision': 0.7094749440317568, 'recall': 0.6515480943348096, 'iou': 0.5277074149121409, 'dice': 0.6613921134368234}
Test   -> {'loss': 1.381492257118225, 'accuracy': 0.5703554749488831, 'precision': 0.5452792048454285, 'recall': 0.4806191325187683, 'iou': 0.3270804286003113, 'dice': 0.45640134811401367}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.38930419139240097, 'accuracy': 0.8354564863702525, 'precision': 0.7819726042125537, 'recall': 0.7547243921653084, 'iou': 0.6347384468368862, 'dice': 0.7663908937703008}
Test   -> {'loss': 1.6990829706192017, 'accuracy': 0.5951830744743347, 'precision': 0.5571365356445312, 'recall': 0.4436652362346649, 'iou': 0.3058644235134125, 'dice': 0.423076331615448}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3434949151847673, 'accuracy': 0.8546696745831034, 'precision': 0.8070562616638516, 'recall': 0.7836335923360742, 'iou': 0.6692982668462006, 'dice': 0.7937241543894229}
Test   -> {'loss': 1.320114254951477, 'accuracy': 0.5188087821006775, 'precision': 0.5584180355072021, 'recall': 0.5000073313713074, 'iou': 0.31352150440216064, 'dice': 0.45398062467575073}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3136285214320473, 'accuracy': 0.8663798508436783, 'precision': 0.8215018153190613, 'recall': 0.803322670770728, 'iou': 0.6918372828027476, 'dice': 0.8108620436295219}
Test   -> {'loss': 1.4752815961837769, 'accuracy': 0.5927671790122986, 'precision': 0.5721623301506042, 'recall': 0.508485734462738, 'iou': 0.34758374094963074, 'dice': 0.48374828696250916}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.28391530746998994, 'accuracy': 0.8783441647239353, 'precision': 0.8368053239324819, 'recall': 0.8197305223216181, 'iou': 0.7137331268061762, 'dice': 0.826928596911223}
Test   -> {'loss': 1.9831160306930542, 'accuracy': 0.6098806858062744, 'precision': 0.5636485815048218, 'recall': 0.4325084686279297, 'iou': 0.29899346828460693, 'dice': 0.4051583707332611}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2608046054840088, 'accuracy': 0.8883027486179186, 'precision': 0.8496565119079922, 'recall': 0.8360142225804537, 'iou': 0.7344826190367989, 'dice': 0.8418306086374365}
Test   -> {'loss': 1.624974250793457, 'accuracy': 0.6197795867919922, 'precision': 0.5702834129333496, 'recall': 0.4900602698326111, 'iou': 0.3481784760951996, 'dice': 0.4770587384700775}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2349984700265138, 'accuracy': 0.8996003114658854, 'precision': 0.8638207477072011, 'recall': 0.853898050474084, 'iou': 0.7576285642126332, 'dice': 0.8579987572587054}
Test   -> {'loss': 1.9932535886764526, 'accuracy': 0.6229954957962036, 'precision': 0.5702587962150574, 'recall': 0.4624554514884949, 'iou': 0.3216167986392975, 'dice': 0.43715667724609375}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2124315417331198, 'accuracy': 0.9086604486341062, 'precision': 0.8770190892012223, 'recall': 0.8659344144489454, 'iou': 0.7763205118801283, 'dice': 0.8706057076868804}
Test   -> {'loss': 1.7369040250778198, 'accuracy': 0.6103998422622681, 'precision': 0.6007765531539917, 'recall': 0.5256351828575134, 'iou': 0.36880654096603394, 'dice': 0.5034774541854858}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1966445179089256, 'accuracy': 0.9157871085664501, 'precision': 0.8854702970255977, 'recall': 0.8769259131473044, 'iou': 0.7915296658225681, 'dice': 0.8806714716164962}
Test   -> {'loss': 3.4850575923919678, 'accuracy': 0.5704165101051331, 'precision': 0.5576146245002747, 'recall': 0.36601221561431885, 'iou': 0.22991198301315308, 'dice': 0.3089401423931122}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.1825745077236839, 'accuracy': 0.922090886986774, 'precision': 0.8929045988165814, 'recall': 0.886614101347716, 'iou': 0.8048250405684761, 'dice': 0.8892978709676992}
Test   -> {'loss': 3.290015697479248, 'accuracy': 0.5597447156906128, 'precision': 0.49252814054489136, 'recall': 0.38812050223350525, 'iou': 0.2513794004917145, 'dice': 0.34863221645355225}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 8 with IoU 0.36880654096603394
Test -> {'loss': 1.7369040250778198, 'accuracy': 0.6103998422622681, 'precision': 0.6007765531539917, 'recall': 0.5256351828575134, 'iou': 0.36880654096603394, 'dice': 0.5034774541854858} 
Train -> {'loss': 0.2124315417331198, 'accuracy': 0.9086604486341062, 'precision': 0.8770190892012223, 'recall': 0.8659344144489454, 'iou': 0.7763205118801283, 'dice': 0.8706057076868804} 

Best model saved for model segnet at epoch 10

Trial 10:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.834755660139996, 'accuracy': 0.6524177454088045, 'precision': 0.6821919288324273, 'recall': 0.37192204452079275, 'iou': 0.25007338679355123, 'dice': 0.31099038525767947}
Test   -> {'loss': 1.3936405181884766, 'accuracy': 0.45871034264564514, 'precision': 0.6046379804611206, 'recall': 0.4046926498413086, 'iou': 0.22282180190086365, 'dice': 0.31126731634140015}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.644849006248557, 'accuracy': 0.7097288740717846, 'precision': 0.6703751071639683, 'recall': 0.4929947518784067, 'iou': 0.36792486530283225, 'dice': 0.4676515844853028}
Test   -> {'loss': 1.8642923831939697, 'accuracy': 0.5905138850212097, 'precision': 0.42508286237716675, 'recall': 0.4043459892272949, 'iou': 0.28649255633354187, 'dice': 0.4019860029220581}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6100275267725406, 'accuracy': 0.7288201990334884, 'precision': 0.6204934972783793, 'recall': 0.578162118015082, 'iou': 0.4482883335455604, 'dice': 0.5884537006201951}
Test   -> {'loss': 3.209531545639038, 'accuracy': 0.6000229120254517, 'precision': 0.4766020178794861, 'recall': 0.3632112741470337, 'iou': 0.24333623051643372, 'dice': 0.3277016282081604}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6005347118429516, 'accuracy': 0.7336959735206936, 'precision': 0.6305712668792062, 'recall': 0.585171305226243, 'iou': 0.4576207580773727, 'dice': 0.5993709121061408}
Test   -> {'loss': 4.280738353729248, 'accuracy': 0.5596824288368225, 'precision': 0.4054863452911377, 'recall': 0.3490469455718994, 'iou': 0.21633535623550415, 'dice': 0.29524603486061096}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5922208957050158, 'accuracy': 0.7367019881372866, 'precision': 0.6375018417835235, 'recall': 0.5894354986107868, 'iou': 0.46269026748512104, 'dice': 0.6051249701043834}
Test   -> {'loss': 6.535420894622803, 'accuracy': 0.6293073296546936, 'precision': 0.5035907030105591, 'recall': 0.3535653352737427, 'iou': 0.23469004034996033, 'dice': 0.3050972819328308}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5903372396593508, 'accuracy': 0.7372772957967675, 'precision': 0.6383729776610498, 'recall': 0.5899497029574021, 'iou': 0.4637734590665154, 'dice': 0.6065608511800351}
Test   -> {'loss': 374.09649658203125, 'accuracy': 0.5701480507850647, 'precision': 0.5298763513565063, 'recall': 0.3570142388343811, 'iou': 0.21962007880210876, 'dice': 0.2981019914150238}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.583899258012357, 'accuracy': 0.7407992943473484, 'precision': 0.6451032151346622, 'recall': 0.5961370418901029, 'iou': 0.46966782095639603, 'dice': 0.6129220350928929}
Test   -> {'loss': 16.26970672607422, 'accuracy': 0.5206149220466614, 'precision': 0.47057807445526123, 'recall': 0.3366127908229828, 'iou': 0.1783418506383896, 'dice': 0.23670326173305511}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5772445229084595, 'accuracy': 0.743598610162735, 'precision': 0.6500327957713086, 'recall': 0.6006166911643485, 'iou': 0.474434056100638, 'dice': 0.6177058613818625}
Test   -> {'loss': 2.7936344146728516, 'accuracy': 0.6023721098899841, 'precision': 0.5645712018013, 'recall': 0.412347674369812, 'iou': 0.27594369649887085, 'dice': 0.37122678756713867}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5658774798331053, 'accuracy': 0.7493736557338548, 'precision': 0.6600683481796928, 'recall': 0.6121956866720448, 'iou': 0.4850269118080968, 'dice': 0.6288625113342119}
Test   -> {'loss': 1.4458861351013184, 'accuracy': 0.6076223850250244, 'precision': 0.5865086317062378, 'recall': 0.3927704691886902, 'iou': 0.2648311257362366, 'dice': 0.3507555425167084}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5404302576313849, 'accuracy': 0.7612311295841051, 'precision': 0.6776888106180274, 'recall': 0.6317011649193971, 'iou': 0.5045513392790504, 'dice': 0.6484523029431053}
Test   -> {'loss': 12.188591957092285, 'accuracy': 0.5479599237442017, 'precision': 0.5204945802688599, 'recall': 0.37577924132347107, 'iou': 0.23946061730384827, 'dice': 0.330392986536026}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 2 with IoU 0.28649255633354187
Test -> {'loss': 1.8642923831939697, 'accuracy': 0.5905138850212097, 'precision': 0.42508286237716675, 'recall': 0.4043459892272949, 'iou': 0.28649255633354187, 'dice': 0.4019860029220581} 
Train -> {'loss': 0.644849006248557, 'accuracy': 0.7097288740717846, 'precision': 0.6703751071639683, 'recall': 0.4929947518784067, 'iou': 0.36792486530283225, 'dice': 0.4676515844853028} 

Best model saved for model segnet at epoch 10

Trial 11:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.8881623356238656, 'accuracy': 0.6356376798256583, 'precision': 0.6493579688279525, 'recall': 0.3364111164341802, 'iou': 0.21748178406901983, 'dice': 0.2686936168566994}
Test   -> {'loss': 1.0326498746871948, 'accuracy': 0.5856176614761353, 'precision': 0.5858713984489441, 'recall': 0.33963626623153687, 'iou': 0.2063848078250885, 'dice': 0.26583564281463623}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.7016125746395276, 'accuracy': 0.6820183541463769, 'precision': 0.6878909468650818, 'recall': 0.4206511033617932, 'iou': 0.29932010951249494, 'dice': 0.3724301675091619}
Test   -> {'loss': 1.4197356700897217, 'accuracy': 0.5329530835151672, 'precision': 0.5825293064117432, 'recall': 0.37669751048088074, 'iou': 0.2234431356191635, 'dice': 0.2987138628959656}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.6410551776056704, 'accuracy': 0.7127081990242005, 'precision': 0.7358421107997065, 'recall': 0.47827650464099386, 'iou': 0.3582617282867432, 'dice': 0.44922446582628334}
Test   -> {'loss': 7.128437042236328, 'accuracy': 0.5726448893547058, 'precision': 0.4179135262966156, 'recall': 0.3335626721382141, 'iou': 0.19824251532554626, 'dice': 0.2556365132331848}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6080340929653334, 'accuracy': 0.7279275241105453, 'precision': 0.6221611904061359, 'recall': 0.5712255234303681, 'iou': 0.43686093273370163, 'dice': 0.5697855384453483}
Test   -> {'loss': 1.4639909267425537, 'accuracy': 0.5880849361419678, 'precision': 0.46777623891830444, 'recall': 0.4036019742488861, 'iou': 0.2823123335838318, 'dice': 0.39371275901794434}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.5930967766305675, 'accuracy': 0.7363964531732642, 'precision': 0.6341444782588793, 'recall': 0.5920060670894125, 'iou': 0.4622217769208162, 'dice': 0.6046925451444543}
Test   -> {'loss': 1.2178397178649902, 'accuracy': 0.6176325082778931, 'precision': 0.5363576412200928, 'recall': 0.4177987575531006, 'iou': 0.2932599186897278, 'dice': 0.3961157500743866}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.5909743599269701, 'accuracy': 0.7373368133669315, 'precision': 0.6365111719007077, 'recall': 0.5931288864301598, 'iou': 0.4631924188655356, 'dice': 0.6056591339733289}
Test   -> {'loss': 1.1176667213439941, 'accuracy': 0.6304022073745728, 'precision': 0.5159797072410583, 'recall': 0.4475947618484497, 'iou': 0.3292211890220642, 'dice': 0.4511392116546631}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.5862942462382109, 'accuracy': 0.7381357680196348, 'precision': 0.6375790865524955, 'recall': 0.5949099779129028, 'iou': 0.46553453880807627, 'dice': 0.6086669792299685}
Test   -> {'loss': 2.2447350025177, 'accuracy': 0.5343546867370605, 'precision': 0.5238338708877563, 'recall': 0.3500199019908905, 'iou': 0.20319359004497528, 'dice': 0.2752421200275421}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5786175572353861, 'accuracy': 0.7423518170481143, 'precision': 0.645293488709823, 'recall': 0.6035019983416018, 'iou': 0.4727487242740134, 'dice': 0.6159253358840943}
Test   -> {'loss': 2.091599941253662, 'accuracy': 0.5442202687263489, 'precision': 0.513490617275238, 'recall': 0.40971192717552185, 'iou': 0.27348947525024414, 'dice': 0.3895227611064911}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.562160395021024, 'accuracy': 0.7506427770075591, 'precision': 0.6588359817214634, 'recall': 0.6140411905620409, 'iou': 0.48557201442511183, 'dice': 0.6295143853063169}
Test   -> {'loss': 1.6819887161254883, 'accuracy': 0.6267061829566956, 'precision': 0.4753471612930298, 'recall': 0.39213132858276367, 'iou': 0.27926623821258545, 'dice': 0.37847790122032166}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.5518838509269383, 'accuracy': 0.7559731607851775, 'precision': 0.6697199054386305, 'recall': 0.6211665194967518, 'iou': 0.49336904857469643, 'dice': 0.6374814997548642}
Test   -> {'loss': 1.5418956279754639, 'accuracy': 0.578274130821228, 'precision': 0.5162546634674072, 'recall': 0.3899308443069458, 'iou': 0.2624771296977997, 'dice': 0.35775062441825867}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 6 with IoU 0.3292211890220642
Test -> {'loss': 1.1176667213439941, 'accuracy': 0.6304022073745728, 'precision': 0.5159797072410583, 'recall': 0.4475947618484497, 'iou': 0.3292211890220642, 'dice': 0.4511392116546631} 
Train -> {'loss': 0.5909743599269701, 'accuracy': 0.7373368133669315, 'precision': 0.6365111719007077, 'recall': 0.5931288864301598, 'iou': 0.4631924188655356, 'dice': 0.6056591339733289} 

Best model saved for model segnet at epoch 10

Trial 12:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.28999987555586776, 'accuracy': 0.7891546588876973, 'precision': 0.7164138558118239, 'recall': 0.7162826499213343, 'iou': 0.5734685186134733, 'dice': 0.7134968964949898}
Test   -> {'loss': 0.4826127290725708, 'accuracy': 0.5897627472877502, 'precision': 0.5780830383300781, 'recall': 0.5527135729789734, 'iou': 0.3814043402671814, 'dice': 0.5287176370620728}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.24257332760354747, 'accuracy': 0.8218018876469654, 'precision': 0.759715021174887, 'recall': 0.7564727233803791, 'iou': 0.6225004465683647, 'dice': 0.7568389874437581}
Test   -> {'loss': 0.5582292675971985, 'accuracy': 0.5404949188232422, 'precision': 0.5349954962730408, 'recall': 0.4679136276245117, 'iou': 0.30973517894744873, 'dice': 0.43798965215682983}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.22730693972629049, 'accuracy': 0.8329152858775595, 'precision': 0.7754989237889, 'recall': 0.7697533615257429, 'iou': 0.6407766482104426, 'dice': 0.7715414905029795}
Test   -> {'loss': 0.5249209403991699, 'accuracy': 0.5744205117225647, 'precision': 0.5865991115570068, 'recall': 0.5100373029708862, 'iou': 0.3331354260444641, 'dice': 0.4671263098716736}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2159881195296412, 'accuracy': 0.840944119380868, 'precision': 0.7861422090426735, 'recall': 0.7813020654346632, 'iou': 0.6548295065112736, 'dice': 0.7825450871301733}
Test   -> {'loss': 0.5208008885383606, 'accuracy': 0.5786917209625244, 'precision': 0.5690856575965881, 'recall': 0.5415156483650208, 'iou': 0.3605022430419922, 'dice': 0.49946901202201843}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.20387590864430302, 'accuracy': 0.8495546491249748, 'precision': 0.7988371714301731, 'recall': 0.7923679312934047, 'iou': 0.6699819686620132, 'dice': 0.7944780072440272}
Test   -> {'loss': 0.5432791709899902, 'accuracy': 0.5777475833892822, 'precision': 0.5728957653045654, 'recall': 0.4840570390224457, 'iou': 0.32519668340682983, 'dice': 0.4541946351528168}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.198397384778313, 'accuracy': 0.8535454405390698, 'precision': 0.803775039444799, 'recall': 0.7978262002053468, 'iou': 0.6770578202993973, 'dice': 0.799807055618452}
Test   -> {'loss': 0.5720866322517395, 'accuracy': 0.6064664721488953, 'precision': 0.555890679359436, 'recall': 0.4366714358329773, 'iou': 0.30386561155319214, 'dice': 0.4178745746612549}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.18708940381589143, 'accuracy': 0.8617756226788397, 'precision': 0.8148352016573367, 'recall': 0.8096225264279738, 'iou': 0.6922484509322955, 'dice': 0.8113228492114855}
Test   -> {'loss': 0.5528021454811096, 'accuracy': 0.5778995156288147, 'precision': 0.5497211813926697, 'recall': 0.48496145009994507, 'iou': 0.32936471700668335, 'dice': 0.4627036452293396}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.1821843481582144, 'accuracy': 0.8651035790858062, 'precision': 0.819174239428147, 'recall': 0.8145850707655368, 'iou': 0.6986830063488172, 'dice': 0.815946221092473}
Test   -> {'loss': 0.5449920892715454, 'accuracy': 0.5971841216087341, 'precision': 0.5415195822715759, 'recall': 0.4921278655529022, 'iou': 0.3384857177734375, 'dice': 0.46816563606262207}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.17207105470740278, 'accuracy': 0.8725888283356377, 'precision': 0.8293955038423123, 'recall': 0.8248131098954574, 'iou': 0.7127326265625332, 'dice': 0.8262504274430482}
Test   -> {'loss': 0.5648312568664551, 'accuracy': 0.6109992861747742, 'precision': 0.5598090887069702, 'recall': 0.4578176438808441, 'iou': 0.32177799940109253, 'dice': 0.4427776336669922}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.1614497475002123, 'accuracy': 0.8803770930870719, 'precision': 0.8404411953428518, 'recall': 0.8343637266884679, 'iou': 0.7270408886930216, 'dice': 0.8365741087042767}
Test   -> {'loss': 0.5570282936096191, 'accuracy': 0.5620179176330566, 'precision': 0.5698292255401611, 'recall': 0.4759649932384491, 'iou': 0.3145022988319397, 'dice': 0.44151052832603455}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 1 with IoU 0.3814043402671814
Test -> {'loss': 0.4826127290725708, 'accuracy': 0.5897627472877502, 'precision': 0.5780830383300781, 'recall': 0.5527135729789734, 'iou': 0.3814043402671814, 'dice': 0.5287176370620728} 
Train -> {'loss': 0.28999987555586776, 'accuracy': 0.7891546588876973, 'precision': 0.7164138558118239, 'recall': 0.7162826499213343, 'iou': 0.5734685186134733, 'dice': 0.7134968964949898} 

Best model saved for model segnet at epoch 10

Trial 13:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.3016815159631812, 'accuracy': 0.7871637074843697, 'precision': 0.7122976147610208, 'recall': 0.7103078785149948, 'iou': 0.5711153870043547, 'dice': 0.7061976894088413}
Test   -> {'loss': 0.604800820350647, 'accuracy': 0.6082209348678589, 'precision': 0.5531470775604248, 'recall': 0.43258899450302124, 'iou': 0.3026551902294159, 'dice': 0.4172184467315674}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.22413380301516989, 'accuracy': 0.83568419891855, 'precision': 0.7772523361703624, 'recall': 0.7740371901056041, 'iou': 0.6447476511416228, 'dice': 0.7751969508502794}
Test   -> {'loss': 0.5910363793373108, 'accuracy': 0.5619840025901794, 'precision': 0.5320132374763489, 'recall': 0.4508431553840637, 'iou': 0.30193448066711426, 'dice': 0.4246044158935547}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.19949665743371714, 'accuracy': 0.8536384395931078, 'precision': 0.8003036727075992, 'recall': 0.798532265683879, 'iou': 0.6754897070967633, 'dice': 0.7990667804427769}
Test   -> {'loss': 0.5509549379348755, 'accuracy': 0.58708655834198, 'precision': 0.5220934748649597, 'recall': 0.4654695987701416, 'iou': 0.3268647789955139, 'dice': 0.45704707503318787}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.18532593405765035, 'accuracy': 0.8638077036194179, 'precision': 0.814952508262966, 'recall': 0.8121982491534689, 'iou': 0.6941181053286013, 'dice': 0.8130484948987546}
Test   -> {'loss': 0.6263985633850098, 'accuracy': 0.5972155928611755, 'precision': 0.5569872260093689, 'recall': 0.42171987891197205, 'iou': 0.2869676947593689, 'dice': 0.39586716890335083}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.17939297893772954, 'accuracy': 0.8678199726602306, 'precision': 0.8209690404974896, 'recall': 0.817856994919155, 'iou': 0.7021029550096263, 'dice': 0.8189871788024903}
Test   -> {'loss': 0.6787466406822205, 'accuracy': 0.6099560856819153, 'precision': 0.5434077382087708, 'recall': 0.3806445598602295, 'iou': 0.25501084327697754, 'dice': 0.34185367822647095}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.16393458013949186, 'accuracy': 0.87849535682927, 'precision': 0.8354334401047748, 'recall': 0.8333479456279589, 'iou': 0.7229424694310064, 'dice': 0.8341100050055462}
Test   -> {'loss': 0.5397663116455078, 'accuracy': 0.6144717335700989, 'precision': 0.570776104927063, 'recall': 0.4754103124141693, 'iou': 0.33788633346557617, 'dice': 0.4648857116699219}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.1613940601763518, 'accuracy': 0.8806680290595345, 'precision': 0.8388437685759171, 'recall': 0.8360541411068129, 'iou': 0.7270727100579635, 'dice': 0.8370603053466134}
Test   -> {'loss': 0.6931988000869751, 'accuracy': 0.6019268035888672, 'precision': 0.5252095460891724, 'recall': 0.3692823350429535, 'iou': 0.24396070837974548, 'dice': 0.32780301570892334}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.14234839833301047, 'accuracy': 0.8948169475016386, 'precision': 0.8575749583866286, 'recall': 0.8549290667409483, 'iou': 0.7542358626490054, 'dice': 0.8559264939764272}
Test   -> {'loss': 0.5676487684249878, 'accuracy': 0.5994608402252197, 'precision': 0.579809844493866, 'recall': 0.46175116300582886, 'iou': 0.32113921642303467, 'dice': 0.44171521067619324}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.1301128828007242, 'accuracy': 0.9038220364114512, 'precision': 0.8704655175623687, 'recall': 0.8671121488446775, 'iou': 0.7727272785228232, 'dice': 0.8684287713921588}
Test   -> {'loss': 0.5840331315994263, 'accuracy': 0.5816783905029297, 'precision': 0.5520405769348145, 'recall': 0.44584497809410095, 'iou': 0.30712515115737915, 'dice': 0.4296426773071289}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.12204432228337163, 'accuracy': 0.9100276112556458, 'precision': 0.8782580028409543, 'recall': 0.8757394179053929, 'iou': 0.7850239168042722, 'dice': 0.8766171636788741}
Test   -> {'loss': 0.5909823179244995, 'accuracy': 0.6255885362625122, 'precision': 0.5555227994918823, 'recall': 0.4355260729789734, 'iou': 0.3071962893009186, 'dice': 0.41928189992904663}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 6 with IoU 0.33788633346557617
Test -> {'loss': 0.5397663116455078, 'accuracy': 0.6144717335700989, 'precision': 0.570776104927063, 'recall': 0.4754103124141693, 'iou': 0.33788633346557617, 'dice': 0.4648857116699219} 
Train -> {'loss': 0.16393458013949186, 'accuracy': 0.87849535682927, 'precision': 0.8354334401047748, 'recall': 0.8333479456279589, 'iou': 0.7229424694310064, 'dice': 0.8341100050055462} 

Best model saved for model segnet at epoch 10

Trial 14:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4930685678254003, 'accuracy': 0.662754044390243, 'precision': 0.6022586387136708, 'recall': 0.5278192731349365, 'iou': 0.37105294948686723, 'dice': 0.49240695892468744}
Test   -> {'loss': 0.6530787944793701, 'accuracy': 0.45901426672935486, 'precision': 0.5277810096740723, 'recall': 0.42125368118286133, 'iou': 0.24438779056072235, 'dice': 0.34525105357170105}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3896670852018439, 'accuracy': 0.7116729959197666, 'precision': 0.6087114318557407, 'recall': 0.623515707772711, 'iou': 0.46566273725551105, 'dice': 0.6140025685662809}
Test   -> {'loss': 0.5311722755432129, 'accuracy': 0.5867060422897339, 'precision': 0.5885857343673706, 'recall': 0.5036935806274414, 'iou': 0.344430536031723, 'dice': 0.47447144985198975}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3829207928284355, 'accuracy': 0.7176512158435324, 'precision': 0.6192432660123576, 'recall': 0.624046314280966, 'iou': 0.4719344985225926, 'dice': 0.6203050178030263}
Test   -> {'loss': 0.6026426553726196, 'accuracy': 0.5595553517341614, 'precision': 0.5790379047393799, 'recall': 0.4462134838104248, 'iou': 0.28315719962120056, 'dice': 0.3932320773601532}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.38139937545942226, 'accuracy': 0.7184902087501858, 'precision': 0.6200878713441932, 'recall': 0.6257521707078685, 'iou': 0.47319999103960786, 'dice': 0.6215422855771107}
Test   -> {'loss': 0.5717899799346924, 'accuracy': 0.5539812445640564, 'precision': 0.5426068305969238, 'recall': 0.44764813780784607, 'iou': 0.29927974939346313, 'dice': 0.41917675733566284}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3772124438182167, 'accuracy': 0.722102796772252, 'precision': 0.6245832142622575, 'recall': 0.6290405589601268, 'iou': 0.4771081477403641, 'dice': 0.6254754392997078}
Test   -> {'loss': 0.627164900302887, 'accuracy': 0.5968714952468872, 'precision': 0.545041024684906, 'recall': 0.4192022681236267, 'iou': 0.2851684093475342, 'dice': 0.3899611830711365}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3734196927236474, 'accuracy': 0.7238997697830201, 'precision': 0.627865548496661, 'recall': 0.6340882980305216, 'iou': 0.4808385509511699, 'dice': 0.6293822628000508}
Test   -> {'loss': 0.5312556028366089, 'accuracy': 0.6131604313850403, 'precision': 0.5885190963745117, 'recall': 0.4875451922416687, 'iou': 0.3444879949092865, 'dice': 0.4656182527542114}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3674330141233361, 'accuracy': 0.7283354323843251, 'precision': 0.6337829071542491, 'recall': 0.6399611670037975, 'iou': 0.486908597531526, 'dice': 0.6353383364884749}
Test   -> {'loss': 0.4886631965637207, 'accuracy': 0.6081978678703308, 'precision': 0.5649228692054749, 'recall': 0.5203549265861511, 'iou': 0.3733350932598114, 'dice': 0.5130731463432312}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.36126586743023087, 'accuracy': 0.7325121496034706, 'precision': 0.6401635999264924, 'recall': 0.6458731542462888, 'iou': 0.4930399324582971, 'dice': 0.6414736198342365}
Test   -> {'loss': 0.485107958316803, 'accuracy': 0.6263390183448792, 'precision': 0.6036828756332397, 'recall': 0.5436745882034302, 'iou': 0.3765808045864105, 'dice': 0.514028787612915}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.35356694848641107, 'accuracy': 0.7387438616027002, 'precision': 0.6487707104371941, 'recall': 0.6538276602392611, 'iou': 0.5016499673542769, 'dice': 0.6497938620007556}
Test   -> {'loss': 0.508164644241333, 'accuracy': 0.5965800285339355, 'precision': 0.5968245267868042, 'recall': 0.5150138139724731, 'iou': 0.3579179644584656, 'dice': 0.4950253963470459}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.34141012378360913, 'accuracy': 0.7476847482764203, 'precision': 0.6603329160939092, 'recall': 0.6640103394570558, 'iou': 0.5130673330763112, 'dice': 0.6607766843360403}
Test   -> {'loss': 0.4940361976623535, 'accuracy': 0.6551152467727661, 'precision': 0.6405225992202759, 'recall': 0.5261052846908569, 'iou': 0.37148723006248474, 'dice': 0.5003137588500977}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 8 with IoU 0.3765808045864105
Test -> {'loss': 0.485107958316803, 'accuracy': 0.6263390183448792, 'precision': 0.6036828756332397, 'recall': 0.5436745882034302, 'iou': 0.3765808045864105, 'dice': 0.514028787612915} 
Train -> {'loss': 0.36126586743023087, 'accuracy': 0.7325121496034706, 'precision': 0.6401635999264924, 'recall': 0.6458731542462888, 'iou': 0.4930399324582971, 'dice': 0.6414736198342365} 

Best model saved for model segnet at epoch 10

Trial 15:
Parameters: {'thresholds': (0.3, 0.7), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5672346861466118, 'accuracy': 0.6230142691861028, 'precision': 0.6123401978741522, 'recall': 0.4450489116751629, 'iou': 0.2970460436914278, 'dice': 0.3939341602118119}
Test   -> {'loss': 0.732679009437561, 'accuracy': 0.39530786871910095, 'precision': 0.3113747835159302, 'recall': 0.3490792214870453, 'iou': 0.19020138680934906, 'dice': 0.28730615973472595}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.44265142679214475, 'accuracy': 0.6794842953267305, 'precision': 0.5556753780530846, 'recall': 0.5977148605429607, 'iou': 0.4201593005138895, 'dice': 0.5619479873906011}
Test   -> {'loss': 0.8004104495048523, 'accuracy': 0.2320307493209839, 'precision': 0.4328194856643677, 'recall': 0.3793714642524719, 'iou': 0.11772843450307846, 'dice': 0.2069290578365326}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.42480935428453526, 'accuracy': 0.6856684674387393, 'precision': 0.5695972499640092, 'recall': 0.6131091418473616, 'iou': 0.434639789228854, 'dice': 0.5803159174711808}
Test   -> {'loss': 0.7201515436172485, 'accuracy': 0.5498526096343994, 'precision': 0.4656982421875, 'recall': 0.35263484716415405, 'iou': 0.21918950974941254, 'dice': 0.301595002412796}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.40314281297766646, 'accuracy': 0.7032199051069177, 'precision': 0.5917220483655515, 'recall': 0.6172336495440939, 'iou': 0.45394811915314714, 'dice': 0.601823223673779}
Test   -> {'loss': 0.7404412627220154, 'accuracy': 0.5527583360671997, 'precision': 0.3884674906730652, 'recall': 0.3353644013404846, 'iou': 0.20502589643001556, 'dice': 0.27481192350387573}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.3933529408081718, 'accuracy': 0.7093014007029326, 'precision': 0.6014636723891549, 'recall': 0.6249732670576676, 'iou': 0.4625892162322998, 'dice': 0.6111506503561269}
Test   -> {'loss': 0.7532186508178711, 'accuracy': 0.5523130297660828, 'precision': 0.4416825771331787, 'recall': 0.3321920335292816, 'iou': 0.19679932296276093, 'dice': 0.25911784172058105}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.39485405735347584, 'accuracy': 0.7064100462457408, 'precision': 0.5985126982564511, 'recall': 0.624759578704834, 'iou': 0.4606045339418494, 'dice': 0.6091932649197785}
Test   -> {'loss': 0.6537396907806396, 'accuracy': 0.5315912961959839, 'precision': 0.4814143776893616, 'recall': 0.39574334025382996, 'iou': 0.25658485293388367, 'dice': 0.3612149655818939}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.38807754101960557, 'accuracy': 0.7120592920676522, 'precision': 0.6068008174066958, 'recall': 0.6284121020980503, 'iou': 0.4670933396919914, 'dice': 0.6159444301024727}
Test   -> {'loss': 0.5846441984176636, 'accuracy': 0.5917099714279175, 'precision': 0.5587878227233887, 'recall': 0.45283016562461853, 'iou': 0.30801719427108765, 'dice': 0.42417311668395996}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3886780158333156, 'accuracy': 0.7109202789223712, 'precision': 0.605699654765751, 'recall': 0.6284168258957241, 'iou': 0.46611250068830407, 'dice': 0.6150609368863313}
Test   -> {'loss': 0.5602891445159912, 'accuracy': 0.6177330613136292, 'precision': 0.5522083044052124, 'recall': 0.4597131907939911, 'iou': 0.3359104096889496, 'dice': 0.45911523699760437}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.3821608937304953, 'accuracy': 0.7170264674269635, 'precision': 0.6183614336926004, 'recall': 0.6262222917183585, 'iou': 0.47184943997341655, 'dice': 0.6210896968841553}
Test   -> {'loss': 0.6017360091209412, 'accuracy': 0.6052501201629639, 'precision': 0.5344794988632202, 'recall': 0.4284588098526001, 'iou': 0.3029964566230774, 'dice': 0.4171382188796997}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.3798049719437309, 'accuracy': 0.7190068644026052, 'precision': 0.621187012091927, 'recall': 0.6276900182599606, 'iou': 0.4741511020971381, 'dice': 0.6234507685122282}
Test   -> {'loss': 0.5344968438148499, 'accuracy': 0.5889067053794861, 'precision': 0.5375325679779053, 'recall': 0.47673580050468445, 'iou': 0.33963489532470703, 'dice': 0.47155818343162537}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 10 with IoU 0.33963489532470703
Test -> {'loss': 0.5344968438148499, 'accuracy': 0.5889067053794861, 'precision': 0.5375325679779053, 'recall': 0.47673580050468445, 'iou': 0.33963489532470703, 'dice': 0.47155818343162537} 
Train -> {'loss': 0.3798049719437309, 'accuracy': 0.7190068644026052, 'precision': 0.621187012091927, 'recall': 0.6276900182599606, 'iou': 0.4741511020971381, 'dice': 0.6234507685122282} 

Best model saved for model segnet at epoch 10

Trial 16:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5666656544674997, 'accuracy': 0.783825349678164, 'precision': 0.6499496116586353, 'recall': 0.5766457442356192, 'iou': 0.46426278307386065, 'dice': 0.5438762427672096}
Test   -> {'loss': 1.294688105583191, 'accuracy': 0.5907629728317261, 'precision': 0.4844205379486084, 'recall': 0.470827579498291, 'iou': 0.3040643632411957, 'dice': 0.4176693856716156}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.47686728537082673, 'accuracy': 0.8132353793019834, 'precision': 0.6451159684554391, 'recall': 0.6033523725426715, 'iou': 0.4966680425664653, 'dice': 0.5685537164625915}
Test   -> {'loss': 0.8860753774642944, 'accuracy': 0.6801134943962097, 'precision': 0.5056657195091248, 'recall': 0.5170620679855347, 'iou': 0.3700166940689087, 'dice': 0.47317156195640564}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.44683656899825386, 'accuracy': 0.8221663871537084, 'precision': 0.6527278166750203, 'recall': 0.6120925781519516, 'iou': 0.5086326838835425, 'dice': 0.57849869572598}
Test   -> {'loss': 0.903350293636322, 'accuracy': 0.6736848950386047, 'precision': 0.49886131286621094, 'recall': 0.505901038646698, 'iou': 0.3694159686565399, 'dice': 0.47539663314819336}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4228184760912605, 'accuracy': 0.8296210755472598, 'precision': 0.6709068795909052, 'recall': 0.6277650034945944, 'iou': 0.5290752780178319, 'dice': 0.6048952084520589}
Test   -> {'loss': 2.0777111053466797, 'accuracy': 0.593904435634613, 'precision': 0.4797421097755432, 'recall': 0.40513691306114197, 'iou': 0.26544660329818726, 'dice': 0.3660730719566345}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.408432198089102, 'accuracy': 0.834675831898399, 'precision': 0.6840011705522951, 'recall': 0.6423030511192653, 'iou': 0.5471669000128041, 'dice': 0.6295915430006773}
Test   -> {'loss': 1.0092390775680542, 'accuracy': 0.6608961224555969, 'precision': 0.5010242462158203, 'recall': 0.5087001323699951, 'iou': 0.3643931746482849, 'dice': 0.4747987389564514}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3909395889095638, 'accuracy': 0.8396116186743198, 'precision': 0.694343081764553, 'recall': 0.6537405617859052, 'iou': 0.5610201757887135, 'dice': 0.6464276699916176}
Test   -> {'loss': 1.2325465679168701, 'accuracy': 0.6213653087615967, 'precision': 0.4721371531486511, 'recall': 0.4978758692741394, 'iou': 0.3381311595439911, 'dice': 0.46142837405204773}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.36934191636417224, 'accuracy': 0.8473308309264805, 'precision': 0.7128872925820557, 'recall': 0.679567646721135, 'iou': 0.5887090353862099, 'dice': 0.6813589852789174}
Test   -> {'loss': 1.022403359413147, 'accuracy': 0.6847060918807983, 'precision': 0.5001106262207031, 'recall': 0.507544219493866, 'iou': 0.38123393058776855, 'dice': 0.49991077184677124}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3489977267773255, 'accuracy': 0.8538925860239112, 'precision': 0.7252410139726556, 'recall': 0.6951221409051315, 'iou': 0.6054963288099869, 'dice': 0.6997993593630584}
Test   -> {'loss': 1.1341159343719482, 'accuracy': 0.6638619303703308, 'precision': 0.4915305972099304, 'recall': 0.5262918472290039, 'iou': 0.3737882971763611, 'dice': 0.4948854148387909}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.331044723028722, 'accuracy': 0.8608056104701498, 'precision': 0.7398340095644412, 'recall': 0.7135910645775173, 'iou': 0.6237744059251702, 'dice': 0.7194690590319426}
Test   -> {'loss': 1.1238590478897095, 'accuracy': 0.6574146151542664, 'precision': 0.5201969146728516, 'recall': 0.5331909656524658, 'iou': 0.39248794317245483, 'dice': 0.5178284645080566}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.31681761599105335, 'accuracy': 0.8660320582597152, 'precision': 0.7491762047228606, 'recall': 0.7259295362493267, 'iou': 0.6360865499662316, 'dice': 0.7320276630961376}
Test   -> {'loss': 0.9713886976242065, 'accuracy': 0.7130351066589355, 'precision': 0.5295712351799011, 'recall': 0.5576812624931335, 'iou': 0.41724562644958496, 'dice': 0.5383238792419434}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 10 with IoU 0.41724562644958496
Test -> {'loss': 0.9713886976242065, 'accuracy': 0.7130351066589355, 'precision': 0.5295712351799011, 'recall': 0.5576812624931335, 'iou': 0.41724562644958496, 'dice': 0.5383238792419434} 
Train -> {'loss': 0.31681761599105335, 'accuracy': 0.8660320582597152, 'precision': 0.7491762047228606, 'recall': 0.7259295362493267, 'iou': 0.6360865499662316, 'dice': 0.7320276630961376} 

Best model saved for model segnet at epoch 10

Trial 17:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.5862825836824335, 'accuracy': 0.7760864133420198, 'precision': 0.6048927835796191, 'recall': 0.569775490657143, 'iou': 0.45811377193616787, 'dice': 0.5391201470209205}
Test   -> {'loss': 1.3457305431365967, 'accuracy': 0.6319916248321533, 'precision': 0.499428927898407, 'recall': 0.4183215796947479, 'iou': 0.28902801871299744, 'dice': 0.39014655351638794}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4393235102943752, 'accuracy': 0.8242566969083703, 'precision': 0.6576722103616466, 'recall': 0.6166925839755846, 'iou': 0.5152430057525634, 'dice': 0.5877763395724089}
Test   -> {'loss': 0.969063401222229, 'accuracy': 0.6942017078399658, 'precision': 0.5161021947860718, 'recall': 0.5023993849754333, 'iou': 0.37245887517929077, 'dice': 0.4766310155391693}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4012603078199469, 'accuracy': 0.8356640338897705, 'precision': 0.6842980452205824, 'recall': 0.6409949484078781, 'iou': 0.5468406293703162, 'dice': 0.6281818115192911}
Test   -> {'loss': 0.9657585620880127, 'accuracy': 0.6735889315605164, 'precision': 0.5056082606315613, 'recall': 0.5218541622161865, 'iou': 0.383833646774292, 'dice': 0.5033512115478516}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.37014411791511204, 'accuracy': 0.8464931099311165, 'precision': 0.7083579260370005, 'recall': 0.6730567771455516, 'iou': 0.582746990867283, 'dice': 0.6733612858730814}
Test   -> {'loss': 2.000782012939453, 'accuracy': 0.6099053025245667, 'precision': 0.5131246447563171, 'recall': 0.4072543978691101, 'iou': 0.27558135986328125, 'dice': 0.3793584108352661}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.33930686634519824, 'accuracy': 0.857700925287993, 'precision': 0.7332187714784042, 'recall': 0.7043425373409106, 'iou': 0.6149788270825925, 'dice': 0.7101618720137555}
Test   -> {'loss': 1.4230356216430664, 'accuracy': 0.6684722900390625, 'precision': 0.5082563161849976, 'recall': 0.47430619597435, 'iou': 0.35556158423423767, 'dice': 0.47439688444137573}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.30462840769601907, 'accuracy': 0.8709269528803618, 'precision': 0.7588122295296711, 'recall': 0.7373957058657771, 'iou': 0.6477241941120313, 'dice': 0.7442357975503673}
Test   -> {'loss': 1.4958291053771973, 'accuracy': 0.6604436635971069, 'precision': 0.5196460485458374, 'recall': 0.4857603907585144, 'iou': 0.3650829493999481, 'dice': 0.4914458692073822}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.2874541422595149, 'accuracy': 0.8768142425495645, 'precision': 0.7700970292091369, 'recall': 0.7512970058814339, 'iou': 0.6613750167514967, 'dice': 0.7575446590133336}
Test   -> {'loss': 1.5434056520462036, 'accuracy': 0.6477630138397217, 'precision': 0.5094125270843506, 'recall': 0.49878841638565063, 'iou': 0.37252938747406006, 'dice': 0.5024065375328064}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.2695108131222103, 'accuracy': 0.8848076239876125, 'precision': 0.7852140716884447, 'recall': 0.7683400071185568, 'iou': 0.6788057420564735, 'dice': 0.7739655826402747}
Test   -> {'loss': 2.0204720497131348, 'accuracy': 0.6395260691642761, 'precision': 0.5080784559249878, 'recall': 0.42845579981803894, 'iou': 0.3117839992046356, 'dice': 0.42776036262512207}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2508398106564646, 'accuracy': 0.8919974156047987, 'precision': 0.7975315467171047, 'recall': 0.7852564682131228, 'iou': 0.6957919043043386, 'dice': 0.7899420240651006}
Test   -> {'loss': 1.7318466901779175, 'accuracy': 0.6699735522270203, 'precision': 0.5170356631278992, 'recall': 0.4709230363368988, 'iou': 0.35704392194747925, 'dice': 0.48043352365493774}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.23491035725759424, 'accuracy': 0.8987647372743358, 'precision': 0.8105927488078242, 'recall': 0.7983922751053519, 'iou': 0.7101147931555043, 'dice': 0.8022262780562691}
Test   -> {'loss': 2.4525160789489746, 'accuracy': 0.5968406796455383, 'precision': 0.47412556409835815, 'recall': 0.44962573051452637, 'iou': 0.32299456000328064, 'dice': 0.4506670832633972}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 3 with IoU 0.383833646774292
Test -> {'loss': 0.9657585620880127, 'accuracy': 0.6735889315605164, 'precision': 0.5056082606315613, 'recall': 0.5218541622161865, 'iou': 0.383833646774292, 'dice': 0.5033512115478516} 
Train -> {'loss': 0.4012603078199469, 'accuracy': 0.8356640338897705, 'precision': 0.6842980452205824, 'recall': 0.6409949484078781, 'iou': 0.5468406293703162, 'dice': 0.6281818115192911} 

Best model saved for model segnet at epoch 10

Trial 18:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.7843977060007012, 'accuracy': 0.7009363039680149, 'precision': 0.6564551657308703, 'recall': 0.5112980058659677, 'iou': 0.3804637524744739, 'dice': 0.4757829638926879}
Test   -> {'loss': 6.682931900024414, 'accuracy': 0.5101019144058228, 'precision': 0.38502952456474304, 'recall': 0.34500762820243835, 'iou': 0.1893598735332489, 'dice': 0.2650368809700012}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.6759570150271706, 'accuracy': 0.740536946317424, 'precision': 0.7002820279287255, 'recall': 0.5408774361662243, 'iou': 0.41815224030743475, 'dice': 0.5120964588030524}
Test   -> {'loss': 7.028592586517334, 'accuracy': 0.5816376209259033, 'precision': 0.36186832189559937, 'recall': 0.3420826196670532, 'iou': 0.22210070490837097, 'dice': 0.29898619651794434}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.664564968192059, 'accuracy': 0.7446674447992574, 'precision': 0.7597724282223245, 'recall': 0.5445254315500674, 'iou': 0.4224619770827501, 'dice': 0.5154336048209149}
Test   -> {'loss': 17.433778762817383, 'accuracy': 0.582783579826355, 'precision': 0.3448437452316284, 'recall': 0.32788538932800293, 'iou': 0.21706371009349823, 'dice': 0.2893246114253998}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6567214595234913, 'accuracy': 0.7482443019099857, 'precision': 0.8217107612153758, 'recall': 0.5473040637762651, 'iou': 0.42598891957946444, 'dice': 0.518105651114298}
Test   -> {'loss': 3.3969221115112305, 'accuracy': 0.5851514935493469, 'precision': 0.3847758173942566, 'recall': 0.3814833164215088, 'iou': 0.2600433826446533, 'dice': 0.3592596650123596}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6458017629125844, 'accuracy': 0.7524661836416825, 'precision': 0.8218202419902967, 'recall': 0.5511976529722629, 'iou': 0.43032457698946414, 'dice': 0.5214256206284399}
Test   -> {'loss': 30.274009704589844, 'accuracy': 0.5157732367515564, 'precision': 0.35379475355148315, 'recall': 0.35052555799484253, 'iou': 0.2268633097410202, 'dice': 0.32546550035476685}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6342991939057474, 'accuracy': 0.7566794797130253, 'precision': 0.8334065289601036, 'recall': 0.5547448399274245, 'iou': 0.4348479537860207, 'dice': 0.5248122370761373}
Test   -> {'loss': 471.3988342285156, 'accuracy': 0.5804430842399597, 'precision': 0.5326744318008423, 'recall': 0.3272223472595215, 'iou': 0.19364646077156067, 'dice': 0.24514064192771912}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6136970532977063, 'accuracy': 0.763964574492496, 'precision': 0.8380225686923317, 'recall': 0.5613960768865502, 'iou': 0.44253835911336153, 'dice': 0.5305745913930561}
Test   -> {'loss': 996.1115112304688, 'accuracy': 0.5579198598861694, 'precision': 0.7383003234863281, 'recall': 0.34638580679893494, 'iou': 0.19949452579021454, 'dice': 0.2662997245788574}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.5899178950682931, 'accuracy': 0.7733058545900428, 'precision': 0.8442346412202586, 'recall': 0.5697905690773674, 'iou': 0.45253884274026623, 'dice': 0.5378890428854072}
Test   -> {'loss': 1373.478515625, 'accuracy': 0.581562876701355, 'precision': 0.528575599193573, 'recall': 0.32930803298950195, 'iou': 0.19385430216789246, 'dice': 0.24514269828796387}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.5757799739423005, 'accuracy': 0.7787906086963156, 'precision': 0.8484590527804001, 'recall': 0.5739523550738459, 'iou': 0.4584191497253335, 'dice': 0.5420869761187097}
Test   -> {'loss': 1523.6319580078125, 'accuracy': 0.5810409784317017, 'precision': 0.5291337966918945, 'recall': 0.32727983593940735, 'iou': 0.1936960071325302, 'dice': 0.24501609802246094}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.554982796959255, 'accuracy': 0.7857919692993164, 'precision': 0.8532192175802977, 'recall': 0.580079334974289, 'iou': 0.4659955462683802, 'dice': 0.5475087541600933}
Test   -> {'loss': 1044.413818359375, 'accuracy': 0.6569176316261292, 'precision': 0.5744450092315674, 'recall': 0.3288145065307617, 'iou': 0.22008973360061646, 'dice': 0.2665160596370697}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 4 with IoU 0.2600433826446533
Test -> {'loss': 3.3969221115112305, 'accuracy': 0.5851514935493469, 'precision': 0.3847758173942566, 'recall': 0.3814833164215088, 'iou': 0.2600433826446533, 'dice': 0.3592596650123596} 
Train -> {'loss': 0.6567214595234913, 'accuracy': 0.7482443019099857, 'precision': 0.8217107612153758, 'recall': 0.5473040637762651, 'iou': 0.42598891957946444, 'dice': 0.518105651114298} 

Best model saved for model segnet at epoch 10

Trial 19:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'ce_mean', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 1.0257796474125074, 'accuracy': 0.5514585614204407, 'precision': 0.6266904530317887, 'recall': 0.3331828480181487, 'iou': 0.18496307575184365, 'dice': 0.23862727258516395}
Test   -> {'loss': 17.701112747192383, 'accuracy': 0.5594606995582581, 'precision': 0.289364755153656, 'recall': 0.3432631194591522, 'iou': 0.2131454050540924, 'dice': 0.28527796268463135}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.8123909172804459, 'accuracy': 0.641023752482041, 'precision': 0.4960004415201104, 'recall': 0.46002911847570666, 'iou': 0.31834605750830275, 'dice': 0.41090314388275145}
Test   -> {'loss': 3.7306220531463623, 'accuracy': 0.45948198437690735, 'precision': 0.3421422839164734, 'recall': 0.3438754975795746, 'iou': 0.22263388335704803, 'dice': 0.33844512701034546}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.7106371195419975, 'accuracy': 0.7364703354628189, 'precision': 0.7279990450195645, 'recall': 0.5420771920162698, 'iou': 0.4157750067503556, 'dice': 0.510637528999992}
Test   -> {'loss': 12.955582618713379, 'accuracy': 0.5755375623703003, 'precision': 0.33744925260543823, 'recall': 0.35361143946647644, 'iou': 0.23449373245239258, 'dice': 0.322041392326355}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.6855795870656552, 'accuracy': 0.7413236586943917, 'precision': 0.7849846928015999, 'recall': 0.5416054435398268, 'iou': 0.41894660021947777, 'dice': 0.5130092024803161}
Test   -> {'loss': 12.682046890258789, 'accuracy': 0.5688868761062622, 'precision': 0.35213765501976013, 'recall': 0.3415103554725647, 'iou': 0.2212756872177124, 'dice': 0.30223211646080017}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.6769901809485063, 'accuracy': 0.7425062739330789, 'precision': 0.8004013585007709, 'recall': 0.5426913530930229, 'iou': 0.4201614639033442, 'dice': 0.5139442386834517}
Test   -> {'loss': 29.732614517211914, 'accuracy': 0.5947909951210022, 'precision': 0.3616395890712738, 'recall': 0.337289422750473, 'iou': 0.21037380397319794, 'dice': 0.27299901843070984}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.6725076379983321, 'accuracy': 0.7438034472258195, 'precision': 0.8236660718917846, 'recall': 0.5441106003263723, 'iou': 0.42163835141969763, 'dice': 0.5150443958199542}
Test   -> {'loss': 1.2670012712478638, 'accuracy': 0.6116989850997925, 'precision': 0.7359228134155273, 'recall': 0.38639312982559204, 'iou': 0.25873202085494995, 'dice': 0.3507401943206787}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.6714079815408458, 'accuracy': 0.7441408981447635, 'precision': 0.7953035219855931, 'recall': 0.5439365718675696, 'iou': 0.4217732222183891, 'dice': 0.515165086414503}
Test   -> {'loss': 4.156428337097168, 'accuracy': 0.545221745967865, 'precision': 0.31770485639572144, 'recall': 0.32964178919792175, 'iou': 0.188807412981987, 'dice': 0.24931937456130981}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.6653286669565284, 'accuracy': 0.7462616682052612, 'precision': 0.7905847559804502, 'recall': 0.5457803337470345, 'iou': 0.4239509538463924, 'dice': 0.5168496012687683}
Test   -> {'loss': 2.3453686237335205, 'accuracy': 0.6102768182754517, 'precision': 0.4484947919845581, 'recall': 0.391967236995697, 'iou': 0.2688697576522827, 'dice': 0.36627912521362305}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.6639416072679603, 'accuracy': 0.7469138357950293, 'precision': 0.799555629491806, 'recall': 0.5469623176947884, 'iou': 0.42488167052683623, 'dice': 0.5175598434779956}
Test   -> {'loss': 0.8619453310966492, 'accuracy': 0.6423738598823547, 'precision': 0.4170684814453125, 'recall': 0.4579077661037445, 'iou': 0.32307878136634827, 'dice': 0.4288133382797241}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.6625088676162388, 'accuracy': 0.7469829719999562, 'precision': 0.7796218861704287, 'recall': 0.5464465794355973, 'iou': 0.42473051496174025, 'dice': 0.5174100533775662}
Test   -> {'loss': 1.5499813556671143, 'accuracy': 0.6270608305931091, 'precision': 0.7344663143157959, 'recall': 0.39704033732414246, 'iou': 0.2747310996055603, 'dice': 0.37049373984336853}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 9 with IoU 0.32307878136634827
Test -> {'loss': 0.8619453310966492, 'accuracy': 0.6423738598823547, 'precision': 0.4170684814453125, 'recall': 0.4579077661037445, 'iou': 0.32307878136634827, 'dice': 0.4288133382797241} 
Train -> {'loss': 0.6639416072679603, 'accuracy': 0.7469138357950293, 'precision': 0.799555629491806, 'recall': 0.5469623176947884, 'iou': 0.42488167052683623, 'dice': 0.5175598434779956} 

Best model saved for model segnet at epoch 10

Trial 20:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.3709190954332766, 'accuracy': 0.7434720867353937, 'precision': 0.6411387868549513, 'recall': 0.6421369901169901, 'iou': 0.5081677327337473, 'dice': 0.6324775421101114}
Test   -> {'loss': 0.5255007147789001, 'accuracy': 0.6020482778549194, 'precision': 0.5251361131668091, 'recall': 0.5038158893585205, 'iou': 0.36605939269065857, 'dice': 0.504074215888977}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3381854591162308, 'accuracy': 0.765919350022855, 'precision': 0.6685037356355916, 'recall': 0.6745163508083509, 'iou': 0.539259551530299, 'dice': 0.6633383452892303}
Test   -> {'loss': 0.5198705196380615, 'accuracy': 0.5538105964660645, 'precision': 0.5138139724731445, 'recall': 0.5167379379272461, 'iou': 0.34471267461776733, 'dice': 0.48870229721069336}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.32092400193214415, 'accuracy': 0.7808753998383232, 'precision': 0.6838072968565899, 'recall': 0.6919968542845353, 'iou': 0.5578121189189994, 'dice': 0.6798369303993557}
Test   -> {'loss': 0.5125803351402283, 'accuracy': 0.6004252433776855, 'precision': 0.5194332599639893, 'recall': 0.5017356276512146, 'iou': 0.3648063540458679, 'dice': 0.5035805106163025}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3123748076998669, 'accuracy': 0.7870820208736088, 'precision': 0.6911784275718357, 'recall': 0.7014953579591668, 'iou': 0.5667866491753122, 'dice': 0.6880437306735827}
Test   -> {'loss': 0.4923076629638672, 'accuracy': 0.6113094091415405, 'precision': 0.5277036428451538, 'recall': 0.5379576683044434, 'iou': 0.38175851106643677, 'dice': 0.5200809240341187}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2997975012530451, 'accuracy': 0.7976690258668817, 'precision': 0.7022683420906897, 'recall': 0.7143506278162417, 'iou': 0.5805145965970081, 'dice': 0.7002302986124288}
Test   -> {'loss': 0.4682372808456421, 'accuracy': 0.6879932284355164, 'precision': 0.5456127524375916, 'recall': 0.549149215221405, 'iou': 0.417961448431015, 'dice': 0.5469632148742676}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.2942519659581392, 'accuracy': 0.8019558447858561, 'precision': 0.7071018491102301, 'recall': 0.72065029921739, 'iou': 0.5866127292747083, 'dice': 0.7057564738004104}
Test   -> {'loss': 0.5041741728782654, 'accuracy': 0.6273280382156372, 'precision': 0.5206890106201172, 'recall': 0.5187619924545288, 'iou': 0.3788972496986389, 'dice': 0.5170652270317078}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.28490889435229094, 'accuracy': 0.8098799775476041, 'precision': 0.7150300834489905, 'recall': 0.7306492178336433, 'iou': 0.59729388848595, 'dice': 0.7150082520816637}
Test   -> {'loss': 0.4896811246871948, 'accuracy': 0.6591223478317261, 'precision': 0.5308683514595032, 'recall': 0.5423433780670166, 'iou': 0.40057462453842163, 'dice': 0.5336450934410095}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.28316712509030884, 'accuracy': 0.8107380286506984, 'precision': 0.7163083633650904, 'recall': 0.7324704742949942, 'iou': 0.5989390308442323, 'dice': 0.7164786240328913}
Test   -> {'loss': 0.48931145668029785, 'accuracy': 0.6358904242515564, 'precision': 0.5241605043411255, 'recall': 0.5269150733947754, 'iou': 0.3888706862926483, 'dice': 0.5252470970153809}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.27125223227169204, 'accuracy': 0.8214135587215423, 'precision': 0.7266299978546474, 'recall': 0.744320417487103, 'iou': 0.6128499901813009, 'dice': 0.7284714719523554}
Test   -> {'loss': 0.47407233715057373, 'accuracy': 0.6240645051002502, 'precision': 0.5486284494400024, 'recall': 0.5414342284202576, 'iou': 0.39501890540122986, 'dice': 0.53481525182724}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.26773721212926116, 'accuracy': 0.8239631424779478, 'precision': 0.730023040201353, 'recall': 0.7489638398522916, 'iou': 0.6170944931714432, 'dice': 0.732068045242973}
Test   -> {'loss': 0.4901008605957031, 'accuracy': 0.6414645314216614, 'precision': 0.5232973098754883, 'recall': 0.5273269414901733, 'iou': 0.38584256172180176, 'dice': 0.516464114189148}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 5 with IoU 0.417961448431015
Test -> {'loss': 0.4682372808456421, 'accuracy': 0.6879932284355164, 'precision': 0.5456127524375916, 'recall': 0.549149215221405, 'iou': 0.417961448431015, 'dice': 0.5469632148742676} 
Train -> {'loss': 0.2997975012530451, 'accuracy': 0.7976690258668817, 'precision': 0.7022683420906897, 'recall': 0.7143506278162417, 'iou': 0.5805145965970081, 'dice': 0.7002302986124288} 

Best model saved for model segnet at epoch 10

Trial 21:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.38025429248809817, 'accuracy': 0.7526012529497561, 'precision': 0.6400609793870345, 'recall': 0.6372002326923868, 'iou': 0.5060805001984472, 'dice': 0.6215705052666042}
Test   -> {'loss': 0.733903706073761, 'accuracy': 0.3552912473678589, 'precision': 0.4206012487411499, 'recall': 0.3821287155151367, 'iou': 0.1744600534439087, 'dice': 0.28114500641822815}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3178198187247567, 'accuracy': 0.7831113167431043, 'precision': 0.6862570462019547, 'recall': 0.696121016792629, 'iou': 0.56129353772039, 'dice': 0.6834520588750425}
Test   -> {'loss': 0.5223677158355713, 'accuracy': 0.6389499306678772, 'precision': 0.5137620568275452, 'recall': 0.49648189544677734, 'iou': 0.3688145577907562, 'dice': 0.500644326210022}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.29918690971706224, 'accuracy': 0.7990347468334695, 'precision': 0.7023902934530507, 'recall': 0.714838869675346, 'iou': 0.5817888363547947, 'dice': 0.7012961107751597}
Test   -> {'loss': 0.5096354484558105, 'accuracy': 0.6004675626754761, 'precision': 0.5145092010498047, 'recall': 0.5212286114692688, 'iou': 0.3711749315261841, 'dice': 0.5101937055587769}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.2805391011030778, 'accuracy': 0.8139822270559228, 'precision': 0.718674055389736, 'recall': 0.7332591658053191, 'iou': 0.6016700086386307, 'dice': 0.7190491717794667}
Test   -> {'loss': 0.505720853805542, 'accuracy': 0.5941488742828369, 'precision': 0.5210504531860352, 'recall': 0.5279600620269775, 'iou': 0.36941346526145935, 'dice': 0.509734570980072}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2715115749317667, 'accuracy': 0.8202293043551238, 'precision': 0.726200240591298, 'recall': 0.7448691964149475, 'iou': 0.6120325378749681, 'dice': 0.7281433188396952}
Test   -> {'loss': 0.4955289363861084, 'accuracy': 0.6375128030776978, 'precision': 0.5273807644844055, 'recall': 0.5249465703964233, 'iou': 0.387983500957489, 'dice': 0.5232223272323608}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.26704014954359634, 'accuracy': 0.8251254957655202, 'precision': 0.7304596009461776, 'recall': 0.748330076881077, 'iou': 0.617527527394502, 'dice': 0.7326065447019494}
Test   -> {'loss': 0.6480032205581665, 'accuracy': 0.6086248159408569, 'precision': 0.5259868502616882, 'recall': 0.4080584943294525, 'iou': 0.2790371775627136, 'dice': 0.38574832677841187}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.24925889657891315, 'accuracy': 0.8389754927676657, 'precision': 0.7462705073149308, 'recall': 0.7671185011449068, 'iou': 0.6380478055580803, 'dice': 0.7502815516098685}
Test   -> {'loss': 0.5659002661705017, 'accuracy': 0.6524249911308289, 'precision': 0.5304849147796631, 'recall': 0.47161054611206055, 'iou': 0.3547213077545166, 'dice': 0.47858208417892456}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.23922715809034265, 'accuracy': 0.8467738301857658, 'precision': 0.7546101010364035, 'recall': 0.7766361039617787, 'iou': 0.6492614756459775, 'dice': 0.7598496696223384}
Test   -> {'loss': 0.5393208861351013, 'accuracy': 0.6469402313232422, 'precision': 0.5126417875289917, 'recall': 0.4898361563682556, 'iou': 0.3664015531539917, 'dice': 0.49700793623924255}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2278300632601199, 'accuracy': 0.8557399884514186, 'precision': 0.7647221601527671, 'recall': 0.7879306736199753, 'iou': 0.6627699551375016, 'dice': 0.771101306832355}
Test   -> {'loss': 0.514426052570343, 'accuracy': 0.661859929561615, 'precision': 0.5418813228607178, 'recall': 0.5051226615905762, 'iou': 0.3828854560852051, 'dice': 0.5134815573692322}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.21915888164354408, 'accuracy': 0.8621278586594955, 'precision': 0.7727728646734486, 'recall': 0.7980349654736726, 'iou': 0.6734794678895369, 'dice': 0.7799643164095671}
Test   -> {'loss': 0.48009276390075684, 'accuracy': 0.6805597543716431, 'precision': 0.5456670522689819, 'recall': 0.5404487252235413, 'iou': 0.41365084052085876, 'dice': 0.5428030490875244}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 10 with IoU 0.41365084052085876
Test -> {'loss': 0.48009276390075684, 'accuracy': 0.6805597543716431, 'precision': 0.5456670522689819, 'recall': 0.5404487252235413, 'iou': 0.41365084052085876, 'dice': 0.5428030490875244} 
Train -> {'loss': 0.21915888164354408, 'accuracy': 0.8621278586594955, 'precision': 0.7727728646734486, 'recall': 0.7980349654736726, 'iou': 0.6734794678895369, 'dice': 0.7799643164095671} 

Best model saved for model segnet at epoch 10

Trial 22:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.47550738039224044, 'accuracy': 0.6609628536778948, 'precision': 0.5949497178844784, 'recall': 0.5347977451656176, 'iou': 0.39727913594764214, 'dice': 0.517014874064404}
Test   -> {'loss': 0.48358482122421265, 'accuracy': 0.6292375922203064, 'precision': 0.5326440334320068, 'recall': 0.5398784875869751, 'iou': 0.38997697830200195, 'dice': 0.5301940441131592}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4286672493685847, 'accuracy': 0.6857787409554357, 'precision': 0.5827984504077746, 'recall': 0.576273076430611, 'iou': 0.44307505980781886, 'dice': 0.5733421284219493}
Test   -> {'loss': 0.5390949249267578, 'accuracy': 0.5745450854301453, 'precision': 0.4886188507080078, 'recall': 0.4960877299308777, 'iou': 0.3415564000606537, 'dice': 0.4790899455547333}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4197837464187456, 'accuracy': 0.6920273855976437, 'precision': 0.5917160391807557, 'recall': 0.5865010655444601, 'iou': 0.45210727932660477, 'dice': 0.5821351758811785}
Test   -> {'loss': 0.49033284187316895, 'accuracy': 0.6356362700462341, 'precision': 0.5213781595230103, 'recall': 0.5320323705673218, 'iou': 0.3873109817504883, 'dice': 0.5223786234855652}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.40961128006810726, 'accuracy': 0.7020303982755413, 'precision': 0.6021112724490788, 'recall': 0.5974988929603411, 'iou': 0.4632544534361881, 'dice': 0.5924179303905238}
Test   -> {'loss': 0.4875227212905884, 'accuracy': 0.6398003697395325, 'precision': 0.5258883833885193, 'recall': 0.5294662714004517, 'iou': 0.39003413915634155, 'dice': 0.5231311321258545}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.39291482256806415, 'accuracy': 0.7159863979920097, 'precision': 0.618774209851804, 'recall': 0.6155130259368731, 'iou': 0.4803589763848678, 'dice': 0.6088270513907723}
Test   -> {'loss': 0.5474004745483398, 'accuracy': 0.6086886525154114, 'precision': 0.5029903650283813, 'recall': 0.46799713373184204, 'iou': 0.3424648940563202, 'dice': 0.4725174307823181}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.3804886563964512, 'accuracy': 0.726719877253408, 'precision': 0.6298386705958325, 'recall': 0.6284428796042567, 'iou': 0.4929035581972288, 'dice': 0.6207364424415257}
Test   -> {'loss': 0.5058870315551758, 'accuracy': 0.620686411857605, 'precision': 0.5112849473953247, 'recall': 0.5026571154594421, 'iou': 0.3685600459575653, 'dice': 0.5041467547416687}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.3723863254422727, 'accuracy': 0.733864357419636, 'precision': 0.6375725124193274, 'recall': 0.6370291087938391, 'iou': 0.5013451270435167, 'dice': 0.6286181198514026}
Test   -> {'loss': 0.5876284241676331, 'accuracy': 0.5045340061187744, 'precision': 0.4630148410797119, 'recall': 0.4554094970226288, 'iou': 0.29604852199554443, 'dice': 0.43252119421958923}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.3637297599211983, 'accuracy': 0.7416435099166373, 'precision': 0.6457312721273173, 'recall': 0.6459759924722754, 'iou': 0.51052736432656, 'dice': 0.6369068451549695}
Test   -> {'loss': 0.5666589736938477, 'accuracy': 0.5442866086959839, 'precision': 0.45935115218162537, 'recall': 0.4592932164669037, 'iou': 0.3143134117126465, 'dice': 0.4512312412261963}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.35727951889452725, 'accuracy': 0.7474566109802412, 'precision': 0.6519013837627743, 'recall': 0.6525366720945939, 'iou': 0.5172092164340226, 'dice': 0.6432619151861771}
Test   -> {'loss': 0.5069130659103394, 'accuracy': 0.5957566499710083, 'precision': 0.5284356474876404, 'recall': 0.507088840007782, 'iou': 0.3623318374156952, 'dice': 0.5039980411529541}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.35173006031824194, 'accuracy': 0.752536636331807, 'precision': 0.6566713843656623, 'recall': 0.657941414480624, 'iou': 0.5227948105853537, 'dice': 0.64851270603097}
Test   -> {'loss': 0.5739212036132812, 'accuracy': 0.527424693107605, 'precision': 0.4450179934501648, 'recall': 0.44858843088150024, 'iou': 0.3003503978252411, 'dice': 0.4359787404537201}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 4 with IoU 0.39003413915634155
Test -> {'loss': 0.4875227212905884, 'accuracy': 0.6398003697395325, 'precision': 0.5258883833885193, 'recall': 0.5294662714004517, 'iou': 0.39003413915634155, 'dice': 0.5231311321258545} 
Train -> {'loss': 0.40961128006810726, 'accuracy': 0.7020303982755413, 'precision': 0.6021112724490788, 'recall': 0.5974988929603411, 'iou': 0.4632544534361881, 'dice': 0.5924179303905238} 

Best model saved for model segnet at epoch 10

Trial 23:
Parameters: {'thresholds': (0.21, 0.33), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-2_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 64}
Generated 3680 pseudo masks
Input images: 3680
tensor(2) tensor(0)
Generated 3680 pseudo masks saved at cam/saved_models/resnet50_gradcampp_trial_pseudo.pt
Number of train batches: 58
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.6461180189381475, 'accuracy': 0.5430597035781197, 'precision': 0.6852228698523148, 'recall': 0.3678425392378932, 'iou': 0.21777984396271083, 'dice': 0.2984047179636748}
Test   -> {'loss': 0.7000472545623779, 'accuracy': 0.40620046854019165, 'precision': 0.706673800945282, 'recall': 0.3760163486003876, 'iou': 0.17401716113090515, 'dice': 0.27221086621284485}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.4748673252437426, 'accuracy': 0.6835512124973795, 'precision': 0.596973617180534, 'recall': 0.5419611241506493, 'iou': 0.40523330880248026, 'dice': 0.5227746217147163}
Test   -> {'loss': 0.5583775043487549, 'accuracy': 0.543494701385498, 'precision': 0.45787596702575684, 'recall': 0.4599730968475342, 'iou': 0.315593421459198, 'dice': 0.45346590876579285}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.4310943219972693, 'accuracy': 0.6828110663787178, 'precision': 0.5797079272892164, 'recall': 0.5736263575761215, 'iou': 0.4400528653808262, 'dice': 0.5709068521209385}
Test   -> {'loss': 0.5465445518493652, 'accuracy': 0.5582708120346069, 'precision': 0.48459500074386597, 'recall': 0.47499650716781616, 'iou': 0.33055341243743896, 'dice': 0.46970972418785095}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.4281083205471868, 'accuracy': 0.6832808510116909, 'precision': 0.5831921846970268, 'recall': 0.5772707607435144, 'iou': 0.44278262905452564, 'dice': 0.5738300971362902}
Test   -> {'loss': 0.535730242729187, 'accuracy': 0.5580690503120422, 'precision': 0.48060911893844604, 'recall': 0.48893165588378906, 'iou': 0.3322083652019501, 'dice': 0.4742354154586792}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.42728049755096437, 'accuracy': 0.6833371307538904, 'precision': 0.5843951619189719, 'recall': 0.5780157669730809, 'iou': 0.44325189072152843, 'dice': 0.574544910762621}
Test   -> {'loss': 0.5165583491325378, 'accuracy': 0.5856015086174011, 'precision': 0.5063301920890808, 'recall': 0.49853751063346863, 'iou': 0.35574597120285034, 'dice': 0.49625247716903687}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.42648455785668415, 'accuracy': 0.6838180459063986, 'precision': 0.5858734167140464, 'recall': 0.578903403489486, 'iou': 0.44415414514748947, 'dice': 0.5754138775493788}
Test   -> {'loss': 0.7251482009887695, 'accuracy': 0.5506881475448608, 'precision': 0.3614107370376587, 'recall': 0.3400813043117523, 'iou': 0.21484850347042084, 'dice': 0.2964664697647095}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.426988887268564, 'accuracy': 0.68394506547762, 'precision': 0.5850165030230646, 'recall': 0.5784891584645147, 'iou': 0.4438502671925918, 'dice': 0.5750930148622264}
Test   -> {'loss': 0.7389000654220581, 'accuracy': 0.49341100454330444, 'precision': 0.33633875846862793, 'recall': 0.3309588134288788, 'iou': 0.19378992915153503, 'dice': 0.2779024541378021}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.4252746027448903, 'accuracy': 0.6855076468509177, 'precision': 0.5866698788559955, 'recall': 0.5800649907277978, 'iou': 0.44546158106430717, 'dice': 0.5766311604043711}
Test   -> {'loss': 0.6577461361885071, 'accuracy': 0.5177163481712341, 'precision': 0.3628482520580292, 'recall': 0.3867270350456238, 'iou': 0.2496812343597412, 'dice': 0.36233922839164734}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.42454880735148554, 'accuracy': 0.6862194564031519, 'precision': 0.5870061496029729, 'recall': 0.5810334983079329, 'iou': 0.44633242617482727, 'dice': 0.5773878626201464}
Test   -> {'loss': 0.7005050778388977, 'accuracy': 0.5483989715576172, 'precision': 0.3758412003517151, 'recall': 0.3476773202419281, 'iou': 0.2282267063856125, 'dice': 0.321779727935791}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.42330228142116383, 'accuracy': 0.6881070292514303, 'precision': 0.5882394759551338, 'recall': 0.5818516866020534, 'iou': 0.4478525141011114, 'dice': 0.5785784866498864}
Test   -> {'loss': 0.6127603054046631, 'accuracy': 0.5254939794540405, 'precision': 0.4002823829650879, 'recall': 0.4091072082519531, 'iou': 0.2755528688430786, 'dice': 0.40199846029281616}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 5 with IoU 0.35574597120285034
Test -> {'loss': 0.5165583491325378, 'accuracy': 0.5856015086174011, 'precision': 0.5063301920890808, 'recall': 0.49853751063346863, 'iou': 0.35574597120285034, 'dice': 0.49625247716903687} 
Train -> {'loss': 0.42728049755096437, 'accuracy': 0.6833371307538904, 'precision': 0.5843951619189719, 'recall': 0.5780157669730809, 'iou': 0.44325189072152843, 'dice': 0.574544910762621} 

Best model saved for model segnet at epoch 10

Best parameters:
Best parameters: {'thresholds': (0.25, 0.325), 'loss_fn': 'dice_loss', 'optimizer': 'adamw_1e-3_1e-4', 'scheduler': 'steplr_15_0.1', 'batch_size': 16}
Max IoU: 0.4014
Best metrics: {'loss': 0.48478188482868345, 'accuracy': 0.6615564420262875, 'precision': 0.5300181835329347, 'recall': 0.5473327290852604, 'iou': 0.40139512857028786, 'dice': 0.5306643928289738}
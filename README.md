# COMP0197 CW2

This codebase contains submission code for COMP0197 Applied Deep Learning coursework 2.

## Setting up Environment

### Base Environment
To create a base conda environment, please execute the below script.
```bash
conda create -n comp0197-cw1-pt python=3.12 pip && conda activate comp0197-cw1-pt && pip install torch==2.5.0 torchvision --index-url https://download.pytorch.org/whl/cpu
```

### Extra Dependencies
In addition to above base packages, this codebase also requires below packages to be installed.
```bash
pip install scikit-image
```


## Script Execution Instructions

### Fully Supervised Model

### Weakly Supervised Model

1. Finetune classifier without regularization
   ```sh
   python -m cam.finetune
   ```
   or with regularization
   ```sh
   python -m crm.train_cam_with_crm
   python -m crm.evaluate_with_crm
   ```
   
3. Get pseudo masks generated by extracting CAM from the classifier:
   ```sh
   python -m cam.postprocessing --model=resnet
   ```

   Sample heapmap images are generated in the ```cam/output/cam_grid.jpg```
4. Train the segmentation model with pseudo masks
   ```sh
   python -m model.train --model=segnet --pseudo --pseudo_path=cam/saved_models/resnet50_gradcampp_pseudo.pt
   ```

### Open-ended Section

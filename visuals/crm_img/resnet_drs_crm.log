Using device: cuda
torch.Size([16, 3, 224, 224]) torch.Size([16, 1, 224, 224])
Using SegNet model
Pseudo mask data loaded from crm_models/resnet_drs_pet_gradcampp_crm_pseudo.pt
torch.Size([16, 3, 224, 224]) torch.Size([16, 224, 224])
torch.Size([16, 3, 224, 224])
Number of train batches: 230
Start epoch 1
Epoch 1/10
Train -> {'loss': 0.4646261155605316, 'accuracy': 0.8064970107182212, 'precision': 0.7174544948598612, 'recall': 0.7032492822926978, 'iou': 0.5904201867787734, 'dice': 0.7008671668560609}
Test   -> {'loss': 1.4546805620193481, 'accuracy': 0.5987698435783386, 'precision': 0.4621792435646057, 'recall': 0.48389917612075806, 'iou': 0.33345621824264526, 'dice': 0.4607853889465332}
--------------------------------------------------
Start epoch 2
Epoch 2/10
Train -> {'loss': 0.3632251801698104, 'accuracy': 0.8469811802325041, 'precision': 0.7775790061639702, 'recall': 0.7685105189033177, 'iou': 0.662767191555189, 'dice': 0.7710974680340809}
Test   -> {'loss': 1.614406943321228, 'accuracy': 0.5839806199073792, 'precision': 0.4964323937892914, 'recall': 0.4950660467147827, 'iou': 0.3567178249359131, 'dice': 0.49510499835014343}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 2
Start epoch 3
Epoch 3/10
Train -> {'loss': 0.3314276642125586, 'accuracy': 0.8602977335453034, 'precision': 0.7967355365338533, 'recall': 0.790237518756286, 'iou': 0.6871549813643746, 'dice': 0.792383621049964}
Test   -> {'loss': 1.2609683275222778, 'accuracy': 0.6401005983352661, 'precision': 0.5265735983848572, 'recall': 0.5329996347427368, 'iou': 0.3922823667526245, 'dice': 0.5241413116455078}
--------------------------------------------------
Start epoch 4
Epoch 4/10
Train -> {'loss': 0.3067407561385113, 'accuracy': 0.8700329562892084, 'precision': 0.8106092022812885, 'recall': 0.8053352700627369, 'iou': 0.7047142972116885, 'dice': 0.807081029985262}
Test   -> {'loss': 1.6966180801391602, 'accuracy': 0.6282771825790405, 'precision': 0.5165392160415649, 'recall': 0.5317925214767456, 'iou': 0.38072535395622253, 'dice': 0.513809084892273}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 4
Start epoch 5
Epoch 5/10
Train -> {'loss': 0.2924218911839568, 'accuracy': 0.8760532801565917, 'precision': 0.8195243472638337, 'recall': 0.8148844345756199, 'iou': 0.7159042671970699, 'dice': 0.8162473468676857}
Test   -> {'loss': 1.837802529335022, 'accuracy': 0.6269319653511047, 'precision': 0.5103242993354797, 'recall': 0.5212070345878601, 'iou': 0.3782534599304199, 'dice': 0.5127861499786377}
--------------------------------------------------
Start epoch 6
Epoch 6/10
Train -> {'loss': 0.27269182872513065, 'accuracy': 0.8844092257644819, 'precision': 0.8310373676859815, 'recall': 0.8272446676440861, 'iou': 0.7311489188152811, 'dice': 0.828462681044703}
Test   -> {'loss': 1.7323274612426758, 'accuracy': 0.6184816956520081, 'precision': 0.48573264479637146, 'recall': 0.5054582357406616, 'iou': 0.3570966124534607, 'dice': 0.48738259077072144}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 6
Start epoch 7
Epoch 7/10
Train -> {'loss': 0.25225013326043666, 'accuracy': 0.8928489311881688, 'precision': 0.8428710377734641, 'recall': 0.8401872953642969, 'iou': 0.7471128601094951, 'dice': 0.8409525443678317}
Test   -> {'loss': 1.8483480215072632, 'accuracy': 0.6290594339370728, 'precision': 0.5200139284133911, 'recall': 0.539007842540741, 'iou': 0.38573917746543884, 'dice': 0.5194858312606812}
--------------------------------------------------
Start epoch 8
Epoch 8/10
Train -> {'loss': 0.234745141280734, 'accuracy': 0.9004069787004719, 'precision': 0.8537671148777009, 'recall': 0.8511903138264366, 'iou': 0.7615941179835278, 'dice': 0.8519145299559054}
Test   -> {'loss': 1.553804874420166, 'accuracy': 0.6540963053703308, 'precision': 0.5351584553718567, 'recall': 0.541570782661438, 'iou': 0.40526336431503296, 'dice': 0.5351724028587341}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 8
Start epoch 9
Epoch 9/10
Train -> {'loss': 0.2197839511477429, 'accuracy': 0.9064677964086117, 'precision': 0.8624902849612028, 'recall': 0.86004777006481, 'iou': 0.7733266418394835, 'dice': 0.8607959939085918}
Test   -> {'loss': 2.2671146392822266, 'accuracy': 0.6106542348861694, 'precision': 0.5032534003257751, 'recall': 0.5194848775863647, 'iou': 0.3672204911708832, 'dice': 0.5027908682823181}
--------------------------------------------------
Start epoch 10
Epoch 10/10
Train -> {'loss': 0.20760831709789193, 'accuracy': 0.9108959247236667, 'precision': 0.868729026162106, 'recall': 0.867156987345737, 'iou': 0.7823763922504757, 'dice': 0.8673762531384178}
Test   -> {'loss': 2.3008065223693848, 'accuracy': 0.6210414171218872, 'precision': 0.49140995740890503, 'recall': 0.5285959243774414, 'iou': 0.35710081458091736, 'dice': 0.4883052706718445}
--------------------------------------------------
Model weights, optimiser, scheduler order saved for model segnet at epoch 10
Best model found at epoch 8 with IoU 0.40526336431503296
Test -> {'loss': 1.553804874420166, 'accuracy': 0.6540963053703308, 'precision': 0.5351584553718567, 'recall': 0.541570782661438, 'iou': 0.40526336431503296, 'dice': 0.5351724028587341} 
Train -> {'loss': 0.234745141280734, 'accuracy': 0.9004069787004719, 'precision': 0.8537671148777009, 'recall': 0.8511903138264366, 'iou': 0.7615941179835278, 'dice': 0.8519145299559054} 

Best model saved for model segnet at epoch 10
Final test metrics:   -> {'loss': 2.2284456639304153, 'accuracy': 0.6082077568478661, 'precision': 0.5058478404696484, 'recall': 0.519103314870708, 'iou': 0.3671744036622514, 'dice': 0.5020380643886583}
Saved grid of 8 examples as 'montage_fully_supervised.png'
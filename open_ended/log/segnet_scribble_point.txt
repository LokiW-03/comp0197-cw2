Using device: cuda
Initializing dataset: split=train, mode=hybrid_points_scribbles, augment=True
Using first 5173 images for training.
Loading weak labels from ./weak_labels/weak_labels_train.pkl
Initializing dataset: split=val, mode=full, augment=False
Using images 5173 to 6280 for validation.
Initializing model in 'hybrid' mode with 2 output classes for segmentation head.
Downloading: "https://download.pytorch.org/models/vgg16_bn-6c64b313.pth" to /root/.cache/torch/hub/checkpoints/vgg16_bn-6c64b313.pth
100% 528M/528M [00:02<00:00, 219MB/s]

Starting training run: segnet_hybrid_points_scribbles_run1
Supervision: hybrid_points_scribbles, Batch Size: 64, LR: 0.0002, Epochs: 25, Num Classes: 2

--- Epoch 1/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.4270, Current Train Acc (GT): 0.4865, Batch Time: 0.44s, Epoch ETA: 00:00:16
Training epoch finished. Average Loss: 0.2787, Train Acc (GT): 0.5018, Train Pet IoU (GT): 0.3386
Starting validation epoch...
Validation epoch finished. Average Loss: 2.3962, Val Acc: 0.5291, Val Pet IoU: 0.3444
Epoch 1 Summary: Train Loss: 0.2787, Train Acc: 0.5018, Train Pet IoU: 0.3386 | Val Loss: 2.3962, Val Acc: 0.5291, Val Pet IoU: 0.3444 | LR: 0.000199
Checkpoint saved: Validation IOU improved to 0.3444 (Loss: 2.3962, Pet IoU: 0.3444). Saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_best_acc.pth
Epoch 1 duration: 00:00:43
Estimated time remaining: 00:17:22

--- Epoch 2/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0200, Current Train Acc (GT): 0.5259, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0179, Train Acc (GT): 0.5247, Train Pet IoU (GT): 0.3602
Starting validation epoch...
Validation epoch finished. Average Loss: 2.9316, Val Acc: 0.5187, Val Pet IoU: 0.3400
Epoch 2 Summary: Train Loss: 0.0179, Train Acc: 0.5247, Train Pet IoU: 0.3602 | Val Loss: 2.9316, Val Acc: 0.5187, Val Pet IoU: 0.3400 | LR: 0.000197
Epoch 2 duration: 00:00:40
Estimated time remaining: 00:16:04

--- Epoch 3/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0091, Current Train Acc (GT): 0.5155, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0085, Train Acc (GT): 0.5148, Train Pet IoU (GT): 0.3559
Starting validation epoch...
Validation epoch finished. Average Loss: 3.3582, Val Acc: 0.5071, Val Pet IoU: 0.3350
Epoch 3 Summary: Train Loss: 0.0085, Train Acc: 0.5148, Train Pet IoU: 0.3559 | Val Loss: 3.3582, Val Acc: 0.5071, Val Pet IoU: 0.3350 | LR: 0.000193
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_2.pth
Epoch 3 duration: 00:00:41
Estimated time remaining: 00:15:14

--- Epoch 4/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0053, Current Train Acc (GT): 0.5111, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0050, Train Acc (GT): 0.5111, Train Pet IoU (GT): 0.3543
Starting validation epoch...
Validation epoch finished. Average Loss: 3.5452, Val Acc: 0.5080, Val Pet IoU: 0.3355
Epoch 4 Summary: Train Loss: 0.0050, Train Acc: 0.5111, Train Pet IoU: 0.3543 | Val Loss: 3.5452, Val Acc: 0.5080, Val Pet IoU: 0.3355 | LR: 0.000188
Epoch 4 duration: 00:00:41
Estimated time remaining: 00:14:27

--- Epoch 5/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0037, Current Train Acc (GT): 0.5093, Batch Time: 0.44s, Epoch ETA: 00:00:14
Training epoch finished. Average Loss: 0.0034, Train Acc (GT): 0.5091, Train Pet IoU (GT): 0.3535
Starting validation epoch...
Validation epoch finished. Average Loss: 3.7349, Val Acc: 0.5060, Val Pet IoU: 0.3346
Epoch 5 Summary: Train Loss: 0.0034, Train Acc: 0.5091, Train Pet IoU: 0.3535 | Val Loss: 3.7349, Val Acc: 0.5060, Val Pet IoU: 0.3346 | LR: 0.000181
Epoch 5 duration: 00:00:40
Estimated time remaining: 00:13:42

--- Epoch 6/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0026, Current Train Acc (GT): 0.5077, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0025, Train Acc (GT): 0.5074, Train Pet IoU (GT): 0.3528
Starting validation epoch...
Validation epoch finished. Average Loss: 3.8870, Val Acc: 0.5052, Val Pet IoU: 0.3342
Epoch 6 Summary: Train Loss: 0.0025, Train Acc: 0.5074, Train Pet IoU: 0.3528 | Val Loss: 3.8870, Val Acc: 0.5052, Val Pet IoU: 0.3342 | LR: 0.000173
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_5.pth
Epoch 6 duration: 00:00:41
Estimated time remaining: 00:13:00

--- Epoch 7/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0020, Current Train Acc (GT): 0.5066, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0019, Train Acc (GT): 0.5064, Train Pet IoU (GT): 0.3523
Starting validation epoch...
Validation epoch finished. Average Loss: 4.0373, Val Acc: 0.5043, Val Pet IoU: 0.3338
Epoch 7 Summary: Train Loss: 0.0019, Train Acc: 0.5064, Train Pet IoU: 0.3523 | Val Loss: 4.0373, Val Acc: 0.5043, Val Pet IoU: 0.3338 | LR: 0.000164
Epoch 7 duration: 00:00:40
Estimated time remaining: 00:12:17

--- Epoch 8/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0016, Current Train Acc (GT): 0.5059, Batch Time: 0.44s, Epoch ETA: 00:00:14
Training epoch finished. Average Loss: 0.0016, Train Acc (GT): 0.5058, Train Pet IoU (GT): 0.3520
Starting validation epoch...
Validation epoch finished. Average Loss: 4.1653, Val Acc: 0.5034, Val Pet IoU: 0.3335
Epoch 8 Summary: Train Loss: 0.0016, Train Acc: 0.5058, Train Pet IoU: 0.3520 | Val Loss: 4.1653, Val Acc: 0.5034, Val Pet IoU: 0.3335 | LR: 0.000154
Epoch 8 duration: 00:00:40
Estimated time remaining: 00:11:34

--- Epoch 9/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0013, Current Train Acc (GT): 0.5056, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0013, Train Acc (GT): 0.5055, Train Pet IoU (GT): 0.3519
Starting validation epoch...
Validation epoch finished. Average Loss: 4.2465, Val Acc: 0.5037, Val Pet IoU: 0.3336
Epoch 9 Summary: Train Loss: 0.0013, Train Acc: 0.5055, Train Pet IoU: 0.3519 | Val Loss: 4.2465, Val Acc: 0.5037, Val Pet IoU: 0.3336 | LR: 0.000143
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_8.pth
Epoch 9 duration: 00:00:41
Estimated time remaining: 00:10:53

--- Epoch 10/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0012, Current Train Acc (GT): 0.5046, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0012, Train Acc (GT): 0.5045, Train Pet IoU (GT): 0.3515
Starting validation epoch...
Validation epoch finished. Average Loss: 4.3231, Val Acc: 0.5032, Val Pet IoU: 0.3334
Epoch 10 Summary: Train Loss: 0.0012, Train Acc: 0.5045, Train Pet IoU: 0.3515 | Val Loss: 4.3231, Val Acc: 0.5032, Val Pet IoU: 0.3334 | LR: 0.000132
Epoch 10 duration: 00:00:40
Estimated time remaining: 00:10:12

--- Epoch 11/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0010, Current Train Acc (GT): 0.5042, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0010, Train Acc (GT): 0.5041, Train Pet IoU (GT): 0.3513
Starting validation epoch...
Validation epoch finished. Average Loss: 4.3887, Val Acc: 0.5029, Val Pet IoU: 0.3332
Epoch 11 Summary: Train Loss: 0.0010, Train Acc: 0.5041, Train Pet IoU: 0.3513 | Val Loss: 4.3887, Val Acc: 0.5029, Val Pet IoU: 0.3332 | LR: 0.000120
Epoch 11 duration: 00:00:41
Estimated time remaining: 00:09:31

--- Epoch 12/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0009, Current Train Acc (GT): 0.5041, Batch Time: 0.44s, Epoch ETA: 00:00:14
Training epoch finished. Average Loss: 0.0008, Train Acc (GT): 0.5042, Train Pet IoU (GT): 0.3513
Starting validation epoch...
Validation epoch finished. Average Loss: 4.4436, Val Acc: 0.5032, Val Pet IoU: 0.3333
Epoch 12 Summary: Train Loss: 0.0008, Train Acc: 0.5042, Train Pet IoU: 0.3513 | Val Loss: 4.4436, Val Acc: 0.5032, Val Pet IoU: 0.3333 | LR: 0.000107
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_11.pth
Epoch 12 duration: 00:00:41
Estimated time remaining: 00:08:50

--- Epoch 13/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0008, Current Train Acc (GT): 0.5043, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0008, Train Acc (GT): 0.5043, Train Pet IoU (GT): 0.3514
Starting validation epoch...
Validation epoch finished. Average Loss: 4.5222, Val Acc: 0.5029, Val Pet IoU: 0.3332
Epoch 13 Summary: Train Loss: 0.0008, Train Acc: 0.5043, Train Pet IoU: 0.3514 | Val Loss: 4.5222, Val Acc: 0.5029, Val Pet IoU: 0.3332 | LR: 0.000095
Epoch 13 duration: 00:00:41
Estimated time remaining: 00:08:09

--- Epoch 14/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0007, Current Train Acc (GT): 0.5041, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0007, Train Acc (GT): 0.5041, Train Pet IoU (GT): 0.3513
Starting validation epoch...
Validation epoch finished. Average Loss: 4.5439, Val Acc: 0.5030, Val Pet IoU: 0.3332
Epoch 14 Summary: Train Loss: 0.0007, Train Acc: 0.5041, Train Pet IoU: 0.3513 | Val Loss: 4.5439, Val Acc: 0.5030, Val Pet IoU: 0.3332 | LR: 0.000082
Epoch 14 duration: 00:00:41
Estimated time remaining: 00:07:28

--- Epoch 15/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0007, Current Train Acc (GT): 0.5040, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0007, Train Acc (GT): 0.5040, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.5638, Val Acc: 0.5034, Val Pet IoU: 0.3334
Epoch 15 Summary: Train Loss: 0.0007, Train Acc: 0.5040, Train Pet IoU: 0.3512 | Val Loss: 4.5638, Val Acc: 0.5034, Val Pet IoU: 0.3334 | LR: 0.000070
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_14.pth
Epoch 15 duration: 00:00:41
Estimated time remaining: 00:06:48

--- Epoch 16/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0006, Current Train Acc (GT): 0.5040, Batch Time: 0.44s, Epoch ETA: 00:00:14
Training epoch finished. Average Loss: 0.0006, Train Acc (GT): 0.5041, Train Pet IoU (GT): 0.3513
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6016, Val Acc: 0.5029, Val Pet IoU: 0.3332
Epoch 16 Summary: Train Loss: 0.0006, Train Acc: 0.5041, Train Pet IoU: 0.3513 | Val Loss: 4.6016, Val Acc: 0.5029, Val Pet IoU: 0.3332 | LR: 0.000059
Epoch 16 duration: 00:00:40
Estimated time remaining: 00:06:07

--- Epoch 17/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0006, Current Train Acc (GT): 0.5039, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0006, Train Acc (GT): 0.5040, Train Pet IoU (GT): 0.3513
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6241, Val Acc: 0.5031, Val Pet IoU: 0.3333
Epoch 17 Summary: Train Loss: 0.0006, Train Acc: 0.5040, Train Pet IoU: 0.3513 | Val Loss: 4.6241, Val Acc: 0.5031, Val Pet IoU: 0.3333 | LR: 0.000048
Epoch 17 duration: 00:00:41
Estimated time remaining: 00:05:26

--- Epoch 18/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0005, Current Train Acc (GT): 0.5040, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0005, Train Acc (GT): 0.5040, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6432, Val Acc: 0.5030, Val Pet IoU: 0.3333
Epoch 18 Summary: Train Loss: 0.0005, Train Acc: 0.5040, Train Pet IoU: 0.3512 | Val Loss: 4.6432, Val Acc: 0.5030, Val Pet IoU: 0.3333 | LR: 0.000038
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_17.pth
Epoch 18 duration: 00:00:41
Estimated time remaining: 00:04:45

--- Epoch 19/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0006, Current Train Acc (GT): 0.5038, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0006, Train Acc (GT): 0.5039, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6440, Val Acc: 0.5032, Val Pet IoU: 0.3334
Epoch 19 Summary: Train Loss: 0.0006, Train Acc: 0.5039, Train Pet IoU: 0.3512 | Val Loss: 4.6440, Val Acc: 0.5032, Val Pet IoU: 0.3334 | LR: 0.000029
Epoch 19 duration: 00:00:40
Estimated time remaining: 00:04:05

--- Epoch 20/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0005, Current Train Acc (GT): 0.5039, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0005, Train Acc (GT): 0.5039, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6734, Val Acc: 0.5031, Val Pet IoU: 0.3333
Epoch 20 Summary: Train Loss: 0.0005, Train Acc: 0.5039, Train Pet IoU: 0.3512 | Val Loss: 4.6734, Val Acc: 0.5031, Val Pet IoU: 0.3333 | LR: 0.000021
Epoch 20 duration: 00:00:40
Estimated time remaining: 00:03:24

--- Epoch 21/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0005, Current Train Acc (GT): 0.5039, Batch Time: 0.44s, Epoch ETA: 00:00:14
Training epoch finished. Average Loss: 0.0005, Train Acc (GT): 0.5039, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6657, Val Acc: 0.5033, Val Pet IoU: 0.3334
Epoch 21 Summary: Train Loss: 0.0005, Train Acc: 0.5039, Train Pet IoU: 0.3512 | Val Loss: 4.6657, Val Acc: 0.5033, Val Pet IoU: 0.3334 | LR: 0.000014
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_20.pth
Epoch 21 duration: 00:00:41
Estimated time remaining: 00:02:43

--- Epoch 22/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0005, Current Train Acc (GT): 0.5039, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0005, Train Acc (GT): 0.5039, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6998, Val Acc: 0.5028, Val Pet IoU: 0.3332
Epoch 22 Summary: Train Loss: 0.0005, Train Acc: 0.5039, Train Pet IoU: 0.3512 | Val Loss: 4.6998, Val Acc: 0.5028, Val Pet IoU: 0.3332 | LR: 0.000009
Epoch 22 duration: 00:00:41
Estimated time remaining: 00:02:02

--- Epoch 23/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0005, Current Train Acc (GT): 0.5039, Batch Time: 0.44s, Epoch ETA: 00:00:14
Training epoch finished. Average Loss: 0.0005, Train Acc (GT): 0.5038, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6990, Val Acc: 0.5028, Val Pet IoU: 0.3332
Epoch 23 Summary: Train Loss: 0.0005, Train Acc: 0.5038, Train Pet IoU: 0.3512 | Val Loss: 4.6990, Val Acc: 0.5028, Val Pet IoU: 0.3332 | LR: 0.000005
Epoch 23 duration: 00:00:40
Estimated time remaining: 00:01:21

--- Epoch 24/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0005, Current Train Acc (GT): 0.5038, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0005, Train Acc (GT): 0.5038, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.7142, Val Acc: 0.5028, Val Pet IoU: 0.3332
Epoch 24 Summary: Train Loss: 0.0005, Train Acc: 0.5038, Train Pet IoU: 0.3512 | Val Loss: 4.7142, Val Acc: 0.5028, Val Pet IoU: 0.3332 | LR: 0.000003
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_23.pth
Epoch 24 duration: 00:00:42
Estimated time remaining: 00:00:41

--- Epoch 25/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.0005, Current Train Acc (GT): 0.5039, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.0005, Train Acc (GT): 0.5038, Train Pet IoU (GT): 0.3512
Starting validation epoch...
Validation epoch finished. Average Loss: 4.6829, Val Acc: 0.5031, Val Pet IoU: 0.3333
Epoch 25 Summary: Train Loss: 0.0005, Train Acc: 0.5038, Train Pet IoU: 0.3512 | Val Loss: 4.6829, Val Acc: 0.5031, Val Pet IoU: 0.3333 | LR: 0.000002
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_24.pth
Epoch 25 duration: 00:00:41

------------------------------------
Training finished.
Total Training Time: 00:16:59
Best Validation IOU achieved: 0.3444
Best model saved to: ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_best_acc.pth (if accuracy improved)
Latest model saved to: ./checkpoints_hybrid/segnet_hybrid_points_scribbles_run1_latest.pth

RECOMMENDATION: Load the '_best_acc.pth' checkpoint and evaluate it on the separate TEST set for final performance.
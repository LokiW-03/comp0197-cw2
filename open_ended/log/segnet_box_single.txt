Using device: cuda
Initializing dataset: split=train, mode=boxes, augment=True
Using first 5173 images for training.
Loading weak labels from ./weak_labels/weak_labels_train.pkl
Initializing dataset: split=val, mode=full, augment=False
Using images 5173 to 6280 for validation.
Initializing model with 2 output classes.

Starting training run: segnet_boxes_run1
Supervision: boxes, Batch Size: 64, LR: 0.0002, Epochs: 25, Num Classes: 2

--- Epoch 1/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.5486
Training epoch finished. Avg Loss: 0.5004, Train Acc (GT): 0.6894, Train Pet IoU (GT): 0.4419
Starting validation epoch...
Validation epoch finished. Average Loss: 0.5510, Val Acc: 0.7373, Val Pet IoU: 0.4826
Epoch 1 Summary: Train Loss: 0.5004, Train Acc: 0.6894, Train Pet IoU: 0.4419 | Val Loss: 0.5510, Val Acc: 0.7373, Val Pet IoU: 0.4826 | LR: 0.000199
Checkpoint saved: Validation IOU improved to 0.4826. Saved to ./checkpoints_single/segnet_boxes_run1_best_acc.pth

--- Epoch 2/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.3816
Training epoch finished. Avg Loss: 0.3812, Train Acc (GT): 0.7090, Train Pet IoU (GT): 0.4666
Starting validation epoch...
Validation epoch finished. Average Loss: 0.9508, Val Acc: 0.7286, Val Pet IoU: 0.4740
Epoch 2 Summary: Train Loss: 0.3812, Train Acc: 0.7090, Train Pet IoU: 0.4666 | Val Loss: 0.9508, Val Acc: 0.7286, Val Pet IoU: 0.4740 | LR: 0.000197

--- Epoch 3/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.3517
Training epoch finished. Avg Loss: 0.3510, Train Acc (GT): 0.7083, Train Pet IoU (GT): 0.4653
Starting validation epoch...
Validation epoch finished. Average Loss: 0.7430, Val Acc: 0.7181, Val Pet IoU: 0.4624
Epoch 3 Summary: Train Loss: 0.3510, Train Acc: 0.7083, Train Pet IoU: 0.4653 | Val Loss: 0.7430, Val Acc: 0.7181, Val Pet IoU: 0.4624 | LR: 0.000193
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_2.pth

--- Epoch 4/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.3213
Training epoch finished. Avg Loss: 0.3224, Train Acc (GT): 0.7097, Train Pet IoU (GT): 0.4670
Starting validation epoch...
Validation epoch finished. Average Loss: 0.8160, Val Acc: 0.7097, Val Pet IoU: 0.4504
Epoch 4 Summary: Train Loss: 0.3224, Train Acc: 0.7097, Train Pet IoU: 0.4670 | Val Loss: 0.8160, Val Acc: 0.7097, Val Pet IoU: 0.4504 | LR: 0.000188

--- Epoch 5/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.2963
Training epoch finished. Avg Loss: 0.3016, Train Acc (GT): 0.7087, Train Pet IoU (GT): 0.4658
Starting validation epoch...
Validation epoch finished. Average Loss: 0.9617, Val Acc: 0.7239, Val Pet IoU: 0.4676
Epoch 5 Summary: Train Loss: 0.3016, Train Acc: 0.7087, Train Pet IoU: 0.4658 | Val Loss: 0.9617, Val Acc: 0.7239, Val Pet IoU: 0.4676 | LR: 0.000181

--- Epoch 6/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.2746
Training epoch finished. Avg Loss: 0.2775, Train Acc (GT): 0.7099, Train Pet IoU (GT): 0.4673
Starting validation epoch...
Validation epoch finished. Average Loss: 1.0884, Val Acc: 0.7126, Val Pet IoU: 0.4550
Epoch 6 Summary: Train Loss: 0.2775, Train Acc: 0.7099, Train Pet IoU: 0.4673 | Val Loss: 1.0884, Val Acc: 0.7126, Val Pet IoU: 0.4550 | LR: 0.000173
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_5.pth

--- Epoch 7/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.2563
Training epoch finished. Avg Loss: 0.2593, Train Acc (GT): 0.7083, Train Pet IoU (GT): 0.4652
Starting validation epoch...
Validation epoch finished. Average Loss: 1.0809, Val Acc: 0.6963, Val Pet IoU: 0.4346
Epoch 7 Summary: Train Loss: 0.2593, Train Acc: 0.7083, Train Pet IoU: 0.4652 | Val Loss: 1.0809, Val Acc: 0.6963, Val Pet IoU: 0.4346 | LR: 0.000164

--- Epoch 8/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.2381
Training epoch finished. Avg Loss: 0.2376, Train Acc (GT): 0.7104, Train Pet IoU (GT): 0.4675
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3227, Val Acc: 0.7055, Val Pet IoU: 0.4488
Epoch 8 Summary: Train Loss: 0.2376, Train Acc: 0.7104, Train Pet IoU: 0.4675 | Val Loss: 1.3227, Val Acc: 0.7055, Val Pet IoU: 0.4488 | LR: 0.000154

--- Epoch 9/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.2237
Training epoch finished. Avg Loss: 0.2266, Train Acc (GT): 0.7101, Train Pet IoU (GT): 0.4675
Starting validation epoch...
Validation epoch finished. Average Loss: 1.0958, Val Acc: 0.6930, Val Pet IoU: 0.4303
Epoch 9 Summary: Train Loss: 0.2266, Train Acc: 0.7101, Train Pet IoU: 0.4675 | Val Loss: 1.0958, Val Acc: 0.6930, Val Pet IoU: 0.4303 | LR: 0.000143
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_8.pth

--- Epoch 10/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.2038
Training epoch finished. Avg Loss: 0.2039, Train Acc (GT): 0.7095, Train Pet IoU (GT): 0.4666
Starting validation epoch...
Validation epoch finished. Average Loss: 1.1540, Val Acc: 0.7213, Val Pet IoU: 0.4646
Epoch 10 Summary: Train Loss: 0.2039, Train Acc: 0.7095, Train Pet IoU: 0.4666 | Val Loss: 1.1540, Val Acc: 0.7213, Val Pet IoU: 0.4646 | LR: 0.000132

--- Epoch 11/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1826
Training epoch finished. Avg Loss: 0.1848, Train Acc (GT): 0.7127, Train Pet IoU (GT): 0.4704
Starting validation epoch...
Validation epoch finished. Average Loss: 1.1047, Val Acc: 0.7144, Val Pet IoU: 0.4571
Epoch 11 Summary: Train Loss: 0.1848, Train Acc: 0.7127, Train Pet IoU: 0.4704 | Val Loss: 1.1047, Val Acc: 0.7144, Val Pet IoU: 0.4571 | LR: 0.000120

--- Epoch 12/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1696
Training epoch finished. Avg Loss: 0.1700, Train Acc (GT): 0.7124, Train Pet IoU (GT): 0.4701
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3777, Val Acc: 0.7050, Val Pet IoU: 0.4460
Epoch 12 Summary: Train Loss: 0.1700, Train Acc: 0.7124, Train Pet IoU: 0.4701 | Val Loss: 1.3777, Val Acc: 0.7050, Val Pet IoU: 0.4460 | LR: 0.000107
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_11.pth

--- Epoch 13/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1560
Training epoch finished. Avg Loss: 0.1559, Train Acc (GT): 0.7129, Train Pet IoU (GT): 0.4706
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4904, Val Acc: 0.7130, Val Pet IoU: 0.4548
Epoch 13 Summary: Train Loss: 0.1559, Train Acc: 0.7129, Train Pet IoU: 0.4706 | Val Loss: 1.4904, Val Acc: 0.7130, Val Pet IoU: 0.4548 | LR: 0.000095

--- Epoch 14/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1450
Training epoch finished. Avg Loss: 0.1430, Train Acc (GT): 0.7132, Train Pet IoU (GT): 0.4710
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3108, Val Acc: 0.7090, Val Pet IoU: 0.4504
Epoch 14 Summary: Train Loss: 0.1430, Train Acc: 0.7132, Train Pet IoU: 0.4710 | Val Loss: 1.3108, Val Acc: 0.7090, Val Pet IoU: 0.4504 | LR: 0.000082

--- Epoch 15/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1361
Training epoch finished. Avg Loss: 0.1364, Train Acc (GT): 0.7136, Train Pet IoU (GT): 0.4714
Starting validation epoch...
Validation epoch finished. Average Loss: 1.2595, Val Acc: 0.7137, Val Pet IoU: 0.4561
Epoch 15 Summary: Train Loss: 0.1364, Train Acc: 0.7136, Train Pet IoU: 0.4714 | Val Loss: 1.2595, Val Acc: 0.7137, Val Pet IoU: 0.4561 | LR: 0.000070
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_14.pth

--- Epoch 16/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1241
Training epoch finished. Avg Loss: 0.1243, Train Acc (GT): 0.7140, Train Pet IoU (GT): 0.4719
Starting validation epoch...
Validation epoch finished. Average Loss: 1.5227, Val Acc: 0.7134, Val Pet IoU: 0.4558
Epoch 16 Summary: Train Loss: 0.1243, Train Acc: 0.7140, Train Pet IoU: 0.4719 | Val Loss: 1.5227, Val Acc: 0.7134, Val Pet IoU: 0.4558 | LR: 0.000059

--- Epoch 17/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1162
Training epoch finished. Avg Loss: 0.1166, Train Acc (GT): 0.7152, Train Pet IoU (GT): 0.4732
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4703, Val Acc: 0.7201, Val Pet IoU: 0.4636
Epoch 17 Summary: Train Loss: 0.1166, Train Acc: 0.7152, Train Pet IoU: 0.4732 | Val Loss: 1.4703, Val Acc: 0.7201, Val Pet IoU: 0.4636 | LR: 0.000048

--- Epoch 18/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1096
Training epoch finished. Avg Loss: 0.1101, Train Acc (GT): 0.7149, Train Pet IoU (GT): 0.4729
Starting validation epoch...
Validation epoch finished. Average Loss: 1.5994, Val Acc: 0.7120, Val Pet IoU: 0.4544
Epoch 18 Summary: Train Loss: 0.1101, Train Acc: 0.7149, Train Pet IoU: 0.4729 | Val Loss: 1.5994, Val Acc: 0.7120, Val Pet IoU: 0.4544 | LR: 0.000038
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_17.pth

--- Epoch 19/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.1026
Training epoch finished. Avg Loss: 0.1036, Train Acc (GT): 0.7155, Train Pet IoU (GT): 0.4736
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4414, Val Acc: 0.7127, Val Pet IoU: 0.4548
Epoch 19 Summary: Train Loss: 0.1036, Train Acc: 0.7155, Train Pet IoU: 0.4736 | Val Loss: 1.4414, Val Acc: 0.7127, Val Pet IoU: 0.4548 | LR: 0.000029

--- Epoch 20/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.0971
Training epoch finished. Avg Loss: 0.0975, Train Acc (GT): 0.7158, Train Pet IoU (GT): 0.4740
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4959, Val Acc: 0.7117, Val Pet IoU: 0.4536
Epoch 20 Summary: Train Loss: 0.0975, Train Acc: 0.7158, Train Pet IoU: 0.4740 | Val Loss: 1.4959, Val Acc: 0.7117, Val Pet IoU: 0.4536 | LR: 0.000021

--- Epoch 21/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.0920
Training epoch finished. Avg Loss: 0.0924, Train Acc (GT): 0.7154, Train Pet IoU (GT): 0.4734
Starting validation epoch...
Validation epoch finished. Average Loss: 1.5266, Val Acc: 0.7139, Val Pet IoU: 0.4561
Epoch 21 Summary: Train Loss: 0.0924, Train Acc: 0.7154, Train Pet IoU: 0.4734 | Val Loss: 1.5266, Val Acc: 0.7139, Val Pet IoU: 0.4561 | LR: 0.000014
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_20.pth

--- Epoch 22/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.0897
Training epoch finished. Avg Loss: 0.0911, Train Acc (GT): 0.7159, Train Pet IoU (GT): 0.4742
Starting validation epoch...
Validation epoch finished. Average Loss: 1.6063, Val Acc: 0.7133, Val Pet IoU: 0.4559
Epoch 22 Summary: Train Loss: 0.0911, Train Acc: 0.7159, Train Pet IoU: 0.4742 | Val Loss: 1.6063, Val Acc: 0.7133, Val Pet IoU: 0.4559 | LR: 0.000009

--- Epoch 23/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.0875
Training epoch finished. Avg Loss: 0.0868, Train Acc (GT): 0.7155, Train Pet IoU (GT): 0.4734
Starting validation epoch...
Validation epoch finished. Average Loss: 1.5300, Val Acc: 0.7137, Val Pet IoU: 0.4557
Epoch 23 Summary: Train Loss: 0.0868, Train Acc: 0.7155, Train Pet IoU: 0.4734 | Val Loss: 1.5300, Val Acc: 0.7137, Val Pet IoU: 0.4557 | LR: 0.000005

--- Epoch 24/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.0868
Training epoch finished. Avg Loss: 0.0863, Train Acc (GT): 0.7159, Train Pet IoU (GT): 0.4742
Starting validation epoch...
Validation epoch finished. Average Loss: 1.6383, Val Acc: 0.7153, Val Pet IoU: 0.4581
Epoch 24 Summary: Train Loss: 0.0863, Train Acc: 0.7159, Train Pet IoU: 0.4742 | Val Loss: 1.6383, Val Acc: 0.7153, Val Pet IoU: 0.4581 | LR: 0.000003
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_23.pth

--- Epoch 25/25 ---
Starting training epoch (Metrics calculated against GT)...
  Batch 50/81, Current Avg Loss: 0.0846
Training epoch finished. Avg Loss: 0.0850, Train Acc (GT): 0.7160, Train Pet IoU (GT): 0.4740
Starting validation epoch...
Validation epoch finished. Average Loss: 1.5911, Val Acc: 0.7125, Val Pet IoU: 0.4544
Epoch 25 Summary: Train Loss: 0.0850, Train Acc: 0.7160, Train Pet IoU: 0.4740 | Val Loss: 1.5911, Val Acc: 0.7125, Val Pet IoU: 0.4544 | LR: 0.000002
Latest checkpoint saved to ./checkpoints_single/segnet_boxes_run1_24.pth

------------------------------------
Training finished.
Best Validation IOU achieved: 0.4826
Best model saved to: ./checkpoints_single/segnet_boxes_run1_best_acc.pth (if accuracy improved)
Latest model saved to: ./checkpoints_single/segnet_boxes_run1_latest.pth

RECOMMENDATION: Load the '_best_acc.pth' checkpoint and evaluate it on the separate TEST set for final performance.
Using device: cuda
Initializing dataset: split=train, mode=hybrid_points_scribbles_boxes, augment=True
Using first 5173 images for training.
Loading weak labels from ./weak_labels/weak_labels_train.pkl
Initializing dataset: split=val, mode=full, augment=False
Using images 5173 to 6280 for validation.
Initializing model in 'hybrid' mode with 2 output classes for segmentation head.

Starting training run: segnet_hybrid_points_scribbles_boxes_run1
Supervision: hybrid_points_scribbles_boxes, Batch Size: 64, LR: 0.0002, Epochs: 25, Num Classes: 2

--- Epoch 1/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 1.3751, Current Train Acc (GT): 0.5038, Batch Time: 0.44s, Epoch ETA: 00:00:16
Training epoch finished. Average Loss: 1.1751, Train Acc (GT): 0.5548, Train Pet IoU (GT): 0.3624
Starting validation epoch...
Validation epoch finished. Average Loss: 1.1061, Val Acc: 0.6395, Val Pet IoU: 0.4009
Epoch 1 Summary: Train Loss: 1.1751, Train Acc: 0.5548, Train Pet IoU: 0.3624 | Val Loss: 1.1061, Val Acc: 0.6395, Val Pet IoU: 0.4009 | LR: 0.000199
Checkpoint saved: Validation IOU improved to 0.4009 (Loss: 1.1061, Pet IoU: 0.4009). Saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_best_acc.pth
Epoch 1 duration: 00:00:43
Estimated time remaining: 00:17:02

--- Epoch 2/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.7369, Current Train Acc (GT): 0.6768, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.7343, Train Acc (GT): 0.6777, Train Pet IoU (GT): 0.4461
Starting validation epoch...
Validation epoch finished. Average Loss: 1.0259, Val Acc: 0.6849, Val Pet IoU: 0.4358
Epoch 2 Summary: Train Loss: 0.7343, Train Acc: 0.6777, Train Pet IoU: 0.4461 | Val Loss: 1.0259, Val Acc: 0.6849, Val Pet IoU: 0.4358 | LR: 0.000197
Checkpoint saved: Validation IOU improved to 0.4358 (Loss: 1.0259, Pet IoU: 0.4358). Saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_best_acc.pth
Epoch 2 duration: 00:00:42
Estimated time remaining: 00:16:10

--- Epoch 3/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.6551, Current Train Acc (GT): 0.6894, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.6518, Train Acc (GT): 0.6870, Train Pet IoU (GT): 0.4533
Starting validation epoch...
Validation epoch finished. Average Loss: 1.0460, Val Acc: 0.6768, Val Pet IoU: 0.4259
Epoch 3 Summary: Train Loss: 0.6518, Train Acc: 0.6870, Train Pet IoU: 0.4533 | Val Loss: 1.0460, Val Acc: 0.6768, Val Pet IoU: 0.4259 | LR: 0.000193
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_2.pth
Epoch 3 duration: 00:00:42
Estimated time remaining: 00:15:24

--- Epoch 4/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.6152, Current Train Acc (GT): 0.6874, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.6087, Train Acc (GT): 0.6899, Train Pet IoU (GT): 0.4556
Starting validation epoch...
Validation epoch finished. Average Loss: 1.1117, Val Acc: 0.6987, Val Pet IoU: 0.4462
Epoch 4 Summary: Train Loss: 0.6087, Train Acc: 0.6899, Train Pet IoU: 0.4556 | Val Loss: 1.1117, Val Acc: 0.6987, Val Pet IoU: 0.4462 | LR: 0.000188
Checkpoint saved: Validation IOU improved to 0.4462 (Loss: 1.1117, Pet IoU: 0.4462). Saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_best_acc.pth
Epoch 4 duration: 00:00:42
Estimated time remaining: 00:14:44

--- Epoch 5/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.5626, Current Train Acc (GT): 0.6922, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.5689, Train Acc (GT): 0.6918, Train Pet IoU (GT): 0.4561
Starting validation epoch...
Validation epoch finished. Average Loss: 0.9914, Val Acc: 0.6975, Val Pet IoU: 0.4449
Epoch 5 Summary: Train Loss: 0.5689, Train Acc: 0.6918, Train Pet IoU: 0.4561 | Val Loss: 0.9914, Val Acc: 0.6975, Val Pet IoU: 0.4449 | LR: 0.000181
Epoch 5 duration: 00:00:41
Estimated time remaining: 00:13:57

--- Epoch 6/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.5282, Current Train Acc (GT): 0.6969, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.5283, Train Acc (GT): 0.6960, Train Pet IoU (GT): 0.4597
Starting validation epoch...
Validation epoch finished. Average Loss: 1.1463, Val Acc: 0.7212, Val Pet IoU: 0.4694
Epoch 6 Summary: Train Loss: 0.5283, Train Acc: 0.6960, Train Pet IoU: 0.4597 | Val Loss: 1.1463, Val Acc: 0.7212, Val Pet IoU: 0.4694 | LR: 0.000173
Checkpoint saved: Validation IOU improved to 0.4694 (Loss: 1.1463, Pet IoU: 0.4694). Saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_best_acc.pth
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_5.pth
Epoch 6 duration: 00:00:43
Estimated time remaining: 00:13:18

--- Epoch 7/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.4998, Current Train Acc (GT): 0.6949, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.5053, Train Acc (GT): 0.6959, Train Pet IoU (GT): 0.4589
Starting validation epoch...
Validation epoch finished. Average Loss: 1.0184, Val Acc: 0.6877, Val Pet IoU: 0.4315
Epoch 7 Summary: Train Loss: 0.5053, Train Acc: 0.6959, Train Pet IoU: 0.4589 | Val Loss: 1.0184, Val Acc: 0.6877, Val Pet IoU: 0.4315 | LR: 0.000164
Epoch 7 duration: 00:00:41
Estimated time remaining: 00:12:33

--- Epoch 8/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.4674, Current Train Acc (GT): 0.6984, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.4759, Train Acc (GT): 0.6985, Train Pet IoU (GT): 0.4610
Starting validation epoch...
Validation epoch finished. Average Loss: 1.2139, Val Acc: 0.7086, Val Pet IoU: 0.4561
Epoch 8 Summary: Train Loss: 0.4759, Train Acc: 0.6985, Train Pet IoU: 0.4610 | Val Loss: 1.2139, Val Acc: 0.7086, Val Pet IoU: 0.4561 | LR: 0.000154
Epoch 8 duration: 00:00:41
Estimated time remaining: 00:11:49

--- Epoch 9/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.4505, Current Train Acc (GT): 0.6988, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.4496, Train Acc (GT): 0.6995, Train Pet IoU (GT): 0.4614
Starting validation epoch...
Validation epoch finished. Average Loss: 1.1012, Val Acc: 0.6889, Val Pet IoU: 0.4334
Epoch 9 Summary: Train Loss: 0.4496, Train Acc: 0.6995, Train Pet IoU: 0.4614 | Val Loss: 1.1012, Val Acc: 0.6889, Val Pet IoU: 0.4334 | LR: 0.000143
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_8.pth
Epoch 9 duration: 00:00:42
Estimated time remaining: 00:11:08

--- Epoch 10/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.4135, Current Train Acc (GT): 0.6988, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.4214, Train Acc (GT): 0.6990, Train Pet IoU (GT): 0.4604
Starting validation epoch...
Validation epoch finished. Average Loss: 1.1551, Val Acc: 0.7027, Val Pet IoU: 0.4472
Epoch 10 Summary: Train Loss: 0.4214, Train Acc: 0.6990, Train Pet IoU: 0.4604 | Val Loss: 1.1551, Val Acc: 0.7027, Val Pet IoU: 0.4472 | LR: 0.000132
Epoch 10 duration: 00:00:41
Estimated time remaining: 00:10:25

--- Epoch 11/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.3871, Current Train Acc (GT): 0.7041, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.3912, Train Acc (GT): 0.7025, Train Pet IoU (GT): 0.4637
Starting validation epoch...
Validation epoch finished. Average Loss: 1.0665, Val Acc: 0.7030, Val Pet IoU: 0.4470
Epoch 11 Summary: Train Loss: 0.3912, Train Acc: 0.7025, Train Pet IoU: 0.4637 | Val Loss: 1.0665, Val Acc: 0.7030, Val Pet IoU: 0.4470 | LR: 0.000120
Epoch 11 duration: 00:00:41
Estimated time remaining: 00:09:42

--- Epoch 12/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.3682, Current Train Acc (GT): 0.7016, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.3667, Train Acc (GT): 0.7018, Train Pet IoU (GT): 0.4627
Starting validation epoch...
Validation epoch finished. Average Loss: 1.2609, Val Acc: 0.6580, Val Pet IoU: 0.3970
Epoch 12 Summary: Train Loss: 0.3667, Train Acc: 0.7018, Train Pet IoU: 0.4627 | Val Loss: 1.2609, Val Acc: 0.6580, Val Pet IoU: 0.3970 | LR: 0.000107
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_11.pth
Epoch 12 duration: 00:00:41
Estimated time remaining: 00:09:00

--- Epoch 13/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.3449, Current Train Acc (GT): 0.7035, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.3435, Train Acc (GT): 0.7037, Train Pet IoU (GT): 0.4644
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3009, Val Acc: 0.6946, Val Pet IoU: 0.4388
Epoch 13 Summary: Train Loss: 0.3435, Train Acc: 0.7037, Train Pet IoU: 0.4644 | Val Loss: 1.3009, Val Acc: 0.6946, Val Pet IoU: 0.4388 | LR: 0.000095
Epoch 13 duration: 00:00:41
Estimated time remaining: 00:08:18

--- Epoch 14/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.3259, Current Train Acc (GT): 0.7026, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.3215, Train Acc (GT): 0.7039, Train Pet IoU (GT): 0.4640
Starting validation epoch...
Validation epoch finished. Average Loss: 1.2880, Val Acc: 0.6929, Val Pet IoU: 0.4361
Epoch 14 Summary: Train Loss: 0.3215, Train Acc: 0.7039, Train Pet IoU: 0.4640 | Val Loss: 1.2880, Val Acc: 0.6929, Val Pet IoU: 0.4361 | LR: 0.000082
Epoch 14 duration: 00:00:41
Estimated time remaining: 00:07:36

--- Epoch 15/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2989, Current Train Acc (GT): 0.7054, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2994, Train Acc (GT): 0.7040, Train Pet IoU (GT): 0.4636
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3163, Val Acc: 0.7063, Val Pet IoU: 0.4508
Epoch 15 Summary: Train Loss: 0.2994, Train Acc: 0.7040, Train Pet IoU: 0.4636 | Val Loss: 1.3163, Val Acc: 0.7063, Val Pet IoU: 0.4508 | LR: 0.000070
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_14.pth
Epoch 15 duration: 00:00:41
Estimated time remaining: 00:06:55

--- Epoch 16/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2754, Current Train Acc (GT): 0.7048, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2777, Train Acc (GT): 0.7053, Train Pet IoU (GT): 0.4649
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3418, Val Acc: 0.7112, Val Pet IoU: 0.4566
Epoch 16 Summary: Train Loss: 0.2777, Train Acc: 0.7053, Train Pet IoU: 0.4649 | Val Loss: 1.3418, Val Acc: 0.7112, Val Pet IoU: 0.4566 | LR: 0.000059
Epoch 16 duration: 00:00:41
Estimated time remaining: 00:06:13

--- Epoch 17/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2673, Current Train Acc (GT): 0.7077, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2675, Train Acc (GT): 0.7068, Train Pet IoU (GT): 0.4663
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3597, Val Acc: 0.7082, Val Pet IoU: 0.4528
Epoch 17 Summary: Train Loss: 0.2675, Train Acc: 0.7068, Train Pet IoU: 0.4663 | Val Loss: 1.3597, Val Acc: 0.7082, Val Pet IoU: 0.4528 | LR: 0.000048
Epoch 17 duration: 00:00:41
Estimated time remaining: 00:05:31

--- Epoch 18/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2534, Current Train Acc (GT): 0.7072, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2529, Train Acc (GT): 0.7066, Train Pet IoU (GT): 0.4658
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4169, Val Acc: 0.6995, Val Pet IoU: 0.4428
Epoch 18 Summary: Train Loss: 0.2529, Train Acc: 0.7066, Train Pet IoU: 0.4658 | Val Loss: 1.4169, Val Acc: 0.6995, Val Pet IoU: 0.4428 | LR: 0.000038
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_17.pth
Epoch 18 duration: 00:00:42
Estimated time remaining: 00:04:50

--- Epoch 19/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2353, Current Train Acc (GT): 0.7048, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2377, Train Acc (GT): 0.7069, Train Pet IoU (GT): 0.4660
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4048, Val Acc: 0.6958, Val Pet IoU: 0.4384
Epoch 19 Summary: Train Loss: 0.2377, Train Acc: 0.7069, Train Pet IoU: 0.4660 | Val Loss: 1.4048, Val Acc: 0.6958, Val Pet IoU: 0.4384 | LR: 0.000029
Epoch 19 duration: 00:00:41
Estimated time remaining: 00:04:08

--- Epoch 20/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2255, Current Train Acc (GT): 0.7093, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2250, Train Acc (GT): 0.7081, Train Pet IoU (GT): 0.4671
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3896, Val Acc: 0.7078, Val Pet IoU: 0.4515
Epoch 20 Summary: Train Loss: 0.2250, Train Acc: 0.7081, Train Pet IoU: 0.4671 | Val Loss: 1.3896, Val Acc: 0.7078, Val Pet IoU: 0.4515 | LR: 0.000021
Epoch 20 duration: 00:00:41
Estimated time remaining: 00:03:27

--- Epoch 21/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2140, Current Train Acc (GT): 0.7123, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2156, Train Acc (GT): 0.7082, Train Pet IoU (GT): 0.4670
Starting validation epoch...
Validation epoch finished. Average Loss: 1.3960, Val Acc: 0.7095, Val Pet IoU: 0.4527
Epoch 21 Summary: Train Loss: 0.2156, Train Acc: 0.7082, Train Pet IoU: 0.4670 | Val Loss: 1.3960, Val Acc: 0.7095, Val Pet IoU: 0.4527 | LR: 0.000014
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_20.pth
Epoch 21 duration: 00:00:42
Estimated time remaining: 00:02:46

--- Epoch 22/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2108, Current Train Acc (GT): 0.7078, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2131, Train Acc (GT): 0.7088, Train Pet IoU (GT): 0.4679
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4443, Val Acc: 0.7082, Val Pet IoU: 0.4519
Epoch 22 Summary: Train Loss: 0.2131, Train Acc: 0.7088, Train Pet IoU: 0.4679 | Val Loss: 1.4443, Val Acc: 0.7082, Val Pet IoU: 0.4519 | LR: 0.000009
Epoch 22 duration: 00:00:41
Estimated time remaining: 00:02:04

--- Epoch 23/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2091, Current Train Acc (GT): 0.7111, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2069, Train Acc (GT): 0.7086, Train Pet IoU (GT): 0.4673
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4017, Val Acc: 0.7085, Val Pet IoU: 0.4514
Epoch 23 Summary: Train Loss: 0.2069, Train Acc: 0.7086, Train Pet IoU: 0.4673 | Val Loss: 1.4017, Val Acc: 0.7085, Val Pet IoU: 0.4514 | LR: 0.000005
Epoch 23 duration: 00:00:41
Estimated time remaining: 00:01:23

--- Epoch 24/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2076, Current Train Acc (GT): 0.7094, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2047, Train Acc (GT): 0.7091, Train Pet IoU (GT): 0.4681
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4636, Val Acc: 0.7106, Val Pet IoU: 0.4547
Epoch 24 Summary: Train Loss: 0.2047, Train Acc: 0.7091, Train Pet IoU: 0.4681 | Val Loss: 1.4636, Val Acc: 0.7106, Val Pet IoU: 0.4547 | LR: 0.000003
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_23.pth
Epoch 24 duration: 00:00:42
Estimated time remaining: 00:00:41

--- Epoch 25/25 ---
Starting training epoch (metrics calculated against GT)...
  Train Batch 50/81, Loss: 0.2019, Current Train Acc (GT): 0.7079, Batch Time: 0.44s, Epoch ETA: 00:00:15
Training epoch finished. Average Loss: 0.2010, Train Acc (GT): 0.7086, Train Pet IoU (GT): 0.4671
Starting validation epoch...
Validation epoch finished. Average Loss: 1.4404, Val Acc: 0.7055, Val Pet IoU: 0.4482
Epoch 25 Summary: Train Loss: 0.2010, Train Acc: 0.7086, Train Pet IoU: 0.4671 | Val Loss: 1.4404, Val Acc: 0.7055, Val Pet IoU: 0.4482 | LR: 0.000002
Latest checkpoint saved to ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_24.pth
Epoch 25 duration: 00:00:41

------------------------------------
Training finished.
Total Training Time: 00:17:15
Best Validation IOU achieved: 0.4694
Best model saved to: ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_best_acc.pth (if accuracy improved)
Latest model saved to: ./checkpoints_hybrid/segnet_hybrid_points_scribbles_boxes_run1_latest.pth

RECOMMENDATION: Load the '_best_acc.pth' checkpoint and evaluate it on the separate TEST set for final performance.